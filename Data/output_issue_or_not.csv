title,body,tags,user_id,username,discussing_issue
Python - Lists checking if something has been randomised already,"<p>Okay, so I am creating a program in python and basically it is a troubleshooting program for mobile phone users, it's very basic as of now, and I am in the situation where I am creating a list for the questions to be asked. </p>

<p>I will use the random module to randomise a string from the troubleshooting questions list, but I don't want it to randomise the first question in the list, then the first question in the list again.</p>

<p>So the real question; how do I check if the randomised string has already been randomised and if it has I want my program to randomise another string from the list, and if it has already been said then randomise another, if not use that string, etcetera.</p>

<p>Note: This program is no where near complete, I literally just started this now, so I am calling the function at the end so I can run the program at different times to see if it works.</p>

<pre><code>import random

Questions = [
            'Has your phone gotten wet?', 'Have you damaged your screen?', 'Is the phone at full battery?',
            'Has your phone been dropped?', ' Does the mobile phone turn itself off?', 'Does the device keep crashing',
            'Does the phone keep freezing?', 'Can you not access the internet on your phone?', 'Is the battery draining quickly?',
            'Can you not access certain files on your phone?'
            ]
Solutions = [
            'Put your mobile phone inside of a fridge, it sounds stupid but it should work!', 'Try turning your device on and off',
            'Visit your local mobile phone store and seek help'
        ]
def PhoneTroubleshooting():
    print('Hello, welcome to the troubleshooting help section for your mobile phone.\n'
            'This troubleshooting program is going to ask you a series of questions, to determine the issue with your device.')
    answer = print(random.choice(Questions))
    if answer == 'yes':
            print('Okay, I have a solution', random.choice(Solutions))

    else: print('Okay, next problem')

PhoneTroubleshooting()
</code></pre>",python|list,5582341,Thom9son,yes
enabling foreground mode on NFC could cause draining the battery?,"<p>Quoting Carl Sagan:</p>

<blockquote>
  <p>There are naive questions, tedious questions, ill-phrased questions, questions put after inadequate self-criticism. But every question is a cry to understand the world. There is no such thing as a dumb question.</p>
</blockquote>

<p>because I think this is a really stupid question, but I just want to solve my doubt.</p>

<p>I'm working in an app with NFC and I'd like to enable the foreground mode forever to be able to handle a new intent even when the app gets killed.</p>

<p>So, let's imagine that the NFC is always ON. Will my feature drain the battery, or consume it faster that if I disable eventually the foreground mode?</p>

<p>Thank you in advance.</p>

<p>Regards.</p>

<p>Rafael.</p>",android|nfc,1348187,Rafael Ruiz Muñoz,no
Android CPU awake and Battery Depletion due to Background Service,"<p>I am working on an Sensors App that needs to measure <em>acceleration</em> and <em>position</em> every second. These measurements take place in a background <strong>Service</strong>.<br>
For the acceleration I use the <strong>Accelerometer Sensor</strong> and for the location the <strong>FusedLocationApi</strong> of Google Play Services.</p>

<p>But as shown in the screenshots below, <strong>the CPU is always awake (why?)</strong> and the battery is depleted very quickly when the app is running. I closed the app and the Service kept running (which is what I want) during the night, and when I woke up, my battery was completely drained. Given that the wifi was turned off, the battery depletion couldn't be caused by the http connection.  </p>

<p>So, is the accelerometer the cause?<br>
<strong>What can be done to reduce power consumption in such a case?</strong></p>

<p>Screenshots:<br>
<a href=""http://i.imgur.com/mmakRMD.png"" rel=""nofollow"">Battery History details</a><br>
<a href=""http://i.imgur.com/zY3jYbA.png"" rel=""nofollow"">Battery</a></p>

<pre class=""lang-java prettyprint-override""><code>public class MyService extends Service implements 
    SensorEventListener, ConnectionCallbacks, OnConnectionFailedListener {
    ...
    ...
    ...

    @Override
    public void onCreate() {
        super.onCreate();
        SensorManager mSensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);

        if ((accelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER)) != null) {
            mSensorManager.registerListener(this, accelerometer, SensorManager.SENSOR_DELAY_NORMAL);
        }

        mGoogleApiClient = new GoogleApiClient.Builder(getApplicationContext())
            .addConnectionCallbacks(this)
            .addOnConnectionFailedListener(this)
            .addApi(LocationServices.API)
            .addApi(ActivityRecognition.API)
            .build();
        mGoogleApiClient.connect();
    }

    @Override
    public void onSensorChanged(SensorEvent event) {
        Sensor sensor = event.sensor;

        if ((sensor.getType() == Sensor.TYPE_ACCELEROMETER) &amp;&amp; accelerometer != null) {
            double accelX = event.values[0];
            double accelY = event.values[1];
            double accelZ = event.values[2];
        }

    }

}
</code></pre>

<p>The UI is updated periodically every second. I use a <strong>Handler</strong> that runs a <strong>Runnable</strong>:  </p>

<pre class=""lang-java prettyprint-override""><code>private Runnable serviceRunnable = new Runnable() {
        @Override
        public void run() {
            if (activity != null) {
                activity.updateSensorDataToClient(mSensorData);
            }

            mHandler.postDelayed(serviceRunnable, 1000);
        }
}
</code></pre>

<p>Another <strong>Runnable</strong> sends data every 10 seconds to an external Database. For this communication I use the <strong>Volley</strong> library.</p>

<pre class=""lang-java prettyprint-override""><code>private Runnable networkRunnable = new Runnable() {
    @Override
    public void run() {
        networkConnection.sendDataToServer(processedData);

        mHandler.postDelayed(networkRunnable, 10*1000);
    }
}
</code></pre>

<p>The <code>networkConnection</code> is a <code>Class</code> and has a method <code>sendDataToServer</code> that stores the current sensor data in local a SQLite Database. If there is a connection, the local data are sent to the external DB.  </p>",android|service|android-volley|android-sensors|battery,4259011,Theodore Samuel,yes
Stop endless buffering of html5 video in cordova webview on Samsung devices,"<p>I am building a cross-platform mobile app using Cordova (PhoneGap 3.0.0-0.14.4), with Android as one of the target platforms.
A (major, but not only) part of the functionality of the app is playing video.
I have chosen the html5 <code>&lt;video&gt;</code> tag as the preferred method of implementing the video player.
The videos are hosted on Vimeo.
The app is implemented as a single html document, where navigation is achieved by altering the content using javascript.</p>

<p>The video tag I used looks like:</p>

<pre><code>&lt;video autoplay controls id=""videotag""&gt;
    &lt;source id=""videosrc"" src=""http://player.vimeo.com/external/...""/&gt;
    Din apparat stöder inte denna video.
&lt;/video&gt;
</code></pre>

<p>Getting the video to be playable worked out of the box just by adding the video tag to the html.
On a HTC One mini (Android 4.3) this solution worked without problems.
On a Samsung Galaxy S4 mini (Android 4.2.2) the video also plays, but another problem occurs:
The video is being buffered by a MediaPlayer component, and this buffering never stops.
The log is filled by the following messages, repeated indefinitely:</p>

<pre><code>01-25 13:45:36.698: V/MediaPlayer(2814): message received msg=3, ext1=34, ext2=0
01-25 13:45:36.698: V/MediaPlayer(2814): buffering 34 
01-25 13:45:36.698: V/MediaPlayer(2814): callback application
01-25 13:45:36.698: V/MediaPlayer(2814): back from callback
</code></pre>

<p>This buffering continues even after playback is stopped, the video tag is removed and the user exits (suspends) the app.
Suspending the app does not stop the buffering, but killing the app does.
The buffering does not even stop when it reaches 100%, but instead keeps on apparently indefinitely.
No sound is playing in the background, but the Internet connection is kept open, the battery drains and the device <strong>heats up</strong>.
This is a showstopper bug for us, as we are not willing to publish an app that causes overheating.</p>

<p>Symptoms similar to the detected problem were also reported by a beta tester on a Samsung Galaxy S3.
The problem might be limited to Samsung only, as it does not occur on a HTC device.</p>

<p>It appears that the MediaPlayer component does not receive a message to stop buffering even though the video is no longer needed.</p>

<p>I have tried the following, without success:</p>

<ul>
<li>I have removed the video tag entirely from the DOM when done watching.</li>
<li>I have used javascript to stop the playback by calling  pause()  on
the video element before removal.</li>
<li>Following  <a href=""https://stackoverflow.com/questions/4071872/html5-video-force-abort-of-buffering"">HTML5 Video: Force abort of buffering</a>
I have tried using javscript to clear the src urls inside the video tag, followed by calling  load()  on the video tag.</li>
<li>Based on a comment on the above question, I have tried placing the video tag inside an iframe, which is removed from the DOM when done
watching.</li>
<li>I have tried combining all of the above.</li>
<li>I have tried having the video tag on a separate page, which is navigated away from. This is a departure from the single-page-with-js
model used otherwise.</li>
<li>I have tried using the Vimeo player through oEmbed, instead of using a html5 video tag directly.</li>
</ul>

<p>That exhausts the platform-indepent tricks that I have been able to find.
There are some approaches based on native Android code</p>

<ul>
<li><a href=""https://stackoverflow.com/questions/20361254/stop-android-mediaplayer-automatically-launched-by-webpage-within-webview"">Stop Android MediaPlayer automatically launched by webpage within WebView</a>  gives a potential solution, but       according to a comment by the question author, the accepted solution only stops audio from playing but does not kill the MediaPlayer.</li>
<li><a href=""https://stackoverflow.com/questions/12418014/android-webview-playing-html5-h-264-mp4-video-how-to-get-at-the-mediaplayer"">Android WebView Playing HTML5/h.264/mp4 Video, How to get at the MediaPlayer</a>  seems to be a similar problem, but  with a custom webview instead of cordova. I don't know how to attempt to apply this to cordova.</li>
</ul>

<p>I am looking for any solution to the problem that allows video to be played without causing overheating.
This ought to be a problem that other people have needed to solve, so hopefully there is a cordova plugin that already solves the problem.
Is there such a plugin?
If there is not, is either of the two Android-native approaches mentioned above implementable in cordova, and would they solve the problem?</p>

<p>A potential workaround would be to kill the app whenever it is suspended.
This is ugly and not according to Android guidelines.
What is the least ugly way of achieving this?</p>",android|cordova|android-webview|html5-video|cordova-3,3289788,Waino,yes
low level bluetooth broadcast,"<p>Since bluetooth is a broadcast protocol, is there some way to listen for broadcasts while not discoverable? The idea is to avoid making a device discoverable, and simply listen for broadcasts, check the devices for a particular device name, and then connecting to that device's mac address (followed by handshaking, verification, etc).</p>

<p>Specifically, I have a bluetooth device that uses the AT command set (<a href=""http://www.cooking-hacks.com/skin/frontend/default/cooking/pdf/Bluetooth_SPP_AT_SW_description.pdf"" rel=""nofollow"">user manual here</a>), and I want my Android device to autoconnect to it when it gets into range. However, I want a solution that doesn't require my Android to be discoverable all the time, because I expect the Android to not be in range most of the time.</p>

<p>Is there a low-level bluetooth command that I can send from my first device, and listen for using the Android SDK that doesn't require pairing, connecting, or discoverability? Something like and ACL request, perhaps?</p>

<p>(Additionally, my reasons for not making my device discoverable are mainly power, and also slightly user privacy reasons. How significant is the battery drain of device discoverability? Next to nothing? Significant?)</p>",android|bluetooth|low-level|at-command,582004,liucheia,no
capacitor-community / background-geolocation return D/Capacitor: Location not available,"<p>I am trying to use  capacitor-community / background-geolocation. i think the background runs like it supposed to be. but it didnt return me the locatio. it returns D/Capacitor: Location not available.</p>
<p>i dont know what happen, i think i just set up the requirement for this plugin. but it just wont give me the location...</p>
<p>here is my AndroidManifest.xml</p>
<pre><code>&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;manifest package=&quot;ai.squad.kominfo.sbh&quot; xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;
    &lt;application android:allowBackup=&quot;true&quot; android:icon=&quot;@mipmap/ic_launcher&quot; android:label=&quot;@string/app_name&quot; android:roundIcon=&quot;@mipmap/ic_launcher_round&quot; android:supportsRtl=&quot;true&quot; android:theme=&quot;@style/AppTheme&quot; android:usesCleartextTraffic=&quot;true&quot;&gt;
        &lt;activity android:configChanges=&quot;orientation|keyboardHidden|keyboard|screenSize|locale|smallestScreenSize|screenLayout|uiMode&quot; android:label=&quot;@string/title_activity_main&quot; android:launchMode=&quot;singleTask&quot; android:name=&quot;ai.squad.kominfo.sbh.MainActivity&quot; android:theme=&quot;@style/AppTheme.NoActionBarLaunch&quot; android:exported=&quot;true&quot;&gt;
            &lt;intent-filter&gt; 
                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;
                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
        &lt;provider android:authorities=&quot;${applicationId}.fileprovider&quot; android:exported=&quot;false&quot; android:grantUriPermissions=&quot;true&quot; android:name=&quot;androidx.core.content.FileProvider&quot;&gt;
            &lt;meta-data android:name=&quot;android.support.FILE_PROVIDER_PATHS&quot; android:resource=&quot;@xml/file_paths&quot; /&gt;
        &lt;/provider&gt;
        &lt;service
            android:name=&quot;com.equimaps.capacitor_background_geolocation.BackgroundGeolocationService&quot;
            android:enabled=&quot;true&quot;
            android:exported=&quot;true&quot;
            android:foregroundServiceType=&quot;location&quot; /&gt;
    &lt;/application&gt;
    &lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.REQUEST_INSTALL_PACKAGES&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.CAMERA&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.FLASHLIGHT&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;
     &lt;uses-permission android:name=&quot;android.permission.ACCESS_COARSE_LOCATION&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.ACCESS_FINE_LOCATION&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.ACCESS_BACKGROUND_LOCATION&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.FOREGROUND_SERVICE&quot; /&gt;
    &lt;uses-feature android:name=&quot;android.hardware.location.gps&quot; /&gt;
&lt;/manifest&gt;
</code></pre>
<p>And String.xml</p>
<pre><code>&lt;!--
        The channel name for the background notification. This will be visible
        when the user presses &amp; holds the notification. It defaults to
        &quot;Background Tracking&quot;.
    --&gt;
    &lt;string name=&quot;capacitor_background_geolocation_notification_channel_name&quot;&gt;
        Background Tracking
    &lt;/string&gt;

    &lt;!--
        The icon to use for the background notification. Note the absence of a
        leading &quot;@&quot;. It defaults to &quot;mipmap/ic_launcher&quot;, the app's launch icon.

        If a raster image is used to generate the icon (as opposed to a vector
        image), it must have a transparent background. To make sure your image
        is compatible, select &quot;Notification Icons&quot; as the Icon Type when
        creating the image asset in Android Studio.
    --&gt;
    &lt;string name=&quot;capacitor_background_geolocation_notification_icon&quot;&gt;
        drawable/ic_tracking
    &lt;/string&gt;
</code></pre>
<p>This is how i code it inside my page.ts</p>
<pre><code>import {BackgroundGeolocationPlugin} from &quot;@capacitor-community/background-geolocation&quot;;

const BackgroundGeolocation = registerPlugin&lt;BackgroundGeolocationPlugin&gt;(&quot;BackgroundGeolocation&quot;);

  ngOnInit() {
    this.getLatLong();
    if(this.plt.is('capacitor')){
     this.backGroundLocation();
    }
  }

async backGroundLocation() {

         await BackgroundGeolocation.addWatcher({
            backgroundMessage: 'Cancel to prevent battery drain',
            backgroundTitle: &quot;Tracking You.&quot;,
            requestPermissions: true,
            stale: false,
            distanceFilter: 50,
          },
          function callback(location, error) {
            if (error) {
              if (error.code === &quot;NOT_AUTHORIZED&quot;) {
                  if (window.confirm(
                      &quot;This app needs your location, &quot; +
                      &quot;but does not have permission.\n\n&quot; +
                      &quot;Open settings now?&quot;
                  )) {
                      // It can be useful to direct the user to their device's
                      // settings when location permissions have been denied. The
                      // plugin provides the 'openSettings' method to do exactly
                      // this.
                      BackgroundGeolocation.openSettings();
                  }
              }
              return console.error('error'+error);
          }

          return console.log('test:'+location);
          
        }
        )
  }
</code></pre>
<p>This is my variables.gradle file, in case this is related</p>
<pre><code>ext {
    minSdkVersion = 21
    compileSdkVersion = 30
    targetSdkVersion = 31
    androidxActivityVersion = '1.2.0'
    androidxAppCompatVersion = '1.2.0'
    androidxCoordinatorLayoutVersion = '1.1.0'
    androidxCoreVersion = '1.3.2'
    androidxFragmentVersion = '1.3.0'
    junitVersion = '4.13.1'
    androidxJunitVersion = '1.1.2'
    androidxEspressoCoreVersion = '3.3.0'
    cordovaAndroidVersion = '7.0.0'
}
</code></pre>
<p>and here is my MainActivity.java, i read in some website that i need to code something here. but it gave me another error, so i decided not to. cause i think in this android version, Plugin does not have to be added manually inside this file</p>
<pre><code>package ai.squad.kominfo.sbh;
import com.getcapacitor.BridgeActivity;

public class MainActivity extends BridgeActivity {

}
</code></pre>
<p>so guys, anyone who knows how to use this plugin, help me please...</p>",ionic-framework|plugins|geolocation|capacitor,15580774,spardano,yes
Alternative to iOS's deprecated UIApplicationExitsOnSuspend,"<p>I have an app that I do NOT want to run in the background. There is nothing my app can do in background mode, and allowing it to only adds annoying UI complications.  I want the app to terminate when it is removed from the foreground.</p>

<p><code>UIApplicationExitsOnSuspend</code> was Apple's method of allowing this before, and it worked perfectly for my use case. However, it is now deprecated and they are rejecting apps with that Info.plist value.</p>

<p>The only alternative I've been able to find is <code>exit(0)</code> in an app delegate method, but Apple strongly discourages this, and it appears as a crash.</p>

<p>Is there any other viable alternative?  I simply do not want my app to run in the background, all it does is drain a user's battery unnecessarily.</p>",ios|swift|background-process,4272549,123,yes
How to measure Battery Drainage Ratio?,"<p>I were using some of foreground service continuously in background and also was tracking location in background. Now I have reduced it depending on some of time frame logic, but I want to know how much % percentage of battery drain is reduced. Is there any tools which can help me to compare previous version of my app and new version of my app ? Or I have to take any manually testing approach ?</p>",android|battery|batterylevel,3947321,Rujul Gandhi,no
How is it possible that Google Fit app measures number of steps all the time without draining battery?,"<p>The <a href=""https://play.google.com/store/apps/details?id=com.google.android.apps.fitness"">Google Fit</a> app, when installed, measures the duration you are walking or running, and also the number of steps <em>all the time</em>. However, strangely, using it does not seem to drain the battery. Other apps like <a href=""https://play.google.com/store/apps/details?id=com.protogeo.moves"">Moves</a> which seems to record number of steps pretty accurately declares that it uses a lot of power because of it constantly monitoring the GPS and the accelerometer.</p>

<p>I imagine several possibilities:</p>

<ul>
<li>Wakes up the phone every minute or so, then analyses the sensors for a few seconds and then sleeps again. However it seems that the records are pretty accurate to the minute, so the waking up must be frequent.</li>
<li>Actually turns on the accelerometer all the time, and analyzes it only after the accelerometer measurement data buffer is full. However I think the accelerometer has a small buffer to store the latest measurements.</li>
<li>Use GPS to <em>estimate</em> the number of steps instead of actually counting it. However this should not be the case, since it works even indoors.</li>
</ul>

<p>The app still feels <em>magical</em>. Counting steps the whole time without perceptible battery drain.</p>",android|gps|accelerometer|android-sensors|google-fit,11238,Randy Sugianto 'Yuku',no
Explicitly Managing WiFi Power Consumption in Android,"<p><strong>Background</strong></p>

<p>I'm developing a research application that runs on Android phones. In short, the application runs so long as the phone is on and periodically takes information from many components and sensors on the phone. The application is to disturb the user as little as possible. That being said, it's draining the battery far too quickly and forces the user to recharge every day. This simply won't do. </p>

<p>To try and figure out how to improve the situation, a colleague also working on the application let the application run for a long period of time and noticed that the biggest battery hog is WiFi. My current idea is to manually shut off WiFi when it's not in use in an attempt to save power. AFAIK, Android uses PSM for WiFi to accomplish this to some end, but it doesn't seem to be enough.</p>

<p><strong>Problem</strong></p>

<p>Is there a way to ""ramp up"" Android's PSM? Or, <a href=""https://stackoverflow.com/questions/3514123/android-wifi-power-question"">if there is not as this question suggests</a>, is there any way that I can safely turn WiFi on and off without adversely affecting the user? I.e., is there a way to tell which applications are using WiFi and turn it off when none are? Do standard applications - such as the web browser and email clients - use <a href=""http://developer.android.com/reference/android/net/wifi/WifiManager.WifiLock.html"" rel=""nofollow noreferrer"">WiFi locks</a> to prevent WiFi from being turned off when they are working?</p>

<p>Any advice on where to start in solving this problem are greatly appreciated. Information on how Android's PSM works, how long it takes for it to take effect, or any information relevant to the problem are very welcome.</p>

<p>Thanks for your time!</p>",android|wifi|android-wifi,341654,Dylan Knowles,no
Better way to get accurate location than using CoreLocation all the time?,<p>Right now we're using CoreLocation to get your GPS location. It sends it to the server once every 90 seconds. To help with battery drain we change the accuracy to the lowest possible until 30 seconds before the update is going to be sent and then change it to <code>[locationHelper switchToBestAccuracy];</code>. Is there a more battery efficient way to get these location updates?</p>,ios|iphone|ios7|geolocation|core-location,3423674,Taylor,no
Need a push framework for android,"<p>We need to achieve a push functionality in our chat application chat for android. We do not want to pursue the method of polling a http-endpoint based on a DB because that would mean polling, and its seriously going to drain the battery too fast.</p>

<p>So, we are looking for a realtime Push framework or a PubSub mechanism with channel subscription (each user will be aunique channelname for his lifetime). We have gone through the following:</p>

<ul>
<li><a href=""http://faye.jcoglan.com"" rel=""nofollow"">Faye.js</a> (based on nodejs and redis, but doesnt have an android library for clients)</li>
<li><a href=""http://pusher.com"" rel=""nofollow"">Pusher</a> (but this has a limit of ""active connection"". This will not let many users be online since each user login will create a connection to pusher.com which is billed)</li>
<li><a href=""http://pubnub.com"" rel=""nofollow"">PubNub</a> (same problem as Pusher.com)</li>
</ul>

<p>Any messaging framework with android client library would do in our case.</p>",android|node.js|redis|push|pusher,759783,ashutosh,yes
How can you execute a repeating JSoup task which will work even if the app is in background in android,"<p>For my app I need values which are parsed by jSoup from a website and then returned to the user using a notification, these values change ~ every minute, so to be up-todate with the values I set up a task using a handler, this works good when the app is in foreground, but as soon as the user goes to the homescreen the app will return multiple exceptions like e.g. java.net.UnknownHostException or java.net.SocketTimeoutException, in the code this happens when jSoup is connecting to the specified site, I already tried using Services and AsyncTasks instead of threads, but it was always the exact same problem, I also searched for people with similar experiences, but I guess my issue is quite specific.</p>
<p>This is the code for the handler:</p>
<pre><code>private final static int INTERVAL = 1000 * 60;
    Handler mHandler = new Handler();
    Runnable mHandlerTask = new Runnable()
    {
        @Override
        public void run() {
            try {
                wakeLock.release();
            } catch (RuntimeException e) {
                e.printStackTrace();
            }
            if (!isUpdating) {
                isUpdating = true;
                App.shouldUpdate = true;
                System.out.println(&quot;update&quot;);
                final TinyDB tinydb = new TinyDB(getApplicationContext());
                                TextView priceEditText = loadedLayouts.get(1).findViewById(R.id.priceTextView);
                                TextView increaseEditText = loadedLayouts.get(1).findViewById(R.id.increaseTextView);
                                updatePricesStock(tinydb.getString(&quot;current_isin&quot;), priceEditText, increaseEditText);
                             
                        }
                        wakeLock.acquire(2*60*1000L /*10 minutes*/);
                 
                }
                mHandler.postDelayed(mHandlerTask, INTERVAL);
            }
        }
    }; 

</code></pre>
<p>and this is the code for the updateStockPrices method (I will not include updatePricesWarrant and updatePricesKnockout since they are essentially doing the same things and also throw the same exceptions)</p>
<pre><code>public void updatePricesStock(final String ISIN, TextView priceText, TextView increaseText) {

        final TinyDB tinydb = new TinyDB(getApplicationContext());
        final Thread thread = new Thread(new Runnable() {
            @Override
            public void run() {
                TinyDB tinydb = new TinyDB(getApplicationContext());
                try {
                    Document doc = Jsoup.connect(&quot;https://www.ls-tc.de/de/aktie/&quot; + ISIN).get();
                    System.out.println(ISIN);
                    increase = doc.selectFirst(&quot;#page_content &gt; div &gt; div:nth-child(1) &gt; div &gt; div.mpe_bootstrapgrid.col-md-8 &gt; div &gt; div:nth-child(3) &gt; div &gt; span:nth-child(3)&quot;).text().replace(&quot; &quot;, &quot;&quot;);
                    tinydb.putString(ISIN + &quot;notification_price&quot;, doc.selectFirst(&quot;#page_content &gt; div &gt; div:nth-child(1) &gt; div &gt; div.mpe_bootstrapgrid.col-md-8 &gt; div &gt; div:nth-child(3) &gt; div &gt; span:nth-child(1)&quot;).text() + &quot;€&quot;);

                } catch (IOException e) {
                    e.printStackTrace();
                    tinydb.putString(ISIN + &quot;notification_price&quot;, &quot;Error Scraping Price&quot;);
                }
            }
        });
        if(!thread.isAlive()) {
            thread.start();
        }
        try{
            thread.join();
        }catch (Exception ex){
            ex.printStackTrace();
        }
        if(!thread.isAlive()) {
            notificationCompat = NotificationManagerCompat.from(getApplicationContext());
            System.out.println(&quot;done&quot;);
            System.out.println(tinydb.getString(ISIN + &quot;notification_price&quot;));
            priceText.setText(tinydb.getString(ISIN + &quot;notification_price&quot;));
            increaseText.setText(increase);
            System.out.println(&quot;Text Updated &quot;  + priceText.getText().toString());
            if(tinydb.getBoolean(ISIN + &quot;_notification_status&quot;)) {
                Notification notification = new NotificationCompat.Builder(getApplicationContext(), App.notificationChannel)
                        .setSmallIcon(R.drawable.ic_baseline_attach_money_24).setContentTitle(tinydb.getString(ISIN + &quot;notification_name&quot;)).setContentText(tinydb.getString(ISIN + &quot;notification_price&quot;)).setPriority(NotificationCompat.PRIORITY_MAX).setCategory(NotificationCompat.CATEGORY_STATUS).setOnlyAlertOnce(true).build();

                notificationCompat.notify(tinydb.getInt(ISIN + &quot;_notification_id&quot;), notification);
            }
            isUpdating = false;
        }
    }
</code></pre>
<p>finnally these are the stacktraces I get:</p>
<pre><code>
W/System.err: java.net.SocketTimeoutException: timeout
W/System.err:     at com.android.okhttp.okio.Okio$3.newTimeoutException(Okio.java:225)
        at com.android.okhttp.okio.AsyncTimeout.exit(AsyncTimeout.java:263)
W/System.err:     at com.android.okhttp.okio.AsyncTimeout$2.read(AsyncTimeout.java:217)
        at com.android.okhttp.okio.RealBufferedSource.indexOf(RealBufferedSource.java:317)
        at com.android.okhttp.okio.RealBufferedSource.indexOf(RealBufferedSource.java:311)
W/System.err:     at com.android.okhttp.okio.RealBufferedSource.readUtf8LineStrict(RealBufferedSource.java:207)
W/System.err:     at com.android.okhttp.internal.http.Http1xStream.readResponse(Http1xStream.java:388)
        at com.android.okhttp.internal.http.Http1xStream.readResponseHeaders(Http1xStream.java:146)
W/System.err:     at com.android.okhttp.internal.http.HttpEngine.readNetworkResponse(HttpEngine.java:900)
        at com.android.okhttp.internal.http.HttpEngine.readResponse(HttpEngine.java:772)
        at com.android.okhttp.internal.huc.HttpURLConnectionImpl.execute(HttpURLConnectionImpl.java:493)
W/System.err:     at com.android.okhttp.internal.huc.HttpURLConnectionImpl.getResponse(HttpURLConnectionImpl.java:429)
        at com.android.okhttp.internal.huc.HttpURLConnectionImpl.getResponseCode(HttpURLConnectionImpl.java:560)
W/System.err:     at com.android.okhttp.internal.huc.DelegatingHttpsURLConnection.getResponseCode(DelegatingHttpsURLConnection.java:106)
        at com.android.okhttp.internal.huc.HttpsURLConnectionImpl.getResponseCode(HttpsURLConnectionImpl.java:30)
        at org.jsoup.helper.HttpConnection$Response.execute(HttpConnection.java:734)
W/System.err:     at org.jsoup.helper.HttpConnection$Response.execute(HttpConnection.java:706)
W/System.err:     at org.jsoup.helper.HttpConnection.execute(HttpConnection.java:299)
W/System.err:     at org.jsoup.helper.HttpConnection.get(HttpConnection.java:288)
        at de.xliquid.stockwatchultimate.MainActivity$4.run(MainActivity.java:266)
W/System.err:     at java.lang.Thread.run(Thread.java:919)
W/System.err: Caused by: java.net.SocketException: socket is closed
        at com.android.org.conscrypt.ConscryptFileDescriptorSocket$SSLInputStream.read(ConscryptFileDescriptorSocket.java:588)
        at com.android.okhttp.okio.Okio$2.read(Okio.java:145)
        at com.android.okhttp.okio.AsyncTimeout$2.read(AsyncTimeout.java:213)
W/System.err:   ... 18 more

</code></pre>
<hr />
<pre><code>
java.net.UnknownHostException: Unable to resolve host &quot;www.onvista.de&quot;: No address associated with hostname
        at java.net.Inet6AddressImpl.lookupHostByName(Inet6AddressImpl.java:156)
W/System.err:     at java.net.Inet6AddressImpl.lookupAllHostAddr(Inet6AddressImpl.java:103)
        at java.net.InetAddress.getAllByName(InetAddress.java:1152)
        at com.android.okhttp.Dns$1.lookup(Dns.java:41)
W/System.err:     at com.android.okhttp.internal.http.RouteSelector.resetNextInetSocketAddress(RouteSelector.java:178)
        at com.android.okhttp.internal.http.RouteSelector.nextProxy(RouteSelector.java:144)
        at com.android.okhttp.internal.http.RouteSelector.next(RouteSelector.java:86)
        at com.android.okhttp.internal.http.StreamAllocation.findConnection(StreamAllocation.java:192)
        at com.android.okhttp.internal.http.StreamAllocation.findHealthyConnection(StreamAllocation.java:144)
        at com.android.okhttp.internal.http.StreamAllocation.newStream(StreamAllocation.java:106)
        at com.android.okhttp.internal.http.HttpEngine.connect(HttpEngine.java:400)
W/System.err:     at com.android.okhttp.internal.http.HttpEngine.sendRequest(HttpEngine.java:333)
        at com.android.okhttp.internal.huc.HttpURLConnectionImpl.execute(HttpURLConnectionImpl.java:483)
        at com.android.okhttp.internal.huc.HttpURLConnectionImpl.getResponse(HttpURLConnectionImpl.java:429)
        at com.android.okhttp.internal.huc.HttpURLConnectionImpl.getResponseCode(HttpURLConnectionImpl.java:560)
        at com.android.okhttp.internal.huc.DelegatingHttpsURLConnection.getResponseCode(DelegatingHttpsURLConnection.java:106)
        at com.android.okhttp.internal.huc.HttpsURLConnectionImpl.getResponseCode(HttpsURLConnectionImpl.java:30)
        at org.jsoup.helper.HttpConnection$Response.execute(HttpConnection.java:734)
        at org.jsoup.helper.HttpConnection$Response.execute(HttpConnection.java:706)
        at org.jsoup.helper.HttpConnection.execute(HttpConnection.java:299)
        at org.jsoup.helper.HttpConnection.get(HttpConnection.java:288)
W/System.err:     at de.xliquid.stockwatchultimate.MainActivity$6.run(MainActivity.java:371)
        at java.lang.Thread.run(Thread.java:919)
W/System.err: Caused by: android.system.GaiException: android_getaddrinfo failed: EAI_NODATA (No address associated with hostname)
W/System.err:     at libcore.io.Linux.android_getaddrinfo(Native Method)
W/System.err:     at libcore.io.ForwardingOs.android_getaddrinfo(ForwardingOs.java:74)
        at libcore.io.BlockGuardOs.android_getaddrinfo(BlockGuardOs.java:200)
        at libcore.io.ForwardingOs.android_getaddrinfo(ForwardingOs.java:74)
        at java.net.Inet6AddressImpl.lookupHostByName(Inet6AddressImpl.java:135)
W/System.err:   ... 22 more

</code></pre>
<p>Also this app is solely for me so I don't really bother if the solution isn't the cleanest or drains the battery faster.</p>",java|android|background|jsoup|repeat,12596708,xliquid,no
What vendors offer mobile geolocation targeting and analytics SDKs?,"<p>I'm conducting a vendor analysis for an enterprise level organization. I'm looking for a SDK I can integrate with an iOS/Android application that does the following well:</p>

<ol>
<li>Location Analytics </li>
<li>Geo-fencing around locations specified by the organization</li>
<li>Push Notifications (specific to geo-fences, time zones, and customer segmentation) </li>
<li>Easy to use console</li>
<li>Doesn't noticeably drain the battery </li>
<li>They also need to be advanced in their field--ideally they'd have some sort of beaconing
capability in their product or planned down the line to support indoor location awareness</li>
</ol>

<p>Some examples I'm looking at are Geoloqi, Xtify and Urban Airship. Do you have any experiences with those or similar vendors?</p>",mobile|geolocation|analytics|targeting,462077,Matt,no
Flutter SoundPool play sound issue,"<p>I am struggling playing sounds with SoundPool on Flutter.
I have read/Googled about the dreaded message ""AUDIO_OUTPUT_FLAG_FAST denied by server; frameCount 0 -> 48000""</p>

<p>So far, here are the steps I have taken : </p>

<ul>
<li>Image running in emulator is Pixel 3A</li>
<li><p>Files are wav, with a size of 90K, they last 1 second each, they are 48K sampled (ffmprobe says :Duration: 00:00:01.00, bitrate: 768 kb/s
Stream #0:0: Audio: pcm_s16le ([1][0][0][0] / 0x0001), 48000 Hz, 1 channels, s16, 768 kb/s) </p></li>
<li><p>I have pre-loaded then during app startup with Asset, follows code (within a foreach): </p></li>
</ul>

<pre><code>     var content = await _bundle.load(notePath);
     sounds[notePath] = content;
     newNote.soundId = await _pool.load(content);
     new Timer(const Duration(milliseconds: (2000)), () =&gt; print(""loaded $notePath""));
</code></pre>

<p>I have put a duration, else some (randomly) sounds were not loaded (I have 72 sounds to load).
When I need to play the sound (upon tap on the screen), I simply do a </p>

<pre><code>_pool.stop(1);
_pool.play(noteToPlay.soundId);
</code></pre>

<p>Which creates some crackle (one guy proposed instead to always play a sound at volume 0 to avoid this, but this will drain the battery).</p>

<p>Now the problem :
The message appears in the console, but I could live with it if there were not the following issue : 
Randomly, some sounds are not played, the taps are simply ignored. The app never crashes. If I remove the soundPool.play call, then everything is ok (corresponding file is found, tap is handled...), so I gather that soundPool gets lost during one of the Future playback. Player can tap very quickly, but even If I go slow, it still fails.</p>

<p>SoundPool is instanciated like this : </p>

<pre><code>class NoteService {
  final Soundpool _pool = Soundpool(streamType: StreamType.notification);
[snip class definition]
</code></pre>

<p>Thank you for your insight.</p>",android|flutter|soundpool,5127657,Charly,no
How to measure power efficiency increase or decrease for code change,"<p>In embedded/mobile environment battery power drain has to be considered when we are developing Software for it, therefore energy efficient software programming matters in embedded/mobile world.</p>

<p>Problem is,(<em>regarding</em> <strong><em>Assembly/C/C++</em></strong>)</p>

<p>Think we have stable software release when it's run on arbitrary platform <strong>X</strong> it consumes<strong>Y</strong> amount of power(in Watts), now we are going to carry out some code change and we want to measure how it's gonna effect on energy consumption and its efficiency at build time.</p>

<pre><code>INT16U x = OXFFFF;
/... some code in stable release .../
for(;x&lt;4096;++x)
{
   /... some code in stable release .../

   INT64U foo = x &gt;&gt; 256 ? x : 4096 ;  // point 1  sample code change;
   if(~foo &amp; foo) foo %= 64 ;         // point 1  sample code change;

   /... some code in stable release .../
}
</code></pre>

<p>Simply if we want to measure how this code change <code>@point1</code> effects on energy efficiency(<em>relative to the stable release statistics</em>) rather than profiling space and time (performance plus memory), If we want to build a simple energy/power analyzing and profiling tool in C/ C++, </p>

<ul>
<li>Is there any recommended C/C++ library or source to build power analysis tool?</li>
<li>If we have to analyze and determine the change in power consumption levels through CPU/GPU instruction level changes for each code change for example as in <code>point1</code>, how can we determine power consumption for each instruction for arbitrary CPU or GPU on the respective platform?</li>
<li>How can developer aware of how much of power consumption reduced or increase due to his code change at Application build time rather than runtime?</li>
</ul>",c++|c|mobile|embedded|profiling,9665437,Dinithi,no
Is FCM still better than polling when updating every 10 min is ok?,"<p>I want to have some sort of notification system for a mobile app with cordova/nativescript and using FCM seems like a lot of trouble for a little thing. I mean this is a private app, I don't want to publish it, just use it for my own purposes and I don't really want to buy a domain name and register for example a let's encrypt cert and renew it each month. All I need is sending a HTTP GET with an if-modified-since header every 10 mins to a certain IP and trigger an alert when there is a new event even at night. Is this a viable solution or would android/ios kill the application after a while? Would it completely drain the battery overnight?</p>",android|ios|cordova|firebase-cloud-messaging|nativescript,607033,inf3rno,yes
Do apps like WhatsApp keep an always live connection with server?,<p>I'm creating an application that has to realtime be live with the server. I'm not sure whether to have an always live (or checking with server every 2mins) app because it might drain the battery. What are my alternatives?</p>,android|ios|networking|tcp|xmpp,2495720,SadeepDarshana,no
Android Internet Connection checker OUTSIDE the app,"<p>My app needs to do something whenever the internet is connected and vice-versa. However, I need to do this <strong>OUTSIDE</strong> my application. There are a lot of ideas and help here on stackoverflow but it is always <strong>WITHIN</strong> the application. I know that the AlarmManager works outside the application but it would just be draining the battery if I try to check if there's internet connection every 5 minutes. What I wanted is to check the connection outside the app to download something. </p>

<p>I also found out that Intent Service can work outside the application as well. I have tried to put this inside the Wakeful Broadcast Receiver. However, it is still not being called.</p>

<p>Can someone out there help me? Thanks! </p>

<p>Here's my Wakeful Broadcast Receiver </p>

<pre><code>public class ConnectivityOutsideAppReceiver extends WakefulBroadcastReceiver {

    private static final String LOG_TAG = ConnectivityOutsideAppReceiver.class.getSimpleName();

    private ConnectivityManager connectivityManager;
    private static boolean connection = false;

    @Override
    public void onReceive(Context context, Intent intent){

        ComponentName comp = new ComponentName(context.getPackageName(),
                ConnectivityOutsideAppService.class.getName());

        // Start the service, keeping the device awake while it is
        // launching.
        startWakefulService(context, (intent.setComponent(comp)

        ));
    }

}
</code></pre>

<p>This is the Intent Service</p>

<p>public class ConnectivityOutsideAppService extends IntentService {</p>

<pre><code>private static final String LOG_TAG = ConnectivityOutsideAppService.class.getSimpleName();
private ConnectivityManager connectivityManager;
private static boolean connection = false;
private Context context;

public ConnectivityOutsideAppService() {
   super(ConnectivityOutsideAppService.class.getSimpleName());
    this.context = context;
}

@Override
protected void onHandleIntent(Intent intent) {
    connectivityManager =
            (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);
    checkConnectionOnDemand();

    Log.e(LOG_TAG, "" ## onHandleIntent##"");
    if (connection == true
            &amp;&amp; intent.getBooleanExtra(ConnectivityManager.EXTRA_NO_CONNECTIVITY,
            false)) {
        Log.e(LOG_TAG, "" ## connection == true ##"");
        connection = false;
    } else if (connection == false
            &amp;&amp; !intent.getBooleanExtra(ConnectivityManager.EXTRA_NO_CONNECTIVITY,
            false)) {
        Log.e(LOG_TAG, "" ## connection == false ##"");
        connection = true;
    }

    ConnectivityOutsideAppReceiver.completeWakefulIntent(intent);
}

public static boolean hasConnection() {
    return connection;
}

private void checkConnectionOnDemand() {
    Log.e(LOG_TAG, "" ## checkConnectionOnDemand ##"");
    final NetworkInfo info = connectivityManager.getActiveNetworkInfo();
    if (info == null || info.getState() != NetworkInfo.State.CONNECTED) {
        if (connection == true) {
            Log.e(LOG_TAG, "" ## connection == true ##"");
            connection = false;
        }
    } else {
        if (connection == false) {
            Log.e(LOG_TAG, "" ## connection == false ##"");
            connection = true;
        }
    }
}
}
</code></pre>

<p>This is my Android Manifest </p>

<pre><code>    &lt;uses-permission android:name=""android.permission.INTERNET"" /&gt;

    &lt;uses-permission android:name=""android.permission.ACCESS_NETWORK_STATE"" /&gt;

    &lt;service
        android:name=""com.timetrackermobilelog.BusinessServices.ConnectivityOutsideAppService""
        android:exported=""false""/&gt;

    &lt;receiver android:name=""com.timetrackermobilelog.Utilities.ConnectivityOutsideAppService""
              android:enabled=""true""
              android:process="":remote""&gt;

        &lt;intent-filter android:priority=""1000"" &gt;
            &lt;action android:name=""com.timetrackermobilelog.Utilities.ConnectivityOutsideAppService"" /&gt;
            &lt;category android:name=""com.Utilities"" /&gt;
        &lt;/intent-filter&gt;
    &lt;/receiver&gt;
</code></pre>

<p>I have tried registering the receiver inside the Activity but it doesn't work as well. </p>

<pre><code>IntentFilter intentFilter = new IntentFilter(""com.pointwest.timetrackermobilelog.Utilities.ConnectivityOutsideAppReceiver"");
ConnectivityOutsideAppReceiver connectivityOutsideAppReceiver = new ConnectivityOutsideAppReceiver();
registerReceiver(connectivityOutsideAppReceiver, intentFilter);
</code></pre>

<p>Is there anything that I missed?</p>",java|android|android-manifest|android-intentservice|android-broadcastreceiver,3987056,Paula Kristin,yes
Android : Update widget when notification coming,"<p>I'm working on a widget witch display the number of missing call, number of new sms, number of new mail and number of any notification. Like that following picture link : </p>

<p><a href=""https://1drv.ms/i/s!AnNwF6LmB2gQi34jxc_11yB703l8"" rel=""nofollow noreferrer"">https://1drv.ms/i/s!AnNwF6LmB2gQi34jxc_11yB703l8</a></p>

<p>But to avoid battery drain, is it possible to update widget only when a any notification is coming ? or I have to create a background service which looking for notification ?</p>",android|notifications|widget,7037280,xNiux,no
BLE out of range detection for UI update,"<p>I am unable to figure out a way to detect BLE device out of range to update UI in discovered state**(and not in connected state-- in which case we can easily update with didDisconnect callback).**</p>

<p>Following workarounds seems to drain up the battery:
 1. Enable CBCentralManagerScanOptionAllowDuplicatesKey and keep checking RSSI
 2. Have a timer at scan time, after discovery on timeout keep checking if the device objects created is not in connected state and discovery time is more the timeout then stop and start scan again.
Any other better option would help</p>",ios|objective-c|swift|bluetooth-lowenergy,2713296,Shrikanth Ananth,yes
How to know when a day was started in android?,"<p>Is there a way to detect when a day was started or date or time changes (not changed by user, it is changed by system). Any <code>BroadCastReciever</code> to do it? I am using service to run it by every hour, But drains battery.</p>

<p>My requirement is to check when the day has started (when time changes to 12 AM) or time changes (hourly) I want to display the <code>notification</code>.</p>",android|datetime|android-service|android-broadcast,4264063,Jack,yes
Sending a value from textfield in SwiftUI to remain once the textfield is clear,"<p>I am fairly new to Swift and SwiftUI programming and I have come up again a weird issue.</p>
<p>My goal is to read the variable in the text field and have the variable print as a comment once the user has clicked return (oncommit).</p>
<p>I tried to use a single $comment variable but that updates both the Text result as soon as the user is typing in the text field.</p>
<p>My goal is for the user to be able to type in the text field and the variable just appears in the section under the text field: (&quot;Your Comment is:&quot;&quot;)</p>
<p>This is my first time posting on Stack Overflow sorry if I added too much code.</p>
<pre><code>import SwiftUI

struct ContentView: View {
    private var numberofImages = 7
    private let timer = Timer.publish(every: 3, on: .main, in: .common).autoconnect()
    @State private var currentIndex = 0
    @State private var comment:String = &quot;&quot;
    @State private var userComment:String = &quot;&quot;
    @State private var showComment:Bool = false
    
    func previous() {
        withAnimation {
        currentIndex = currentIndex &gt; 0 ? currentIndex - 1 : numberofImages - 1
        }
    }
    
    func next() {
        withAnimation{
        currentIndex = currentIndex &lt; numberofImages ? currentIndex + 1 : 0
        }
    }
    
    var controls: some View {
        HStack{
            Button {
                previous()
            } label: {
                Image(systemName: &quot;chevron.left&quot;)
            }
            Spacer().frame(width:100)
            Button {
               next()
            } label: {
                Image(systemName: &quot;chevron.right&quot;)
            }
            .accentColor(.primary)
            
        }
    }
    
    
    var body: some View {
        NavigationView{
        GeometryReader { proxy in
            VStack {
                ScrollView{
            TabView(selection: $currentIndex) {
            ForEach(1..&lt;numberofImages) {
                num in Image(&quot;\(num)&quot;)
                    .resizable()
                    .scaledToFill()
                    .overlay(Color.black.opacity(0.4))
                    .tag(num)
            }
        }.tabViewStyle(PageTabViewStyle())
            .clipShape(RoundedRectangle(cornerRadius: 9))
        .frame(width: proxy.size.width, height: proxy.size.height / 3)
        .onReceive(timer, perform: { _ in
            next()
        })
                controls
                    .padding()
                Text(&quot;Product Description&quot;).font(.largeTitle).bold()
                
                    Text(&quot;&quot;&quot;
                    Incredibly light and boasting a speedy performance, get your work done anywhere with the MacBook Air (2020). From video-editing to gaming, the Apple M1 chip lets you take on the biggest tasks without draining your battery.
                    It's 3.5x faster than the previous generation, with eight-cores of power providing an incredible performance. And for whisper-quiet operation, the improved thermal efficiency means it doesn't even need a fan.
                    With the Retina Display screen, everything from blockbuster movies to everyday browsing is a visual joy.
                    True Tone technology automatically adjust the display to your environment - so web pages and emails look as natural as if they were printed.
                    &quot;&quot;&quot;) .padding() //.frame(width: 300, height: 300, alignment: .topLeading)
                //Comment Text Field will need to go here. So it can be included within the scroll view.
                    TextField(&quot;&quot;, text: $comment, onEditingChanged: {_ in
                        self.showComment = true
                    }, onCommit: {
                        if self.showComment {
                            self.comment = self.userComment
                        }
                    })
                        .textFieldStyle(RoundedBorderTextFieldStyle())
                    
                    Text(&quot;Your Comment is: \(self.userComment)&quot;)
                    // Rating Section will need to go her as well. SystemName:Star.circle.fill or unfill.
                }
            }
</code></pre>",swiftui|textfield,15846507,onaikepo,no
"Beacons, CoreLocation, BLE, and ""Geo-Fencing"" - definition of terms?","<p>I was hoping someone could spell out the relationship between iBeacon recognition, CoreLocation and CoreBluetooth, specifically in the context of what iOS considers ""geo-fencing"".</p>

<p>First off, I understand Apple's documentation on <a href=""https://developer.apple.com/library/ios/documentation/CoreLocation/Reference/CLLocationManager_Class/index.html"" rel=""nofollow noreferrer"" title=""title"">Using Regions to Monitor Boundary Crossings</a>  and have seen other discussions around the topic, like <a href=""https://stackoverflow.com/questions/17174042/ios-corelocation-and-geofencing-while-app-is-closed"">iOS - CoreLocation and geofencing while app is closed</a> (especially pertinent to our app since this is a background operation). However, I'm having a hard time finding Apple's explicit definition of geofencing and exactly which frameworks get categorized as such.</p>

<p>Consider:</p>

<ol>
<li><p>Beacons are based on BLE and yet they use the CoreLocation framework and not the CoreBluetooth framework. In fact, you do not need to add Bluetooth capabilities to the project settings in order to get them to work.</p></li>
<li><p>Detecting beacon regions uses the same object and method calls: to register a region, you call the ‘startMonitoringForRegion’ method of ‘CLLocationManager’ object.</p></li>
<li><p>It appears that once we added beacon recognition to our app, users have begun seeing ""geo-fencing enabled"" messages in their settings.</p></li>
</ol>

<p>I thought geo-fencing was purely used in GPS- and Wifi-based location services? Not BLE services? The whole point of BLE beacons is to reduce the drain on the battery that geo-fencing produces.</p>

<p>On a higher level, is there any way to prove demonstrably that using beacon technology produces a much lower battery drain than other location-based geo-fencing? Using ""geo-fencing"" as an umbrella term for both (if that is indeed what is happening), muddies the waters significantly when making a business case for beacons.</p>",ios|iphone|bluetooth,764577,Justin Whitney,yes
What should an ARKit app do when the user leaves the current screen?,<p>Should the app keep the ARKit session open or pause it while the user leaves the current view controller or app? I've noticed a battery drain when using ARKit.</p>,ios|arkit,1135714,Cesare,no
Running an Alarm Service once a day on Oreo,"<p>I've created a service which consult notes if they are in recicle bin, it have to run once a day but with handler I think it will drain too much battery, So I need you help How can I do a task once a day without drain battery or other thing that's not a handler ?</p>

<p>When the app is launched the NotesApplication is created and start the NotesService class, it should be executing all day but it will drain battery, so I need to execute once a day</p>

<p>NotesApplication</p>

<pre><code>public class NotesApplication extends Application {

String TAG = ""NotesApplication"";
Intent intent;

@Override
public void onCreate() {
    // TODO: Implement this method
    super.onCreate();
    Log.d(TAG, ""Application created"");
    intent = new Intent(getApplicationContext(), NotesService.class);
    if(Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O){
        Log.d(TAG, ""Foreground service started"");
        getApplicationContext().startForegroundService(intent);
    }else if(Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.O){
        Log.d(TAG, ""Service started"");
        getApplicationContext().startService(intent);
    }
}
</code></pre>

<p>Notes Service</p>

<pre><code>public class NotesService extends Service {

ArrayList&lt;Notes&gt; listNotas;
String TAG = ""NotesService"";
SQLiteHelperConnection conn;

@Override
public void onCreate()
{
    // TODO: Implement this method
    super.onCreate();
    Log.d(TAG, ""Notes service created"");
    if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O){
        final NotificationManager mNotific= (NotificationManager)getSystemService(Context.NOTIFICATION_SERVICE);
        CharSequence name = ""Axco"";
        String description = ""Service"";
        int importance = NotificationManager.IMPORTANCE_MIN;
        final String ChannelID=""Service Channel"";
        NotificationChannel mChannel = new NotificationChannel(ChannelID, name, importance);
        mChannel.setDescription(description); 
        mChannel.setLightColor(ThemeClass.getColor()); 
        mChannel.canShowBadge(); 
        mChannel.setShowBadge(true); 
        mNotific.createNotificationChannel(mChannel);
        final int code = 101; 
        String body= ""Service Running"";
        Notification notification = new Notification.Builder(this, ChannelID)
            .setContentTitle(getPackageName())
            .setContentText(body)
            .setBadgeIconType(R.drawable.ic_launcher)
            .setNumber(1)
            .setSmallIcon(R.drawable.ic_launcher)
            .setAutoCancel(true)
            .build();
        startForeground(code, notification);
    }
    conn = new SQLiteHelperConnection(this, ""db_notas.db"", null, 1);
    listNotas = new ArrayList&lt;Notes&gt;();
}

@Override
public int onStartCommand(Intent intent, int flags, int startId)
{
    // TODO: Implement this method
    if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O){
        final NotificationManager mNotific= (NotificationManager)getSystemService(Context.NOTIFICATION_SERVICE);
        CharSequence name = ""Axco"";
        String description = ""Service"";
        int importance = NotificationManager.IMPORTANCE_MIN;
        final String ChannelID=""Service Channel"";
        NotificationChannel mChannel = new NotificationChannel(ChannelID, name, importance);
        mChannel.setDescription(description); 
        mChannel.setLightColor(ThemeClass.getColor()); 
        mChannel.canShowBadge(); 
        mChannel.setShowBadge(true); 
        mNotific.createNotificationChannel(mChannel);
        final int code = 101; 
        String body= ""Service Running"";
        Notification notification = new Notification.Builder(this, ChannelID)
            .setContentTitle(getPackageName())
            .setContentText(body)
            .setBadgeIconType(R.drawable.ic_launcher)
            .setNumber(1)
            .setSmallIcon(R.drawable.ic_launcher)
            .setAutoCancel(true)
            .build();
        startForeground(code, notification);
    }
    final Handler handler = new Handler();
    Runnable runnable = new Runnable(){
        @Override
        public void run()
        {
            // TODO: Implement this method
            Log.d(TAG, ""Service running"");
            listNotas.clear();
            consult();
            check();
            handler.postDelayed(this, 15000);
        }
    };
    handler.post(runnable);
    return Service.START_STICKY;
}

private void consult(){
    Log.d(TAG, ""Consulting..."");
    SQLiteDatabase db = conn.getReadableDatabase();

    Notes notas = null;

    Cursor cursor = db.rawQuery(""SELECT * FROM ""+Utilities.TABLA_NOTA, null);

    while (cursor.moveToNext()) {
        notas = new Notes();
        notas.setId(cursor.getString(0));
        notas.setLastModified(cursor.getString(5));
        notas.setLastModifiedDate(cursor.getString(7));

        boolean a = Boolean.valueOf(cursor.getString(4));

        if(a){
            listNotas.add(notas);
        }
    }
}

private void check(){
    //Do something
}

private void deleteNote(int position){
    SQLiteDatabase db = conn.getWritableDatabase();
    String[] parametros = {listNotas.get(position).getId()};
    db.delete(Utilities.TABLA_NOTA, Utilities.ID+""=?"", parametros);
    listNotas.remove(position);
}

@Override
public IBinder onBind(Intent p1){
    // TODO: Implement this method
    return null;
}
</code></pre>",java|android|handler|android-8.0-oreo,9596977,user9596977,yes
How to check Javascript battery usage,"<p>This sounds like a very strange question as I have probably phrased it wrong. </p>

<p>How can I check how big of an impact my javascript code is having on the battery of a device such as a laptop? I know the website I'm using the JS in is causing my power to drain rapidly through checking Mac Activity monitor and the sound of the fans coming on full speed when the site is on for a while. When I close the tab, everything calms down.</p>

<p>Thanks.</p>",javascript|batterylevel|battery-saver,4295477,Adam Jarvis,no
Using two-way data binding with managed RealmObject in EditText,"<p><strong>Background:</strong> I am using <code>io.realm:android-adapters:2.0.0</code> for showing a list of items. Each row consists of three <code>TextViews</code>  and two <code>EditText</code> fields. These three <code>TextViews</code> text are set from <code>realm</code> schema. I am using two way data binding for <code>EditText</code> like:</p>

<pre><code>&lt;EditText
 android:layout_width=""wrap_content""
 android:layout_height=""wrap_content""
 android:inputType=""number""
 android:text=""@={Conversion.toString(offline.inputUI)}"" /&gt;
</code></pre>

<p>This <code>offline</code> is the schema that extends <code>RealmObject</code> with two <code>@Ignore</code> fields which correspond to the two <code>EditText</code>. Vales are reflected in the <code>offline</code> model when user types.</p>

<p><strong>Problem:</strong> When I scroll past the screen <code>EditText</code> values are lost. If four rows are visible at a time on the screen and user feed the <code>EditText</code> and scrolls for the next four rows and if revisits the first four rows values of all <code>EditText</code> are lost. This is happening because of <strong>zero copy design</strong> and I understand it. However if I remove the <code>@Ignore</code> from <code>EditText</code> then an exception is thrown that you cannot perform transaction outside ....etc.</p>

<p><strong>Desired output</strong> How to avoid the values of <code>EditText</code> vanishing while scrolling and taking the benefit of realm <strong>zero copy design</strong>. Also, save the values of <code>EditText</code> in realm in real time as user types or after user has left the <code>EditText</code>. <strong>Is it really possible or not?</strong> . Do I need to change my current approach. If I use frequent write transactions when focus is changed from <code>EditText</code>, will it drain the battery?</p>",android|android-edittext|android-recyclerview|realm|realm-java,2870088,Anurag Singh,no
r text mining extract keywords,"<p>I am new to R and working on a machine learning problem, I understand that machine learning requires labelled data to make accurate prediction.</p>

<p>I am working with text data where the reviews given by users for a particular mobile app in text format. My primary task is to first extract the main keywords(features) </p>

<p>The text data is as follows in the CSV file in the 'review' column</p>

<pre><code>review1  - ""the gps does not work"",
review2  - ""tracking of phone is inconsistent"",
review3  - ""the battery is draining fast"",
review4  - ""the tracks disappear after some time"",
review5  - ""the app consumes the battery lot because of gps""
</code></pre>

<p>now I want to extract the feature mentioned in the each review such as
""gps"", ""tracking"", ""battery"", ""tracks"",""battery gps"" and add it as a label next to it respectively in the CSV file; so there would be one more column created in the CSV file as 'Feature'. 
So my CSV will have 2 columns, one review and one feature column that will highlight the feature mentioned in the review.The snapshot of the data in the CSV will be as follows <a href=""https://i.stack.imgur.com/H1VGs.jpg"" rel=""nofollow noreferrer"">new csv file data</a></p>

<p>I have written a sample code mentioned below for the same but since I need to deal with thousands of reviews I need to get the Feature column in my csv file which will act as a label for feature prediction</p>

<pre><code>#Feature Prediction
library(tm)
library(e1071)
texts &lt;- c(""the gps does not work"",
           ""tracking of phone is inconsistent"",
           ""the battery is draining fast"",
           ""the tracks disappear after some time"",
           ""the app consumes the battery a lot"")

features &lt;- c(""gps"", ""tracking"", ""battery"", ""tracks"",""battery"")
docs &lt;- VCorpus(VectorSource(texts))
# Clean corpus
docs &lt;- tm_map(docs, content_transformer(tolower))
docs &lt;- tm_map(docs, removeNumbers)
docs &lt;- tm_map(docs, removeWords, stopwords(""english""))
docs &lt;- tm_map(docs, removePunctuation)
docs &lt;- tm_map(docs, stripWhitespace)
dtm &lt;- DocumentTermMatrix(docs)
# Transform dtm to matrix to data frame - df is easier to work with
mat.df &lt;- as.data.frame(data.matrix(dtm), stringsAsfactors = FALSE)
# Column bind category (known classification)
mat.df &lt;- cbind(mat.df, features)
View(mat.df)
# Split data by rownumber into two equal portions (Train and Test Data)
train &lt;- sample(nrow(mat.df), ceiling(nrow(mat.df) * .50))
test &lt;- (1:nrow(mat.df))[- train]
# Isolate classifier
cl &lt;- mat.df[, ""features""]
# Create model data and remove ""features""
modeldata &lt;- mat.df[,!colnames(mat.df) %in% ""features""]
feature_pred &lt;- naiveBayes(modeldata[train,], cl[train])
naiv_pred &lt;- predict(feature_pred, modeldata[test,])
conf.mat &lt;- table(""Predictions"" = naiv_pred, Actual = cl[test])
conf.mat
(accuracy &lt;- sum(diag(conf.mat))/length(test) * 100)
</code></pre>",r|csv|text|machine-learning|nlp,7428676,IronMaiden,no
What is the power efficient way to keep offline data in sync with the server without GCM?,"<p>I'm building an Android client for an Internet discussion board: the app downloads the discussions from the server and displays them using the native Android UI.  It was quite easy to build the basics such as getting and displaying the content, and posting the replies back to the server.</p>

<p>Now I want to bring it to the next level: the app should store all the data locally on the device and sync it with the server periodically, getting the recent changes and updating the local DB.  I don't want it to check for the changes on demand; the periodic updates are better because this allows some nice features like subscribing to the updates.</p>

<p>Unfortunately the server is not GCM-compliant (and it will never be), it is a good old simple web server so I have to implement the sync myself.</p>

<p>I've found <a href=""https://stackoverflow.com/a/1356469/1380150"">a comment to another question</a> where it's said that a timer-based check is a bad idea because the device will have to wake up and connect to the Internet.  It would be much better to catch when the device begins its own data sync, but its there a way to handle this without a perioic check?</p>

<p>I've looked over many discussions on this issue; most of them discuss the ContentProviders, protocols, services like GCM/C2DM and so on.  I've found nothing about the power efficiency.</p>

<p>So how to do the sync properly so my app wouldn't drain the battery?</p>",android|offline-caching,1380150,Alexander Dunaev,yes
Weird behaviour when using intent and BroadcastReceiver to get android battery level,"<p>I am trying to find the battery level after running an android app. When the phone starts the app completely charged the code always returns 100% battery level (even though it has drained a lot). If I start the app at 75% battery or whatever then it returns the actual battery level at the end of the test. I start my test with the phone plugged into my computer keeping its charge up then right before executing the app I unplug it. Ideally I'd like tobe able to get starting% and ending% but that read 100% on both as well. So here is what I am doing... I call this from my activity:</p>

<pre><code>this.registerReceiver(this.mBatInfoReceiver, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));
</code></pre>

<p>Then in BroadcastReceiver I do a bunch of stuff (that takes over an hour so battery level changes). Then at the end of BoradcastReceiver I call this</p>

<pre><code>int level2 = intent.getIntExtra(""level"", 0);    /* Ending battery level */
String end = ""Ending battery level: "" + String.valueOf(level2) + ""%"";
</code></pre>

<p>And then send the String end to the server. </p>

<p>Here is what my code looks like:</p>

<pre><code>package com.mdog.datareceive;

import java.io.IOException;
import java.io.PrintWriter;
import java.net.Socket;
import java.net.UnknownHostException;

import android.app.Activity;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.os.Bundle;
import android.os.PowerManager;
import android.util.Log;
import android.widget.TextView;


public class Receive extends Activity {

    /* Test parameters */
    static int BYTES_TO_READ = 1024*1024*50;    /* The size of the data for each transfer */
    static int TIMES_TO_READ = 20;              /* The number of times the client will request the data */
    static int PLAYER_BUFFER_SIZE = 1638400;    /* Clients buffer size 1638400 = 1.57MB */
    static int SLEEP_TIME_MS = 5000;

    /* Display Info */
    String start = ""empty"";                 /* String holder for the starting battery life */
    String end = ""empty2"";                  /* String holder for the ending battery life */
    int allMBytes = 0;                      /* Integer holder for the total number of megabytes received during the test */
    TextView tv;                            /* The view the phone displays after completion of test */

    /* Server Info */
    String serverIP = ""192.168.0.104"";      /* Server IP */
    int serverPort = 11313;                 /* Server port number */



    private BroadcastReceiver mBatInfoReceiver = new BroadcastReceiver(){

        @Override
        public void onReceive(Context arg0, Intent intent) {

            //int level = intent.getIntExtra(""level"", 0);

            Socket connectionSocket = null;                         /* Socket to communicate with server */
            byte[] inputHolderByteArray = new byte[PLAYER_BUFFER_SIZE]; /* Used to read from the socket */

            int bufferBytes = 0;        /* filling the second buffer */
            int totalBytesRead = 0;     /* The total number of bytes read for this transfer round */
            int read=0;                 /* reading from stream, will contain the number of bytes read or -1 if the end has been hit */

            /* Acquire a wake lock for the phone so it does not go to sleep */
            PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
            PowerManager.WakeLock wl = pm.newWakeLock(PowerManager.SCREEN_BRIGHT_WAKE_LOCK, getClass().getName());

            /* Connect to Server */
            try {

                connectionSocket = new Socket(serverIP, serverPort);
                connectionSocket.setReceiveBufferSize(PLAYER_BUFFER_SIZE); //1.5ish MB
                connectionSocket.setKeepAlive(true);
                PrintWriter out = new PrintWriter(connectionSocket.getOutputStream(), true);

                out.print(""Client Info: Bytes expected per transfer:"" + BYTES_TO_READ + "", Number of transfer to request:"" + TIMES_TO_READ+ "", Buffer size:"" +PLAYER_BUFFER_SIZE+ "", Sleep time(ms):"" + SLEEP_TIME_MS + ""\n"");
                out.flush();

                wl.acquire();

                for(int i=0; i&lt;TIMES_TO_READ; i++){

                    out.print(""Start\n"");
                    out.flush();

                    while(totalBytesRead &lt; BYTES_TO_READ){

                        /* Read at most PLAYER_BUFFER_SIZE bytes */
                        read = connectionSocket.getInputStream().read(inputHolderByteArray, 0, PLAYER_BUFFER_SIZE);

                        if(read != -1){
                            bufferBytes += read;
                            totalBytesRead  += read;
                            if(bufferBytes &gt;= PLAYER_BUFFER_SIZE){
                                    try {
                                        Thread.sleep(SLEEP_TIME_MS);
                                    } catch (InterruptedException e) {
                                        e.printStackTrace();
                                    }
                                bufferBytes = 0;
                            }
                        }
                        else{
                            /* End of stream reached */
                            break;
                        }     
                    }

                    allMBytes += ((totalBytesRead/1024)/1024);
                    totalBytesRead = 0;

                    try {
                        Thread.sleep(1000);
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }

                }

                int level2 = intent.getIntExtra(""level"", 0);    /* Ending battery level */

                /* Put data on screen */
                start = ""Starting battery level: 100%"";
                end = ""Ending battery level: "" + String.valueOf(level2) + ""%"";
                out.print(""Test Completed: "" + start + "", "" + end + "", Megabytes Read: "" + allMBytes + ""\n"");
                out.flush();

                wl.release();

                tv.setText(start + ""    \n"" + end + ""    \n Total MB transferred:"" + allMBytes);
                setContentView(tv);

            } catch (UnknownHostException e) {
                Log.i(""UnknownHost exception "", "" ******************** Log Msg UHE "" + e.getLocalizedMessage());
                e.printStackTrace();
            } catch (IOException e2) {
                Log.i(""IO exception "", ""******************** Log Msg IOE "" + e2.toString());
                e2.printStackTrace();
            }
        }
    };


    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {

        tv = new TextView(this);                /* The view to post text to */
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        this.registerReceiver(this.mBatInfoReceiver, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));
    }
}
</code></pre>",android|android-activity|android-intent|broadcastreceiver|battery,604996,Michael,no
Is there a battery saving methode when reading GPS sensor in time intervals?,"<p>I'm developing an android app which collect GPS sensor data in time intervals programatically (one per 5min). So it drains the battery badly. Is there any way to optimize the power consumption?
Is there a way to disable or sleep GPS sensor when it is not reading?
All those should be progrmmatically. There is no way to turn on/off GPS sensor programmaticaly. </p>",android|gps|battery-saver|power-saving,5334087,lakshitha madusanka,yes
Android DJI UX SDK - problem reading location - battery drain,"<p>I tried to run a sample DJI UX SDK app that DJI provides on their github repo:
<a href=""https://github.com/dji-sdk/Mobile-UXSDK-Android/tree/master/sample"" rel=""nofollow noreferrer"">https://github.com/dji-sdk/Mobile-UXSDK-Android/tree/master/sample</a></p>
<p>However, when I open the app, the dji sdk registration starts and ends, but the GPS location pin in the status bar appears and doesn't disappear.</p>
<p><a href=""https://i.stack.imgur.com/B5w7P.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/B5w7P.jpg"" alt=""enter image description here"" /></a></p>
<p><strong>The GPS pin is also present when I put the app to the background.</strong> This results in the system telling me after some time that the application is draining too much battery.</p>
<p>Is there any way to fix this?</p>",android|background|battery|dji-sdk,2999762,Simon,yes
Pushwoosh and Android Phonegap App not communicating,"<h2>The Problem</h2>

<p>Okay so I have a Phonegap (2.3.0) android application with Pushwoosh to manage the push notifications. I followed the instructions, and got an app with only a few wording errors working. The app itself seems to run perfectly fine, however it doesn't seem like Pushwoosh is pushing anything to GCM (Google Cloud Messanger), which it turn isn't pushing anything to the app. Now that is what I think is wrong, however this is my first time using GCM and Pushwoosh. </p>

<p>On the Pushwoosh console page it shows each ""push"" as completed with no errors, but then on my GCM console it doesn't show any requests, nor do any notification pop up on my phone.</p>

<p>I have the GCM API key (server key) in my XML and my Pushwoosh is the correct XXXXX-XXXXX key. Here is my code to better outline how my code is setup (and maybe someone can see what I'm missing).</p>

<hr>

<h2>The Code</h2>

<p>Here is the AndroidManifest.xml</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;
</code></pre>

<p></p>

<pre><code>&lt;supports-screens
    android:largeScreens=""true""
    android:normalScreens=""true""
    android:smallScreens=""true""
    android:resizeable=""true""
    android:anyDensity=""true""
    /&gt;


&lt;uses-sdk android:minSdkVersion=""8"" android:targetSdkVersion=""17""/&gt;

&lt;uses-permission android:name=""android.permission.CAMERA"" /&gt;
&lt;uses-permission android:name=""android.permission.VIBRATE"" /&gt;
&lt;uses-permission android:name=""android.permission.ACCESS_COARSE_LOCATION"" /&gt;
&lt;uses-permission android:name=""android.permission.ACCESS_FINE_LOCATION"" /&gt;
&lt;uses-permission android:name=""android.permission.ACCESS_LOCATION_EXTRA_COMMANDS"" /&gt;
&lt;uses-permission android:name=""android.permission.RECEIVE_SMS"" /&gt;
&lt;uses-permission android:name=""android.permission.RECORD_AUDIO"" /&gt;
&lt;uses-permission android:name=""android.permission.RECORD_VIDEO""/&gt;
&lt;uses-permission android:name=""android.permission.MODIFY_AUDIO_SETTINGS"" /&gt;
&lt;uses-permission android:name=""android.permission.READ_CONTACTS"" /&gt;
&lt;uses-permission android:name=""android.permission.WRITE_CONTACTS"" /&gt;   
&lt;uses-permission android:name=""android.permission.WRITE_EXTERNAL_STORAGE"" /&gt;   
&lt;uses-permission android:name=""android.permission.ACCESS_NETWORK_STATE"" /&gt;
&lt;uses-permission android:name=""android.permission.BROADCAST_STICKY"" /&gt;
&lt;uses-permission android:name=""android.permission.ACCESS_NETWORK_STATE""/&gt;

&lt;!--library--&gt;
&lt;uses-permission android:name=""android.permission.READ_PHONE_STATE""/&gt;

&lt;!-- GCM connects to Google Services. --&gt;
&lt;uses-permission android:name=""android.permission.INTERNET""/&gt;

&lt;!-- GCM requires a Google account. --&gt;
&lt;uses-permission android:name=""android.permission.GET_ACCOUNTS""/&gt;

&lt;!-- Keeps the processor from sleeping when a message is received. --&gt;
&lt;uses-permission android:name=""android.permission.WAKE_LOCK""/&gt;

 &lt;!--
Creates a custom permission so only this app can receive its messages.

NOTE: the permission *must* be called PACKAGE.permission.C2D_MESSAGE,
    where PACKAGE is the application's package name.
--&gt;
&lt;permission
     android:name=""com.springmobile.employee.permission.C2D_MESSAGE""
     android:protectionLevel=""signature""/&gt;
&lt;uses-permission
     android:name=""com.springmobile.employee.permission.C2D_MESSAGE""/&gt;

&lt;!-- This app has permission to register and receive data message. --&gt;
&lt;uses-permission
     android:name=""com.google.android.c2dm.permission.RECEIVE""/&gt;



&lt;application android:icon=""@drawable/ic_launcher"" android:label=""@string/app_name"" android:allowBackup=""true""&gt;

  &lt;!--
Service for sending location updates
--&gt;
&lt;service android:name=""com.arellomobile.android.push.GeoLocationService""/&gt;
&lt;intent-filter&gt;
     &lt;action android:name=""com.springmobile.employee.MESSAGE""/&gt;
     &lt;category android:name=""android.intent.category.DEFAULT""/&gt;
 &lt;/intent-filter&gt;
 &lt;intent-filter&gt;
     &lt;action android:name=""android.intent.action.MAIN""/&gt;
     &lt;category android:name=""android.intent.category.LAUNCHER""/&gt;
 &lt;/intent-filter&gt;
    &lt;activity android:name=""com.arellomobile.android.push.PushWebview""/&gt;

    &lt;activity android:name=""com.arellomobile.android.push.MessageActivity""/&gt;

    &lt;activity android:name=""com.arellomobile.android.push.PushHandlerActivity""/&gt;

    &lt;!--
    BroadcastReceiver that will receive intents from GCM
    services and handle them to the custom IntentService.

    The com.google.android.c2dm.permission.SEND permission is necessary
    so only GCM services can send data messages for the app.
    --&gt;
    &lt;receiver
    android:name=""com.google.android.gcm.GCMBroadcastReceiver""
    android:permission=""com.google.android.c2dm.permission.SEND""&gt;
    &lt;intent-filter&gt;
    &lt;!-- Receives the actual messages. --&gt;
    &lt;action android:name=""com.google.android.c2dm.intent.RECEIVE""/&gt;
    &lt;!-- Receives the registration id. --&gt;
    &lt;action android:name=""com.google.android.c2dm.intent.REGISTRATION""/&gt;
    &lt;category android:name=""com.springmobile.employee""/&gt;
    &lt;/intent-filter&gt;
    &lt;/receiver&gt;

    &lt;!--
    Application-specific subclass of PushGCMIntentService that will
    handle received messages.
    --&gt;
    &lt;service android:name=""com.arellomobile.android.push.PushGCMIntentService""/&gt;
    &lt;activity android:name=""org.apache.cordova.example.cordovaExample"" android:label=""@string/app_name""
            android:theme=""@android:style/Theme.Black.NoTitleBar""
            android:configChanges=""orientation|keyboardHidden""&gt;
        &lt;intent-filter&gt;
            &lt;action android:name=""android.intent.action.MAIN"" /&gt;
            &lt;category android:name=""android.intent.category.LAUNCHER"" /&gt;
        &lt;/intent-filter&gt;
    &lt;/activity&gt;
&lt;/application&gt;
</code></pre>

<p> </p>

<hr>

<p>Here is my Phonegap plugin config.XML</p>

<pre><code>&lt;plugins&gt;
&lt;plugin name=""PushNotification"" value=""com.pushwoosh.plugin.pushnotifications.PushNotifications"" onload=""true""/&gt;
&lt;/plugins&gt;
</code></pre>

<hr>

<p>Here is the JS for my Phonegap page to initialize and listen for the Pushwoosh Notification.</p>

<pre><code>function initPushwoosh()
{
var pushNotification = window.plugins.pushNotification;
pushNotification.onDeviceReady();

pushNotification.registerDevice({ projectid: ""I_HAVE_MY_PROJECT_ID_HERE"", appid : ""THIS_IS_MY_PUSHWOOSH_ID"" },
    function(status) {
        var pushToken = status;
        console.warn('push token: ' + pushToken);
    },
    function(status) {
        console.warn(JSON.stringify(['failed to register ', status]));
    }
);

document.addEventListener('push-notification', function(event) {
    var title = event.notification.title;
        var userData = event.notification.userdata;

        if(typeof(userData) != ""undefined"") {
        console.warn('user data: ' + JSON.stringify(userData));
    }

    navigator.notification.alert(title);
});
}

function init() {
document.addEventListener(""deviceready"", initPushwoosh, true);

//rest of the code
document.addEventListener('push-notification', function(event) {
    var title = event.notification.title;
        var userData = event.notification.userdata;

    console.warn('user data: ' + JSON.stringify(userData));
    navigator.notification.alert(title);
});
}

function initPushwoosh()
{
var pushNotification = window.plugins.pushNotification;
pushNotification.onDeviceReady();

document.addEventListener('push-notification', function(event) {
                            var title = event.notification.title;
                            var userData = event.notification.userdata;

                            if(typeof(userData) != ""undefined"") {
                                console.warn('user data: ' + JSON.stringify(userData));
                            }

                            navigator.notification.alert(title);

                            pushNotification.stopGeoPushes();
                          });
}

function registerPushwoosh()
{
var pushNotification = window.plugins.pushNotification;
//projectid: ""GOOGLE_PROJECT_ID"", appid : ""PUSHWOOSH_APP_ID""
pushNotification.registerDevice({ projectid: ""1039894503284"", appid : ""EE861-B95A3"" },
                                function(token) {
                                    alert(token);
                                    onPushwooshInitialized(token);
                                },
                                function(status) {
                                    alert(""failed to register: "" +  status);
                                    console.warn(JSON.stringify(['failed to register ', status]));
                                });
}

function unregisterPushwoosh()
{
var pushNotification = window.plugins.pushNotification;
pushNotification.unregisterDevice(function(token) {
                                    alert(""unregistered, old token "" + token);
                                },
                                function(status) {
                                    alert(""failed to unregister: "" +  status);
                                    console.warn(JSON.stringify(['failed to unregister ', status]));
                                });
}

//set the settings for Pushwoosh or set tags, this must be called only after successful registration
function onPushwooshInitialized(pushToken)
{
//output the token to the console
console.warn('push token: ' + pushToken);

var pushNotification = window.plugins.pushNotification;

//set multi notificaiton mode
//pushNotification.setMultiNotificationMode();

//set single notification mode
//pushNotification.setSingleNotificationMode();

//disable sound and vibration
//pushNotification.setSoundType(1);
//pushNotification.setVibrateType(1);

pushNotification.setLightScreenOnNotification(false);

//goal with count
//pushNotification.sendGoalAchieved({goal:'purchase', count:3});

//goal with no count
//pushNotification.sendGoalAchieved({goal:'registration'});

//setting list tags
//pushNotification.setTags({""MyTag"":[""hello"", ""world""]});

//settings tags
pushNotification.setTags({deviceName:""hello"", deviceId:10},
                                function(status) {
                                    console.warn('setTags success');
                                },
                                function(status) {
                                    console.warn('setTags failed');
                                });

function geolocationSuccess(position) {
    pushNotification.sendLocation({lat:position.coords.latitude, lon:position.coords.longitude},
                             function(status) {
                                  console.warn('sendLocation success');
                             },
                             function(status) {
                                  console.warn('sendLocation failed');
                             });
};

// onError Callback receives a PositionError object
//
function geolocationError(error) {
    alert('code: '    + error.code    + '\n' +
          'message: ' + error.message + '\n');
}

function getCurrentPosition() {
    navigator.geolocation.getCurrentPosition(geolocationSuccess, geolocationError);
}

//greedy method to get user position every 3 second. works well for demo.
//  setInterval(getCurrentPosition, 3000);

//this method just gives the position once
//  navigator.geolocation.getCurrentPosition(geolocationSuccess, geolocationError);

//this method should track the user position as per Phonegap docs.
//  navigator.geolocation.watchPosition(geolocationSuccess, geolocationError, { maximumAge: 3000, enableHighAccuracy: true });

//Pushwoosh Android specific method that cares for the battery
pushNotification.startGeoPushes();
}

var app = {
// Application Constructor
initialize: function() {
    this.bindEvents();
},
// Bind Event Listeners
//
// Bind any events that are required on startup. Common events are:
// 'load', 'deviceready', 'offline', and 'online'.
bindEvents: function() {
    document.addEventListener('deviceready', this.onDeviceReady, false);
},
// deviceready Event Handler
//
// The scope of 'this' is the event. In order to call the 'receivedEvent'
// function, we must explicity call 'app.receivedEvent(...);'
onDeviceReady: function() {
    initPushwoosh();
    app.receivedEvent('deviceready');

    //optional: create local notification alert
    //var pushNotification = window.plugins.pushNotification;
//pushNotification.clearLocalNotification();
//pushNotification.createLocalNotification({""msg"":""message"", ""seconds"":30, ""userData"":""optional""});

},
// Update DOM on a Received Event
receivedEvent: function(id) {
    var parentElement = document.getElementById(id);
    var listeningElement = parentElement.querySelector('.listening');
    var receivedElement = parentElement.querySelector('.received');

    listeningElement.setAttribute('style', 'display:none;');
    receivedElement.setAttribute('style', 'display:block;');

    console.log('Received Event: ' + id);
}
};
</code></pre>

<hr>

<p>Here is the PushWoosh.js code</p>

<pre><code>(function(cordova) {

function PushNotification() {}

// Call this to register for push notifications and retreive a deviceToken
PushNotification.prototype.registerDevice = function(config, success, fail) {
    cordova.exec(success, fail, ""PushNotification"", ""registerDevice"", config ? [config] : []);
};

// Call this to set tags for the device
PushNotification.prototype.setTags = function(config, success, fail) {
    cordova.exec(success, fail, ""PushNotification"", ""setTags"", config ? [config] : []);
};

// Call this to send geo location for the device
PushNotification.prototype.sendLocation = function(config, success, fail) {
    cordova.exec(success, fail, ""PushNotification"", ""sendLocation"", config ? [config] : []);
};

//Android Only----
PushNotification.prototype.unregisterDevice = function(success, fail) {
    cordova.exec(success, fail, ""PushNotification"", ""unregisterDevice"", []);
};

//config params: {msg:""message"", seconds:30, userData:""optional""}
PushNotification.prototype.createLocalNotification = function(config, success, fail) {
    cordova.exec(success, fail, ""PushNotification"", ""createLocalNotification"", config ? [config] : []);
};

PushNotification.prototype.clearLocalNotification = function() {
    cordova.exec(null, null, ""PushNotification"", ""clearLocalNotification"", []);
};

//advanced background task to track device position and not drain the battery
PushNotification.prototype.startGeoPushes = function(success, fail) {
    cordova.exec(success, fail, ""PushNotification"", ""startGeoPushes"", []);
};

PushNotification.prototype.stopGeoPushes = function(success, fail) {
    cordova.exec(success, fail, ""PushNotification"", ""stopGeoPushes"", []);
};

//sets multi notification mode on
PushNotification.prototype.setMultiNotificationMode = function(success, fail) {
    cordova.exec(success, fail, ""PushNotification"", ""setMultiNotificationMode"", []);
};

//sets single notification mode
PushNotification.prototype.setSingleNotificationMode = function(success, fail) {
    cordova.exec(success, fail, ""PushNotification"", ""setSingleNotificationMode"", []);
};

//type: 0 default, 1 no sound, 2 always
PushNotification.prototype.setSoundType = function(type, success, fail) {
    cordova.exec(success, fail, ""PushNotification"", ""setSoundType"", [type]);
};  

//type: 0 default, 1 no vibration, 2 always
PushNotification.prototype.setVibrateType = function(type, success, fail) {
    cordova.exec(success, fail, ""PushNotification"", ""setVibrateType"", [type]);
};  

PushNotification.prototype.setLightScreenOnNotification = function(on, success, fail) {
    cordova.exec(success, fail, ""PushNotification"", ""setLightScreenOnNotification"", [on]);
};

//set to enable led blinking when notification arrives and display is off
PushNotification.prototype.setEnableLED = function(on, success, fail) {
    cordova.exec(success, fail, ""PushNotification"", ""setEnableLED"", [on]);
};

//{goal:'name', count:3} (count is optional)
PushNotification.prototype.sendGoalAchieved = function(config, success, fail) {
    cordova.exec(success, fail, ""PushNotification"", ""sendGoalAchieved"", config ? [config] : []);
};

//Android End----

//iOS only----
PushNotification.prototype.onDeviceReady = function() {
    cordova.exec(null, null, ""PushNotification"", ""onDeviceReady"", []);
};

// Call this to get a detailed status of remoteNotifications
PushNotification.prototype.getRemoteNotificationStatus = function(callback) {
    cordova.exec(callback, callback, ""PushNotification"", ""getRemoteNotificationStatus"", []);
};

// Call this to set the application icon badge
PushNotification.prototype.setApplicationIconBadgeNumber = function(badge, callback) {
    cordova.exec(callback, callback, ""PushNotification"", ""setApplicationIconBadgeNumber"", [{badge: badge}]);
};

// Call this to clear all notifications from the notification center
PushNotification.prototype.cancelAllLocalNotifications = function(callback) {
    cordova.exec(callback, callback, ""PushNotification"", ""cancelAllLocalNotifications"", []);
};
//iOS End----

// Event spawned when a notification is received while the application is active
PushNotification.prototype.notificationCallback = function(notification) {
    var ev = document.createEvent('HTMLEvents');
    ev.notification = notification;
    ev.initEvent('push-notification', true, true, arguments);
    document.dispatchEvent(ev);
};

cordova.addConstructor(function() {
    if(!window.plugins) window.plugins = {};
    window.plugins.pushNotification = new PushNotification();
});

})(window.cordova || window.Cordova || window.PhoneGap);
</code></pre>

<hr>

<h2>Screenshots of GCM, Pushwoosh and Eclipse</h2>

<p>Sorry this is lengthy but I want to make sure I have everything here. Also not enough rep to post images so links below.</p>

<p><a href=""http://imgur.com/a/ZS4uR"" rel=""nofollow"">GCM API server key, Pushwoosh Control Panel, and Eclipse setup</a></p>

<hr>

<p><strong>Thanks!</strong></p>",android|cordova|push-notification|google-cloud-messaging|pushwoosh,1959211,nikobradshaw,yes
Detecting when an Android device is in a certain location,"<p>What's the best way of detecting when an Android device is in a certain location? I'm creating a device admin app that enforces certain policies when the device is in a certain premise, e.g. a certain office building, and in order to enforce the policies, I need to know where the device is, and the Device Administrator API does not have any geo-location/geo-fence APIs.</p>

<p>I can think of a few methods, but none are foolproof:</p>

<ol>
<li>Poll fine location (Wifi/GPS) - dependent on whether user has Wifi/GPS on. Impossible to enforce. Also, GPS doesn't work indoors and drains battery significantly.</li>
<li>Poll course location(cell tower) - more reliable, but inaccurate.</li>
<li>Place wifi routers around premises and detect when they are near - dependent of whether user has Wifi on.</li>
</ol>

<p>What's the best way of detecting a device's location?</p>",android|gps|geolocation|android-geofence|device-admin,1118764,user1118764,yes
Linux high cpu usage - htop shows 90% to 100% cpu usage,"<p>I installed a fresh Manjaro Linux on my laptop and it works okay but I noticed high CPU usage when i ran the htop command. One of the cores were constantly busy near 100% and the 2nd one was around 90% (I got 4 cores, the remaining 2 are running normally). The laptop is usable but my battery is draining faster than before.</p>
<p><strong>I already found the solution</strong> and posting it below to hopefully help someone who is a Linux beginner like myself.</p>",linux|cpu-usage|manjaro|htop,15013363,cpu1001,yes
Android: How to timeout GPS trying to find a lock?,"<p>Here are snippets of my code:</p>

<pre><code>private class NoGpsLock implements Runnable {
    public void run() {
      if (gps == null) {
        Toast toast = Toast.makeText(getApplicationContext(), ""Unable to find GPS lock"", Toast.LENGTH_LONG);
        toast.show();
        if (locManager != null) {
          locManager.removeUpdates(locListener);
        }
      }
    }
  }
</code></pre>

<p>Called by</p>

<pre><code>try {
  locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, MIN_TIME, MIN_DIST, locListener);
} catch (Exception ex) {
}
Handler gpsHandler = new Handler();
gpsHandler.postDelayed(new NoGpsLock(), 15000); //15seconds
</code></pre>

<p>From what I understand, <code>removeUpdates()</code> is supposed to stop the GPS receiving updates. I tried this on the emulator and on 2 devices; on the emulator, it does stop the app from receiving further location changes. However, on the actual devices, the icon for ""Receiving location data from GPS"" keeps showing up and drains the battery (which I assume indicates that the app/phone keeps on looking for a location and unable to, since I'm indoors). How do I stop the GPS from trying to find a location?</p>

<p>EDIT: I want my app to stop trying to find location after a period of time, and then maybe restart the GPS again later.</p>",android|gps|locationmanager,861815,dee,yes
Is it possible to make Intellij enter power save mode when my laptop is on battery automatically?,<p>I usually work with the AC plugged in but sometimes I remove the cord and forget to put Intellij into Power Save mode and my battery drains battery very quickly. Is it possible to do what I am asking? </p>,intellij-idea|intellij-16,1242842,Alexander Suraphel,no
MS Visual Studio.net - saved source files missing after reboot,"<p>The other day I created a MS visual studio 2010 C# project and started coding. I saved the source frequently, but I did not select a destination to save to (just pressed ctrl+s and assumed the source was being saved). However I had to run and threw my laptop in my backpack on sleep. Unfortunately this laptop (acer aspire 5252 fyi) battery drains extremely quickly when on sleep, and eventually my computer shut off. Now I can't find my source files anywhere and I'm going crazy because I know I saved it and it's several days worth of work.</p>

<p>I tried doing a windows search but couldn't find the project files. I also did a little experiment - I created a new project and without saving the entire solution, I pressed ctrl+s on the source files. Save was successful, but I cannot even find the file that's open in the IDE. Even the ""open containing folder option"" is grayed out (see screen shot).</p>

<p><img src=""https://i.stack.imgur.com/pNdRj.png"" alt=""File was created and saved, but where is it?""></p>

<p>I really need these source files back. Obviously it's because I didn't save the solution that the source got wiped out, but where do the source files get saved temporarily before the solution is saved?</p>

<p>Thanks.</p>",visual-studio-2010,720238,JSideris,no
GPS not updating location when device locked android,"<p>I need to create live path tracking app. I have used <a href=""https://developers.google.com/android/reference/com/google/android/gms/location/FusedLocationProviderApi#getLastLocation%28com.google.android.gms.common.api.GoogleApiClient%29"" rel=""nofollow"">FusedLocationProviderApi </a> for getting the current location. My problem is when device is locked some how <code>FusedLocationProvider</code> do not update location. I tried to make device wake using <a href=""https://developer.android.com/training/scheduling/wakelock.html"" rel=""nofollow"">WAKE_LOCK</a> when tracking is in process, but it result device headed and battery drain. Please suggest me something to get rid of it. Below is my location service code </p>

<pre><code>  public class LocationService extends Service {
public static float MIN_DIST = 50.0f;
public static float MIN_SPEED = 0.0f;

public static final String BROADCAST_ACTION = ""LocationService.LOCATION_UPDATE"";

public LocationManager locationManager;
public MyLocationListener listener;

private static final long MINIMUM_DISTANCE_CHANGE_FOR_UPDATES = 0; // in meters
private static final long MINIMUM_TIME_BETWEEN_UPDATES = 5*1000; // in mili


Intent intent;
String tag=getClass().getSimpleName();

PowerManager powerManager;
 // WakeLock wakeLock;

Timer checkLastLocUpdateTimer; // timer to check time of last loc update and reset loc update if required

@Override
public void onCreate() {
    super.onCreate();
    intent = new Intent(BROADCAST_ACTION);

    locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    listener = new MyLocationListener();

    powerManager = (PowerManager) getSystemService(POWER_SERVICE);
    /*wakeLock = powerManager.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,
            ""FUSED_LOCATOIN_SERVICE_WAKE_LOCK"");*/
    checkLastLocUpdateTimer = new Timer();
    //Set the schedule function and rate
    checkLastLocUpdateTimer.scheduleAtFixedRate(new TimerTask() {

        @Override
        public void run() 
        {

            long maxWaitTimeforUpdate = 60*1000; // in millis
            long currentTime = System.currentTimeMillis();
            long lastLocUpdateTime = Pref.getLastLocUpdateTime(getApplicationContext());
            long timeDiff = currentTime- lastLocUpdateTime;
            Log.e(tag,""Time since last loc update: ""+timeDiff);

        if(timeDiff&gt;maxWaitTimeforUpdate)
            {
                Log.e(tag,""Time since last loc update is more than max waiting time: ""+timeDiff);

                //if(mGoogleApiClient.isConnected())
                {
                    Log.e(tag,""Restarting Location Updates..."" );// 


                    startStopLocationUpdateHandler.sendEmptyMessage(0);
                }
            }

        }

    },
    //Set how long before to start calling the TimerTask (in milliseconds)
    30*1000,
    //Set the amount of time between each execution (in milliseconds)
    30*1000);


    Log.e(tag,""OnCreate()"");
}

private final Handler startStopLocationUpdateHandler = new Handler()
{
    @Override
    public void handleMessage(Message msg)
    {
        stopLocationUpdates();
        startLocationUpdates();
    }
};  

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    Log.e(""LocationService"", ""onStartCommand"");
  //        wakeLock.acquire();
    startLocationUpdates();

    return Service.START_STICKY;
}

@Override
public IBinder onBind(Intent intent) {
    return null;
}

@Override
public void onDestroy() {
    super.onDestroy();
    checkLastLocUpdateTimer.cancel();
    stopLocationUpdates();
    /*if(wakeLock.isHeld())
    {
        wakeLock.release();
    }*/
    Log.e(tag,""OnDestroy()"");

}

protected void startLocationUpdates()
{
    locationManager.requestLocationUpdates(
            LocationManager.GPS_PROVIDER,
            MINIMUM_TIME_BETWEEN_UPDATES,
            MINIMUM_DISTANCE_CHANGE_FOR_UPDATES, 
            listener);
    Log.e(tag,""Requested location update"");

}

protected void stopLocationUpdates()
{
    locationManager.removeUpdates(listener);
    Log.e(tag,""Location updates removed"");

}

public class MyLocationListener implements LocationListener {

    public void onLocationChanged(final Location loc) 
    {
        Log.e(tag, ""locationChanged ""+loc.toString());


        Pref.setLastLocUpdateTime(System.currentTimeMillis(), getApplicationContext());

        intent.putExtra(""Latitude"", loc.getLatitude());
        intent.putExtra(""Longitude"", loc.getLongitude());
        intent.putExtra(""Provider"", loc.getProvider());
        intent.putExtra(""Accuracy"", loc.getAccuracy());
        intent.putExtra(""Altitude"", loc.getAltitude());
        intent.putExtra(""Bearing"", loc.getBearing());
        intent.putExtra(""Speed"", loc.getSpeed());
        intent.putExtra(""Time"", loc.getTime());
        sendBroadcast(intent);

    }

    public void onProviderDisabled(String provider) {

        Log.e(tag,""onProviderDisabled: ""+provider.toString());
    }

    public void onProviderEnabled(String provider) {

        Log.e(tag,""onProviderEnabled: ""+provider.toString());
    }

    public void onStatusChanged(String provider, int status, Bundle extras) {

        Log.e(tag,""onStatusChanged- provider: ""+provider.toString()+"" status: ""+status);
    }
}

}
</code></pre>",android|gps|android-location|fusedlocationproviderapi,2361084,maddy d,yes
iOS: How to reduce background activity in drive tracking app,"<p>I have an app that runs in the background and monitors the user drive.</p>

<p>The app stays alive in the background due to CLLocation background mode.</p>

<p>But the problem is that the app show background activity as 22 hours in last 24 hours. My understanding is that the background activity drains a lot of battery.</p>

<p>There are some drive tracking apps that have background activity approximately equal to the sum of all drive times. My app consumes 3 times more power than them.</p>

<p>How can i detect all user drives and at the same time also reduce background activity, thereby reducing battery consumption?</p>",ios|background|core-location|cllocationmanager,3643290,Parin Shah,yes
Best strategy for picking accuracy priority for Fused Location Services?,"<p>I'm building an app that requires that location coordinates be recorded every 5 minutes. Because the devices I'm targeting are Samsung devices, which has a problem with getting from network providers via the native Android location library, I have opted to use the Fused Location Services from the Google Play Services.</p>

<p>Obviously using <code>PRIORITY_HIGH_ACCURACY</code> would be best as it would use all providers to get the best location. The problem is that this drains the battery too quickly. I'd like to toggle between <code>PRIORITY_BALANCED_POWER_ACCURACY</code> and <code>PRIORITY_HIGH_ACCURACY</code>, depending on the situation.</p>

<p>Currently, I have it so when there is internet connection (confirmed by pinging a specific site), I use <code>PRIORITY_BALANCED_POWER_ACCURACY</code>. If there isn't, I use <code>PRIORITY_HIGH_ACCURACY</code>. I'm wondering if this is the best way, as there could be situations where the user is not connected to any WIFI, but has their WIFI on and is in a WIFI crowded area. Should I, in addition to checking for connectivity, if that fails, check for available WIFI access points  and if I find some, still use <code>PRIORITY_BALANCED_POWER_ACCURACY</code>?</p>",android|google-play-services|android-location,1051164,Huy T,no
Minimising an app's battery usage on iOS (while phone is locked etc),"<p>I've noticed that since iOS 4.0, the apps I developed started to not ""exit"" when the home button is pressed, but rather they stay in the ""system tray"" thing which pops out when you double click the system.</p>

<p>At around the same time, I noticed that the battery in my phone starts draining a lot faster. Then again, theoretically all the app should be using right now is only memory, because it is not currently active.</p>

<p>Which begs the question, has there ever been any benchmark on what causes the iPhone to drain the most batteries? Perhaps opengl calls, which use the graphics card would consume quite a bit? Or maybe just having the apps active mean there's less memory, and this causes faster battery loss (say, because the memory allocator must do more work etc)?</p>

<p>I am keen to know what other developers have tried to do to optimise battery usage.</p>",iphone|ios|battery,277941,kamziro,yes
latest free and easy to use web barcode scanner?,"<p>Which is the latest free and easy to use web barcode scanner ?</p>

<p>I am building a .net/asp web application and need to implement a functionality to scan barcodes using a tablet or smartphone.
I have found <a href=""https://serratus.github.io/quaggaJS/"" rel=""nofollow noreferrer"">quaggaJS</a> but its a bit difficult to use and is draining my battery very fast while using.</p>",web-applications|barcode-scanner,2614938,eddy white,no
onDependentViewChanged from CoordinatorLayout.Behavior called all the time,"<p>I implemented <code>CoordinatorLayout.Behavior</code>and overridden <code>onDependentViewChanged</code> function but it worries me it fires every couple milliseconds even the scroll view is staying still. </p>

<p>That doesn't change if I return false from <code>onDependentViewChanged</code></p>

<p>I can't find any information on this, but this thing spamming my logs doesn't look like a proper behavior. Will drain the battery.</p>

<p>My simplified layout look like this:</p>

<pre><code>&lt;SwipeRefreshLayout
        android:id=""@+id/ptr""
        android:layout_width=""match_parent""
        android:layout_height=""match_parent""&gt;

        &lt;android.support.design.widget.CoordinatorLayout
            android:id=""@+id/coordinatorLayout""
            android:layout_width=""match_parent""
            android:layout_height=""match_parent""&gt;

            &lt;android.support.v4.widget.NestedScrollView
                android:id=""@+id/scrollView""
                android:layout_width=""match_parent""
                android:layout_height=""match_parent""
                android:fillViewport=""true""
                app:layout_behavior=""@string/appbar_scrolling_view_behavior""&gt;
            &lt;/android.support.v4.widget.NestedScrollView&gt;

            &lt;FrameLayout
                android:id=""@+id/avatarContainer""
                android:layout_width=""20dp""
                android:layout_height=""20dp""
                app:layout_anchor=""@id/scrollView""
                app:layout_anchorGravity=""center_horizontal|top""
                app:layout_behavior=""my.app.behaviors.ProfileAvatarBehavior""&gt;

            &lt;/FrameLayout&gt;

        &lt;/android.support.design.widget.CoordinatorLayout&gt;
    &lt;/SwipeRefreshLayout&gt;
</code></pre>",android|android-coordinatorlayout|coordinator-layout,928611,Jacek Kwiecień,yes
How to make application be executed from background service?,"<p>I want to ask how alarm applications work on mobile. As it doesn't drain battery, and i think in my problem (below) i can use same approach. And i don't know how to use background service, that it executes the main application with given period.
I have to calculate something each time period which user inputs. And if the result is the same as user wants (user inputs it too) i need to show him about result. How i must make application: two apart applications (timer/calculator and input/output) or one application ? and if i write two apart applications, the 1st timer/calculator must be like console application?</p>

<p>And my main question: how to set ""something"" to given period, that with it i know that my calculator will calculate something with given period?
P.S. Sorry for my English. And sorry for my mistakes if there are any</p>",c#|windows-phone-8|background-service,885200,Javidan,yes
Does the accelerometer drain battery on Android Wear? (Android watch),"<p>I'm creating an Android Wear app that tries to detect some of the hand movements, <strong>to do it, I need to continuously monitor the accelerometer output</strong>. I'm wondering how it will affect the battery life. </p>

<p>For phones, I know that there are methods like ""disable accelerometer while screen is turned off"" to save battery, but what's the battery cost in case of watches? <strong>Since Android watch can count your steps and it turns on the screen when you face it towards your face, I believe the accelerometer is turned-on all the time anyway.</strong></p>

<p><strong>in this case, will my app drain the battery?</strong></p>

<p>(Calculations after receiving the accelerometer values will be pretty simple.) </p>",android|accelerometer|battery|wear-os,1083338,Umair,no
Does android-wear watch keep the accelerometer always on to turn on the screen automatically?,"<p>I m wondering how android watch automatically turn on the screen when you face it towards you, or how it counts the number of steps? if it keeps the accelerometer always on, doesn't it drain the battery? </p>

<p>If I listen to accelerometer values 24x7, will it drain any additional battery? </p>",android|accelerometer|battery|wear-os,1083338,Umair,no
UDP/RTCP Packets not reaching Device/Application Whens device screen is Locked,"<p>My VOIP Android Application has the C/Native Library which does all business logic of login/Logout etc.</p>

<p>Issue with this is when the device screen is locked the application(c Code) is not able to receive any packets from the server. I verified this with Wireshark. It looks like the CPU is not running.</p>

<p>I was able to solve the issue doing below on my application INIT.</p>

<pre><code>WakeLock mWakeLock =  null;
PowerManager pm = (PowerManager) cxt.getSystemService(Context.POWER_SERVICE);
if(mPartialWakeLock == null){
    // lock used to keep the processor awake.
    mPartialWakeLock = pm.newWakeLock(
        PowerManager.PARTIAL_WAKE_LOCK
            | PowerManager.ON_AFTER_RELEASE, TAG);
    mPartialWakeLock.acquire;
}
</code></pre>

<p>But doing above will drain my battery.</p>

<p>Why the requests are not reaching my application? How can I make device CPU up all time when Screen is LOCKED and receive requests from the Server?</p>

<p>Note: 
EDITED
Device Used: Samsung Rugby Smart i847
OS     : Android OS, v2.3.6 (Gingerbread.UCLA4)</p>

<p>The the application works on Galaxy s2.(Is it because its Dual Core Processor and CPU is up on Screen LOCK?)
How Does SKYPE and VIBER designed WRT to Sleep Mode??</p>",android|android-ndk|cpu,1225076,NitZRobotKoder,yes
Best way to detect (any) app (i.e. activity) launch from a my background service,"<p>My app has a background Service. In the Service I need to detect and log all app launches. For example: whether the user opens Facebook or Google+ or Twitter (any app) - I want a receiver in my Service to catch it for me to perform an action.</p>
<p>The only way I have been able to come up to do this - is to have a Timer running in the onCreate() function of my Service. My concern is that this 1 second timer may drain battery.</p>
<ol>
<li>Is that assumption correct?</li>
<li>If yes, is there another way (some intent filter?) that I can register with my Broadcast Receiver to catch any App Launch?</li>
</ol>
<p><strong>Things I have tried:</strong></p>
<p>(1) My Service code with the TimerTask. My trigger action code will be placed inside the &quot;run()&quot; function of the TimerTask.</p>
<pre><code>public class KillService extends Service {

ActivityManager mActivityManager;

@Override
public IBinder onBind(Intent arg0) {
    // TODO Auto-generated method stub
    return null;
}



@Override
public void onDestroy() {
    unregisterReceiver(receiver);
    super.onDestroy();
}




@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    return START_STICKY;
}

@Override
public void onCreate() {
    super.onCreate();
    Timer timer = new Timer();    
            TimerTask refresher = new TimerTask() {
            public void run() {
                   //PLACING MY TRIGGER ACTION HERE
        };
    };
    //TIMER RUNS EVERY 1 SECOND
    timer.scheduleAtFixedRate(refresher, 1000,1000);    

}   
}
</code></pre>
<p><strong>(2) Reviewed Available Broadcast Actions</strong>
I reviewed the broadcast_actions.txt that comes in the SDK Folder (sdk\platforms\android-19\data), but I did not find any Intent that will be appropriate for this use case.
<a href=""http://pastebin.com/72kZgZbS"" rel=""nofollow noreferrer"">Link to file</a></p>
<p>All I want is to know when any App Activity is started (i.e. in the Foreground) so that I dont have to continually check with Timer (afraid that it may drain battery)</p>",android|service|intentfilter|timertask,1406716,user1406716,no
Keep connection between Windows service and Windows Phone app alive,"<p>So, I would like to have a Windows Phone app ""connected"" at ALL TIME with a Windows service.
That means that the service would need to know if a device has been turned off or lost network connection within seconds after it happens. On iOS and Android we keep this connection up with sockets. But this doesn't seems to be possible with background tasks on Windows Phone?</p>

<p>Is there somehow we could ""ping"" the server/service more often then every 30 mins from a scheduled task? The app will only be used by known people so if there is a possibility to ""fake"" a music app och location app that would do it. The app will probably be released as a enterprise company app so all users will be aware of the possible ""battery drain"" that could be caused.</p>

<p>If using Push notification, how long can it take before a device gets it and could the service know right away if that device received it?</p>",windows-phone-8|windows-phone,201048,Andreas Bergqvist,yes
Monitoring battery level on iPhone,"<p>I'm using the basic battery monitoring code on iOS and I've read somewhere that it drains battery to do so.</p>

<pre><code>UIDevice *device = [UIDevice currentDevice];
    device.batteryMonitoringEnabled = YES;
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(batteryChanged) name:@""UIDeviceBatteryLevelDidChangeNotification"" object:device];
</code></pre>

<p>I can't really find any good reference with actual data on this.</p>

<p>Is it really bad to check the changes in battery level? What other possibilities do I have?
I would like to do much less treatment when the battery is low so that I don't finish it off.</p>",ios|iphone|battery,1148137,SeikoTheWiz,no
"How to detect headphone plug event in ""offline"" mode","<p>I know how to detect headphone plug in event if my application is running. You have to register broadcast receiver for ACTION_HEADSET_PLUG. But you can't capture this action using Manifest declaration for broadcast receiver. Therefore the only option to capture headphone plug in event is background service. But it drains battery and so on.</p>

<p>I checked out some music players and figured out that they capture that event without any additional services. How do they do that? Any ideas?</p>",android|broadcastreceiver,412469,MistaGreen,no
How can Google Maps (android) be so efficient requesting GPS fixes so often,"<p>I've been developing a tracking app for Android in which I need to track a person using GPS fixes very often (10 seconds interval tops).</p>

<p>Turns out that after couple of minutes my phone warned a battery-draining app - my app.</p>

<p>Although I know GPS fixes uses lots of battery, how is it possible to use Google Maps tracking for over an hour without drain-battery and still get instant GPS changes fix?</p>

<p>Thanks a lot. </p>

<p>Here's an idea of what i'm doing:</p>

<pre><code>// Define a listener that responds to location updates
LocationListener locationListener = new LocationListener() {
    public void onLocationChanged(Location location) {
      // Called when a new location is found by the network location provider.
      makeUseOfNewLocation(location);
    }

    public void onStatusChanged(String provider, int status, Bundle extras) {}

    public void onProviderEnabled(String provider) {}

    public void onProviderDisabled(String provider) {}
  };

// Register the listener with the Location Manager to receive location updates
locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 10000, 0, locationListener);
</code></pre>

<p>That's pretty much it of battery-draining in my whole code.</p>",android|google-maps|gps|battery,3443488,ricardofagodoy,no
How to Update the Fragment ListView from Service in android?,"<p>I am trying to build a chatting app using <code>GCM</code>.Now i could successfully receive and send data between two users.When i am chatting i have a <code>chatwindow</code> open only for me and myfriend.Now the problem is that i have a listview for the conversation between me and my friend.I am little bit confused how to update the listview while i am chatting with my friend, actually when my friend send me message.Now the scenarios in my app is:<br></p>

<p><strong>1.</strong> If chat window is open for me and Mr A  and Mr A sends me a message then i want to update the <code>listview</code>.My <code>ChatWindow</code> is in a <code>fragment</code>.Now i don't know how to update the fragment UI from the service.The below <code>ShowToast()</code>method can give me the message.Now what i want is to just append this message to my listview in the <code>chatFragment</code>.</p>

<pre><code>public class GcmIntentService extends IntentService {

    public GcmIntentService() {
        super(""GcmIntentService"");
    }

    @Override
    protected void onHandleIntent(Intent intent) {
        Bundle extras = intent.getExtras();
        GoogleCloudMessaging gcm = GoogleCloudMessaging.getInstance(this);
        // The getMessageType() intent parameter must be the intent you received
        // in your BroadcastReceiver.
        String messageType = gcm.getMessageType(intent);

        if (extras != null &amp;&amp; !extras.isEmpty()) {  // has effect of unparcelling Bundle
            // Since we're not using two way messaging, this is all we really to check for
            if (GoogleCloudMessaging.MESSAGE_TYPE_MESSAGE.equals(messageType)) {
                Logger.getLogger(""GCM_RECEIVED"").log(Level.INFO, extras.toString());

                showToast(extras.getString(""message""));
            }
        }
        GcmBroadcastReceiver.completeWakefulIntent(intent);
    }

    protected void showToast(final String message) {
        new Handler(Looper.getMainLooper()).post(new Runnable() {
            @Override
            public void run() {
                Toast.makeText(getApplicationContext(), message, Toast.LENGTH_LONG).show();

            }
        });
    }
}
</code></pre>

<p><strong>ChatFragment:</strong></p>

<pre><code>public class ChatFragment extends Fragment {

    private EditText et_chat;
    Bundle mailData;
    String caller_mail;
    private ListView chatListview;
    private ChatWindowAdapter chatWindowAdapter;
    private List&lt;ChatSession&gt;PreviousChatSession;
    private List&lt;ChatInfo&gt; chatListItems;
    Button chat_send;
    public ChatFragment() {

    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        View v = inflater.inflate(R.layout.chat_window, null, false);
        et_chat = (EditText) v.findViewById(R.id.et_chat);
        chat_send = (Button) v.findViewById(R.id.bt_chat_send);
        chatListview = (ListView)v.findViewById(R.id.chat_listView);
        chatListItems = new ArrayList&lt;ChatInfo&gt;();
        chatWindowAdapter = new ChatWindowAdapter(getActivity(),chatListItems);
        chatListview.setAdapter(chatWindowAdapter);
        mailData=getArguments();
        caller_mail = mailData.getString(PropertyNames.Userinfo_Mail.getProperty());

        retrieveChats();

        chat_send.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                ChatInfo chatInfo= new ChatInfo();
                chatInfo.setChat_text(et_chat.getText().toString());
                chatInfo.setDirection(""right"");
                chatListItems.add(chatInfo);
                chatWindowAdapter.notifyDataSetChanged();

                fetchID(caller_mail);
            }
        });

        return v;
    }


    public void fetchID(String mail) {
        Data d = new Data();
        d.setUsermail(mail);
        d.setCommand(Commands.GCM_getRegID.getCommand());

        new GCMRegIDCheckerEndpointCommunicator() {
            @Override
            protected void onPostExecute(GCMEndpointReturnData result) {

                super.onPostExecute(result);

                insertMsg(result.getRegID());
            }
        }.execute(d);
    }

    public void insertMsg(String DestinationID){

        Data d = new Data();
        d.setCommand(Commands.ChatSession_insert.getCommand());
        d.setExtra(DestinationID);

        String sessionName = null;
        if(caller_mail.compareTo(getMymail()) &lt; 0){
            sessionName = caller_mail + getMymail();
        }
        else //greater
        {
            sessionName = getMymail() + caller_mail;
        }

        d.setStringKey(sessionName);
        d.setExtramsg(et_chat.getText().toString());
        d.setUsername(getMyName());

        new ChatSessionEndpointCommunicator().execute(d);
    }



    public String getMymail() {
        Bundle mailBundle = ((SlidingDrawerActivity) getActivity()).getEmail();
        String mail = mailBundle.getString(PropertyNames.Userinfo_Mail.getProperty());
        return mail;
    }

    public String getMyName() {
        Bundle nameBundle = ((SlidingDrawerActivity) getActivity()).getEmail();
        String name = nameBundle.getString(PropertyNames.Userinfo_Username.getProperty());
        return name;
    }

    private void retrieveChats() {
        String sessionName = null;
        if(caller_mail.compareTo(getMymail()) &lt; 0){
            sessionName = caller_mail + getMymail();
        }
        else //greater
        {
            sessionName = getMymail() + caller_mail;
        }

        Data d = new Data();
        d.setUsername(getMyName());
        d.setCommand(Commands.ChatSession_fetch.getCommand());
        d.setStringKey(sessionName);

        new ChatSessionEndpointCommunicator(){
            @Override
            protected void onPostExecute(List&lt;ChatSession&gt; result) {

                super.onPostExecute(result);
                PreviousChatSession = result;
                populateChats(PreviousChatSession);
                }
        }.execute(d);
    }

    private void populateChats(List&lt;ChatSession&gt; previousChatSession) {
        for(int i=0;i&lt;previousChatSession.size();i++){
            ChatSession c = previousChatSession.get(i);
            ChatInfo chatInfo = new ChatInfo();
            chatInfo.setChat_text(c.getMsg());
            try {
                chatInfo.setChat_time(convertDate(c.getDate()));
            } catch (ParseException e) {

            }
            if (c.getNameofPerson().equals(getMyName())){
                chatInfo.setDirection(""right"");
            }else{
                chatInfo.setDirection(""left"");
            }
            chatListItems.add(chatInfo);
        }
        chatWindowAdapter.notifyDataSetChanged();
    }
</code></pre>

<p><strong>2.</strong> If the message came from my other friend whom i am not chatting now then i will create a notification.At this time no need to update the <code>listview</code> of the <code>chatFragment</code>.I can handle this as i am saving every message in my database.</p>

<p>As i am saving it in my <code>database</code> i can retrive the data from database after some time interval but it will drain my battery and also not good approach.I just want to update the <code>chatwindow</code> when message comes from my friend and at that time <code>chatWindow</code> was open..<br><br>
<strong>Now how can i reference the Fragment listview to update the listview when message comes??</strong></p>",android|android-fragments|android-listview|service|google-cloud-messaging,4299527,Setu Kumar Basak,yes
Python NameError: name '' is not defined,"<p>I am fairly new to python, i have created this code for a controlled assessment but it is suggesting that 'q11' (the first of the web opening commands) is not defined. It is the same as the others and was working fine before but now i have begun work on it again but it just won't work. </p>

<p>Thank you in advance </p>

<p>Here is my code:</p>

<pre><code>import webbrowser
import random
sol1 = (""Check if there is lint in the charging ports. This can be removed            carefully with a toothpick or similar implement"")
sol2 = (""Turn on assistive touch if you have an iphone (settings &gt; general &gt;    accessability &gt; assistive touch until you go to a shop to get them replaced. If  you use android, download 'button savior' from the google play store"")
sol3 = (""Do a hard reset - hold down the power and home buttons until the screen  turns off and keep them held down until the screen turns on again "")
sol4 = (""Restore the phone to factory settings and set it up as new"")
sol5 = (""You need a screen replacement."")
sol6 = (""You may need to replace the battery."")
sol7 = (""You dont need to do anything. Your phone doesnt have any problems."")
sol8 = (""Please update your phone software."")
sol9 = (""Contact apple for support"")
sol10 = (""Take the phone and put it in a bag of rice for  24-36 hours to let the rice absorb the water."")


q1=input(""Is your phone charging correctly? "")
 if q1 == ""no"":
    print(sol1)
if q1 == ""yes"":

q2=input(""Is your phone water damaged? "")
  if q2 == ""yes"":
      print(sol10)
if q2 == ""no"":

q3=input(""Is the screen cracked or badly scratched? "")
 if q3 == ""yes"":
     print(sol5)
if q3 == ""no"":

q4=input(""Is the phone working slowly and crashing? "")
 if q4 == ""yes"":
     print(sol3)
if q4 == ""no"":

q5=input(""Do you wish to remove data from the phone? "")
 if q5 == ""yes"":
     print(sol4)
if q5 == ""no"":

q6=input(""Does the phone work without issues? "")
 if q6 == ""yes"":
     print(sol7)
if q6 == ""no"":

q7=input(""Are you running the lastest software version? "")
  if q7 == ""no"":
     print(sol8)
if q7 == ""yes"":

q8=input(""Are the buttons producing accurate responses "")
 if q8 == ""no"":
     print(sol2)
if q8 == ""yes"":

q9=input(""Is your phone battery draining and dying early? "")
 if q9 == ""yes"":
    print(sol6)
if q9 == ""no"":

q10=input(""Does the phone turn on, even if it has been charged with a working charger? "")
 if q10 == ""yes"":
     print(sol9)
if q10 == ""no"":

q11=input(""Would you like to visit the apple support site?: yes/no "")
 if q11 == ""yes"":
      webbrowser.open(""https://support.apple.com/en-gb"")
if q11 == ""no"":

q12=input(""Would you like to visit the genius bar booking site?: yes/no "")
 if q12 == ""yes"":
      webbrowser.open(""https://getsupport.apple.com/"")
 if q12 == ""no"":
</code></pre>

<p>print(""Thank you for using this service. We hope you found it useful"")</p>",python|undefined|defined,6903913,dbs,no
Can I analyze sensor data with Android Wear in background?,<p>for a experimental application I need to analyze accelerometer data of a smartwatch nearly all the time (I know that this will drain battery). On standard Android  would create a <code>Service</code> and a <code>WakeLock</code> to collect and process the data. Is this also possible with Android Wear?</p>,android|service|background-process|wear-os|android-sensors,3726405,hendra,yes
advantage WebSockets over TCP/IP,"<p>We have an application that connects to a server and sends it position every 15 seconds. Now our client has asked to ""upgrade"" our current TCP/IP connection into WebSocket. The reason for this is he heard it used less bandwidth and he wants to diminish the 15 seconds to 1 second. (not a public application so battery drain is not really a problem) </p>

<p>I have already done some research and many WebSockets vs HTTP comparisons but only 2 or 3 comparisons of WebSocket vs TCP/IP. </p>

<p>I've already found out that :</p>

<ol>
<li>WebSockets are basically the same as TCP/IP but TCP/IP works on a lower layer than WebSockets.</li>
<li>WebSockets might use less bandwidth because its protocol might be more efficient than our current protocol. </li>
<li>WebSockets use more resources on the server side. </li>
</ol>

<p>My question is: is it worth it to change our existing code and make use of WebSockets instead of the good ol' TCP/IP sockets? </p>",sockets|tcp|websocket,1866914,M3-n50,no
Does Apple's M7 Processor support low-power GPS tracking?,"<p>Apple's new M7 co-processor is said to enable a new generation of health and fitness apps by providing continuous monitoring of movement without draining the battery.</p>

<p>At the iPhone 5S announcement, Apple listed support for these sensors:</p>

<blockquote>
  <ul>
  <li>Accelerometer</li>
  <li>Gyroscope</li>
  <li>Compass</li>
  </ul>
</blockquote>

<p>It doesn't mention GPS hardware, but because it would make sense for me, I'd like to know if the M7 processor can also be used for low-power geo-location tracking?</p>",ios|iphone|core-location|core-motion|apple-m7,1265240,Mobiletainment,yes
Android: Firebase realtime database updated when app destroyed,"<p>I'm new to firebase realtime database, and have a basic question I cannot seem to find the answer to.</p>

<p>I need my Android app to keep track of changes in the database, so I understand I need to use addValueEventListener, with the onDataChange method. However will the method onDataChange, be called even if the app is destroyed? I need to be able to access the changes of the information in the database even if the app isn't running in the background, (for example the user force quits the app). This is because when the values reach a certain point, I want to show a pop up notification, so I need to able to read the values even when the app isn't running.</p>

<p><strong>If</strong> the onDataChange is called even when the app is in the background, will this drain battery use since the phone is always listening for changes.</p>

<p>Sorry for the basic question, but I couldn't find the info.</p>

<p>Thanks!</p>",android|firebase|firebase-realtime-database,5993652,RJB,yes
Firebase download huge dataset android,"<p>I'm trying download dataset from firebase after login. About 23 000 records for some counting and offline capabilities.
It takes a lot of time, processor time and memory. </p>

<p>When I tried pagination for taking 500 records at the time it take a lot of cpu time, almost 45% for 10 minutes. It's such a battery drainer.</p>

<p>I have to use firebase for realtime capabilities.</p>

<p>Does anyone experience with this case or any idea how to do this initial download more effectively?</p>

<p>It took a screenshot for better understanding</p>

<p><a href=""https://i.stack.imgur.com/RzLFf.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/RzLFf.png"" alt=""enter image description here""></a></p>

<p>Blue is memory, red CPU and orange is network.</p>

<p>Thank you for any help.</p>

<p><strong>EDIT:</strong></p>

<p>Pagination is solving only memory issue (when I downloading data, app is not taking abou 120 MB ram on my phone). Problem is that I can download 500 record almost immediately and when I downloading one page in 23k records it takes almost 10 seconds...</p>

<p>Data looks like: </p>

<p><a href=""https://i.stack.imgur.com/agqFq.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/agqFq.png"" alt=""enter image description here""></a></p>

<p><strong>EDIT2:</strong>
I maybe figured out the fastest way. I'm using firebase REST API for download this amount of data and it's faster and better (for my purpose) than getting data from SDK.</p>

<p>For caching in firebase storage on phone I use this code</p>

<pre><code>FirebaseDatabase db = FirebaseDatabase.getInstance();
DatabaseReference ref = getReference(db);
db.goOffline();
ref.updateChildren(mapFromResponse);
db.goOnline();
</code></pre>",android|firebase,4351731,Michal Kučera,no
What is a healthy interval for triggering AlarmManager for running a background service?,"<p>My app is running a background service using <code>AlarmManager</code>. The service downloads a JSON from server and checks if some value is matching. Right now it is triggered every 10 minutes but I am thinking of increasing the interval to 5 minutes to have more accuracy.</p>

<p>Ideally the service should run every few minutes but I don't want to drain the user's battery too much. What is a reasonable and healthy (battery-wise) schedule interval?</p>",android|android-service|alarmmanager|android-alarms,1181261,c0dehunter,yes
Android issues in wakelock?,"<p>Hai i developed a application using broadcast receiver.I need to wake my Application always.so i used wakelock.here my code</p>

<pre><code>PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
PowerManager.WakeLock wl = pm.newWakeLock(PowerManager.SCREEN_DIM_WAKE_LOCK, ""My Tag"");
wl.acquire();
</code></pre>

<p><strong>problem</strong></p>

<p>1.If i wake up always my battery is getting drained.</p>

<p>2.if i cal <code>w1.acquier()</code> ,Is necessary to release the w1<code>(ie w1.release)</code></p>",android-wake-lock,993437,Mercy,yes
Keep Activity running in background,"<p>I have a counter app. It counts things over a long period of time(2-3hrs). During the majority of the time, for 10-15, maybe 30 minute increments), the app remains in power down state in my pocket. After this long duration Android decides i am not using it and shuts it down. So i lose all my counts.</p>

<p>What is best way to keep activity open in background? I was noticing the use of either wakelock, which I don't want to do because of unnecessary battery drain, and services, which would be good, i have no problem operating a service in the background. </p>

<p>Can services update particular interface objects of the activity, basically can it update the count on my counter screen?</p>

<p>and will the service prevent android from shutting down my app? I assume i can battle this by doing something like this...</p>

<pre><code>@Override
public void onCreate(){
    ....
    if(myService.isRunning())
        Intent i = new Intent(this, MyCounterActivity.class);
        startActivity(intent);
}
</code></pre>

<p>That should start my activity back if android shuts it down while running the service. But then how can i get info from the service back to the counter visuals?</p>

<p><em>Edit</em>
I decided to go with the sharedPreferences recommendation. so to do this i would need something like the following?</p>

<p>SharedPreference Singleton</p>

<pre><code>public class MySharedPreference {   
    private static MySharedPreference mySharedPreference;
    private SharedPreferences sharedPreferences;

    public static MySharedPreference getInstance(Context context) {
        if (mySharedPreference == null) {
            mySharedPreference = new mySharedPreference(context);
        }
        return mySharedPreference;
    }

    private mySharedPreference(Context context) {
        sharedPreferences = context.getSharedPreferences(MyConstants.PREF_FILE_KEY, Context.MODE_PRIVATE);
    }

    public void saveData(String key,String value) {
        SharedPreferences.Editor prefsEditor = sharedPreferences.edit();
        prefsEditor .putString(key, value);
        //prefsEditor.commit(); 
        prefsEditor.apply();
    }

    public String getData(String key) {
        if (sharedPreferences!= null) {
           return sharedPreferences.getString(key, """");
        }
        return """";         
    }
}
</code></pre>

<p>Activity.class</p>

<pre><code>@Override
public void onCreate(){


    SharedPreferences.OnSharedPreferenceChangeListener listener;
    listener = new SharedPreferences.OnSharedPreferenceChangeListener() {
    public void onSharedPreferenceChanged(SharedPreferences prefs, String key) {
        if(key.compareTo(MyConstants.PREF_FIELD_M20_COUNT)){
            m20CountTextView.setText(String.format(""$1%d"", prefs.getInt(key, 0)));
        }else if(key.compareTo(MyConstants.PREF_FIELD_M30_COUNT)){
            m30CountTextView.setText(String.format(""$1%d"", prefs.getInt(key, 0)))
        }
      }
    };

    MySharedPreference.getInstance().registerOnSharedPreferenceChangeListener(listener);

    button1 = (Button) findViewById(R.id.button1);
    button1.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View arg0) {
            m20Count++;
            MySharedPreferences.getInstance().saveData(MyConstants.PREF_FIELD_M20_COUNT, m20Count);
        }

    });

    button2 = (Button) findViewById(R.id.button2);
    button2.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View arg0) {
            m30Count++;
            MySharedPreferences.getInstance().saveData(MyConstants.PREF_FIELD_M30_COUNT, m30Count);
        }
    });
}

@Override
public void onResume(){
    updateInterfaceWithPreferences();
}

private void updateInterfaceWithPreferences(){
    m20CountTextView.setText(String.format(""$1%d"", MySharedPreferences.getInstance().getInt(MyConstants.PREF_FIELD_M20_COUNT, 0)));
    m30CountTextView.setText(String.format(""$1%d"", MySharedPreferences.getInstance().getInt(MyConstants.PREF_FIELD_M30_COUNT, 0)));
}
</code></pre>

<p>Will this work to save my data and restore it when re-entering the activity that gets shutoff.</p>",android|android-service,1491966,John Bravado,no
BroadcastReceiver dies with app,"<p>If i let the phone sit for a long time like 15 minutes i lose my receiver but i thought it was to persist like a service after being killed for memory.</p>

<p>Manifest:</p>

<pre><code>&lt;receiver
    android:name="".WearableReceiver""
    android:enabled=""false""&gt;
    &lt;intent-filter&gt;
        &lt;action android:name=""com.example.johnbravado.MESSAGE_PROCESSED""/&gt;
    &lt;/intent-filter&gt;
&lt;/receiver&gt;
</code></pre>

<p>In Activity to start receiver</p>

<pre><code>ComponentName component = new ComponentName(CounterActivity.this, WearableReceiver.class);
getPackageManager()
    .setComponentEnabledSetting(component,
        PackageManager.COMPONENT_ENABLED_STATE_ENABLED,
        PackageManager.DONT_KILL_APP);
</code></pre>

<p>The receiver</p>

<pre><code>@Override
public void onReceive(Context context, Intent intent) {
    // TODO: This method is called when the BroadcastReceiver is receiving
    // an Intent broadcast.
    //MyConstants.getInstance().showToast(""Message Rcvd"");
    PowerManager powerManager = (PowerManager) context.getSystemService(POWER_SERVICE);
    PowerManager.WakeLock wakeLock = powerManager.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,
            ""com.example.johnbravado"");
    wakeLock.acquire();
    // Do Work
    MyConstants.getInstance().msgReqAction(intent.getIntExtra(MyConstants.BROADCAST_DATA_REQ, 0));

    wakeLock.release();
}
</code></pre>

<p>The broadcast sender</p>

<pre><code>String BROADCAST_ACTION_RESP = ""com.example.johnbravado.MESSAGE_PROCESSED""
@Override
public void onMessageReceived(final MessageEvent messageEvent) {
    nodeId = messageEvent.getSourceNodeId();
    String incomingPath = messageEvent.getPath();
    int incomingReq = Integer.parseInt(new String(messageEvent.getData()));

    if(incomingPath.equalsIgnoreCase(MyConstants.MSG_COUNTER_REQ_PATH)) {
        Intent broadcastIntent = new Intent();
        broadcastIntent.setAction(BROADCAST_ACTION_RESP);
        broadcastIntent.putExtra(MyConstants.BROADCAST_DATA_REQ, incomingReq);
        sendBroadcast(broadcastIntent);

    }else if(incomingPath.equalsIgnoreCase(MyConstants.MSG_DEFAULT_PATH)){

    }
}
</code></pre>

<p>only way I get this to persist for long periods of time is to invoke a service</p>

<pre><code>wearableReceiverIntent = new Intent(this, WearableReceiverService.class);
if(!WearableReceiverService.isRunning())
    startService(wearableReceiverIntent);
</code></pre>

<p>the service</p>

<pre><code>@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    // Let it continue running until it is stopped.
    IntentFilter filter = new IntentFilter(MyConstants.BROADCAST_ACTION_RESP);
    filter.addCategory(Intent.CATEGORY_DEFAULT);
    receiver = new WearableReceiver();
    registerReceiver(receiver, filter);

Notification notification = new NotificationCompat.Builder(this)
        .setSmallIcon(R.drawable.ic_notif_bible)
        .setContentText(""Preaching"").build();
startForeground(MyConstants.NOTIF_COUNTING_SERVICE, notification);

    isRunning = true;
    return START_STICKY;
}
</code></pre>

<p>If I run the service it persists for long periods of time but it drains the battery unnecessarily considering I interact only once every 10 minutes. I was under impression Broadcast receiver would work like service except for short bursts of work. invoke the service if you need to do long actions.</p>",android|android-service|android-broadcastreceiver,1491966,John Bravado,yes
Watch for changes in external USB storage for Honeycomb or later Android versions,"<p>I've got a DSLR camera and Samsung Galaxy Tab running Android Honeycomb. DSLR connected to a tablet using USB-cable (via USB kit enabling host functionality on a tablet). I'd like to being notified when user takes a photo using this external camera, in order to download this image to the tablet or do something else with it like showing Toast notification containing meta-information taken from the image.</p>

<p>As far as I get all of the existing tools (like <code>FileObserver</code> using underlying <code>inotify</code> mechanism, <code>MediaContentProvider</code> etc)  allowing to watch for changes, demand a specific file or a filesystem path to be watched. This was good enough till we had a block layer protocol support in 2.x and earlier Android versions - when you connected device it'd been mounted somewhere on the device's filesystem and you was able to use this mountpoint as a watch point for those tools. </p>

<p>Since Honeycomb Google has changed the way of accessing external USB devices to <code>Media Transfer Protocol</code> with <code>PTP</code> as a subset of this. Now when I connect external USB device to an Android device I won't see any mountpoints for it (I'm using <code>adb shell</code> and subsequent <code>mount</code> command for getting them). Moreover, <code>MTP</code> implementation uses storage ids which apparently act as a higher level of abstraction and are just plain integer values. I was hoping there is a way to somehow translate these storage ids to the real paths/mountpoint/whatever but apparently there does not appear to be. </p>

<p>Thinking about Android <code>MediaScanner</code> which is already running on my device I guessed it could manage this issue with a special <code>Intent</code> broadcasted when there're changes in media files accessible from the device, so I started looking for already existing and suitable <code>Intents</code> for being notified, but no luck - I found only <code>ACTION_MEDIA_MOUNTED</code> and <code>ACTION_MEDIA_REMOVED</code> which are broadcasted only when device is connected and disconnected respectively. That means <code>MediaScanner</code> can't notice any changes on the device until you remount it (I've double checked it using stock Gallery app - it doesn't see any newly created images on the camera until you unplug and then plug it into the Android device again). </p>

<p>Trying to get this mount path for external sdcard, I used <code>Environment.getExternalStorageDirectory()</code> API call but it yields emulated Galaxy's sdcard path
which is <code>/mnt/sdcard</code>, not the camera's one. So it doesn't work for me either. </p>

<p>I managed to work out this issue only having launched periodic <code>Timer</code> event with <code>AsyncTask</code> acting as a <code>TimerTask</code>. This task does initialize usb connection, open device,
 scan the whole device memory, getting only the last taken photo and then close device descriptor and usb connection. </p>

<p>It doesn't look like the best and efficient way  of doing that taking into account it has to do all of these actions every time which could be pretty often, say each 5 or 10 seconds. It definitely quickly drains battery out and produces unnecessary system I/O for only taking last taken photo and comparing it with the previous last taken photo (in 99% it'd the same image), but I haven't found any better working solution for doing this. It'd much better off to have an observer mechanism with event-based notifications.</p>

<p>So my question is there more efficient way of being notified about changes in external USB storage for Honeycomb or later Android versions rather than one described above? </p>",android|android-intent|usb|usb-drive|mtp,1360465,Sunseeker,no
JSch/Java - proper way to detect disconnected server,"<p>I'm using the Jsch library to execute some commands on a server, using SSH. My app should stay connected to the server, until the user manually disconnects it. So, I need some way to detect disconnects due to network problems (for example), to allow my app to automatically reconnect.</p>

<p>There is the <a href=""http://epaul.github.io/jsch-documentation/javadoc/com/jcraft/jsch/Session.html#isConnected%28%29"" rel=""nofollow""><code>#isConnected()</code></a> method. Can I use it to perform my check? I mean, if this method can detect disconnects caused by network problems, or it only changes state, after I call the method <a href=""http://epaul.github.io/jsch-documentation/javadoc/com/jcraft/jsch/Session.html#disconnect%28%29"" rel=""nofollow""><code>#disconnect()</code></a>?</p>

<p>[edit]
It seems that the status of a connection in JSch is only updated if some action occurs over this connection. So I can't handle network errors this way. I can create new thread to monitor my host and port using Socket (for example), but I don't like this workaround. It would cause huge battery draining when applied in a backround. It's not acceptable.</p>

<p>I also need to notify user that server closed the connection and let him to retry.</p>",java|session|jsch|disconnect,1209216,user1209216,yes
"Getting current Location now, not on update","<p>I'm building an app that requires your current location to initialize and show a map. I am requesting location updates with <code>LocationManager.requestLocationUpdates(...)</code>, but this only appears to give me data when the location changes (for example I move 10 feet). I am also attempting to use getLastKnownLocation, but in some uncommon cases (like turning the GPS on and without moving opening the app) this will return null for all providers I am making use of.</p>

<p>Whenever getLastKnownLocation returns null, my app can't initialize until I move 10 feet and receive a location update. So far I haven't found a method to poll for my location right now, nor have I found anything suggesting that when I <code>requestLocationUpdates(...)</code> I can get my first data the moment I subscribe and not when I either wait the specified time period or move the specified distance.</p>

<p>One approach would be to <code>requestLocationUpdates(...)</code> on a very small or 0 time interval, get that to send me my current location, delete the LocationListener and again <code>requestLocationUpdates(...)</code> but this time with the much larger value I use to avoid drainig the battery.</p>

<p>I'm looking for a better way to solve this. Probably something like getCurrentLocation(), but really anything that works.</p>",android|gps|android-gps,3482428,Blueriver,yes
Recognize volume button presses when screen is off Android,"<p>I am trying to recognize when the user presses the volume rockers when the screen is off to update an activity. From what I've read, BroadcastReceivers (I think) don't work when the phone is asleep, and so the only way to do this is to keep the activity running using a PARTIAL_WAKE_LOCK. My app is a basic one that shouldn't use too much battery, but I'm concerned that using a PARTIAL_WAKE_LOCK might drain the battery (which defies the purpose of recognizing button presses when the screen is off). </p>

<p>Would the PARTIAL_WAKE_LOCK actually be an issue for a basic app? If so, what is the best way to go about doing this, and if not, what is the best way to use the PARTIAL_WAKE_LOCK (i.e. when should I acquire/release it)?</p>

<p>Thanks in advance.</p>",android|power-management|wakelock|screen-off,3194777,husam,yes
Trigger background location updates every X minutes in iOS 10,"<p>I know there have been multiple threads on this subject, but all the answers I find seem to be outdated, working on iOS 7 or 8, and so on.</p>

<p>The question is: how can I trigger background location updates every X minutes (for instance: 5 minutes)? The goal here obviously is to use the less possible battery. </p>

<p>This solution:</p>

<ul>
<li>Specify location background mode</li>
<li>Create an NSTimer in the background with UIApplication:beginBackgroundTaskWithExpirationHandler:</li>
<li>When n is smaller than UIApplication:backgroundTimeRemaining it will work just fine. When n is larger, the location manager should be enabled (and disabled) again before there is no time remaining to avoid the background task being killed.</li>
</ul>

<p>Seems to have issues on iOS 10 regarding battery usage.</p>

<p>Is there still no native solution by Apple that simply allows to get background location without having the need of constant background updates that drain battery usage immensely?</p>",ios|location|ios10,3209448,el-flor,no
How to find the GPS and Network provider status without consuming GPS?,"<p>How to listen for GPS and Network Provider status without consuming the GPS. 
I want to know the status alone. I dont want to get the location information. </p>

<p>I have used the below code,</p>

<pre><code>mLocationManager.requestLocationUpdates(
                    LocationManager.GPS_PROVIDER, 0, 0, this);
mLocationManager.requestLocationUpdates(
                    LocationManager.NETWORK_PROVIDER, 0, 0, this);
mLocationManager.requestLocationUpdates(
                    LocationManager.PASSIVE_PROVIDER, 0, 0, this);
</code></pre>

<p>When using the above code, the GPS icon is always splashing in the notification bar. It means that it is always consuming the GPS. I don't want the GPS to be consumed just to check the GPS status. Because this is draining the battery power. 
Checking the GPS ON or OFF is different from consuming the GPS. </p>

<p>And also I have explored and found the way to check the GPS status alone 
<a href=""http://developer.android.com/reference/android/location/GpsStatus.Listener.html"" rel=""nofollow"">""GpsStatus.Listener"".</a></p>

<p>But I want to know both the GPS and Network provider status. I don't want the location information. </p>

<p>Please help me on this. </p>",android|networking|gps|location|locationlistener,1138083,M Vignesh,no
keep service alive in android,"<p>I have created an Android service which basically does the following:</p>

<pre><code>schedule a task, using the ScheduledThreadPoolExecutor.schedule() method
when the schedule time is reached, the task is executed and a new schedule is started
</code></pre>

<p>Thus, the service continuously has a timer in place (except during execution of the task); sometimes 2 (independent) timers are in place, depending on the result of the task. The service should be running all the time and executes different tasks from time to time. </p>

<p>All seems to work ok (at least when running with DDMS), but after a while (something like an hour without connecting the device via DDMS) the timer tasks are not executed anymore. The only way to get it working again is either stopping and starting the service again or by connecting the device with DDMS (using Eclipse); waking up the device only does not trigger this. </p>

<p>It looks like, Android sets the service in a kind of sleep mode (service is still running when looking at the Active Services on the device).</p>

<p>My question is: how do I prevent this behavior and keep the service working all the time?</p>

<p>I did some research and I found something which theoretically could give a solution, by acquiring a (PARTIAL_WAKE_LOCK) WakeLock in the service, but as far as I understand, using this solution, I have to acquire the lock at the onStartService() method and release it at onDestroy(), meaning that I keep the lock during the lifetime of the service (which is forever); I suspect a battery drainage using this method.</p>

<p>Is there another way to accomplish the same?</p>",java|android|service|keep-alive,867092,Harald Tempelman,yes
How to remove duplicates based on property after an aggregate query?,"<p>I'm trying to figure out how to remove duplicates based on the url, as the aggregate query can match the same document twice if say &quot;APPL&quot; and &quot;TSLA&quot; are in <code>stocks</code> and included in the same document.</p>
<pre><code>    const res = await ReadSchema.find({ 'tickers.symbol': { $in: stocks } })
      .select(['-content', '-htm'])
      .sort({ createdAt: -1 })
      .limit(100)
      .filter((v, i, a) =&gt; a.findIndex((t) =&gt; t.url === v.url) === i);

</code></pre>
<p>I'm doing this in <code>js</code> after the results, but I'd rather do it before the <code>.limit(100)</code> so that I remove duplicate urls <em>before</em> I grab the first 100.</p>
<p>Here is an example document:</p>
<pre><code>{
    &quot;_id&quot; : ObjectId(&quot;6001eb414110e6001cb5b226&quot;),
    &quot;summary&quot; : {
        &quot;topics&quot; : [ 
            &quot;buds&quot;, 
            &quot;pro&quot;, 
            &quot;galaxy&quot;, 
            &quot;anc&quot;, 
            &quot;live&quot;, 
            &quot;sound&quot;, 
            &quot;samsung&quot;, 
            &quot;noise&quot;, 
            &quot;ear&quot;, 
            &quot;app&quot;
        ],
        &quot;sentiment&quot; : 0,
        &quot;words&quot; : 0,
        &quot;difficulty&quot; : 0,
        &quot;minutes&quot; : 0
    },
    &quot;views&quot; : 1,
    &quot;title&quot; : &quot;Samsung takes on Apple's AirPods Pro with new Galaxy Buds Pro&quot;,
    &quot;byline&quot; : &quot;Alex Perry&quot;,
    &quot;dir&quot; : null,
    &quot;content&quot; : &quot;&lt;div id=\&quot;readability-page-1\&quot; class=\&quot;page\&quot;&gt;&lt;section&gt;\n\n&lt;p&gt;Sometimes making things less fun is for the best. Case in point: The Samsung Galaxy Buds Pro.&amp;nbsp;&lt;/p&gt;\n&lt;p&gt;Just a handful of months after Samsung graced us with the delightfully bean-shaped (and genuinely good) &lt;a href=\&quot;https://mashable.com/review/samsung-galaxy-buds-live-review/\&quot;&gt;Galaxy Buds Live&lt;/a&gt;, we've already got a more, uh, \&quot;professional\&quot; follow-up. At $199.99, the Galaxy Buds Pro are only marginally more expensive than the Buds Live, but offer a totally different look and a few extra features, largely revolving around active noise cancellation.&lt;/p&gt;\n&lt;p&gt;The end result is something that should please Samsung fans (and Android users in general). But is there any reason to spend that extra $30 instead of getting the &lt;em&gt;already totally fine&lt;/em&gt; Galaxy Buds Live?&amp;nbsp;&lt;/p&gt;\n&lt;div&gt;\n\n&lt;div&gt;\n&lt;div&gt;\n&lt;div&gt;\n&lt;p&gt;\nMuch more comfortable than Buds Live • Improved ANC • Sound quality is still great • Strong app-based customization\n&lt;/p&gt;&lt;/div&gt;\n&lt;div&gt;\n&lt;p&gt;\nVoice detection feature is a dud • ANC struggles with outdoor bustle\n&lt;/p&gt;&lt;/div&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;/div&gt;\n&lt;/div&gt;\n\n&lt;h2&gt;The Good: Improved ANC and comfort, SmartThings Find, sound quality&lt;/h2&gt;\n&lt;p&gt;The most noticeable difference between the Buds Live and the Buds Pro from the jump is their appearance. As we've discussed, the Buds Live were shaped like something you'd find in a burrito and, on a practical level, let a decent amount of outside noise in due to the lack of a seal of any kind. Their ANC features did a little bit to offset this, but it wasn't good enough. It was pretty sweet that they attracted next to no earwax because they didn't actually go inside the ear, though.&lt;/p&gt;\n&lt;p&gt;The Buds Pro aren't nearly as eye-catching but they make up for it in the ways that actually matter. Like &lt;a href=\&quot;https://mashable.com/review/airpods-pro-review/\&quot;&gt;Apple's AirPods Pro&lt;/a&gt; equivalent, the Buds Pro have rubber ear cups that you insert into the ear canal with a rounded touch panel that sits outside featuring basic playback controls. Tap once to pause, tap twice to skip ahead, and so on. Samsung is shipping the Buds Pro with three different ear cup sizes to accommodate different ear shapes, as well.&lt;/p&gt;\n&lt;div&gt;\n&lt;div&gt;\n\n&lt;figure&gt;&lt;div&gt;\n  &lt;p&gt;&lt;img alt=\&quot;Galaxy Buds Live\&quot; data-fragment=\&quot;m!0fdc\&quot; data-image=\&quot;https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591715%252F873bf2ac-34d3-4a4a-b2cd-f3befe3f05fe.png%252Ffull-fit-in__1200x2000.png?signature=NZalyPHmMKjSvE_-Md19lx1Ovfk=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com\&quot; data-micro=\&quot;1\&quot; loading=\&quot;lazy\&quot; naturalwidth=\&quot;950\&quot; sizes=\&quot;(max-width: 300px) 280w,(max-width: 400px) 356w,(max-width: 700px) 638w,950w\&quot; src=\&quot;https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591715%252F873bf2ac-34d3-4a4a-b2cd-f3befe3f05fe.png%252Ffull-fit-in__950x534.png?signature=0P5F2WHmrx7IopVdxva_M-CrBCs=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com\&quot; src_type=\&quot;png\&quot; srcset=\&quot;https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591715%252F873bf2ac-34d3-4a4a-b2cd-f3befe3f05fe.png%252Ffull-fit-in__280x157.png?signature=KLY0Uk8B1s5bL03gF9ehpT1HFM4=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com 280w,https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591715%252F873bf2ac-34d3-4a4a-b2cd-f3befe3f05fe.png%252Ffull-fit-in__356x205.png?signature=Z-q_8wMfWcP-cbOWGMcJOcIcps0=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com 356w,https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591715%252F873bf2ac-34d3-4a4a-b2cd-f3befe3f05fe.png%252Ffull-fit-in__638x368.png?signature=dUn8anfa1mPCeLNJAwiejq4X83E=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com 638w,https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591715%252F873bf2ac-34d3-4a4a-b2cd-f3befe3f05fe.png%252Ffull-fit-in__950x534.png?signature=0P5F2WHmrx7IopVdxva_M-CrBCs=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com 950w\&quot;&gt;\n&lt;/p&gt;&lt;/div&gt;\n\n\n&lt;figcaption&gt;&lt;p&gt;Galaxy Buds Live\n&lt;/p&gt;&lt;/figcaption&gt;&lt;p&gt;Image:  alex perry / mashable\n&lt;/p&gt;&lt;/figure&gt;\n&lt;/div&gt;\n&lt;div&gt;\n\n&lt;figure&gt;&lt;div&gt;\n  &lt;p&gt;&lt;img alt=\&quot;Galaxy Buds Pro\&quot; data-fragment=\&quot;m!a70e\&quot; data-image=\&quot;https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591722%252Fb72cbc58-58fc-484c-8a54-fae6c2306ebc.jpg%252Ffull-fit-in__1200x2000.jpg?signature=dFshI8fkvoBN6_Rg8ZYPqfRwxb4=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com\&quot; data-micro=\&quot;1\&quot; loading=\&quot;lazy\&quot; naturalwidth=\&quot;950\&quot; sizes=\&quot;(max-width: 300px) 280w,(max-width: 400px) 356w,(max-width: 700px) 638w,950w\&quot; src=\&quot;https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591722%252Fb72cbc58-58fc-484c-8a54-fae6c2306ebc.jpg%252Ffull-fit-in__950x534.jpg?signature=SpjFrkhxftv8Z4eGTzVzosVqvhI=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com\&quot; src_type=\&quot;jpg\&quot; srcset=\&quot;https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591722%252Fb72cbc58-58fc-484c-8a54-fae6c2306ebc.jpg%252Ffull-fit-in__280x157.jpg?signature=HXfNokeRqH-JA92c1-GP_w-fQlI=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com 280w,https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591722%252Fb72cbc58-58fc-484c-8a54-fae6c2306ebc.jpg%252Ffull-fit-in__356x205.jpg?signature=d2iT0s-p_vsJpWa0pK1kHpbm6Qg=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com 356w,https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591722%252Fb72cbc58-58fc-484c-8a54-fae6c2306ebc.jpg%252Ffull-fit-in__638x368.jpg?signature=5eWyZZdHOKWwE4y2-2ogtFJHUg4=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com 638w,https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591722%252Fb72cbc58-58fc-484c-8a54-fae6c2306ebc.jpg%252Ffull-fit-in__950x534.jpg?signature=SpjFrkhxftv8Z4eGTzVzosVqvhI=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com 950w\&quot;&gt;\n&lt;/p&gt;&lt;/div&gt;\n\n\n&lt;figcaption&gt;&lt;p&gt;Galaxy Buds Pro\n&lt;/p&gt;&lt;/figcaption&gt;&lt;p&gt;Image:  alex perry / mashable\n&lt;/p&gt;&lt;/figure&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;From a purely physical standpoint, the Buds Pro are fundamentally a step up from the Buds Live because of how much better they feel in the ear. The \&quot;beans\&quot; fit snugly and were never a threat to fall out, but the insides of my ears didn't appreciate long sessions with them, and signaled that with minor aching. By virtue of keeping hard plastic away from the sensitive skin inside my ears, the Buds Pro were &lt;em&gt;significantly&lt;/em&gt; more comfortable for lengthy periods of time.&amp;nbsp;&lt;/p&gt;\n&lt;p&gt;The ear tips not only make the Buds Pro more comfortable, but they also do a much better job of blocking unwanted outside noise than the Buds Live's open form factor did. While the ANC here still isn't perfect (more on that in a bit), it's a real improvement. When it's enabled and you're not in close proximity to chaos, you'll be able to listen to your music or podcasts in peace.&lt;/p&gt;\n&lt;p&gt;Just like the Buds Live, Samsung's newest earbuds can connect to the &lt;a href=\&quot;https://play.google.com/store/apps/details?id=com.samsung.android.app.watchmanager&amp;amp;hl=en_US&amp;amp;gl=US\&quot; target=\&quot;_blank\&quot;&gt;Galaxy Wearable&lt;/a&gt; Android app for all of your settings and customization needs. That app is Android-only, so iPhone owners should probably buy some AirPods instead. Within the Wearable app you can set ANC to high or low (I didn't notice a huge difference between the two), turn it off entirely, or turn on an ambient sound mode that uses the on-board microphones to amplify sounds around you in situations where you might need to hear what people are saying.&amp;nbsp;&lt;/p&gt;\n&lt;p&gt;Beyond that, you can adjust what the long-press command on the earbuds' outer panels does (taps are set in stone), choose from a handful of different equalizer options like \&quot;bass boost\&quot; and \&quot;treble boost,\&quot; or even shift the audio balance to favor the left or right side if your hearing is better in one ear than the other. This amount of customization was a strong aspect of the Buds Live and it's still strong here, as well. It isn't super different, but it's appreciated nonetheless.&lt;/p&gt;\n&lt;p&gt;Another side of the Buds Pro that picks up where Buds Live left off is sound quality. I was really impressed with how deep and rich the sound was in the \&quot;beans\&quot; despite their unusual shape. That hasn't changed with the shift to a more traditional build. The audio output here isn't dramatically better than what I experienced in the \&quot;beans,\&quot; but the 11mm woofer and 6.5mm tweeter inside do an excellent job of making songs sound like they should.&amp;nbsp;&lt;/p&gt;\n&lt;figure&gt;&lt;div&gt;\n  &lt;p&gt;&lt;img alt=\&quot;The Galaxy Wearable app\&quot; data-fragment=\&quot;m!beae\&quot; data-image=\&quot;https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591421%252Fc7dad555-1148-4700-8268-77002a63f642.jpg%252Foriginal.jpg?signature=mVprQdLxhltKq-tGPj21dYhKOzk=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com\&quot; data-micro=\&quot;1\&quot; loading=\&quot;lazy\&quot; naturalwidth=\&quot;950\&quot; sizes=\&quot;(max-width: 300px) 280w,(max-width: 400px) 356w,(max-width: 700px) 638w,950w\&quot; src=\&quot;https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591421%252Fc7dad555-1148-4700-8268-77002a63f642.jpg%252Ffull-fit-in__950x534.jpg?signature=cZGICWc0BfWlzHT4dBKEa7BDPos=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com\&quot; src_type=\&quot;jpg\&quot; srcset=\&quot;https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591421%252Fc7dad555-1148-4700-8268-77002a63f642.jpg%252Ffull-fit-in__280x157.jpg?signature=I9LxxqU9xNEBTe6ZDZ3x8Pf6MFo=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com 280w,https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591421%252Fc7dad555-1148-4700-8268-77002a63f642.jpg%252Ffull-fit-in__356x205.jpg?signature=Vxxu-64ZaXie39nPyghsfKgryA0=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com 356w,https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591421%252Fc7dad555-1148-4700-8268-77002a63f642.jpg%252Ffull-fit-in__638x368.jpg?signature=6fP9FBkiCqJdSAbT6qOBW6EOT2s=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com 638w,https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591421%252Fc7dad555-1148-4700-8268-77002a63f642.jpg%252Ffull-fit-in__950x534.jpg?signature=cZGICWc0BfWlzHT4dBKEa7BDPos=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com 950w\&quot;&gt;\n&lt;/p&gt;&lt;/div&gt;\n\n\n&lt;figcaption&gt;&lt;p&gt;The Galaxy Wearable app\n&lt;/p&gt;&lt;/figcaption&gt;&lt;p&gt;Image:  alex perry / mashable\n&lt;/p&gt;&lt;/figure&gt;&lt;p&gt;Instruments and vocals at the front of the mix are appropriately prominent, while aspects of a song that fill out the sound without calling much attention to themselves are fully audible if you focus on them. Some wireless earbuds can flatten songs out due to small, chintzy speakers, but the Buds Pro avoid that particular pitfall. I would still say the &lt;a href=\&quot;https://mashable.com/review/bose-quiet-comfort-earbuds-review/\&quot;&gt;Bose QC Earbuds&lt;/a&gt; are &lt;em&gt;slightly&lt;/em&gt; richer in sound, but they're also $80 more expensive.&amp;nbsp;&lt;/p&gt;\n&lt;p&gt;Battery life is also acceptable, if not remarkable. People who like to use ANC will notice battery drain, as the Buds Pro are rated for about five hours of ANC listening time with an additional 13 hours in the charging case, which is in line with my experience. Turn ANC off and you should get closer to eight hours on a single charge, so if you can live without that key feature, you'll have a better time.&lt;/p&gt;\n&lt;p&gt;Oh, and one last thing: Galaxy Buds Pro work with Samsung's recently launched device tracking feature within the &lt;a href=\&quot;https://play.google.com/store/apps/details?id=com.samsung.android.oneconnect&amp;amp;hl=en_US&amp;amp;gl=US\&quot; target=\&quot;_blank\&quot;&gt;SmartThings app&lt;/a&gt;. SmartThings Find will show you a GPS location for your Buds Pro even if they're off. If they get lost or stolen, this is huge. Simply open the SmartThings app while the Buds Pro are paired to the phone to pair them to the app. It's quick, easy, and eminently useful.&lt;/p&gt;\n&lt;h2&gt;The Bad: Sensitive voice detection, ANC is better indoors than outdoors&lt;/h2&gt;\n&lt;figure&gt;&lt;div&gt;\n  &lt;p&gt;&lt;img alt=\&quot;The case is almost identical to the Buds Live case.\&quot; data-fragment=\&quot;m!6d74\&quot; data-image=\&quot;https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591414%252F2bf3f78c-75f9-4720-af0b-0e8494231004.jpg%252Foriginal.jpg?signature=c1GLO0Mcnadapz4KHB3k_jiZgB0=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com\&quot; data-micro=\&quot;1\&quot; loading=\&quot;lazy\&quot; naturalwidth=\&quot;950\&quot; sizes=\&quot;(max-width: 300px) 280w,(max-width: 400px) 356w,(max-width: 700px) 638w,950w\&quot; src=\&quot;https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591414%252F2bf3f78c-75f9-4720-af0b-0e8494231004.jpg%252Ffull-fit-in__950x534.jpg?signature=qMk3EQVFbzAZSCBsJrTc1Hpg5V0=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com\&quot; src_type=\&quot;jpg\&quot; srcset=\&quot;https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591414%252F2bf3f78c-75f9-4720-af0b-0e8494231004.jpg%252Ffull-fit-in__280x157.jpg?signature=sKmiyBUFQdAvwwN_hQDYwFSCOGo=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com 280w,https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591414%252F2bf3f78c-75f9-4720-af0b-0e8494231004.jpg%252Ffull-fit-in__356x205.jpg?signature=MrGzmcAVT-ha4f0pyB_cjLjtaV8=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com 356w,https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591414%252F2bf3f78c-75f9-4720-af0b-0e8494231004.jpg%252Ffull-fit-in__638x368.jpg?signature=K03SKbqjuUqgjS0hTi-xENqm3Js=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com 638w,https://mondrian.mashable.com/uploads%252Fcard%252Fimage%252F1591414%252F2bf3f78c-75f9-4720-af0b-0e8494231004.jpg%252Ffull-fit-in__950x534.jpg?signature=qMk3EQVFbzAZSCBsJrTc1Hpg5V0=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com 950w\&quot;&gt;\n&lt;/p&gt;&lt;/div&gt;\n\n\n&lt;figcaption&gt;&lt;p&gt;The case is almost identical to the Buds Live case.\n&lt;/p&gt;&lt;/figcaption&gt;&lt;p&gt;Image:  alex perry / mashable\n&lt;/p&gt;&lt;/figure&gt;&lt;p&gt;Unfortunately, one of the more distinct ANC-centric features of the Buds Pro was a dud for me. Samsung is touting the \&quot;voice detect\&quot; feature (enabled in the Galaxy Wearable app) as a way to get through your day without constantly turning ANC on or off, but I ended up keeping the feature disabled entirely.&amp;nbsp;&lt;/p&gt;\n&lt;p&gt;The way it works is that the Buds Pro can detect when you start speaking, at which point they will turn whatever you're listening to down and turn on the ambient noise mode so you can theoretically carry a conversation for a moment. Once you stop speaking for 10 seconds, everything goes back to the way it was. My issue is that it reacted a little too sensitively to things like sighing and clearing my throat, which would then ruin a song I was listening to for 10 seconds.&amp;nbsp;&lt;/p&gt;\n&lt;p&gt;I wish there were a way to shorten the time before ambient sound turns off, but for now, 10 seconds is the only option you have. I can see people getting use out of this, but personally, I found it more useful to long press one of the earbuds to manually turn ambient sound mode on or off.&lt;/p&gt;\n&lt;p&gt;The only other minor criticism I have is less of a specific problem with the Buds Pro and more of a general issue with noise-cancelling wireless earbuds. Samsung's ANC here is better than it was in the previous model, but it can still let too much noise in when you're walking down a busy street. In other words, you can drown out the noise of an office or an apartment, but cars whizzing by you will still make noise. Use &lt;a href=\&quot;https://mashable.com/review/bose-noise-cancelling-700-headphones-review/\&quot;&gt;over-ear noise-cancelling headphones&lt;/a&gt; if you want to &lt;em&gt;really&lt;/em&gt; escape from the world.&lt;/p&gt;\n&lt;h2&gt;The Verdict&lt;/h2&gt;\n&lt;p&gt;If I owned a Samsung smartphone, the Galaxy Buds Pro would be a no-brainer for me. They work just as seamlessly with something like a Galaxy Note 20 (which I used for testing) as AirPods do with an iPhone, provide terrific sound quality and noise cancellation, and can sit in my ears for hours at a time without bothering me. The improved ANC and additional comfort are enough to make me wholeheartedly recommend these over the Galaxy Buds Live for Android owners.&lt;/p&gt;\n&lt;p&gt;That said, I wish the ANC did a better job of muting louder outdoor noises, but maybe that's a few years away. It's also unfortunate that the voice detection feature can be more of a hindrance than a help, at least in my experience. Despite those minor issues, as well as middling battery life when ANC is turned on, the Galaxy Buds Pro are a worthy successor to the Galaxy Buds Live and something Android owners should consider.&lt;/p&gt;\n&lt;p&gt;With all due respect to the \&quot;beans,\&quot; this is a case where boring is better.&lt;/p&gt;\n&lt;h2&gt;WATCH: Unboxing the BTS Edition Samsung Galaxy Buds+&lt;/h2&gt;\n&lt;div data-source=\&quot;blueprint\&quot; data-template=\&quot;embedded\&quot; data-video=\&quot;O4oKA2YZnd\&quot;&gt;\n&lt;div&gt;\n  &lt;p&gt;&lt;img alt=\&quot;Uploads%252fvideo uploaders%252fdistribution thumb%252fimage%252f95136%252f96587d2f 7dea 48ef 87c8 0ed74bd00239.png%252f930x520.png?signature=dkg2rtrnetqd20fsap ou2byynm=&amp;amp;source=https%3a%2f%2fblueprint api production.s3.amazonaws\&quot; src=\&quot;https://mondrian.mashable.com/uploads%252Fvideo_uploaders%252Fdistribution_thumb%252Fimage%252F95136%252F96587d2f-7dea-48ef-87c8-0ed74bd00239.png%252F930x520.png?signature=dkg2rtRNEtQd20FSap-Ou2bYYnM=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com\&quot; data-fragment=\&quot;m!3c0b\&quot; data-image=\&quot;https://mondrian.mashable.com/uploads%252Fvideo_uploaders%252Fdistribution_thumb%252Fimage%252F95136%252F96587d2f-7dea-48ef-87c8-0ed74bd00239.png%252Foriginal.png?signature=b1YV-6FyrAnr5O_ELQa8Vr7FPPE=&amp;amp;source=https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com\&quot; data-micro=\&quot;1\&quot;&gt;\n&lt;/p&gt;&lt;/div&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;/section&gt;&lt;/div&gt;&quot;,
    &quot;length&quot; : 8417,
    &quot;excerpt&quot; : &quot;Samsung's newest earbuds are less fun to look at, but better to use.&quot;,
    &quot;siteName&quot; : &quot;Mashable&quot;,
    &quot;tickers&quot; : [ 
        {
            &quot;_id&quot; : ObjectId(&quot;6001eb414110e6001cb5b227&quot;),
            &quot;name&quot; : &quot;Apple Inc.&quot;,
            &quot;symbol&quot; : &quot;AAPL&quot;,
            &quot;exchange&quot; : &quot;nasdaq&quot;
        }
    ],
    &quot;cryptos&quot; : [ 
        {
            &quot;_id&quot; : ObjectId(&quot;6001eb414110e6001cb5b228&quot;),
            &quot;name&quot; : &quot;Strong&quot;,
            &quot;symbol&quot; : &quot;STRONG&quot;
        }, 
        {
            &quot;_id&quot; : ObjectId(&quot;6001eb414110e6001cb5b229&quot;),
            &quot;name&quot; : &quot;Tap&quot;,
            &quot;symbol&quot; : &quot;XTP&quot;
        }
    ],
    &quot;meta&quot; : {
        &quot;title&quot; : &quot;Samsung takes on Apple's AirPods Pro with new Galaxy Buds Pro&quot;,
        &quot;thumb&quot; : &quot;https://mondrian.mashable.com/2021%252F01%252F15%252Fdd%252Fac21db42899b4219ab9b4e35fc74c043.002a7.jpg%252F1200x630.jpg?signature=I4q1zJF08njPyxmiZgxnHrSsTsM=&quot;
    },
    &quot;url&quot; : &quot;https://mashable.com/review/samsung-galaxy-buds-pro-review/&quot;,
       &quot;host&quot; : &quot;mashable.com&quot;,
 &quot;createdAt&quot; : ISODate(&quot;2021-01-15T19:21:37.931Z&quot;),
    &quot;updatedAt&quot; : ISODate(&quot;2021-01-15T19:21:37.931Z&quot;),
    &quot;__v&quot; : 0
}
</code></pre>",mongodb|aggregation-framework,33522,chovy,yes
"Multittasking Shows Black screen for apps ""UIApplicationExitsOnSuspend is set to TRUE""","<p>I am building an app which exits on going to the background.  I have set ""UIApplicationExitsOnSuspend""  flag  to TRUE. </p>

<h3>Multitasking feature</h3>

<blockquote>
  <p>Keep the content of your app up-to-date by adopting the new
  multitasking APIs in iOS 7. The new services allow your app to update
  information and download content in the background without draining
  the battery unnecessarily. The updates can happen at opportunistic
  times and are intelligently scheduled according to usage, so your app
  can update content in the background just when your users need it."" to
  do this ""Double Press the Home Button</p>
</blockquote>

<p>My app screen is shown as black screen in multitasking tray/app switcher till it comes into foreground. </p>

<p>Is there a way to show launch graphics/splash screen when the app is in the background during Multitasking tray/ app-switcher? </p>

<p>Can anyone please let me know how to show the launch graphics of my app during multitasking.</p>",multitasking|ios7,2728863,Vivek,no
ios - Cllocation in background,"<p>I am working on project in which I need to fire notification when user reaches particular place, even application in background. What is the best way to do this? </p>

<p>What I found is following.</p>

<pre><code>locationManager = [CLLocationManager new];
[locationManager startUpdatingLocation];
</code></pre>

<p>or </p>

<pre><code>[sharedService.locationManager stopMonitoringSignificantLocationChanges];
</code></pre>

<p>or</p>

<pre><code>[locationManager startMonitoringForRegion:region];
</code></pre>

<p>About <code>startUpdatingLocation</code> I am getting continuous notification on simulator and on ipod after 3-4 mins.
Documents says it will drain battery and appstore may not accept because this methods must be used by application like navigation types.</p>

<p>About <code>stopMonitoringSignificantLocationChanges</code> documents says it uses cellular network. I am not sure whether it wil work on ipod. On my ipod not working. Does this method needs sim card?
And how does this method works? Means should I walk some distance to get this method respond? I traveled 1-2 km but it did not work.</p>

<p>About <code>startMonitoringForRegion</code> I used</p>

<pre><code>if([CLLocationManager regionMonitoringEnabled])
        NSLog(@""monitering enable"");
    else
        NSLog(@""monitering not avail"");
</code></pre>

<p>For Ipod I got <code>monitering not avail</code>. Also client checked on his iphone. He also did not got notification.</p>

<p>Please can some one explain me this method? If any other way of finding location in background then please tell. </p>

<p>Edit:
I am using startUpdatingLocation. On device it calls <code>didUpdateToLocation</code> method every after 5 mins. Will it use lot of battery? and appstore will accept this?</p>

<p>If I use startUpdatingLocation will appstore accept app? Since my need is just to give notification when user reach a particular place.</p>",ios|notifications|cllocationmanager|cllocation,1682779,Durgaprasad,yes
permanent data download after AppEventsLogger activateApp,"<p>I'm trying to measure installs from Mobile App Ads in Facebook, using Facebook SDK 3.21.1. Following the guide from FB, I just added the following line to the onResume method of the activity:   </p>

<pre><code>com.facebook.AppEventsLogger.activateApp(this, getString(R.string.facebook_app_id));
</code></pre>

<p>The measurement works, but looking at DDMS Network Statiatics, I observe a nearly permanent data transfer about 1 KB/s, which even persists, when putting the into background. The result is a corresponding battery and data drain.</p>

<p>I tried deactivating in the onPause method, but didn't stop the data transfer:</p>

<pre><code>com.facebook.AppEventsLogger.deactivateApp
</code></pre>

<p>Is there anything else to do in order to start/stop the measurement? </p>",android|facebook,4420508,Raul,yes
What would be the good way to go about having something running background that constantly keeps an eye on network connectivity?,"<p>My app has certain features that are only activated with a network connection is present.  I have the code in place to check for a connection, but I'm not sure how I should go about doing constant checks.</p>

<p>I want to check for an active connection in the background once every 2-3 seconds.</p>

<p>...Check for connection
...Wait a few seconds
...Check for connection
...Wait a few seconds
...Check for connection
...Wait a few seconds
...etc</p>

<p>I originally put it in a loop in an IntentService, but I heard you shouldn't run endless loops in IntentServices because they will eventually be terminated. Then read it might be good to use an Alarm but heard from someone else to limit alarms to once per minute or so, otherwise it will cause bad battery drain.</p>

<p>What would be a good way to approach this?</p>",java|android|android-service,1003916,cowsay,no
Is it possible to completely disable the Doze mode and Standby mode?,"<p>I have a requirement to create an app that should run 24/7. I don't care about battery drain, becoz app will not be submitted to PlayStore and its only for the selected user.I also understand app will only last for one day, that is acceptable in my case.  </p>

<p>The application functionality mainly dependent on network and Bluetooth functionality and the most of the code written in pre marshmallow and changing the whole implementation is not a right option for me now. </p>

<p>So is there any way to create the app without any restriction? Also, As observed some of the Device manufacturers put an extra layer of battery optimization to make this worse.</p>

<p>I tried to create a dummy foreground service with partial wakelock, but this not seems to be working. and even whitelisting the app didn't solve the issue.</p>

<p><strong>There is no proper documentation from Google</strong> about what are the functionalities will be affected from doze/standby. According to Google doc the background task will not be suspended, it only deferred until the next maintenance window. If that is the case, App should be able to print all the app that is missed during doze period. But as observed app will print the log only during the maintenance window. The is will break the expected behavior.</p>

<p>Whitelisting is a good option but app will be still be affected by the doze mode. What is the reason to restrict the app behavior even when the user explicitly chose not to? It very frustrating when the app behaves differently in different device OS, Manufacturer etc. </p>

<p>Sorry for the story. I would like to understand is there any way to completely disable Doze and standby mode without changing the existing implementation? <strong>I have gone through the various document, but there is NO WAY to achieve this 100%.</strong> Please share your thoughts</p>",android|android-doze-and-standby|doze,9471124,Jess,no
Dynamically enable/disable FXBlurView,"<p>I have an app where I blur the navigationbar and tabbar. Here I use FXBlurView to easily do this. I have noticed that the blur keeps being refreshed even though the view doesn't change. This causes the battery to drain quicker than I would want.</p>

<p>Is there a way to quickly detect if the view has changed, without having to take a snapshot (which also is +-5ms each time)?</p>",ios|performance|xamarin|xamarin.ios|blur,1009013,vrwim,yes
Android GCM notifications drains battery,"<p>I'm using Urban Airship and GCM to send push notifications to my app, GCM setup required process wake lock permissions in manifest,</p>

<pre><code>  &lt;uses-permission android:name=""android.permission.WAKE_LOCK"" /&gt;
  application can keep the processor from sleeping when a message is received. Optional—    
  use only if the app wants to keep the device from sleeping
</code></pre>

<p>When i checked my app battery performance with PowerTutor it shows a continuous process on my app.
is this WAKE_LOCK causing the issue.</p>",android|google-cloud-messaging|urbanairship.com,2328378,Kasun Wanniarachchi,no
Use fusedlocationapi to get location without requesting for location updates after a time interval,"<p>I am using google's fusedlocationapi in android for getting user's current latitude and longitude, now according to my use case i only want to get user's current location only when user clicks on a button, now i thought that instead of requesting for location updates again and again between a time interval i can use something different so that my user's battery will not get drained much, i searched a lot of posts on SO and on other communities also but didn't find anything useful. Now can anybody please tell me how can i find something that will work for my use case.</p>",android|geolocation|location|fusedlocationproviderapi|android-fusedlocation,6387388,Prakash Kumar,no
How to Integrate FCM with Ejabberd?,"<blockquote>
<p><strong>Environment:</strong></p>
<p>Ejabberd Version : 16.04</p>
<p>Smack-android-4.1.0</p>
</blockquote>
<p>I have created an Android chat application with a XMPP server. However due to Google play permission issue I had to narrow down the feature from app which supported receiving incoming message notifications when the app is in the background.</p>
<p>As an alternative I received the following suggestion from GooglePlay Review Team.</p>
<blockquote>
<p>Once you’ve removed this permission, you might consider using Firebase
Cloud Messaging (FCM) if your app’s message delivery requires a
temporary exemption from battery optimization. Please set high
priority only if the message is time-critical and requires the user’s
immediate interaction, and be aware that setting your messages to high
priority contributes to more battery drain compared to normal priority
messages</p>
</blockquote>
<p>So at the moment users can send messags via the app. But when he close the app, he will be considered as an offline user, and will not receive any notifications from app. When he opens the app again, he will get all the offline messages those were saved the Ejabberd server.</p>
<p>I want to enhance the current app so that even though a user had closed the app he will still receive a notification when some one sends a message to him (Similar to whatsapp)</p>
<ol>
<li><p>Is there a module in ejabberd which integrates the server with FCM and handles this?</p>
</li>
<li><p>If we can not achieve this by Ejabberd, is there a 3rd party library to support this?</p>
</li>
<li><p>If not do we have to write an Erlang module from scratch?</p>
</li>
</ol>
<p>I found similar questions in the internet but I could not find any working solution. Since I am not much experienced with Erlang and would be glad to hear your solutions/ideas on this. Thanks in advance.</p>",android|erlang|firebase-cloud-messaging|ejabberd|smack,5361779,B378,no
Android - MediaPlayer + PowerManager.PARTIAL_WAKE_LOCK,"<p>I'm creating application for listening radio streams via WiFi &amp; 3G network.</p>

<p>I am using native MediaPlayer. Unfortunately when screen goes black and phone goes into standby mode mediaplayer starts stopping playing the music.</p>

<p>I have added:</p>

<pre><code>mp.setWakeMode(myContext, PowerManager.PARTIAL_WAKE_LOCK);
</code></pre>

<p>But there wasn't almost any change (just stop playing and in the next 3 seconds start playing again..) only FULL_WAKE_LOCK and SCREEN_DIM_WAKE_LOCK is working as I expected... </p>

<p>In my device I have set option that prevents wifi to sleep. </p>

<p>I was trying to add my cusom WAKE_LOCK</p>

<pre><code>        mp.setWakeMode(this.getBaseContext(), PowerManager.PARTIAL_WAKE_LOCK);
        wl = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, ""testa"");
        wl.acquire();
</code></pre>

<p>But it didn't work as well. Only FULL_WAKE_LOCK works, but I do not want to drain battery with screen on :(. </p>

<p>I have HTC Desire with Android 2.2. Do you have any ideas how to prevent MediaPlayer stop playing internet radio stream while telephone is in standby mode?</p>",java|android|media-player|android-mediaplayer,408613,radzio,no
Get the more accurate user location android,"<p>I'm building an app that track user movement. I found on the net and I'm still  blocked about how to get a reliable user location.</p>
<p>For that purpose, I started by use the GPS_PROVIDER to get user location every minutes. But that drains a lot of battery.
Now I'm using NETWORK_PROVIDER which have better yield on battery, but as per my understanding, is not really accurate.</p>
<p>So firstly, I want to know to deal between usage of those providers to have good yield regarding battery consumption and user location accuracy.</p>
<p>Secondly, I read there (<a href=""https://source.android.com/devices/sensors/sensor-types.html#significant_motion"" rel=""nofollow noreferrer"">Significant Motion</a>)  that:</p>
<blockquote>
<p>At the high level, the significant motion detector is used to reduce the power consumption of location determination. When the localization algorithms detect that the device is static, they can switch to a low power mode, where they rely on significant motion to wake the device up when the user is changing location.</p>
</blockquote>
<p>Does it mean that this sensor is already used by GPS_NETWORK or that applications have to implement the described behavior?</p>
<p>Thanks</p>",android|gps|location,4211994,Coccoonx,yes
How to schedule synchronization for Internet connectivity only,"<p>I'm using a <a href=""http://developer.android.com/training/sync-adapters/creating-sync-adapter.html"" rel=""nofollow noreferrer"">Sync Adapter</a> to perform synchronization for my app. It has set automatic sync:</p>

<pre><code>// Inform the system that this account supports sync
ContentResolver.setIsSyncable(account, AuthenticatorService.AUTHORITY, 1);
// Inform the system that this account is eligible for auto sync when the network is up
ContentResolver.setSyncAutomatically(account, AuthenticatorService.AUTHORITY, true);
</code></pre>

<p>If I request the sync:</p>

<pre><code>Bundle b = new Bundle();
// Disable sync backoff and ignore sync preferences. In other words...perform sync NOW!
b.putBoolean(ContentResolver.SYNC_EXTRAS_MANUAL, true);
b.putBoolean(ContentResolver.SYNC_EXTRAS_EXPEDITED, true);
ContentResolver.requestSync(AuthenticatorService.GetAccount(), AuthenticatorService.AUTHORITY, b);
</code></pre>

<p>it works well -- as soon as the network is up, SyncAdapter.onPerformSync() is called. However, there's one problem: if the network is up but not connected to Internet (hotspot without tethering for instance), onPerformSync() is still called.</p>

<p>Of course, since it can't reach the server, sync code fails. What is worse, the system thinks everything went OK and <strong>wont do any more sync calls unless my data change</strong>.</p>

<p>My question is: can I either mark the synchronization as not successful so the system will try it later (for instance on another CONNECTED event or in a few seconds) or better to tell the system to perform the sync only when real Internet connectivity is present?</p>

<p>I could monitor the network state and do a connectivity check by myself but that would defy the whole purpose of sync adapters, wouldn't it. Only workaround I can think of is to schedule periodic synchronization (using ContentResolver.addPeriodicSync()) and when my synchronization code succeeds, turn it off. But I'm not very happy about this either (draining battery).</p>

<p><strong>EDIT:</strong> As for the first part of my question, <a href=""https://stackoverflow.com/a/14829963"">this answer</a> is what I was looking for. It partially solves my problem but if there's consecutive number of ""non-working"" connections, when the device is associated with the real connection, it would take tens of minutes to sync (because of the exponential backoff algorithm).</p>",android|android-syncadapter,21009,Miro Kropacek,yes
Always launch new activity instance with no history,"<p>Is there a way to launch an activity as a new instance with no history?</p>

<p>Tried the following in the manifest file.</p>

<pre><code>android:launchmode=""singleinstance""
android:noHistory=true
</code></pre>

<p>I am able to achieve what I need, but as soon as the screen is locked the previous activity is displayed. That's what <code>noHistory</code> is supposed to do, but not what I need.</p>

<p>Keeping the screen on always would not be preferable as it would drain the battery unnecessarily. Is there any other way to start an activity with a new instance and have no history but also work when the screen is locked?</p>",android|android-intent|android-activity,1791906,banditpoper,yes
iphone - Battery using startMonitoringSignificantLocationChanges and desiredAccuracy,"<p>I'm developing a localization app that runs in the background.</p>

<p>I'm using <code>startMonitoringSignificantLocationChanges</code> to get the location updates of the user.</p>

<p>I know this method only uses the cell towers to determine the user location, but it saves battery, even if it's not very accurate.</p>

<p>I was wondering, what would be the effect combining this method with <code>desiredAccuracy</code> or <code>distanceFilter</code>?</p>

<p>Will it still be inaccurate and battery-friendly?</p>

<p>Or it will actually use the GPS and drain the battery?</p>

<p>Thanks</p>",iphone|localization|power-management,628244,subharb,yes
iphone - Doubts on geofencing,"<p>I've heard of geofencing and I have some doubts. Hope you can answer some of them.</p>

<p>-It's new for iOS 5.1 but what is the difference between geofencing and Using Regions? From what I've read is nearly the same, the battery drain?</p>

<p>-Why can't I find apple documentation on geofencing?</p>

<p>-How do you define the regions? can I add them remotely, via webservice?</p>

<p>Thanks.</p>",iphone|geofencing,628244,subharb,no
Understanding sampler,"<p>I have a location based app that runs in the background indefinetly.
The battery drains quite fast so I used Sampler to see what was going on while app was in the background. It's supposed not to do anything while in background unless a location change happens.</p>

<p>this is what Sampler returns:
<img src=""https://i.stack.imgur.com/RXQhu.jpg"" alt=""enter image description here""></p>

<p>I see XMPPModule deactivate, is taking 24.1% while it shouldn't be running at all. I set breakpoints on this block and they are never called, so what does this mean exactly then?</p>

<p>Thanks.</p>",ios|instruments,628244,subharb,yes
Setting LocationManager to default accuracy,"<p>My app uses  <code>significantLocationChanges</code> but for a short amount of time I need to use the GPS, so I set the accuracy to <code>kCLLocationAccuracyBest</code> and <code>startUpdatingLocation</code> after a short time I <code>stopUpdatingLocation</code>.
Since I will still be monitoring significant location changes I dont want to have <code>kCLLocationAccuracyBest</code> but a less accurate, the default one, so the battery doesn`t drain, which one is that?</p>

<p>Thanks.</p>",objective-c|cllocationmanager,628244,subharb,no
Android: What is a good place to release used resources that is not onDestroy?,"<p>I am looking for a place to put my clean up code (e.g. releasing file handles, shutting down services).</p>

<p>Here is the scenario: I have an app with multiple activities and a service running in the background. The service accesses a lot of sensors and files. Thus, it must be stopped if the app is terminated by the user to prevent battery draining. However, the service must continue running while the app is in the background and/or the screen is turned off. I am looking for a place to stop the service in code. onDestroy() of my Activities seems not to be a good idea because Android may call it (even while my app is running) or may call it never at all. </p>

<p>Is there a good place for releasing used resources of an app when the user knowingly terminates it?</p>",android|activity-lifecycle,3522584,user3522584,no
CoreLocation stops working in background after certain amount of time,"<p>I am developing an iOS (7.0+) application for fitness (running) that uses the users GPS location, does a small calculation and transmits the data to a Bluetooth Low Energy (4.0) watch. This process needs to be happening in the background, even when the user locks their iOS device.</p>

<p>I have implemented the following background modes as well:</p>

<pre><code> App communicates using CoreBluetooth
 App registers for location updates
</code></pre>

<p>I have successfully been able to get everything to work well, except for after a certain amount of time (ex. 2 hours) when the device is locked, the iOS device stops updating the location because I can see that it is no longer sending updating GPS values to the Bluetooth watch. I then have to unlock the device, re-open the app and location services works as it should again. </p>

<p>Does anybody know how to keep location services running the whole time in the background (device locked) without it suddenly stopping the location updates after a certain amount of time? If possible, an efficient solution would be preferred that does not drain the battery too much more than it normal would for using GPS. </p>",ios|objective-c|core-location|cllocationmanager|ios-background-mode,970237,Teddy13,no
iOS/Android GPS battery draw?,"<p>I'm investigating the possiblity of writing an app for Android/iOS4/both that would use GPS in the background. I found the <a href=""http://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/BackgroundExecution/BackgroundExecution.html#//apple_ref/doc/uid/TP40007072-CH5-SW4"" rel=""nofollow noreferrer"">""Receiving Location Events in the Background""</a> section of the  iphone developer documentation, which recommends that I only register for ""significant location change"" events. I'm not aware of any such capability in the Android SDK, but it still seems like a good idea to do it this way if I can (so as not to drain the battery).</p>

<p>My question is this: has anyone done any sort of benchmarking for this on and iPhone/Android phone? So far, I've seen a lot posts/documentation saying that listening for GPS events in the background is a VERY BAD THING and I should AVOID IT AT ALL COSTS, but I haven't been able to find any numbers for just how much power a background application listening on GPS changes would drain (i.e. % battery drain per time app is running in the background).</p>

<p>This information might be helpful for me (and possibly others too) because I might be able to poll less frequently or even register/unregister my GPS listener based on power drain. Essentially, I could try to put a ceiling on how much battery life my app could drain while in the background.</p>

<p>Thanks!</p>",android|geolocation|gps|ios4|battery,195625,Seth,yes
Android device needs restart/reboot to get GPS locations after having GPS chip active a long time,"<p>I'm developing yet another GPS tracking application for Android and I'm testing my code in Sony Xperia SP c5302 with Android 4.3. </p>

<p>I made a background service which uses Google Play Services' GoogleApiClient to get fused locations. I'm able to get locations fine but after a couple hours I realize my GPS chip stops returning locations because their accuracy raises from 10 to 30 or 50 (which means other providers than GPS are returning the new location). </p>

<p>Considering I'm indoors I thought the API decided to listen only to network providers, then I went to the street (with wifi and data connection turned off) and stopped getting fused locations at all (I wasn't getting network fixes anymore as expected and GPS chip was already dead as stated). Even Google Maps couldn't track me. Then I decided to just restart my phone at that very moment and I got GPS chip updates again just fine on both my application and Google Maps (wifi and data connection were still turned off).</p>

<p>I tried the same approach with the original Location API which used LocationManager with the same results.... I have to restart my phone in order for GPS chip to work again.</p>

<p>Here is my base code with GoogleApiClient:</p>

<pre><code>public class MyService extends Service {

private final static String TAG = MyService.class.getSimpleName();

//GPS
private GoogleApiClient miGoogleApiClient = null;
private LocationRequest miLocationRequest = null;
private LocationRequest currLocation = null;

@Override  
public void onCreate() {     
    super.onCreate();     
    Log.i(TAG, ""onCreate MY SERVICE"");

    startGPS();
}

@Override
public void onDestroy(){
    super.onDestroy();
    Log.d(TAG, ""onDestroy"");
    stopGPS();
}


public boolean startGPS(){
    Log.d(TAG, ""startGPS"");
    try{
        miGoogleApiClient = new GoogleApiClient.Builder(this)
            .addApi(LocationServices.API)
            .addConnectionCallbacks(miConnectionCallbacks)
            .addOnConnectionFailedListener(miOnConnectionFailedListener)
            .build();
        miGoogleApiClient.connect();

        return true;
    }catch(Exception e){
        Log.d(TAG, ""can't start GPS:""+e);
        return false;
    }finally{return false;}
}

public void stopGPS(){
    Log.d(TAG, ""stopGPS"");
    miGoogleApiClient.disconnect();
}

private LocationListener miLocationListener = new LocationListener(){
    @Override public void onLocationChanged(Location location){
        Log.d(TAG, ""onLocationChanged:""+new Date(location.getTime())+"", ""+ location);
        //...more work
        currLocation = location;
    }
};

private GoogleApiClient.ConnectionCallbacks miConnectionCallbacks = new GoogleApiClient.ConnectionCallbacks(){
    @Override public void onConnected(Bundle bundle){
        Log.d(TAG, ""onConnected:""+bundle);
        currLocation = LocationServices.FusedLocationApi.getLastLocation(miGoogleApiClient); //may be old
        miLocationRequest = LocationRequest.create()
            .setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY)
            //.setSmallestDisplacement(10) //Won't use this for now
            .setInterval(30000)
            .setFastestInterval(30000);
        LocationServices.FusedLocationApi.requestLocationUpdates(
            miGoogleApiClient, miLocationRequest, miLocationListener);
    }
    @Override public void onConnectionSuspended(int i){
        Log.d(TAG, ""onConnectionSuspended:""+i);
    }
};

private GoogleApiClient.OnConnectionFailedListener miOnConnectionFailedListener = new GoogleApiClient.OnConnectionFailedListener(){
    @Override public void onConnectionFailed(ConnectionResult connectionResult){
        Log.d(TAG, ""onConnectionFailed:""+connectionResult);
    }
};

}
</code></pre>

<p>I know this approach drains battery faster but this application is meant for a specific client and not for general public so it's OK.</p>

<p>¿Is this behavior supposed to happen or there is something wrong with my phone or something wrong with my code? I find specially weird that even Google Maps can't get the location so I'm wondering if my application is messing with the phone itself.</p>

<p>Edit.</p>

<p>I have to restart the phone because turning off and on GPS from Android settings menu makes no difference. (My service log shows that GPS is started with no mistakes if I stop it and start it again)</p>",android|gps|google-api-client,2997817,user2997817,no
"Wakelock alternative, right using - android","<p>I using Wakelock in my Service, because the Service and the handy must working the whole time. It works very fine, but its drain the batterypower very fast.</p>

<p>Actually my code for the wakelock:</p>

<pre><code>    public static PowerManager pm;
    public static PowerManager.WakeLock wl;
    wl = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, ""My Tag"");
    wl.acquire();
</code></pre>

<p>If the Service is closed I do</p>

<pre><code>    wl.release();
</code></pre>

<p>I think it is a way, but not the best. And another question - for what I can use the ""My Tag"". 
Maybe you can help me. Thanks.</p>",android|wakelock|android-wake-lock,2387843,user2387843,no
iOS app crashes on NSOperationQueue when in Low Power Mode,"<p>I've written an app in Swift which crashes on the following lines, when in Low Power Mode. It's basically a request that runs on a background thread. And some UI updates that's happening on the main thread.</p>

<p>I can't recreate the crash on my phone when in Low Power Mode, but according to my users this is the root cause.</p>

<pre><code>// Run the request on a background thread
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), {
   self.runRequestOnBackgroundThread(request)
});

func runRequestOnBackgroundThread(request: NSMutableURLRequest) {
    //We need to update the UI on the mainthread/ ONLY THE UI
    dispatch_async(dispatch_get_main_queue(), {
        self.scanInProgress()
    })
    let session = NSURLSession.sharedSession()
    // run the request
    let task = session.dataTaskWithRequest(request, completionHandler: {data, response, error -&gt; Void in
        self.analyzeResults(data!)
    })
    task.resume()
}


func analyzeResults(dataToParse: NSData) {
    // Update UI on the main thread and analyze data from request
    // Line 491 below this line
    dispatch_async(dispatch_get_main_queue(), {
        //Here goes some regex
    })
</code></pre>

<p>I also found this on Apple.com:</p>

<blockquote>
  <p>Users who wish to prolong their iPhone’s battery life can enable Low
  Power Mode under Settings > Battery. In Low Power Mode, iOS conserves
  battery life by enacting certain energy-saving measures. For example,
  the system may:</p>
  
  <ul>
  <li>Reduce CPU and GPU performance</li>
  <li>Pause discretionary and background activities, including networking</li>
  <li>Reduce screen brightness</li>
  <li>Reduce the timeout for auto-locking the device</li>
  <li>Disable Mail fetch</li>
  <li>Disable motion effects</li>
  <li>Disable animated wallpapers</li>
  </ul>
</blockquote>

<p>Sound like the problem is with <em>Pause discretionary and background activities, including networking</em>?</p>

<p>How can I make the request in the background and update the UI on the mainthread meanwhile when Low Power Mode is enabled (I have some UIView.animateWithDuration going)? The user will always have the app in the foreground when these methods are run, does this mean I should run the request on the main thread?</p>

<p>Below is the Crash report from Fabric/Crashlytics:</p>

<pre><code>#-1. com.apple.main-thread
0  libsystem_platform.dylib       0x18428d8b0 _platform_memcmp + 32
1  CoreFoundation                 0x1845fe710 __CFStringEqual + 256
2  CoreFoundation                 0x1845fe710 __CFStringEqual + 256
3  CoreFoundation                 0x18450ebf4 CFEqual + 400
4  CoreFoundation                 0x184670314 __NSCacheKeyEqual + 12
5  libcache.dylib                 0x184006bcc _entry_get_optionally_checking_collisions + 164
6  libcache.dylib                 0x1840051b8 cache_get_and_retain + 132
7  CoreFoundation                 0x18455f22c -[NSCache objectForKey:] + 68
8  CoreUI                         0x189146660 -[CUIStructuredThemeStore _canGetRenditionWithKey:isFPO:lookForSubstitutions:] + 360
9  CoreUI                         0x189168f48 -[CUICatalog _resolvedRenditionKeyFromThemeRef:withBaseKey:scaleFactor:deviceIdiom:deviceSubtype:sizeClassHorizontal:sizeClassVertical:memoryClass:graphicsClass:graphicsFallBackOrder:] + 1416
10 CoreUI                         0x1891680fc -[CUICatalog namedLookupWithName:scaleFactor:deviceIdiom:deviceSubtype:sizeClassHorizontal:sizeClassVertical:] + 148
11 UIKit                          0x189b7d994 __98-[_UIAssetManager imageNamed:scale:idiom:subtype:cachingOptions:sizeClassPair:attachCatalogImage:]_block_invoke + 424
12 UIKit                          0x189b7d734 -[_UIAssetManager imageNamed:scale:idiom:subtype:cachingOptions:sizeClassPair:attachCatalogImage:] + 212
13 UIKit                          0x189c90584 -[UIImageAsset imageWithTraitCollection:] + 404
14 UIKit                          0x1896cf058 -[UIImageView _resolveImageForTrait:] + 460
15 UIKit                          0x1896ce928 -[UIImageView _didMoveFromWindow:toWindow:] + 212
16 UIKit                          0x18931ad7c -[UIView(Internal) _didMoveFromWindow:toWindow:] + 760
17 UIKit                          0x1893a04f8 -[UIControl _didMoveFromWindow:toWindow:] + 80
18 UIKit                          0x18931ad7c -[UIView(Internal) _didMoveFromWindow:toWindow:] + 760
19 UIKit                          0x18931a310 __45-[UIView(Hierarchy) _postMovedFromSuperview:]_block_invoke + 152
20 Foundation                     0x184f4d500 -[NSISEngine withBehaviors:performModifications:] + 168
21 UIKit                          0x18931a194 -[UIView(Hierarchy) _postMovedFromSuperview:] + 532
22 UIKit                          0x189327b80 -[UIView(Internal) _addSubview:positioned:relativeTo:] + 1784
23 UIKit                          0x189420b34 -[UITransitionView transition:fromView:toView:removeFromView:] + 1544
24 UIKit                          0x189420458 -[UIViewControllerBuiltinTransitionViewAnimator animateTransition:] + 2780
25 UIKit                          0x18967ab7c __56-[UIPresentationController runTransitionForCurrentState]_block_invoke + 2228
26 UIKit                          0x1895d0b70 _runAfterCACommitDeferredBlocks + 292
27 UIKit                          0x1895de030 _cleanUpAfterCAFlushAndRunDeferredBlocks + 92
28 UIKit                          0x189311c24 _afterCACommitHandler + 96
29 CoreFoundation                 0x1845e4588 __CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__ + 32
30 CoreFoundation                 0x1845e232c __CFRunLoopDoObservers + 372
31 CoreFoundation                 0x1845e275c __CFRunLoopRun + 928
32 CoreFoundation                 0x184511680 CFRunLoopRunSpecific + 384
33 GraphicsServices               0x185a20088 GSEventRunModal + 180
34 UIKit                          0x189388d90 UIApplicationMain + 204
35 TestDrive                      0x1000a32ec main (AppDelegate.swift:15)
36 libdispatch.dylib              0x1840b28b8 (Missing)

#0. com.apple.libdispatch-manager
0  libsystem_kernel.dylib         0x1841d14fc kevent_qos + 8
1  libdispatch.dylib              0x18409494c _dispatch_mgr_invoke + 232
2  libdispatch.dylib              0x1840837bc _dispatch_source_invoke + 50

#1. com.twitter.crashlytics.ios.MachExceptionServer
0  TestDrive                      0x1000d94c8 CLSProcessRecordAllThreads + 4296103112
1  TestDrive                      0x1000d94c8 CLSProcessRecordAllThreads + 4296103112
2  TestDrive                      0x1000d98e8 CLSProcessRecordAllThreads + 4296104168
3  TestDrive                      0x1000ca5a8 CLSHandler + 4296041896
4  TestDrive                      0x1000c572c CLSMachExceptionServer + 4296021804
5  libsystem_pthread.dylib        0x184297b28 _pthread_body + 156
6  libsystem_pthread.dylib        0x184297a8c _pthread_body + 154
7  libsystem_pthread.dylib        0x184295028 thread_start + 4

#2. com.apple.NSURLConnectionLoader
0  libsystem_kernel.dylib         0x1841b54bc mach_msg_trap + 8
1  libsystem_kernel.dylib         0x1841b5338 mach_msg + 72
2  CoreFoundation                 0x1845e4ac0 __CFRunLoopServiceMachPort + 196
3  CoreFoundation                 0x1845e27c4 __CFRunLoopRun + 1032
4  CoreFoundation                 0x184511680 CFRunLoopRunSpecific + 384
5  CFNetwork                      0x184c81434 +[NSURLConnection(Loader) _resourceLoadLoop:] + 412
6  Foundation                     0x184fefc40 __NSThread__start__ + 1000
7  libsystem_pthread.dylib        0x184297b28 _pthread_body + 156
8  libsystem_pthread.dylib        0x184297a8c _pthread_body + 154
9  libsystem_pthread.dylib        0x184295028 thread_start + 4

#3. com.apple.CFSocket.private
0  libsystem_kernel.dylib         0x1841d0368 __select + 8
1  CoreFoundation                 0x1845eb028 __CFSocketManager + 648
2  libsystem_pthread.dylib        0x184297b28 _pthread_body + 156
3  libsystem_pthread.dylib        0x184297a8c _pthread_body + 154
4  libsystem_pthread.dylib        0x184295028 thread_start + 4

#4. com.apple.coremedia.player.async
0  libsystem_kernel.dylib         0x1841b54f8 semaphore_wait_trap + 8
1  libdispatch.dylib              0x18409255c _dispatch_semaphore_wait_slow + 244
2  MediaToolbox                   0x18a119454 fpa_AsyncMovieControlThread + 1948
3  CoreMedia                      0x1865ea980 figThreadMain + 272
4  libsystem_pthread.dylib        0x184297b28 _pthread_body + 156
5  libsystem_pthread.dylib        0x184297a8c _pthread_body + 154
6  libsystem_pthread.dylib        0x184295028 thread_start + 4

#5. com.apple.CoreMotion.MotionThread
0  libsystem_kernel.dylib         0x1841b54bc mach_msg_trap + 8
1  libsystem_kernel.dylib         0x1841b5338 mach_msg + 72
2  CoreFoundation                 0x1845e4ac0 __CFRunLoopServiceMachPort + 196
3  CoreFoundation                 0x1845e27c4 __CFRunLoopRun + 1032
4  CoreFoundation                 0x184511680 CFRunLoopRunSpecific + 384
5  CoreFoundation                 0x18455ee2c CFRunLoopRun + 112
6  CoreMotion                     0x18a03e22c (null) + 95286384
7  libsystem_pthread.dylib        0x184297b28 _pthread_body + 156
8  libsystem_pthread.dylib        0x184297a8c _pthread_body + 154
9  libsystem_pthread.dylib        0x184295028 thread_start + 4

#6. Thread
0  libsystem_kernel.dylib         0x1841d0b6c __workq_kernreturn + 8
1  libsystem_pthread.dylib        0x184295530 _pthread_wqthread + 1284
2  libsystem_pthread.dylib        0x184295020 start_wqthread + 4

#7. com.apple.camera.avcapturesession
0  libsystem_kernel.dylib         0x1841b54bc mach_msg_trap + 8
1  libsystem_kernel.dylib         0x1841b5338 mach_msg + 72
2  CoreFoundation                 0x1845e4ac0 __CFRunLoopServiceMachPort + 196
3  CoreFoundation                 0x1845e27c4 __CFRunLoopRun + 1032
4  CoreFoundation                 0x184511680 CFRunLoopRunSpecific + 384
5  AVFoundation                   0x18a8e61dc -[AVRunLoopCondition _waitInMode:untilDate:] + 432
6  AVFoundation                   0x18a8ce960 -[AVCaptureSession _stopFigCaptureSession] + 412
7  AVFoundation                   0x18a8ceb34 -[AVCaptureSession _setRunning:] + 216
8  CameraKit                      0x18d1dcce0 __35-[CMKCaptureController stopPreview]_block_invoke
9  libdispatch.dylib              0x184081630 _dispatch_call_block_and_release + 24
10 libdispatch.dylib              0x1840815f0 _dispatch_client_callout + 16
11 libdispatch.dylib              0x18408d634 _dispatch_queue_drain + 864
12 libdispatch.dylib              0x1840850f4 _dispatch_queue_invoke + 464
13 libdispatch.dylib              0x1840815f0 _dispatch_client_callout + 16
14 libdispatch.dylib              0x18408fa88 _dispatch_root_queue_drain + 2140
15 libdispatch.dylib              0x18408f224 _dispatch_worker_thread3 + 112
16 libsystem_pthread.dylib        0x184295470 _pthread_wqthread + 1092
17 libsystem_pthread.dylib        0x184295020 start_wqthread + 4

Crashed: NSOperationQueue 0x15d5754b0 :: NSOperation 0x15e9b8460 (QOS: LEGACY)
0  TestDrive                      0x1000b597c VerifyDriverViewController.(runRequestOnBackgroundThread(NSMutableURLRequest) -&gt; ()).(closure #2) (VerifyDriverViewController.swift:491)
1  CFNetwork                      0x184c0f344 __75-[__NSURLSessionLocal taskForClass:request:uploadFile:bodyData:completion:]_block_invoke + 32
2  CFNetwork                      0x184c21cc4 __49-[__NSCFLocalSessionTask _task_onqueue_didFinish]_block_invoke + 296
3  Foundation                     0x184fd4334 __NSBLOCKOPERATION_IS_CALLING_OUT_TO_A_BLOCK__ + 16
4  Foundation                     0x184f27100 -[NSBlockOperation main] + 96
5  Foundation                     0x184f17348 -[__NSOperationInternal _start:] + 604
6  Foundation                     0x184fd6728 __NSOQSchedule_f + 224
7  libdispatch.dylib              0x1840815f0 _dispatch_client_callout + 16
8  libdispatch.dylib              0x18408d634 _dispatch_queue_drain + 864
9  libdispatch.dylib              0x1840850f4 _dispatch_queue_invoke + 464
10 libdispatch.dylib              0x18408f504 _dispatch_root_queue_drain + 728
11 libdispatch.dylib              0x18408f224 _dispatch_worker_thread3 + 112
12 libsystem_pthread.dylib        0x184295470 _pthread_wqthread + 1092
13 libsystem_pthread.dylib        0x184295020 start_wqthread + 4

#9. Thread
0  libsystem_kernel.dylib         0x1841d0b6c __workq_kernreturn + 8
1  libsystem_pthread.dylib        0x184295530 _pthread_wqthread + 1284
2  libsystem_pthread.dylib        0x184295020 start_wqthread + 4

#10. Thread
0  libsystem_kernel.dylib         0x1841d0b6c __workq_kernreturn + 8
1  libsystem_pthread.dylib        0x184295530 _pthread_wqthread + 1284
2  libsystem_pthread.dylib        0x184295020 start_wqthread + 4

#11. Thread
0  libsystem_kernel.dylib         0x1841d0b6c __workq_kernreturn + 8
1  libsystem_pthread.dylib        0x184295530 _pthread_wqthread + 1284
2  libsystem_pthread.dylib        0x184295020 start_wqthread + 4
</code></pre>",ios|swift|nsurlsession|nsoperation|nsoperationqueue,1528306,sebastiansson,no
How to get heart rate every x seconds in Android Studio?,"<p>I want to get data from the Heart Rate sensor every x seconds.
I tried it with postDelayed() but that only works for reading the data every x seconds, but the sensor is running in that time and the battery drains very fast.
I'm trying to find a way to start the sensor, get the data and stop the sensor every x seconds.</p>
<p>Here's what I did so far:</p>
<pre><code>final Handler handler = new Handler();
    handler.postDelayed(new Runnable() {
        @Override
        public void run() {
            checkHR = true;
            handler.postDelayed(this, 10000);
        }
    }, 1);

public void onSensorChanged(SensorEvent event) {
    if(checkHR == true){
        if (event.sensor.getType() == Sensor.TYPE_HEART_RATE) {
            String msg = &quot;&quot; + (int)event.values[0];
            heartRate = (int)event.values[0];
            Log.d(&quot;Heart rate is:&quot;, msg);
            checkHR = false;
        }
    }
</code></pre>",android|handler|wear-os|postdelayed,9921801,Liviu Pinzaru,yes
How can I ensure that my Android app doesn't access a file simultaneously?,"<p>I am building a fitness app which continually logs activity on the device. I need to log quite often, but I also don't want to unnecessarily drain the battery of my users which is why I am thinking about batching network calls together and transmitting them all at once as soon as the radio is active, the device is connected to a WiFi or it is charging.</p>

<p>I am using a filesystem based approach to implement that. I persist the data first to a <code>File</code> - eventually I might use <a href=""https://github.com/square/tape"" rel=""nofollow""><strong>Tape from Square</strong></a> to do that - but here is where I encounter the first issues. </p>

<p>I am continually writing new log data to the <code>File</code>, but I also need to periodically send all the logged data to my backend. When that happens I delete the contents of the <code>File</code>. The problem now is how can I prevent both of those operations from happening at the same time? Of course it will cause problems if I try to write log data to the <code>File</code> at the same time as some other process is reading from the <code>File</code> and trying to delete its contents. </p>

<p>I am thinking about using an <code>IntentService</code> essentially act as a queue for all those operations. And since - at least I have read as much - an <code>IntentServices</code> handles <code>Intent</code>s sequentially in single worker <code>Thread</code> it shouldn't be possible for two of those operations to happen at the same time, right?</p>

<p>Currently I want to schedule a <code>PeriodicTask</code> with the <code>GcmNetworkManager</code> which would take care of sending the data to the server. Is there any better way to do all this? </p>",java|android|multithreading|android-service|square-tape,304262,Mattias Petter Johansson,yes
Keeping services awake without draining battery,"<p>I have an application that needs to continuously listen for incoming requests over wifi. A service that runs in the background does this job. However, this service falls asleep after a while when the screen turns off.</p>

<p>The solution from what I have searched is to use AlarmManager to keep it awake. But it is said that this will drain the battery of the device.
So, is there another way to do this?</p>

<p>For eg, what do apps like Whatsapp and Skype do? They don't seem to kill too much battery but they have continuously running services right?</p>

<p>Also, in case AlarmManager is the only way, it would be really kind if someone could share a tutorial or example for it.</p>",android|android-service|alarmmanager,1203413,Alabhya,yes
Battery saving on iOS with VoIP,"<p>I am working on an application for VoIP calls. Things seems to be going alright. I am concerned about the battery life. Even on Wifi battery seems to be draining very fast with an active VoIP call. Battery drain on Wifi is very quick, it would be faster over cellular data. What all steps can I take to improve the battery/power consumption? Also how can I profile/analyze the battery consuming processes in the app?
Thanks in advance.</p>",ios|iphone|call|voip|battery,431764,sole007,no
How to change the get access location permission value based on time in iOS?,"<p>I work in the Geofence feature using the <code>CoreLocation</code> library. The <code>CoreLocation</code> library has a <code>CoreLocationManager</code> class, which has the <code>requestAlwaysAuthorization()</code> permission function.</p>

<p>I want to ask a question, can I change the permission based on time automatically after choosing the always allow? I want to avoid the battery drain. E.g. in peak time (10 AM -10 PM) the permission value will be always allowed and otherwise will be only while using the app</p>",ios|swift|permissions|core-location|geofencing,7407623,Kiel,no
How to execute parallel/power intensive code on mobile phones with less battery drain?,"<p>I was asked in an Interview how I would execute parallel/power intensive code on mobile phones without draining the power much.</p>

<p>I had no idea and still have no idea, all I can find on the internet is to have better battery and better processors but I dont think thats the answer.</p>

<p>Any ideas?</p>",android|ios|mobile|parallel-processing,723597,LoveMeow,yes
Does Android's standard mail app run using AlarmManager,"<p>When an Android device receives mail, does it do this by periodically connecting to the mail server? When the device is in standby mode where the screen is off, I assume that the standard mail app also is shut down but possibly uses the AlarmManager to awake and then check the mail. I can't imagine that the mail app is always running with a full Wakelock turned on, keeping the CPU always running, as that would drain the battery.</p>

<p>The reason I need to know this is because my own app needs to get a notification from its own server when certain events take place. I could just as well implement a repeating alarm that activates my app periodically and checks for the notifications. But if the mail client already is waking up at a regular time interval, I probably can save on battery consumption by using e-mail to notify my app instead. For this to work though, it must be possible for the mail app to launch my app when it receives e-mail. I doubt that this is possible, or is it?</p>",android|email|wakelock,753632,Johann,yes
ICS Device lock during application run,"<p>My Android device having ICS OS 4.0.4 does not lock the screen of the application when my app is running. This works well when I use the app on a device having OS &lt; 4. Is there any change in implementation in ICS device? This leads to draining of the battery. </p>

<p>Please let me know if there are any config changes that needs to be set up to lock the screen.</p>",android|android-4.0-ice-cream-sandwich|lockscreen,1612543,amit kumar babu,yes
How to find the distance travelled by user without using GPS,"<p>i am doing one application.In that I want to find how much distance travelled by user.And i don't want to use the GPS due to battery drain.In some posts i saw,they are using Accelerometer to find the distance with different formulae.But didn't understand that posts.And that accelerometer giving the accelerate data when the device is in stationary mode also.So how to calculate the distance travelled by user. </p>",ios|accelerometer|distance|core-motion,4849017,jack kevin,no
Location update rate in Google Maps (Android),"<p>I'm writing a simple GPS based app for location awareness. Whenever GPS is enabled, the app requests location updates and prints latitude and longitude in a <code>TextView</code>. If GPS is disabled, the location provider fall-backs to <code>LocationManager.NETWORK_PROVIDER</code> for triangulating device position relative to neighboring cell-towers. The aim is whenever device movement is detected, it should start populating the <code>TextView</code> with lat/long. When there is no movement, the process should stop. In order to do so, I've implemented the location update rate as:</p>

<pre><code>locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 1, this);
</code></pre>

<p>The above line causes very frequent location updates (even when there is no movement, I keep getting lat/long values). I read somewhere that putting <code>minTime=0</code> is not a good idea (battery drains faster). When I change it to 2 or 3 seconds, the update becomes very slow (even if the device moves more than 50 meters). Changing <code>minDistance</code> doesn't seem to work either! I want to know what settings does Google Maps application use? Power consumption is not a limiting factor for me as I'm developing the app for some network drive test equipment (which gets constant power from vehicle's on-board lead acid battery).</p>",android|gps|geolocation|location,2173438,Vinit Shandilya,no
Network Notification on Android Device,"<p>I am wondering is it possible to access the internal Network Notification on the android devices?  I want to monitor/scan for wireless networks and I'm wondering if it's possible to plug into what's already there internally? </p>

<p>I know you can use a connectivity manager (which uses a broadcast receiver) and I want to be able to check for networks even if the application is in the background so I'm guessing this would be a quite draining on the battery so that's a non runner. </p>

<p>Also I know what I can use the wifi manager, however, again I need to perform scans using a broadcast receiver which again I guess would be quite draining on the battery.  </p>

<p>So I'm wondering if these are my only options or is it possible to 'plug in' to the network notifications?</p>

<p>I have seen a similar post on here but connectivity manager is what was suggested...so I'm wondering if that's the way I need to go?</p>

<p>Thanks</p>",android|wifi|android-wifi,1250031,DJ-DOO,yes
"If the processor is always spinning, why does it drain more resources sometimes and not others?","<p>I've had a massive curiosity as to this for a long time. How do processors ""sleep""? As far as I can tell it spins until a set time, that's fine. But there's a problem with this, if the processor is always running at full speed, then why does it get noisy and heat up when it's from my program but stay quiet and not drain power during the OS idle spinning?</p>

<p>Does this have more to do with shared variable access? Even a spin lock requires checking a register with a shared variable. So would it require an external device I/O to actually heat up, or is there a ""different sleep""?</p>

<p>I've always wondered how to put my program into a sleep() and know it won't drain battery, (admittedly before I learned about OS schedules/time slicing).</p>

<p>In short, how does this work, and how would I ensure that my Sleep() or otherwise spin-locks use the low-power type.</p>",sleep|thread-sleep,1028958,Stephen J,yes
How to walk the line between location accuracy and power efficiency?,"<p>I am working on an app that requires to work in foreground and background and send location data.  I haven't written code yet and just familiarized myself with how CoreLocation works to determine which approach to follow. From the reading I did so far, I gather that:</p>

<ol>
<li><p>With startMonitoringSignificantLocationChanges  </p>

<ul>
<li>the GPS is never activated  </li>
<li>it only calls didUpdateLocations (or didUpdateToLocation for ios&lt;6) when a change of radio tower is detected  </li>
<li>the desiredAccuracy and distanceFilter properties are both ignored</li>
</ul></li>
<li><p>With startUpdatingLocation</p>

<ul>
<li>the battery drain is higher</li>
<li>didUpdateLocations is called whenever some hardware from the phone has some data to provide.  And because there are multiple hardware components that can be used for location (GPS, radio, wifi), there is no guarantee when or how often didUpdateLocations is called, or whether a new reading will be more accurate than the previous one even</li>
<li>the first number(s) are usually bad because they do not rely on the GPS</li>
<li>there is no sure way of knowing whether we have the best location we will ever get: it is just a matter of picking among all locations received the one with the best accuracy in the given time window available   </li>
</ul></li>
</ol>

<p>I don't see however much discussion or documentation about any intermediate route.  What if I want to be power-conscious but get reasonably accurate data when a user has moved significantly?  It seems that a possible compromise approach is to:</p>

<ul>
<li>turn on startMonitoringSignificantLocationChanges</li>
<li>switch to using startUpdatingLocation when didUpdateLocations is called</li>
<li>wait for a short while to give a chance to the GPS to get some good readings and select the one with best accuracy </li>
<li>switch back to using startMonitoringSignificantLocationChanges and so on...</li>
</ul>

<p>As far as I know, this approach will work the same in foreground and background and will provide some compromise between the two standard approaches supported by Apple.</p>

<p>Questions:<br>
- Is my understanding correct and my ""compromise"" approach sound?<br>
- Has anyone used that approach successfully?<br>
- What are the caveats to look for with that approach?<br>
- Is there a better compromise approach out there?</p>

<p>PS: I imagine that I could later refine the approach to take into account the estimated travel speed so that I don't constantly use the GPS when the person is traveling.</p>",iphone|cocoa-touch|core-location|cllocationmanager|background-process,91208,Lolo,no
Code inside AsyncTask doesn't run smoothly when screen is off,"<p>Inside my AsyncTask I vibrate the phone in a certain pattern and repeat this until the user turns it off. This works fine as long as the screen is on. If the screen is off, the code still runs but with periodic breaks in between. It seems like Android tries to consume battery with the screen off and only runs code within threads (like my AsyncTask) only periodically. Is that true? Or is this some other behavior? Is there a way I can get my code to run smoothly even with the screen off? Turning on the screen could drain the battery. The vibration is used to notify the user even when the screen is off.</p>",android|android-asynctask|screen,753632,Johann,yes
QT Get Last known location quickly,"<p>I am developing cross platform application using QT for Android,iOS,windows. I want to get device current location. I am using <a href=""http://doc.qt.io/qt-5/qtpositioning-index.html"" rel=""nofollow noreferrer"">Qt Positioning Api</a>. I have written C++ code using the <a href=""http://doc.qt.io/qt-5/qtpositioning-logfilepositionsource-example.html"" rel=""nofollow noreferrer"">Samples available</a>. Application want to update device location at specified time interval(x seconds) or specified distance(y meters) in meters. Please find the bellow sample code written. Code is causing lot of battery drain almost 9% of the entire battery life also takes lot of time to update first location if network is off.As requirement is to update device location continuously at specified time interval, can't stop location updates <a href=""http://doc.qt.io/qt-5/qgeopositioninfosource.html"" rel=""nofollow noreferrer"">QGeoPositionInfoSource</a> </p>

<p><strong>Locationhandler.h</strong></p>

<pre><code>#ifndef LOCATIONHANDLER_H
#define LOCATIONHANDLER_H

#include &lt;QObject&gt;
#include &lt;QGeoPositionInfo&gt;
#include &lt;QGeoPositionInfoSource&gt;
#include &lt;QDebug&gt;
#include ""main.h""


class LocationHandler : public QObject
{
    Q_OBJECT
    public :
    explicit LocationHandler(QObject *parent = 0);
    QGeoCoordinate getCurrentLocation();
    private :
    QGeoCoordinate currentLocation;
    QGeoPositionInfoSource *source;
    signals :
    public slots :
    void positionUpdated(const QGeoPositionInfo &amp;info);
};
#endif // LOCATIONHANDLER_H
</code></pre>

<p><strong>locationhandler.cpp</strong></p>

<pre><code>#include ""LocationHandler.h""

LocationHandler::LocationHandler(QObject *parent) : QObject(parent)
{
    source = QGeoPositionInfoSource::createDefaultSource(this);
   if (source) {
       connect(source, SIGNAL(positionUpdated(QGeoPositionInfo)),
                        this, SLOT(positionUpdated(QGeoPositionInfo)));
       source-&gt;startUpdates();
       source-&gt;setUpdateInterval(60);

   }
}

void LocationHandler::positionUpdated(const QGeoPositionInfo &amp;info)
{
      if(info.isValid())
      {
          currentLocation = info.coordinate();
          qDebug() &lt;&lt; ""Current Latitude : "" &lt;&lt; currentLocation.latitude();
          qDebug() &lt;&lt; ""Current Longitude : "" &lt;&lt; currentLocation.longitude();
          updateDeviceCordinate(currentLocation);
      }
}
</code></pre>

<p>please let me know,</p>

<ol>
<li>Is there any way where i can specify the GPS update interval in
terms of Time and Distance which can reduce CPU active time.</li>
<li>Also I want to know is there any direct way where i can get device
location directly using QT API without any(QT Signal) callback
function quickly.</li>
</ol>

<p><strong>Note :</strong> qml based location update may not be helpful as we want to implement functionality in C++ code.</p>",android|c++|ios|qt|gps,580908,Swapnil,no
Proper way of using CLLocationManager (to start/stop updating user location),"<p>I have a <code>UIView</code> with an <code>MKMapView</code>, in a UIViewController, which appears only when user taps a button.</p>

<p>The process is as follows:</p>

<ul>
<li>A <code>CLLocationManager</code> object is declared as private member in the <code>header</code> file.</li>
<li>A <code>UIView</code> with an <code>MKMapView</code> is presented (initially the frame is outside bounds. Is moved to within view bounds on user's action, WITHIN THE SAME <code>viewController</code>).</li>
<li><p>It is initialized:</p>

<pre><code>locationManager = [[CLLocationManager alloc]  init];
locationManager.distanceFilter = kCLDistanceFilterNone; // whenever we move
locationManager.desiredAccuracy = kCLLocationAccuracyBest; // 100 m
[locationManager startUpdatingLocation];
CLLocation *location = [locationManager location];
CLLocationCoordinate2D coordinate = [location coordinate];

MKCoordinateSpan span = MKCoordinateSpanMake(0.04, 0.04);
MKCoordinateRegion region = MKCoordinateRegionMake(coordinate, span);
mapView.showsUserLocation = YES;
[mapView setRegion:region animated:YES];
</code></pre></li>
<li><p>Nearby locations are fetched using <code>Foursquare API</code></p></li>
</ul>

<p>Now, I wish to stop the location lock, when the <code>view</code> is removed from visible bounds.
I tried it with <code>stopUdatingUserLocation</code>. I also <code>released</code> the <code>locationManager</code>, but the GPS lock icon is persistent in the <code>statusBar</code>. As I understand, continuous GPS lock drains the battery, and I would like to stop that. How would I go about it ?</p>",iphone|ios|mkmapview|cllocationmanager,2082856,n00bProgrammer,no
how do android monitor usage applications work,"<p>I want to write an application that logs the usage of other applications on my phone.<br>
So for example I get the times I have entered Facebook. </p>

<p>I understand there is no way to get a broadcastreceiver to wake up every time Facebook starts.
Another way is to have a service that always runs in the background and checks for running apps and goes to sleep every second or so, but I guess this will drain my battery faster.  </p>

<p>So what is the best way this could be done? is there some kind of log I can look at? </p>",android|monitor|usage-statistics,976281,yonigo,yes
Energy consumption of smartphone components,"<p>I'm looking for a list of all the components and their power drainage on an up-to-date smart phone.</p>

<ul>
<li>Accelerometer, gyroscope, magnetometer, etc.</li>
<li>Display</li>
<li>WiFi</li>
<li>Bluetooth</li>
<li>GPS</li>
<li>CPU</li>
<li>Camera</li>
<li>Microphone</li>
<li>etc.</li>
</ul>

<p>Preferably in mA so it can be easily compared to the battery's capacity (usually specified in mAh). </p>

<p>The Sensor's power is actually available via the SDK and can also easily figured out for most devices on <a href=""http://www.androidfragmentation.com"" rel=""noreferrer"">AndroidFragmentation</a>. However what I'm looking for is <em>comparable</em> data for the other hardware components to consider their efficency.</p>

<p>Bonus: Will a request for less frequent updates of a Sensor decrease energy consumption of the Sensor, as it returns only one value for <code>getPower()</code>?</p>",android|smartphone|energy,202526,eL.,no
Android app not listed in Battery Usage,"<p>I was given a question and I have a hard time finding the correct answer.
Let's say that I have an app called MyApp and when this app is installed it drains the battery life really fast, I know that because when I uninstall the app the battery life is significantly improved.
When the app is installed I can't see it in the Android Build-in Battery Usage Stats in settings app which means that it's not the app that's draining the battery life.</p>

<p>What could be the problem?</p>

<p>I thought that the problem is that maybe the app is activating background services of Android, but was told that when I activate a service from an app, it is registered under the app's name and it should be listed in the battery usage.
I can't seem to find any information describing the problem I was given.</p>

<p>Any ideas guys?</p>",android|performance|battery,2505350,OmriYaHoo,yes
Making code run continuously,"<p>I'm trying to make an app that does certain tasks according to a certain battery level (say a notification when battery level reaches 10%). 
The problem is when i launch it the app just checks the event once instead of continuous monitoring.
e.g. (say i launched the app when battery was 11%. Since the notification is scheduled at 10% it wont give any notification. It just check the event a single time instead of continuously monitoring  i.e. when battery drains to 10% while running the app,nothing happens)
What is the possible solution to make the code run continuously ?</p>",android|batterymanager,6669021,codenamered5,yes
Android tablet kiosk development,"<p>I am trying to develop a kiosk application on Android.<br>
I am facing two challenges.</p>

<hr>

<ol>
<li>Once the tablet getting off due to a battery drain it is not turning on even after the battery reached 100%. Is there a workaround for this? I have seen regarding editing some files in <code>/system/init</code> of Android after rooting. But I have not seen any file related to battery or charging. I am using 4.1 and higher</li>
</ol>

<hr>

<ol start=""2"">
<li>I am experiencing a problem of battery draining. As it continuously keep display on, battery drains gradually even if the charger is connected. </li>
</ol>

<p>Has anybody came across similar problems and find any solutions ?</p>

<p>Is there android devices available which , power on automatically after connecting wall charger ?
Is there tablets that doesn't have battery and directly works from charger connection ?</p>

<p>Please provide your suggestions.</p>",android|kiosk,5189280,aivknow tech,yes
Caching Bitmaps in a Appwidget,"<p>I am building an AppWidget which I'm hoping to be skinnable by allowing the user to download skins from a central repository.</p>

<p>I am copying the pngs that make up a skin into the widget's private directory.  I was loading the bitmaps from this directory and making Bitmaps that I stored in a static HashMap in order to avoid loading them each time.</p>

<p>I've realised that this will not work as the HashMap is garbage collected at some point (several hours later typically).  I realise it would be possible to load the Bitmaps from disk each time, but this will most likely be slow and drain the battery.</p>

<p>Is there a better way of caching this kind of data?</p>",android|caching|bitmap|android-widget|android-appwidget,318381,Ash McConnell,no
Android geofencing API BroadcastReceiver not triggered,"<p>I am trying to use the geofencing api from the google play services but I can't manage to get my broadcast receiver trigger its <code>onReceive()</code> method.</p>

<p>It looks like I respect everything that is needed to make it work but I get no transition event.</p>

<ul>
<li>I include the google play services in my dependencies</li>
<li>I request the <code>ACCESS_FINE_LOCATION</code> permission</li>
<li>I register my <code>BroadcastReceiver</code> with the exported value set to ""true"" (some say that it is needed) in my Manifest</li>
<li>I add a big geofence at the exact location where I am (I validated it with Google Maps on my cellphone) with both transition types and no expiration</li>
<li>I tried with a precise mock location in the middle of the geofence, and another out of the geofence 10 seconds later (and I made sure the <code>ACCESS_MOCK_LOCATION</code> persmission was present)</li>
<li>I verified that my cellphone's location was on and its mode was set to high accuracy</li>
<li>I verified the internet connection</li>
<li>I tried with and without disconnecting the LocationClient after adding the geofence</li>
</ul>

<p>But still, I get a successful <code>onAddGeofencesResult()</code> callback, but no <code>onReceive()</code> callback. I tried it with a Nexus 5 and a Nexus 7 and both fails to trigger the geofence transitions.</p>

<p>I also tried the sample on <a href=""https://developer.android.com/training/location/geofencing.html"">https://developer.android.com/training/location/geofencing.html</a>, but its behavior was identical.</p>

<p>Here is my <code>BroadcastReceiver</code> class :</p>

<pre><code>public class GeofencesReceiver extends BroadcastReceiver implements ConnectionCallbacks, OnConnectionFailedListener, OnAddGeofencesResultListener {
    private final static String TAG = ""GeofencesReceiver"";

    private Context context = null;
    private LocationClient locationClient = null;

    /**
     * An empty constructor is needed by the manifest.
     */
    @SuppressWarnings(""unused"")
    public GeofencesReceiver(){}

    public GeofencesReceiver(Context context){
        this.context = context;
        locationClient = new LocationClient(context, this, this);
        locationClient.connect();
    }

    @Override
    public void onConnected(Bundle bundle) {
        new Thread(new Runnable() {
            @Override
            public void run() {
                List&lt;Geofence&gt; geofences = getGeofences();
                if(geofences.size() &gt; 0){
                    Intent geofenceBroadcastReceiverIntent = new Intent(context, GeofencesReceiver.class);
                    PendingIntent pi = PendingIntent.getBroadcast(context, 0, geofenceBroadcastReceiverIntent, PendingIntent.FLAG_UPDATE_CURRENT);
                    locationClient.addGeofences(geofences, pi, GeofencesReceiver.this);
                }else
                    Log.w(TAG, ""No GPS zone found"");
            }
        }).start();
    }

    private List&lt;Geofence&gt; getGeofences(){
        Vector&lt;Geofence&gt; geofences = new Vector&lt;Geofence&gt;();
        Geofence geofence = new Geofence.Builder()
                    .setRequestId(""1"")
                    .setTransitionTypes(Geofence.GEOFENCE_TRANSITION_ENTER | Geofence.GEOFENCE_TRANSITION_EXIT)
                    .setCircularRegion(45.2676018, -72.1572185, 100)
                    .setExpirationDuration(Geofence.NEVER_EXPIRE)
                    .build();
        geofences.add(geofence);
        return geofences;
    }

    @Override
    public void onDisconnected() {
        Log.d(TAG, ""onDisconnected"");
    }

    @Override
    public void onAddGeofencesResult(int i, String[] strings) {
        if(i != LocationStatusCodes.SUCCESS)
            Log.e(TAG, ""Failed to add geofences"");
        else
            Log.d(TAG, ""Geofences successfully added"");
        locationClient.disconnect();
    }

    @Override
    public void onConnectionFailed(ConnectionResult connectionResult) {
        Log.e(TAG, ""onConnectionFailed"");
    }

    @Override
    public void onReceive(Context context, Intent intent) {
        Log.d(TAG, ""onReceive"");
        if(LocationClient.hasError(intent)){
            int errorCode = LocationClient.getErrorCode(intent);
            Log.e(TAG, ""Location Services error: "" + Integer.toString(errorCode));
            return;
        }
        int transitionType = LocationClient.getGeofenceTransition(intent);
        if(transitionType == Geofence.GEOFENCE_TRANSITION_ENTER || transitionType == Geofence.GEOFENCE_TRANSITION_EXIT) {
            List&lt;Geofence&gt; triggerList = LocationClient.getTriggeringGeofences(intent);
            for(Geofence geofence : triggerList){
                Log.d(TAG, (transitionType == Geofence.GEOFENCE_TRANSITION_ENTER ? ""Entering"" : ""Exiting"") + "" GPS zone "" + geofence.getRequestId());
            }
        }else{
            Log.e(TAG, ""Geofence transition error: "" + transitionType);
        }
    }
}
</code></pre>

<p>In my Manifest, I have the following lines (not in that structure)</p>

<pre><code>&lt;uses-permission android:name=""android.permission.ACCESS_FINE_LOCATION"" /&gt;
&lt;receiver android:name=""novom.anyware.anywaresdk.GeofencesReceiver"" android:exported=""true"" /&gt;
&lt;meta-data android:name=""com.google.android.gms.version"" android:value=""4323000"" /&gt;
</code></pre>

<p>And in my build.gradle file, I include the services like this</p>

<pre><code>dependencies {
    compile 'com.google.android.gms:play-services:4.3.23'
}
</code></pre>

<p>I spent the whole day trying to figure out why it doesn't work... From Logcat I've found those lines, but I am not sure if they are related to the problem, since I find no post on Google about those errors with Geofencing.</p>

<pre><code>04-07 09:01:14.631    1160-1319/? I/GCoreUlr﹕ Successfully inserted location
04-07 09:01:14.631    1160-1319/? I/GCoreUlr﹕ Not calling LocationReportingService, hasMoved: true, elapsed millis: 580166, request: Phone

04-07 09:02:16.481    1160-1319/? I/GCoreUlr﹕ Successfully inserted location
04-07 09:02:16.501    1160-1319/? I/GCoreUlr﹕ Starting service, intent=Intent { cmp=com.google.android.gms/com.google.android.location.reporting.LocationReportingService }, extras=null
04-07 09:02:16.571    1210-1252/? W/GLSUser﹕ GoogleAccountDataService.getToken()
04-07 09:02:16.601    1160-3780/? I/qtaguid﹕ Failed write_ctrl(u 69) res=-1 errno=22
04-07 09:02:16.601    1160-3780/? I/qtaguid﹕ Untagging socket 69 failed errno=-22
04-07 09:02:16.601    1160-3780/? W/NetworkManagementSocketTagger﹕ untagSocket(69) failed with errno -22
04-07 09:02:16.601    1160-3780/? I/imp﹕ I/O exception (org.apache.http.NoHttpResponseException) caught when processing request: The target server failed to respond
04-07 09:02:16.601    1160-3780/? I/imp﹕ Retrying request
04-07 09:02:17.501    1160-6156/? I/GCoreUlr﹕ Starting service, intent=Intent { act=com.google.android.location.reporting.ACTION_UPDATE_ACTIVE_STATE cmp=com.google.android.gms/com.google.android.location.reporting.service.DispatchingService }, extras=null
04-07 09:02:17.511    1160-6156/? I/GCoreUlr﹕ Batch Location Update succeeded for account account#7#
04-07 09:02:17.571    1160-1319/? I/GCoreUlr﹕ Ensuring that reporting is active for [account#7#]
</code></pre>

<p>If nobody can help me, I fear I'm going to implement my own geofencing algorithm with the LocationManager registered with the GPS_PROVIDER, and this is going to drain my users' battery...</p>",android|broadcastreceiver|google-play-services|geofencing|location-client,1084822,Raphael Royer-Rivard,no
Xamarin Forms Debug Battery Drain,"<p>For the past 6 months i developed a XF app for a client.
Now we run into the problem that the app is heating up the phone really fast and it drains battery super fast.
Is there any good way to debug what in my app is causing this?</p>

<p>Some specialties about my app:
It accesses the camera most of the time the app is running.
It syncs small data with a webservice ever 15 seconds (2 Calls done with System.Net.Http.HttpClient)</p>

<p>I'm working with Visual studio</p>",c#|debugging|xamarin|xamarin.forms,2878603,Aytee,yes
Identify if point is in the polygon,"<p>As per my requirement, I am drawing polygons on google map shown in the image below.(using maps v2) <img src=""https://i.stack.imgur.com/4zOx1.png"" alt=""enter image description here""></p>

<p>Now I need to show an alert when user enters that particular polygons. </p>

<p>How to identify if my current location is with in the polygon. 
(Need optimized way without draining battery) </p>

<p>Thanks in advance.  </p>",android|google-maps|geolocation|android-maps-v2|polygons,1923399,Supriya,no
Running service for android calendar changes?,"<p>My goal is to write an app that listens for changes in android calendar. It doesn't seem like there's support for broadcasts in this case, but what's needed is a <code>ContentObserver</code>.</p>

<p>If I want a <code>ContentObserver</code> to run indefinitely, it requires a thread to keep running when the app is closed (ultimately I want it to start on mobile boot). </p>

<p>Is a service a good solution for this? Or is it bad having a service running all the time? Will it drain a lot of battery, even though all I will be doing is keeping a <code>ContentObserver</code> registered? </p>

<p>As far as I can see, my only alternative is to use periodical polling, but I would rather not do that. </p>",android|android-service|android-contentprovider|contentobserver,3357751,user3357751,no
Is it bad practice to getLastKnownLocation any time someone moves a pin on the map?,"<p>I have implemented GoogleMap.OnMyLocationChangeListener and attached to my map object OnMyLocationChangeListener so that whenever any movement is done on the map, I can receive feedback of these changes in the callback method</p>

<pre><code>@Override
    public void onMyLocationChange(android.location.Location location) {
}
</code></pre>

<p>I was reading the Android Developers strategies documentation  (<a href=""https://developer.android.com/guide/topics/location/strategies.html"" rel=""nofollow"">https://developer.android.com/guide/topics/location/strategies.html</a>) and learned that there is a function to determine whether one location reading is better than the current location fix</p>

<p>What I decided to do was check for a better location with every map change. In order to do this, I am passing in the lastKnownGPSLocation and the location object from onMyLocationChange callback. From my knowledge, calling getLastKnownLocation can be expensive and battery draining. This is the idea of what I am doing.</p>

<pre><code>if (isBetterLocation(mLocationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER), location) {
    // update my current lat/long
}
</code></pre>

<p>And the function for isBetterLocation() is the following:</p>

<pre><code>/** Determines whether one Location reading is better than the current Location fix
  * @param location  The new Location that you want to evaluate
  * @param currentBestLocation  The current Location fix, to which you want to compare the new one
  */
protected boolean isBetterLocation(Location location, Location currentBestLocation) {
    if (currentBestLocation == null) {
        // A new location is always better than no location
        return true;
    }

    // Check whether the new location fix is newer or older
    long timeDelta = location.getTime() - currentBestLocation.getTime();
    boolean isSignificantlyNewer = timeDelta &gt; TWO_MINUTES;
    boolean isSignificantlyOlder = timeDelta &lt; -TWO_MINUTES;
    boolean isNewer = timeDelta &gt; 0;

    // If it's been more than two minutes since the current location, use the new location
    // because the user has likely moved
    if (isSignificantlyNewer) {
        return true;
    // If the new location is more than two minutes older, it must be worse
    } else if (isSignificantlyOlder) {
        return false;
    }

    // Check whether the new location fix is more or less accurate
    int accuracyDelta = (int) (location.getAccuracy() - currentBestLocation.getAccuracy());
    boolean isLessAccurate = accuracyDelta &gt; 0;
    boolean isMoreAccurate = accuracyDelta &lt; 0;
    boolean isSignificantlyLessAccurate = accuracyDelta &gt; 200;

    // Check if the old and new location are from the same provider
    boolean isFromSameProvider = isSameProvider(location.getProvider(),
            currentBestLocation.getProvider());

    // Determine location quality using a combination of timeliness and accuracy
    if (isMoreAccurate) {
        return true;
    } else if (isNewer &amp;&amp; !isLessAccurate) {
        return true;
    } else if (isNewer &amp;&amp; !isSignificantlyLessAccurate &amp;&amp; isFromSameProvider) {
        return true;
    }
    return false;
}

/** Checks whether two providers are the same */
private boolean isSameProvider(String provider1, String provider2) {
    if (provider1 == null) {
      return provider2 == null;
    }
    return provider1.equals(provider2);
}
</code></pre>

<p>Is this how this function is intended to be used? I have noticed that other people use this as a Service. Thanks in advance.</p>",android|google-maps|gps,2127950,portfoliobuilder,no
stemming of set of tokens using r,"<p>I have tried using snowballc stemmer for stemming but it produces different output for same queries</p>

<pre><code>wordStem(""waiting"",language = ""porter"")
## [1] wait
</code></pre>

<p>The above word is correctly stemmed but whenever i give a set of tokens as an input</p>

<pre><code>c(""htc"", ""makes"", ""bad"", ""cheap"", ""phones"", ""dont"", ""buy"", ""cheap"", 
""phones"", ""battery"", ""jock"", ""taiwanese"", ""buying"", ""htc"", ""desire"", 
""phone"", ""htc"", ""mobile"", ""specifications"", ""battery"", ""pick"", 
""low"", ""light"", ""camera"", ""experience"", ""htc"", ""e8"", ""desire"", 
""10"", ""pro"", ""phone"", ""performance"", ""excellent"", ""camera"", ""nice"", 
""model"", ""cam"", ""battery"", ""realy"", ""hand"", ""set"", ""phone"", ""coming"", 
""phone"", ""price"", ""range"", ""average"", ""performer"", ""worst"", ""battery"", 
""features"", ""goooood"", ""htc"", ""real"", ""hero"", ""amazing"", ""x9"", 
""features"", ""battery"", ""poor"", ""camera"", ""battery"", ""life"", ""x9"", 
""e9"", ""worry"", ""phone"", ""processor"", ""happy"", ""battery"", ""life"", 
""drain"", ""faster"", ""buy"", ""product"", ""heating"", ""issue"", ""concern"", 
""front"", ""facing"", ""camera"", ""awful"", ""htc"", ""phones"", ""heats"", 
""quickly"", ""pity"", ""phone"", ""beautiful"", ""potential"", ""stylish"", 
""htc"", ""fan"", ""wise"", ""ofcourse"", ""htc"", ""overpriced"", ""compared"", 
""xiaomi"", ""redmi"", ""note"", ""3"", ""design"", ""fingerprint"", ""reader"", 
""capacitive"", ""buttons"", ""screen"", ""iam"", ""100"", ""satisfied"", 
""phone"", ""brought"", ""2014"", ""smoothly"", ""touch"", ""battery"", ""backup"", 
""buying"", ""phone"", ""total"", ""waste"", ""money"", ""nice"", ""phone"", 
""price"", ""range"", ""device"", ""front"", ""facing"", ""camera"", ""awful"", 
""htc"", ""phones"", ""heats"", ""quickly"", ""pity"", ""phone"", ""beautiful"", 
""potential"", ""stylish"", ""htc"", ""fan"", ""wise"", ""ofcourse"", ""htc"", 
""overpriced"", ""compared"", ""xiaomi"", ""redmi"", ""note"", ""3"", ""design"", 
""fingerprint"", ""reader"", ""capacitive"", ""buttons"", ""screen"", ""iam"", 
""100"", ""satisfied"", ""phone"", ""brought"", ""2014"", ""htc"", ""desire"", 
""eye"", ""happy"", ""phone"", ""phone"", ""appearance"", ""nice"", ""mobile"", 
""plz"", ""update"", ""price"", ""phone"", ""meant"", ""performance"", ""camera"", 
""htc"", ""nice"", ""mobiles"", ""waiting"", ""mobile"", ""htc"", ""10"", ""pro"", 
""nice"", ""camera"", ""beautiful"", ""design"", ""fingerprint"", ""sensor"", 
""overheating"", ""issue"", ""typical"", ""htc"", ""crappy"", ""specs"", ""poo"")
</code></pre>

<p>it outputs the words with no change</p>

<pre><code>wordStem(htcdtokensstop,language = ""porter"")
##   [1] ""htc""            ""makes""          ""bad""            ""cheap""          ""phones""         ""dont""           ""buy""            ""cheap""         
##   [9] ""phones""         ""battery""        ""jock""           ""taiwanese""      ""buying""         ""htc""            ""desire""         ""phone""         
##  [17] ""htc""            ""mobile""         ""specifications"" ""battery""        ""pick""           ""low""            ""light""          ""camera""        
##  [25] ""experience""     ""htc""            ""e8""             ""desire""         ""10""             ""pro""            ""phone""          ""performance""   
##  [33] ""excellent""      ""camera""         ""nice""           ""model""          ""cam""            ""battery""        ""realy""          ""hand""          
##  [41] ""set""            ""phone""          ""coming""         ""phone""          ""price""          ""range""          ""average""        ""performer""     
##  [49] ""worst""          ""battery""        ""features""       ""goooood""        ""htc""            ""real""           ""hero""           ""amazing""       
##  [57] ""x9""             ""features""       ""battery""        ""poor""           ""camera""         ""battery""        ""life""           ""x9""            
##  [65] ""e9""             ""worry""          ""phone""          ""processor""      ""happy""          ""battery""        ""life""           ""drain""         
##  [73] ""faster""         ""buy""            ""product""        ""heating""        ""issue""          ""concern""        ""front""          ""facing""        
##  [81] ""camera""         ""awful""          ""htc""            ""phones""         ""heats""          ""quickly""        ""pity""           ""phone""         
##  [89] ""beautiful""      ""potential""      ""stylish""        ""htc""            ""fan""            ""wise""           ""ofcourse""       ""htc""           
##  [97] ""overpriced""     ""compared""       ""xiaomi""         ""redmi""          ""note""           ""3""              ""design""         ""fingerprint""   
## [105] ""reader""         ""capacitive""     ""buttons""        ""screen""         ""iam""            ""100""            ""satisfied""      ""phone""         
## [113] ""brought""        ""2014""           ""smoothly""       ""touch""          ""battery""        ""backup""         ""buying""         ""phone""         
## [121] ""total""          ""waste""          ""money""          ""nice""           ""phone""          ""price""          ""range""          ""device""        
## [129] ""front""          ""facing""         ""camera""         ""awful""          ""htc""            ""phones""         ""heats""          ""quickly""       
## [137] ""pity""           ""phone""          ""beautiful""      ""potential""      ""stylish""        ""htc""            ""fan""            ""wise""          
## [145] ""ofcourse""       ""htc""            ""overpriced""     ""compared""       ""xiaomi""         ""redmi""          ""note""           ""3""             
## [153] ""design""         ""fingerprint""    ""reader""         ""capacitive""     ""buttons""        ""screen""         ""iam""            ""100""           
## [161] ""satisfied""      ""phone""          ""brought""        ""2014""           ""htc""            ""desire""         ""eye""            ""happy""         
## [169] ""phone""          ""phone""          ""appearance""     ""nice""           ""mobile""         ""plz""            ""update""         ""price""         
## [177] ""phone""          ""meant""          ""performance""    ""camera""         ""htc""            ""nice""           ""mobiles""        ""waiting""       
## [185] ""mobile""         ""htc""            ""10""             ""pro""            ""nice""           ""camera""         ""beautiful""      ""design""        
## [193] ""fingerprint""    ""sensor""         ""overheating""    ""issue""          ""typical""        ""htc""            ""crappy""         ""specs""         
## [201] ""poo""           
</code></pre>

<p>It would be helpful if there is a way to process(do stemming) all the words in the tokens.</p>",r|stemming|snowball,5511913,p.k,yes
How to avoid battery drainage if the app is using GPS even when the app is in background,"<p>I have to build an app that will have the following features :-</p>

<ol>
<li>A way to add users and their data in a database. (which will be parse)</li>
<li>The app will access the location updates of the user (say after every 10 minutes or when the user has moved a significant distance). This will be done even when the app is in background. These locations will then be updated to the parse database as and when the new locations are received.</li>
</ol>

<p>I am a beginner, so any suggestion to how i should approach this will be appreciated. Most importantly, i have the following problems :-</p>

<ol>
<li><p>The app will also run in the background and will regularly use GPS. This will drain a lot of battery. How can i avoid this? (The precision of the locations are important)</p></li>
<li><p>The app will regularly update these locations to the parse database and will have to make regular API requests which will add to the cost. How can i minimise this?</p></li>
</ol>",ios|swift|parsing|core-data|geolocation,5197835,shivamkaushik,no
android:I can not stop GPS update,"<p>My app find out current location using <code>GPS</code>. It is working fine in outdoor. But where <code>GPS</code> is not available or poor it is trying to get update again and again and it drains battery. So i want to stop update when <code>GPS</code> is poor or unavailable. You may suggest to use </p>

<p><code>lm.removeUpdates(locationlistenerforGPS);</code> </p>

<p>It is working fine when <code>GPS</code> is available not in indoor. I like to stop update when <code>GPS</code> is poor or unavailable.</p>

<p>my code is</p>

<pre><code>LocationManager lm = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
LocationListener locationlistenerforGPS = new mylocationlistenerGPS();
lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, locationlistenerforGPS);
</code></pre>

<p>My locationlistenerGPS() function is</p>

<pre><code> private class mylocationlistenerGPS implements LocationListener {
  @Override
  public void onLocationChanged(Location location) {
      counterGPS++;
      if (location != null) {
      Log.d(""LOCATION CHANGED"", location.getLatitude() + "" "");
      Log.d(""LOCATION CHANGED"", location.getLongitude() + "" "");
      Toast.makeText(LocationActivity.this,""latitude: ""+
          location.getLatitude() + ""longitude: "" + location.getLongitude()
          + "" Provider:"" + location.getProvider() + "" Accuracy:"" + location.getAccuracy(),
          Toast.LENGTH_LONG).show();
      }

  }
  @Override
  public void onProviderDisabled(String provider) {
  }
  @Override
  public void onProviderEnabled(String provider) {
  }
  @Override
  public void onStatusChanged(String provider, int status, Bundle extras) {
  }
  }
</code></pre>

<p>Thank you very much for any kind of assistance.</p>",android|gps|location,1432009,Humayun Kabir,yes
Android - Are there query-able services that already poll for GPS location?,"<p>I have some ideas for an app that checks your location about every 5 minutes or less. Maybe every 1 minute, I'm not sure yet. Obviously I can simply create a service that checks what the phone's GPS location is every N minutes. But that is a potential drain on the battery.</p>

<p>What I was wondering, are there any internal services that are already running in the Android OS that are already polling for the phones GPS location? That way perhaps I can simply ask those services for what the location is instead of making the GPS location request myself, in order to save on battery usage.</p>",java|android|gps,172350,Jake Wilson,no
BroadcastReceiver with a Listener drains battery when not in use,"<p>I have a receiver which waits for <code>TelephonyManager.ACTION_PHONE_STATE_CHANGED</code>:</p>

<pre><code>public void onReceive(Context context, Intent intent) {
String theAction = intent.getAction();  
if (theAction != null &amp;&amp; theAction.equals(TelephonyManager.ACTION_PHONE_STATE_CHANGED)) {
        CONTEXT = context;
        startListening();   
}
</code></pre>

<p>When it gets it, I register the listener (for orientation sensor):</p>

<pre><code>public void startListening() {  
    sensorManager = (SensorManager) CONTEXT.getSystemService(Context.SENSOR_SERVICE);
    List&lt;Sensor&gt; sensors = sensorManager.getSensorList(Sensor.TYPE_ORIENTATION);
    if (sensors.size() &gt; 0) {
        sensor = sensors.get(0);
        running = sensorManager.registerListener(sensorEventListener, sensor, SensorManager.SENSOR_DELAY_FASTEST);
    }
}   
</code></pre>

<p>And then, in the Listener's <code>onSensorChanged()</code> method:</p>

<pre><code>public void onSensorChanged(SensorEvent event) {
    if(running) {   
        sensorManager.unregisterListener(this);
        // do some not significant stuff here
    }
</code></pre>

<p>And now the problem: I get a phone call, receiver starts, then listener starts and everything works as designed. But, later on, when I look at the battery stats, my app is listed as the one with 2-3% of drain. <em>And</em> this percentage is increasing <em>even though</em> there are no calls - hence the receiver <em>is not</em> working.</p>

<p>Where does this battery drain come from? The activity which starts the receiver is not working (and it is single checkbox anyway). I suppose, that the listener may not get unregistered by <code>sensorManager.unregisterListener(this);</code>, but it shoudl work - I unregister the listener when it received the first event, it makes sense.</p>

<p>How could I solve the problem?</p>",java|android|broadcastreceiver|battery,828133,jacek,no
SensorEventListener doesn't get unregistered with unregisterListener() method,"<p>I have very simple Android app: in activity I have a button and I start/stop the OrientationListener. However, after unregistering it, in ddms I can still see the thread <em>android.hardware.SensorManager$SensorThread] (Running)</em>. </p>

<p>The registration code:</p>

<pre><code>sensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
List&lt;Sensor&gt; sensors = sensorManager.getSensorList(Sensor.TYPE_ORIENTATION);
if (sensors.size() &gt; 0)
{
    sensor = sensors.get(0);
    running = sensorManager.registerListener(sensorEventListener, sensor, SensorManager.SENSOR_DELAY_FASTEST);
}
</code></pre>

<p>and unregistration:</p>

<pre><code>try
{
    if (sensorManager != null &amp;&amp; sensorEventListener != null)
    {
        sensorManager.unregisterListener(sensorEventListener,sensor);
        running = false;
    }
}
catch (Exception e)
{
    Log.w(TAG, e.getMessage());
}
</code></pre>

<p>The <code>unregisterListener()</code> method does get executed, however it doesn't kill the sensors thread very often, which keeps running and draining the battery. After few hours my app is listed with 20-30% battery drain. How is that possible? How can I make sure, that the sensor gets unregistered? I don't get any exceptions nor any errors in the logcat. I tried running the listener in the Service - same thing.</p>",java|android|listener|sensors,828133,jacek,no
TurfJS: Efficiently locate the nearest point on a line string,"<p>Edit:
The quicksort algorithm isn't actually working...</p>
<p><a href=""https://codesandbox.io/s/busy-wilbur-4vjmr5?file=/src/index.js"" rel=""nofollow noreferrer"">CODESANDBOX</a></p>
<p><strong>SITUATION</strong></p>
<p>I have a line string with up to 2000 points. I am trying to find the nearest point on the line from the user's location. This operation is executed roughly every 5 seconds and failing to optimise it would unnecessarily drain the users battery.</p>
<p>The <a href=""https://github.com/Turfjs/turf/blob/f62ba326cba17d9ebfb29ba8671107f937a89442/packages/turf-nearest-point-on-line/index.ts#L58"" rel=""nofollow noreferrer"">source code</a> shows that the <code>distance</code> operation is conducted on every point on the line string - not good for my users.</p>
<p>I would like to implement a quick-sort style algorithm to get the nearest point and reduce the number of the operations. The example below is working quite well and produces a point on the line with far fewer operations (for a list of 1700 points it takes 14 operations to locate the closest point).</p>
<p><strong>PROBLEM</strong></p>
<p>I cannot determine an elegant way to track the index of the result. Once I have the nearest point, I do not want to have to search the original list again to find it's index.</p>
<p>first operation - 0 | median</p>
<p>second - fHalf (0 | median of fHalf) | sHalf (median of list | median of sHalf)</p>
<p>third - at this point it becomes a mess to track</p>
<p>What I have so far:</p>
<pre class=""lang-js prettyprint-override""><code>import distance from &quot;@turf/distance&quot;;
import { point } from &quot;@turf/helpers&quot;;

const user = point([-77.037076, 38.884017]);

function getMedian(list) {
  return Math.ceil(list.length / 2);
}

function getHalves(list) {
  const median = getMedian(list);
  const firstHalf = list.slice(0, median);
  const secondHalf = list.slice(-median);
  return { firstHalf, secondHalf };
}

function getClosest(list) {
  const to = point(list[0]);
  const meters = distance(user, to, { units: &quot;meters&quot; });
  return meters;
}

let operations = 0; // used in development to track operations

function selectHalf(list) {
  operations += 1;
  const { firstHalf, secondHalf } = getHalves(list);
  const firstDistance = getClosest(firstHalf);
  const secondDistance = getClosest(secondHalf);
  const nextList = firstDistance &lt; secondDistance ? firstHalf : secondHalf;
  if (list.length === 1)
    console.log(&quot;operations:&quot;, operations, &quot;closest point:&quot;, nextList);
  else selectHalf(nextList);
}

const morePoints = `-37.0467378013181,145.1634433308106
-37.04674949407303,145.1634394751351
-37.04676521014147,145.1634369605642
-37.04678021374815,145.1634352003645
-37.04679207414114,145.1634343621742
-37.04680510800057,145.1634334401648
// Full list is available in the codesandbox link below
`
  .split(&quot;\n&quot;)
  .map((p) =&gt; p.split(&quot;,&quot;).map((n) =&gt; parseFloat(n)));

selectHalf(morePoints);

</code></pre>",javascript|geolocation|coordinates|geo|turfjs,9221698,Alex Mckay,yes
"Why does my Android service get restarted when the process is killed, even though I used START_NOT_STICKY?","<p>My app uses a pattern where I start a service with <a href=""http://developer.android.com/reference/android/content/Context.html#startService%28android.content.Intent%29"" rel=""noreferrer"">Context#startService()</a> as well as bind to it with <a href=""http://developer.android.com/reference/android/content/Context.html#bindService%28android.content.Intent,%20android.content.ServiceConnection,%20int%29"" rel=""noreferrer"">Context#bindService()</a>.  This is so that I can control the lifetime of the service independently from whether any clients are currently bound to it.  However, I noticed recently that whenever my app is killed by the system, it soon restarts any services that were running.  At this point the service will never be told to stop, and this is causing battery drain whenever it happens.  Here's a minimal example:</p>

<p>I found someone with a similar issue <a href=""https://groups.google.com/forum/?fromgroups=#!topic/android-developers/x4pYZcXeKsw"" rel=""noreferrer"">here</a>, but it wasn't ever diagnosed or solved.</p>

<p>Service:</p>

<pre><code>@Override
public void onCreate() {
    Toast.makeText(this, ""onCreate"", Toast.LENGTH_LONG).show();
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    return START_NOT_STICKY;
}

@Override
public IBinder onBind(Intent intent) {
    return new Binder();
}
</code></pre>

<p>Activity:</p>

<pre><code>@Override
protected void onStart() {
    super.onStart();
    Intent service = new Intent(this, BoundService.class);
    startService(service);
    bindService(service, mServiceConnection, 0);
}

@Override
protected void onStop() {
    unbindService(mServiceConnection);
    Toast.makeText(this, ""unbindService"", Toast.LENGTH_SHORT).show();
    super.onStop();
}
</code></pre>

<p>To test it, I launched the app, which started the service and bound to it.  Then I backed out of the app, which unbinds (but leaves the service running).  Then I did</p>

<pre><code>$ adb shell am kill com.tavianator.servicerestart
</code></pre>

<p>and sure enough, 5 seconds later, the ""onCreate"" toast appears, indicating that the service started again.  Logcat shows this:</p>

<pre><code>$ adb logcat | grep BoundService
W/ActivityManager(  306): Scheduling restart of crashed service com.tavianator.servicerestart/.BoundService in 5000ms
I/ActivityManager(  306): Start proc com.tavianator.servicerestart for service com.tavianator.servicerestart/.BoundService: pid=20900 uid=10096 gids={1028}
</code></pre>

<p>If I replace the startService() pattern with BIND_AUTO_CREATE, the problem doesn't occur (even if I crash the app while it's still bound to the service).  It also works if I never bind to the service.  But the combination of start, bind, and unbind seems to never let my service die.</p>

<p>Using dumpsys before killing the app shows this:</p>

<pre><code>$ adb shell dumpsys activity services com.tavianator.servicerestart
ACTIVITY MANAGER SERVICES (dumpsys activity services)
  Active services:
  * ServiceRecord{43099410 com.tavianator.servicerestart/.BoundService}
    intent={cmp=com.tavianator.servicerestart/.BoundService}
    packageName=com.tavianator.servicerestart
    processName=com.tavianator.servicerestart
    baseDir=/data/app/com.tavianator.servicerestart-2.apk
    dataDir=/data/data/com.tavianator.servicerestart
    app=ProcessRecord{424fb5c8 20473:com.tavianator.servicerestart/u0a96}
    createTime=-20s825ms lastActivity=-20s825ms
    executingStart=-5s0ms restartTime=-20s825ms
    startRequested=true stopIfKilled=true callStart=true lastStartId=1
    Bindings:
    * IntentBindRecord{42e5e7c0}:
      intent={cmp=com.tavianator.servicerestart/.BoundService}
      binder=android.os.BinderProxy@42aee778
      requested=true received=true hasBound=false doRebind=false
</code></pre>",android|android-service,502399,Tavian Barnes,yes
iOS6 Differences for Developers,"<p>For iOS6, what are some of the new features that developers can take advantage of?</p>

<p>Specifically, I'm interested in the user location services.</p>

<p>For instance, in iO6 demo it says when a user rejects a phone call, they can select to get notified when they get to work. </p>

<p>Does this mean that GPS services is always on in iOS6? In iOS5, when an app (such as highlight) requests full-time access to location services (even when they exit), GPS remains on, but it drains the battery a lot.</p>",iphone|ios|gps|location|ios6,744487,Pee Wee,no
iPhone battery drain issue,"<p>I think my question will be useful for others. I have battery drain issue and want to find out where it is. </p>

<p>I use xcode instruments: Enter profile
<img src=""https://i.stack.imgur.com/S4XC0.png"" alt=""enter image description here"">
then Energy Diagnostics, but I see nothing in energy usage section.
<img src=""https://i.stack.imgur.com/q431a.png"" alt=""enter image description here""></p>

<p>How can I enable information in Energy Usage section?</p>",iphone|ios|xcode|battery|batterylevel,1328838,Paul T.,no
What should I do if app didn't receive any ad from adWhirl in iOS,"<p>I am integrated adWhirl in my iOS app successfully. I read in Apple docs that , if your app don't have any ad to show then you should hide banner. But in case of AdWhirl it is written in <a href=""http://code.google.com/p/adwhirl/wiki/FrequentlyAskedQuestions"" rel=""nofollow"">FAQ of AdWhirl</a></p>

<blockquote>
  <p>Does the AdWhirl SDK check network connectivity before attempting to request ads and prevent battery drainage? </p>
  
  <p>Yes. The client SDK checks to see if network connectivity is available before allowing any ad requests to run. If no network connectivity is available, no ad requests are made. Therefore, note that since no ad requests are made, no callbacks will be made. </p>
</blockquote>

<p>So how can I handle this situation? Does Apple reject my application? 
Any kind of help is highly appreciated. Thanks</p>",ios|iad|adwhirl,1465536,iOSAppDev,yes
Are active listeners a good solution to populate UI changes once a day?,"<p>Using Cloud Firestore as a database for my application. </p>

<p>The labels/images I use in the app are <strong>updated about once a day</strong>, if that, and are populated from the data saved onto my Firestore database. </p>

<p>I'm trying to weigh the pros of having a one-stop solution to my having my UI updated automagically and not having to deal with unreliable network on the user's behalf, and the cons of my application being a drain on both, the user's battery life and their data connection. </p>

<p>There are no documentations I can find on this, and the only source I have  is <a href=""https://www.youtube.com/watch?v=3aoxOtMM2rc"" rel=""nofollow noreferrer"">this Firecast video</a> where I can find some confirmation for the former use case.</p>

<p>I'm trying to figure out if I should go with manual fetches or active listeners.
If someone know about any documentation on this topic, I'd be thankful for it.</p>",firebase|google-cloud-firestore|fetch,13219306,newKidCoderr33,yes
Battery-safe coding,"<p>I was wondering if there are some rules or hints how to prevent battery drain directly while coding. I know that there may be some ways to code to minimize workload on the processor or prevent leaks. However, does anybody have something like a guide or a something like a ""checklist"" besides the usual suspects like location service and internet connection?</p>",ios|battery,1210953,Corona,no
How do I notified when camera is used or opened by any other application,"<p>I want to get notified whenever any other application opened or accessed camera. I already know that I can check <code>Camera.open()</code> and its exception. but for that I have to check every time using service but it drain battery so I want whenever opened camera just notified me and get its package name. I already read these.</p>

<p><a href=""https://stackoverflow.com/questions/11220288/how-to-find-whether-the-camera-is-in-use"">How to find whether the camera is in use?</a></p>

<p><a href=""https://stackoverflow.com/questions/15862621/how-to-check-if-camera-is-opened-by-any-application"">How to check if camera is opened by any application</a></p>",android|android-camera|android-camera2,6041365,Upendra Shah,yes
Confusion about WakefulBroadcastReceiver,"<p>I've been studying WakefulBroadcastReceiver from this link : <a href=""https://developer.android.com/reference/android/support/v4/content/WakefulBroadcastReceiver.html"" rel=""nofollow"">https://developer.android.com/reference/android/support/v4/content/WakefulBroadcastReceiver.html</a></p>

<p>I have few confusions regarding this:</p>

<ol>
<li>Does this receiver ensures that you'll receive the broadcast even when the device is in sleep mode? (I think no, it just keeps the device awake after receiving the broadcast until a call to completeWakefulIntent() is made.)</li>
<li>The documentation illustrates the use of intent service within the receiver and after the completion of work, a call to completeWakefulIntent is made. </li>
</ol>

<p>CODE : </p>

<pre><code>import android.app.IntentService;
import android.content.Intent;
import android.os.SystemClock;
import android.util.Log;

public class SimpleWakefulService extends IntentService {
    public SimpleWakefulService() {
        super(""SimpleWakefulService"");
    }

    @Override
    protected void onHandleIntent(Intent intent) {
        // At this point SimpleWakefulReceiver is still holding a wake lock
        // for us.  We can do whatever we need to here and then tell it that
        // it can release the wakelock.  This sample just does some slow work,
        // but more complicated implementations could take their own wake
        // lock here before releasing the receiver's.
        //
        // Note that when using this approach you should be aware that if your
        // service gets killed and restarted while in the middle of such work
        // (so the Intent gets re-delivered to perform the work again), it will
        // at that point no longer be holding a wake lock since we are depending
        // on SimpleWakefulReceiver to that for us.  If this is a concern, you can
        // acquire a separate wake lock here.
        for (int i=0; i&lt;5; i++) {
            Log.i(""SimpleWakefulReceiver"", ""Running service "" + (i+1)
                    + ""/5 @ "" + SystemClock.elapsedRealtime());
            try {
                Thread.sleep(5000);
            } catch (InterruptedException e) {
            }
        }
        Log.i(""SimpleWakefulReceiver"", ""Completed service @ "" + SystemClock.elapsedRealtime());
        SimpleWakefulReceiver.completeWakefulIntent(intent);
    }
}
</code></pre>

<p>Now, as the docs say that this receiver holds a wake lock, I highly doubt that it's a good practice to start something like an intent service from the receiver. This would prevent the receiver from releasing the wake lock and drain a lot of battery as services are generally used for <em>long operations</em>.</p>

<p>Even as the code snippet above highlights, there's a delay of 25 seconds before releasing the lock. Is this the right way to use this receiver or should it be used only for short operations? Any help is appreciated.</p>",android|broadcastreceiver|android-wake-lock,1671058,gaurav jain,no
Android USB Host and Device Sleep,"<p>I have a USB device that I am interfacing with an android app using USB host mode. The device sends some data approximately once every 10 seconds but in some cases (high priority data) the data can come anytime. On the android app side I have a service that reads the data using USB host mode API. My android app processes the data and writes data back to the usb device. Now all works fine till the android device goes to sleep. The service goes to pause and all communication stops. I understand that I can use partial wake lock to keep the CPU running and the communication going and that it will have a huge impact on the battery. I though have two questions:</p>

<ol>
<li><p>Since the USB device can send data anytime, I really need the android service to alive all the time especially since higher priority data can come anytime. This could potentially mean that I acquire the partial wake lock and never release it. Havent been able to find in documentation if this is allowed and if yes what are the ramifications besides draining the battery?</p></li>
<li><p>Does the USB Host mode API or any other API provide a different and potentially better solution?</p></li>
</ol>

<p>The app is a custom app with limited users and so battery drain is not a big issue. I just want to understand if there are other issues I need to be careful about or if there is a much better way to do it.</p>",android|android-service,540587,Pankaj,yes
Stopping chrooted linux on android,"<p>I have built myself an chrooted linux-envionment for my android-tablet and everything works fine (I can even run a desktop), but there is one thing I have not yet quite figured out: How to stop it properly...</p>

<p>What I want to avoid is some linux-process remaining, possibly draining the battery, so I am looking for a way to systematically kill all processes running in the chroot.</p>

<p>How would I do that? </p>

<p>Normally I start the linux-environment by starting a chrooted bash from an android terminal emulation and from that I start services or a desktop etc (depending on what I want to do), but I would need a way to cleanly shut down all the processes once I am done with the linux-session without having to reboot the tablet.</p>

<p>This is mainly a hacking/educational project for me, so please don't point me to some out-of-the-box solutions for running linux on android - I want to understand how it is done.</p>

<p>Many thanks!</p>",android|linux,1475895,user1475895,yes
Can ESP32 be the one who starts bluetooth connection to Android device?,"<p>I have a M5StickC device, that is basically a battery operated ESP32.</p>
<p><strong>What I want to achieve:</strong> I want the M5StickC device to wirelessly cause an Android device do something when a button is pressed on the M5StickC. The M5StickC should only wake up when button is pressed, do the thing and then sleep and wake up again when button is pressed again.</p>
<p><strong>What I have tried</strong>: I have found example codes on the internet and was able to make a 2-way BT serial connection, but the problem is that <em>the Android device is the one that starts the connection</em>. Also I would have to keep the devices connected all the time to receive button presses. As the M5StickC device is battery operated, it needs to conserve power and can not be on 24/7. Also it does not look like a good idea to constantly try to connect to the M5Stick device from Android (by polling) and asking whether the button was pressed, as that will probably drain the phone battery.</p>
<p>Can anyone please point me in the right direction how to achieve this? I am experienced in software development, so I can figure things out. I am just lost right now.</p>
<p>(I don't care if it's Bluetooth Classic or BLE.)</p>",android|bluetooth|bluetooth-lowenergy|esp32,20027179,tp55,yes
Will my heavy iPad app be rejected?,"<p>I am looking forward to submitting an iPad application which uses CoreAnimation a lot and so it's heavy.</p>

<p>In ""App Store Review Guideline"", it shows:</p>

<blockquote>
  <p>13.2 Apps that rapidly drain the device's battery or generate excessive heat will be rejected</p>
</blockquote>

<p>While working my application on real iPad, it drains the battery to half in 4 hours, let the device to become a little bit warm. Will this be a reason enough to be rejected?</p>",ios|ipad|app-store,934437,Izumi Kawashima,no
How to make the Android device hold a TCP connection to Internet without wake lock?,"<p>I want my application to be connected to server though the mobile connection, yet allowing the device to go into sleep mode. I expect it to wake up when IP packates arrives.</p>

<p>How can this be done? How to receive ""interrupts"" from the Internet without draining battery?</p>",android|networking|wakelock|standby,266720,Vi.,no
Are beacons that work with Eddystone and iBeacon feasible?,"<p>I have concluded that Eddystone and iBeacon may each have their uses - at least if I want to have the best possible beacon support in my Android + iOS apps.</p>

<p>It seems to me it would be simplest to have physical beacons that work with both - but since beacons are very new to me, I am not sure if they will be feasible:</p>

<ol>
<li>In use (i.e. no major delays in broadcast and similar)</li>
<li>With concerns to battery drain in the beacon</li>
</ol>

<p>Since I have zero experience with beacons, it is difficult had to evaluate the different maintenance aspects. </p>

<p>If you do not have day-to-day access to where beacons are placed - is it possible to acquire beacons that can do both without requiring constant maintenance?</p>",ibeacon|beacon|eddystone,599361,Tom,no
iPhone : Does a rapidly updating (60Hz) accelerometer drain battery?,"<p>I'm making an accelerometer-based app using cocos2d, and I noticed that it's possible to set the accelerometer update interval.</p>

<pre><code>[[UIAccelerometer sharedAccelerometer] setUpdateInterval: (1.0f / 60.0f)];
</code></pre>

<p>Is updating the accelerometer very often like this (60 times a second) a significant battery drain?</p>",iphone|objective-c|accelerometer,306378,Johannes Jensen,no
changing background data state in Android,"<p>Allow me to start with a little rant: While Background Data is enabled on my Galaxy S (Froyo) the battery completely drains in just a few hours! I really cant figure out why when both my exchange and gmail accounts are set to push. In any case, this leads to the need to turn BG Data off to conserve my battery and turn it on mainly for browsing the marketplace.
I dont understand why the Market app cant simply turn the thing on when I open the app and not bother me about it and I really dont get why everytime I turn BG Data off I get a dialog telling me it will save me battery, I know that! thats why im turning if off!!! eurghhhh...</p>

<p>With that out of the way, I wanted to write a little widget that will allow me to turn Background Data on and off whenever I want without going through the menus and seeing that annoying dialog.
Then I found out that this setting is one of the ""secured settings"" which apps cant change.</p>

<p>What I wanted to ask, is whether there is any way to change a secure setting in Android through code? Has anyone found a way around this? Or do we just have to live with it?</p>

<p>Thanks!</p>",android|security|settings|widget,107976,poeticGeek,no
Is service running all the time bad?,"<p>I am trying to learn about service and BroadCastReceiver.
Code below is a service which runs all the time in the background.  The problem is I don't know how it would affect the battery consumption.</p>

<p>My goal is to detect the screen on and off, so I need a running service in the background when the app is close or open...</p>

<p>Is it going to drain a lot of battery?
Can you please explain it?</p>

<p>Thank you</p>

<pre><code>public class MyService extends Service{

    private static final String TAG = ""MyService"";
    private BroadcastReceiver mScreenOnOffReceiver;
    private BroadcastReceiver OnOffBroadcastReceiver;
    private NotificationManager mNotificationManager;
    private Notification barNotif;

    @Override
    public IBinder onBind(Intent arg0) {
        return null;
    }

    @Override
    public void onCreate() {

    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        super.onStartCommand(intent, flags, startId);

    // here to show that your service is running foreground     
    mNotificationManager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);
        Intent bIntent = new Intent(this, WidgetBroadCastReceiver.class);       
        PendingIntent pbIntent = PendingIntent.getActivity(this, 0 , bIntent, Intent.FLAG_ACTIVITY_CLEAR_TOP);
        NotificationCompat.Builder bBuilder =
                new NotificationCompat.Builder(this)
                    .setSmallIcon(R.drawable.ic_launcher)
                    .setContentTitle(""STICKY"")
                    .setContentText(""Sub Title"")
                    .setAutoCancel(true)
                    .setOngoing(true)
                    .setContentIntent(pbIntent);
        barNotif = bBuilder.build();
        this.startForeground(1, barNotif);

    // here the body of your service where you can arrange your reminders and send alerts

     Thread mThread = new Thread() {
         @Override
         public void run() {
         // Register the ScreenOnOffReceiver.java  
        IntentFilter filter = new IntentFilter(Intent.ACTION_SCREEN_ON);
        filter.addAction(Intent.ACTION_SCREEN_OFF);
        mScreenOnOffReceiver = new ScreenOnOffReceiver();
        registerReceiver(mScreenOnOffReceiver, filter);

        // initialize and register mScreenOnOffReceiver (no need the BroadcastReceiver class)
        OnOffBroadcastReceiver = new BroadcastReceiver() {
            @Override
            public void onReceive(Context context, Intent intent) {
                if (intent.getAction().equals(Intent.ACTION_SCREEN_OFF)) {
                    Log.e("""", ""SERVICE Screen is: "" +  ""turned OFF....."");
                } 
           else if (intent.getAction().equals(Intent.ACTION_SCREEN_ON)) {
                    Log.e("""", ""SERVICE Screen is: "" +  ""turned ON......"");
                }
            }
        };
        registerReceiver(OnOffBroadcastReceiver, new IntentFilter(filter));       
         }
     };

     mThread.start();   

    return START_STICKY;
    }


    @Override
    public void onStart(Intent intent, int startId) {
        Toast.makeText(this, ""My Service has Started"", Toast.LENGTH_SHORT).show();
    }

    @Override
    public void onDestroy() {
        Toast.makeText(this, ""MyService Stopped"", Toast.LENGTH_SHORT).show();
        unregisterReceiver(mScreenOnOffReceiver);
        unregisterReceiver(OnOffBroadcastReceiver);
        stopForeground(true);
    }
}
</code></pre>",android|android-service|android-broadcast|android-background|battery-saver,3944473,YRTM2014,yes
How can I stop the Pow server from starting up at computer boot (OS X)?,"<p><strong>TL;DR: Is there a way to disable the Pow server from starting when my machine boots up, but retain the ability to launch the server manually via <code>powder up</code> when I need it to run?</strong></p>

<p>I am using <a href=""http://pow.cx/"" rel=""nofollow"">Pow</a> for my local development (and managing via the <a href=""https://github.com/rodreegez/powder"" rel=""nofollow"">Powder gem</a>). I'd like to set up Pow so that the server isn't started automatically on boot, as running it drains my battery life and I'm not always coding.</p>

<p>Pow has added itself to <code>launchd</code> and I can't seem to get to a scenario where the Pow server is not running after startup, but can still be run via a <code>powder up</code> or other equivalent command when I need to launch the server.</p>

<p>What I've tried that hasn't worked:</p>

<ul>
<li>setting a disabled key for the <code>cx.pow.powd</code> process via <code>launchctl unload -w ~/Library/LaunchAgents/cx.pow.powd</code> prevents Pow from booting on start, but also prevents the process from being started manually when I need it</li>
<li>setting <code>RunAtLoad</code> to <code>NO</code> in the cx.pow.powd.plist file also didn't work, later realized that this was not for controlling startup behavior of the daemon.</li>
</ul>",launchd|rack-pow,524750,AndrewS,yes
How to keep background service alive in Android when on battery?,"<p>I am building an Ionic/Cordova app that will poll the GPS location of the user to my back end server every 4 minutes. To implement my logic i am using <a href=""https://github.com/Red-Folder/bgs-core"" rel=""nofollow"">BGS Core plugin</a></p>

<p>In order to prevent CPU from sleeping i am implemented a WakeLock which drains the battery very quickly. Ideally i would like to use an Alarm Manager or a better solution but i am unable to understand how to use an Alarm Manager within the scope of the MyService plugin class.</p>

<p>Here is my code:</p>

<pre><code>    public class MyService extends BackgroundService {

    private final static String TAG = MyService.class.getSimpleName();  
    private String proId = ""0"";
    private String proIdFromStorage = """";
    private String requestResult = """";

    private String lat = """";
    private String lon = """";
    private String time = """";
    private String locationProvider = """";       

    private String testId = ""10"";

    private final String device = Build.MODEL;
    private final String manufacturer = Build.MANUFACTURER;
    private final String buildNumber = Build.VERSION.RELEASE;

    private String batteryLevel = """";
    private String isBatteryCharging = """";

    private String isConnnectedToNetwork = ""false"";
    private String networkType = ""Unknown"";
    private String imei = """";
    private String imsi = """";   
    private String simSerialNumber = """";
    private String carrier = """";    

    private PowerManager.WakeLock wl = null;

    //Initializing the file name that will store the pro details
    public static final String PRO_DATA_STORE = ""ProDataStore""; 

    @Override
    protected JSONObject doWork() {                                         

        requestLocationUpdate(); //It will force phone to get latest location
        performStorageOperations(); //Getting and setting pro id to/from storage        
        setBatteryStats();  //Setting battery stats
        getNetworkInfo(); //Getting and setting network info details
        getLocationInfo(); //Getting and setting location info details
        makeRequestToServer(); //Sending Pro details to Mr Right Server         

        JSONObject result = new JSONObject();
        try { result.put(""Message"", this.requestResult); } catch (JSONException e) {}   

        return result;  
    }

    @Override
    protected JSONObject getConfig() {

        JSONObject gC = new JSONObject();

        try{            
            gC.put(""ProIdFromGet"", this.proId);         
        }
        catch (JSONException e) {
        //some exception handler code.
        }               
        return gC;
    }

    @Override
    protected void setConfig(JSONObject config) {           
        try {
            if (config.has(""proId""))
            {
                this.proId = config.getString(""proId"");
            }                                               

        } catch (JSONException e) {
        }

    }               

    @Override
    protected void onTimerEnabled() {
        // TODO Auto-generated method stub
        wakeLockEnable();               
    }

    @Override
    protected void onTimerDisabled() {
        // TODO Auto-generated method stub
        releaseWakeLock();      
    }           

    private void getLocationInfo(){     
        try {
             LocationManager lm = (LocationManager) getApplicationContext().getSystemService(Context.LOCATION_SERVICE);          
             Log.d(TAG, ""Location Manager is initilaised""); 
             /*
             Criteria criteria = new Criteria();
             criteria.setAccuracy(Criteria.ACCURACY_FINE);
             criteria.setAltitudeRequired(false);
             criteria.setBearingRequired(false);
             criteria.setCostAllowed(true);
             String strLocationProvider = lm.getBestProvider(criteria, true);
             Log.d(TAG, ""Location Provider : "" + strLocationProvider);
             */                                         

             try{
                    Location location = null;
                    Location locationGPS = lm.getLastKnownLocation(LocationManager.GPS_PROVIDER);
                    Location locationNetwork = lm.getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
                    if(locationGPS != null &amp;&amp; locationNetwork != null)
                    {
                        //Testing if GPS Location is not older than 10 mins as compared to Network Location
                        if(locationGPS.getTime() - locationNetwork.getTime() &gt; 8 * 60 * 1000)
                        {
                            location = locationNetwork;
                        }
                        else{
                            location = locationGPS;
                        }
                    }
                    if(locationGPS == null &amp;&amp; locationNetwork != null)
                    {
                        location = locationNetwork;
                    }                                                                                                                                           
                    if(location != null)
                    {                                       
                        Log.d(TAG, ""Location Fetched Successfully"");                        

                        Double lat = location.getLatitude();
                        Double lon = location.getLongitude();
                        Float speed = location.getSpeed();
                        Long timeStamp = location.getTime();
                        Float accuracy = location.getAccuracy();

                        this.lat = lat.toString();
                        this.lon = lon.toString();
                        this.time = timeStamp.toString();
                        this.locationProvider = location.getProvider();                                                                     
                    }
                    else{
                        Log.d(TAG, ""Location fetched is null""); 
                    }
             }
             catch (SecurityException e) {
             Log.d(TAG, ""This is a Security Exception"");            
                e.printStackTrace();
            }
            catch(IllegalArgumentException e){
            Log.d(TAG, ""This is an Illegal Argument Exception"");            
                e.printStackTrace();
            }                        

        } catch (Exception e) {
            Log.d(TAG, ""Location could not be fetched"");
            e.printStackTrace();                        
        }
    }

    private void requestLocationUpdate(){

        LocationManager lm2 = (LocationManager) getApplicationContext().getSystemService(Context.LOCATION_SERVICE);                      
            try{            
                // Identify a listener that responds to location updates LocationListener       
                LocationListener locationListener = new LocationListener() {
                    Handler MAIN_HANDLER = new Handler(Looper.getMainLooper()); 
                    public void onLocationChanged(Location location) 
                    { 
                        final Location result = location;                       
                        // Called when a new location is found by the network location provider.                     
                         MAIN_HANDLER.post( new Runnable() { 
                            @Override
                            public void run() {                            
                               Log.d(TAG, ""Latitude : "" + Double.toString(result.getLatitude()));
                               Log.d(TAG, ""Longitude : "" + Double.toString(result.getLongitude()));
                               Log.d(TAG, ""Time : "" + Long.toString(result.getTime()));
                               Log.d(TAG, ""Accuracy : "" + Float.toString(result.getAccuracy()));
                            }
                         });
                    } 
                    public void onStatusChanged(String provider, int status, Bundle extras) {}
                    public void onProviderEnabled(String provider) {}
                    public void onProviderDisabled(String provider) {} 
                };

                // Register the listener with the Location Manager to receive location updates
                HandlerThread t = new HandlerThread(""my handler thread"");
                t.start();
                try{
                    if(lm2.isProviderEnabled(LocationManager.GPS_PROVIDER))
                     {
                        Log.d(TAG, ""Location Fetching from GPS"");                       
                        lm2.requestSingleUpdate(LocationManager.GPS_PROVIDER,locationListener,t.getLooper());
                        lm2.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 30 * 1000, 0, locationListener,t.getLooper());                                                                                             
                     }
                     else
                     {
                        Log.d(TAG, ""Location Fetching from Network"");
                        lm2.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 30 * 1000, 0, locationListener,t.getLooper());
                     }
                 }
                 catch (SecurityException e) {
                    lm2.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 60 * 1000, 0, locationListener,t.getLooper());
                     Log.d(TAG, ""This is a Security Exception"");            
                        e.printStackTrace();
                    }
                 catch(IllegalArgumentException e){
                    lm2.requestLocationUpdates(LocationManager.NETWORK_PROVIDER,  60 * 1000, 0, locationListener,t.getLooper());
                    Log.d(TAG, ""This is an Illegal Argument Exception"");            
                        e.printStackTrace();
                    }                       
            }
            catch(Exception e){
                Log.d(TAG,""An error occured in forced location fetching"");
                e.printStackTrace();
            }                       
    }
    private void wakeLockEnable(){
        if (wl == null) {
            Log.d(TAG, ""Creating and acquiring wake lock..."");
            PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
            this.wl = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, ""doWork()"");
            wl.setReferenceCounted(false);
            if (!wl.isHeld()) {
                wl.acquire();
                Log.i(TAG, ""Acquired wake lock!"");
            }
        } else {
            if (!wl.isHeld()) {
                Log.d(TAG, ""Wake lock not held...Acquiring wake lock..."");
                wl.acquire();
            }
        }
    }

    private void releaseWakeLock(){
        if (wl != null) {
            Log.i(TAG, ""wl is not null"");
            if (wl.isHeld()) {                
                    Log.i(""WakeLock"", ""We have a wake lock....Releasing wake lock..."");
                wl.release();
            }
        }
    }
</code></pre>",android|cordova|ionic-framework|geolocation,4025878,Veer Arjun,no
"In android, why my service doesn't go to sleep after pushes the power button","<p>I have created an app which will start a service. In my service, I created a timer that will do something periodically. I didn't use any wakelock. </p>

<p>After I press the power button and wait for sometime, it seems that my service still keeps printing something periodically into the eclipse( I keep the usb connected in order to see the message in eclipse). </p>

<p>So my service is still running and will never go sleep even the power button is pushed?Then it will keep draining the battery? Is that caused by the usb connection? Does anyone have such experience?</p>",android|service|power-management,980818,Hao Shen,no
Scheduling Repeating Events -- Handler.PostDelayed and Doze,"<h3>Context</h3>

<p>I'm working on a screen filter app (like f.lux) for Android. I'm currently working the feature to gradually fade in the filter as the sun sets. The state does not matter when the screen is off, but when the screen is on, it's important that the fade progress be correct (or immediately updated).</p>

<h3>Technical requirements</h3>

<ul>
<li>I want to fire a series of intents at semi-regular intervals.</li>
<li>When the screen is off, they can be ignored / discarded, <strong>except:</strong>

<ul>
<li>when the screen turns on, the most recent intent must be fired immediately.</li>
</ul></li>
<li>I do not want to drain the battery unnecessarily.</li>
</ul>

<h3>Obvious solutions and why they don't work</h3>

<ul>
<li>I could use <a href=""https://developer.android.com/reference/android/app/AlarmManager.html#setInexactRepeating(int,%20long,%20long,%20android.app.PendingIntent)"" rel=""noreferrer""><code>AlarmManager.setInexactRepeating</code></a>, which is supposedly the most energy-efficient of the alarms, except:</li>
</ul>

<blockquote>
  <p>Your alarm's first trigger will not be before the requested time, but it might not occur for almost a full interval after that time.</p>
</blockquote>

<p>I think this implies that the first trigger will <em>necessarily</em> happen within the first interval, meaning the device will be woken, causing unnecessary battery drain.</p>

<ul>
<li>I could use <a href=""https://developer.android.com/reference/android/app/AlarmManager.html#set(int,%20long,%20android.app.PendingIntent)"" rel=""noreferrer""><code>AlarmManager.set</code></a> to schedule the first alarm. When it goes off, I could update the screen, then schedule the next alarm. This would work, but would wake up older devices (without Doze) on each alarm, instead of waiting until the screen turns on. It's also using AlarmManger as a timer, which the documentation explicitly recommends against:</li>
</ul>

<blockquote>
  <p>For timing operations (ticks, timeouts, etc) it is easier and much more efficient to use Handler.</p>
</blockquote>

<p>Okay, so,</p>

<ul>
<li>I could set a single alarm to starts up a <a href=""https://developer.android.com/reference/android/os/Handler.html"" rel=""noreferrer""><code>Handler</code></a>, which would update the UI periodically. But wait: this relies on <a href=""https://developer.android.com/reference/android/os/Handler.html#postDelayed(java.lang.Runnable,%20long)"" rel=""noreferrer""><code>postDelayed</code></a>, which says (emphasis mine):</li>
</ul>

<blockquote>
  <p>Time spent in deep sleep will add an <strong><em>additional</em></strong> delay to execution.</p>
</blockquote>

<p>I think that means, when the device wakes up from sleep, the next update might not happens for a whole interval. Am I reading this right? Forcing the user to wait a minute or two before the next update is a deal-breaker.</p>

<p><a href=""https://developer.android.com/reference/android/os/CountDownTimer.html"" rel=""noreferrer"">CountDownTimer</a> and <a href=""https://developer.android.com/reference/android/animation/ValueAnimator.html"" rel=""noreferrer"">ValueAnimator</a> both use this method in their implementations, so if my interpretation of Handler is right, they're both out.</p>

<p>I could use a handler-based method and also receive events when the screen is turned off, at which point I'd cancel the existing animation, then start a new one. This looks to be the best solution, but it seems like there should be a simpler way to do it.</p>

<h3>Conclusion</h3>

<p>There are a ton of other SO questions on this topic. Everyone and their mother recommends using a Handler, but there's absolutely no information about how it behaves when the device goes to sleep, aside from the quote above. It's really weird that (apparently) nobody else has run into this issue -- am I doing something really unusual, or missing something basic?</p>

<p>Can anybody provide insight about how <code>Handler.postDelayed</code> really behaves when the device goes to sleep, and recommend what I should do in this particular instance?</p>",android|timer|alarmmanager|handler|android-doze,4184103,Julian Delphiki,yes
"iPhone ""go to background"" versus ""quit"" confusion","<p>First some background; for the tl;dr version skip to ""the problem"" below.</p>

<h1>Background</h1>

<p>This is really more of a user interface question than a technical one, but I think it fits better here than on the UI site anyway.</p>

<p>Since iOS (iPhone OS) 4.0 apps can run in the background, and actually always does so instead of quitting. Quitting an application requires pressing the home button, pressing it again, holding your finger on the application icon until it starts shaking, touching the ""close"" indicator, pressing the home button again. Not really intuitive.</p>

<p>The reason for this is of course that usually the user shouldn't care if the app is quit or just suspended, because it doesn't matter. But for some apps it does.</p>

<h1>The problem</h1>

<p>I have an app that logs location changes; think ""RunKeeper"" if that's familiar. The user starts the app, chooses to start recording (to a file), or just uses it to view distance, speed, etc. When the user is done (or wants to do something else), they hit the home button. The app disappears. Now one of several things happen:</p>

<ol>
<li>The app quits, closing any ongoing recording (iPhoneOS 3.1.3 and below).</li>
<li>The app continues running in the background, using the GPS and draining the battery (iOS 4). This is appropriate if the user for example wanted to switch to the iPod app to change their soundtrack.</li>
<li>The app continues running in the background, using the GPS and draining the battery (iOS 4). This is completely inappropriate if the user was done and wanted to quit the app.</li>
</ol>

<p>There is of course no way for the app to see the difference between cases three and four. A quick look around RunKeeper forums indicates that many users have no clue what is happening and get seriously confused by this.</p>

<h1>Ideas</h1>

<p>So what's the best way to solve this from a user interface point of view?</p>

<ol>
<li>When the home button is pressed, go into background as is the default action. It's the user's problem to actually kill the app if they are done. It's the platforms fault that this is non-obvious and slightly tedious.</li>
<li>When the home button is pressed and a recording is in progress, continue in background. If we are not recording, quit the application.</li>
<li>Present a toggle widget somewhere in the application that allows the user to choose what happens when the home button is pressed. (This might run afoul of the HIG; I'm not sure)</li>
<li>...?</li>
</ol>

<p>What do you think?</p>",iphone|user-interface|ios4,247563,Jakob Borg,yes
How can I get high accuracy location every 5 seconds or when user moves a threshold without draining the battery?,"<p>I have a location app that needs to get accurate location periodically.  Currently I am getting constantly getting location in <code>didUpdateLocation</code> but I only ever log the location every 5 seconds.  I am interested in a solution that gets accurate location periodically or on signification change.  I would like either or both of these scenarios:
(by very accurate, I need 10m of desired accuracy)</p>

<ul>
<li>Get a very accurate location every 5 seconds</li>
<li>Notify/callback if user moves a threshold ( eg moves 5 - 10 meters)</li>
</ul>

<p>The app needs to work when backgrounded as well and location must still be logged if user switches to another app.</p>

<p>I was considering turning on/off location every 5 seconds but was not sure if that is the best practice.   I also know there is also <code>allowDeferredLocationUpdatesUntilTraveled</code>  but I believe that only applied to backgrounded mode.  I would appreciate a solution that saves battery when the app is in use and in background mode.  Please share your solutions and best practices for my use case.</p>",ios|iphone,1012786,jaybers,yes
Battery issues with background scans,"<p>I'm using altbeacon's Android Beacon Library to do a background proximity scan to show the user a notification when they enter the range of 1 of my beacons when the app is in the background. I have made it work by adding this to my application file's <code>onCreate</code> method:     </p>

<pre><code>region = new Region(""com.myapplication.identifier"", 
                    Identifier.parse(Constants.beaconUUID), null, null); 
regionBootstrap = new RegionBootstrap(this, region);
beaconManager.setBackgroundScanPeriod(1000l);
beaconManager.setBackgroundBetweenScanPeriod(30000l);
</code></pre>

<p>I have code in the <code>didEnterRegion</code> method to range that beacon and display the notification for that location. I found 30 seconds the be the minimum acceptable frequency to still get the notifications when walking through the beacon range. I have noticed since I added this code that it is causing android 7.0 to report battery issues ""between 1% and 2% battery usage per hour"" even when I am not near any beacons. I have done a lot of iterations on different scan frequencies and have isolated the problem to be entirely independent of what actually is in <code>didEnterRegion</code>, and I'm pulling my hair out at this point. Anyone know a way to reduce the battery drain and still trigger <code>didEnterRegion</code>? </p>",android|altbeacon,5543732,Ryan McCaffrey,no
"After using rngd, [hwrng] continues to max out entropy","<p>I installed rngd 5 and haveged on my android, which is running Android 5.1. I made a script to test them out:</p>

<p><code>#!/system/bin/sh</code></p>

<p><code>haveged -w 1024 -p /dev/haveged.pid -r 0 &amp;</code></p>

<p><code>rngd -d 1 -p /dev/rngd.pid -r /dev/hw_random &amp;</code></p>

<p>I found that using either method to increase entropy drained battery, so I removed the scripts, binaries, and /data/system/entropy*.</p>

<p>The problem I have is that this didn't stop entropy generation after rebooting several times. <code>/proc/sys/kernel/random/entropy_avail</code> is maxed out at the poolsize number, <code>/proc/sys/kernel/random/poolsize</code>. A process labeled as <code>[hwrng]</code> is running consuming far more cpu time than any other process. It's draining my battery and really slowing down the system. It seems like the hwrng process, whereever it originates, was permanently reconfigured. I found only this <code>[hwrng]</code> process searching processes for rng or haveged with <code>ps|grep</code> and <code>pgrep</code>. I didn't find any kind of hwrng file in /dev or anywhere else. I've found nothing on the search engines or rngd or haveged documentation about this. Does anybody have an idea what's going on or a way to reset the natural entropy generation of the system? I have to be missing something.</p>",android|linux|entropy,5256114,jan,yes
Running a repeating task in background on a real time application,"<p>I'm writing an application which is continuously listening and checking the sensors (almost all available) and saving that data into the database in the device. </p>

<p>I need to make some calculations every X second with that data and throw a new event if the calculations check says so. 
I'm thinking about requesting to have the device plugged in while using the application (regarding battery drain).</p>

<p>What's the best approach for the task that needs to make the calculations and throw the event? Timer? Threads? AsynkTask? AlarmManager? Another approach?</p>

<p>I want to keep getting sensors data and saving them to the database despite if the application is not on foreground...it should save the values as long as the application is not stopped by the user. 
One option for that is wake locks (PARTIAL_WAKE_LOCK, which keeps CPU running).</p>

<p>I'd like to hear different opinions.
Thanks in advance! Guillermo.</p>",android|real-time|alarmmanager,338262,gdpwork,yes
Is it possible to trigger location change without battery drain?,"<p>In my application I need to get an update for the user's location when entering another city.</p>

<p>So for example:</p>

<ol>
<li>User lives in cityA</li>
<li>User travels from cityA to cityB</li>
<li>A function should be triggered.</li>
</ol>

<p>I see just the following functions are provided by Google play services:</p>

<ol>
<li><p><code>public abstract Location getLastLocation (GoogleApiClient client)</code></p></li>
<li><p><code>public abstract PendingResult&lt;Status&gt; requestLocationUpdates (GoogleApiClient client, LocationRequest request, LocationListener listener)</code></p></li>
</ol>

<p>The problem is:</p>

<p><strong>I need to track the user's city location changes continuously, not just when the user is using the app.</strong></p>

<p>How could I do that without draining the battery too fast?</p>",android|location|battery|android-gps,4270833,david,yes
What drains the battery more: A longliving Service that does not do much or a many shortlived IntentServices,"<p>I am designing an application which will collect different data from a lot of sensors and store them in a db, continuously. Sensors that I am using are like Google Play's fused location provider and activity detection. (There is some UI as well, but the UI will barely be launched, so almost everything is happening in the background)</p>
<p>I got two different ways to do this:</p>
<h1>1) Start a longliving Service</h1>
<p>So I would start a long-living service (with the STICKY flag), that would run in the background. The service would just register for periodic location and activity updates and - in between the updates - just do nothing.</p>
<p>Pros: App is only initialized once</p>
<p>Cons: Service is running 24x7</p>
<h1>2) Register PendingIntent and use shortlived IntentService</h1>
<p>Now Google Play's Location provider support registration of PendingIntent instead of callback [see here](<a href=""https://developers.google.com/android/reference/com/google/android/gms/location/FusedLocationProviderApi#requestLocationUpdates(com.google.android.gms.common.api.GoogleApiClient%2C%20com.google.android.gms.location.LocationRequest%2C%20android.app.PendingIntent)"" rel=""nofollow noreferrer"">https://developers.google.com/android/reference/com/google/android/gms/location/FusedLocationProviderApi#requestLocationUpdates(com.google.android.gms.common.api.GoogleApiClient%2C%20com.google.android.gms.location.LocationRequest%2C%20android.app.PendingIntent)</a> which is even recommended for background tasks.</p>
<p>Pros: The app can get 'shut down' between sensor events</p>
<p>Cons: Each IntentService might re-start the app if it was shut down inbetween, which probably has quite an overhead (initialize db, read shared prefs, initialize all classes, ...)</p>
<p>So my question is: <strong>Is it still recommended to use many short lived IntentServices for this kind of app?</strong> I haven't done any measurements yet, but I am worried, that each IntentService (and they will be launched quite often), re-starts my app, so that I end up spending more CPU time on initialization, etc. then just having a long-lived service lying dormant.</p>
<p>Anybody has experience with this?</p>",android|android-location|intentservice|battery|android-backup-service,1406325,Flo,no
The best battery saving method for Location updates,"<p>I'm trying to write an Adroid application that should run in background and notify the user when he will be close to the place given in the database. Should I do it by requestLocationUpdates in the extended IntentService class? </p>

<p>What is the best way to make it as least battery draining as possible?</p>",java|android,1528981,Nav,no
Set display brightness to 0% after some time of inactivity. And back to original value after user input,"<p>I'm writing an app for Android (2.1+). And I need to solve problem with brightness of display. App will be running for longer time and if user is inactive (for example 30 seconds) it should set brightness to 0% and after touch on screen restore original value.</p>

<p>Now I'm using</p>

<pre><code>PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);  
wl = pm.newWakeLock(PowerManager.SCREEN_DIM_WAKE_LOCK, ""DimScreen"");
</code></pre>

<p>and</p>

<pre><code>@Override
protected void onPause() {
    super.onPause();
wl.release();
}
@Override
protected void onResume() {
super.onResume();
wl.acquire();
}
</code></pre>

<p>But this won't set brightness to 0%. And battery drain is higher.
It is possible to set brightness to 0% (no turn off the display) and restore original value <strong>just by touching</strong> the screen ? And device should not lock itself while app is running.</p>

<p>Thanks in advance.<br>
kamelot_sk</p>",android|brightness,537732,kamelot,yes
How do I execute code every frame in Ionic React?,"<p>First of all, I'm completely new to Ionic, React and JSX and fairly new to JS in general. For learning purposes I want to play around with something like a &quot;mini experimental idle game&quot;.</p>
<p>Now, I'm trying to update some field every frame and do some calculations.
I know this will be quite CPU-intensive and battery-draining (on mobile devices) but I specifically want that behavior.
I have set my <code>tsconfig.json { &quot;strict&quot;: false }</code>, so I can use plain JS, which I'm a bit more used to.</p>
<p>So say, I have this element:</p>
<pre><code>var count = 0;

&lt;IonCardTitle&gt;
    &lt;span id=&quot;fieldCount&quot;&gt;{count}&lt;/span&gt; Things
&lt;/IonCardTitle&gt;
</code></pre>
<p>What I know want is to run something like this every single frame:</p>
<pre><code>if(count &lt; 1000000) {
    document.querySelector('#moneycount').innerHTML = count.toString();
    count++;
}
</code></pre>
<p>How would I go about changing the <code>.innerHTML</code> of the element <strong>every frame</strong> and increment <code>count</code>?</p>",reactjs|react-native|ionic-framework,7123934,traxx2012,no
Impact of regular repeating android wakeup alarms?,"<p>I have an android app with the following Alarms setup:
Alarm A is of type RTC_WAKEUP, uses the <a href=""https://github.com/commonsguy/cwac-wakeful"" rel=""nofollow"">commonsguy wakeful</a> pattern to start a service and repeats on an interval of 1 minute. Alarm B is of type RTC, starts a service and repeats on an interval of 10 seconds.</p>

<p>My questions are as follows:</p>

<ol>
<li>When the phone goes to sleep, for example it is left unused with screen off overnight, is it guaranteed alarm B will get triggered once every minute throughout the night because alarm A wakes up the device every minute? (Ignore the fact that alarm B might not execute fully to completion because it lacks a wakelock)</li>
<li>Is alarm A likely to cause severe battery drain by waking up so regularly and causing an onslaught of other RTC alarms to be triggered? I guess its dependant on other apps having RTC type alarms but how likely is it that you'd have lots of other apps with RTC alarms?</li>
<li>I've been trying to investigate the battery drain impact of this setup by monitoring the device using <a href=""https://play.google.com/store/apps/details?id=ccc71.bmw&amp;hl=en"" rel=""nofollow"">Battery Monitor Widget</a>. I first monitor the device for a period of time without the app installed and record the average milliampere during that period. I then run the same test with the app installed and compare the results. But I have a suspicion that the amount of drain is dependent on other apps installed and these apps taking advantage of alarm A regularly waking the device up. Is this correct? Any suggestions on better ways to test this?</li>
</ol>

<p>Hopefully these are easy questions and thanks in advance!</p>

<p>Dom</p>",android|alarmmanager|wakeup,752504,Dom,yes
Battery Drain Issue,"<p>I am using many threads in my app that are always running.These are used to send data to server periodically.There are called through services.The problem is that my app drains a lot of battery.I want to fix this.How??
I mean gmail etc dont drains that much of batterry.</p>",java|android|multithreading,1747460,Payal,yes
How to secure a raw UDP listener in Azure on a static IP address,<p>We need to listen for UDP messages from a vendor who wants to send a single small package once per hour to minimize battery drain. I cannot whitelist the client IP addresses but also need to prevent DOS and garbage being dumped into the system. Any help is most welcomed.</p>,azure|security|udp|static-ip-address,614695,RBZ,yes
How can I properly send a batch request using UCWA 2.0?,"<p>I am writing a UCWA application to receive each user's presence and note. At the moment, I subscribe to all my desired contacts, I initiate my event stream and then I receive around 200 events. I loop through them to receive my contacts presence and notes using a for loop, meaning I send around 100 requests, which, according to Microsoft documentation, can drain battery on mobile devices or impact performance. I would like to use batching to fix this problem.</p>

<pre><code>onEvent(events) {
    for (var i in events) {
        const event = events[i]
        switch (event.link.rel) { // 250 events filtered down to around 100
            case 'contactPresence':
            case 'presence':
                this.setPresence(event.link.href, this.getUser(event))
                break
            case 'contactNote':
            case 'note':
                this.setNote(event.link.href, this.getUser(event))
                break
            case 'presenceSubscription':
                ...
                break
        }
    }
}
</code></pre>

<p>After searching through Microsoft's documentation, I couldn't find any help on how to format a batch request. I tried following one of the examples provided, but I received a 400 error like this:</p>

<pre><code>{
    ""code"":""BadRequest"",
    ""message"":""Your request couldn\u0027t be completed.""
}
</code></pre>

<p>Eventually I tried sending a batch following formatting that I've seen from <a href=""https://social.msdn.microsoft.com/Forums/azure/en-US/2aca214f-f8d9-4e39-acb7-39cb46c0b226/400-bad-request-8220your-request-couldnt-be-completed8221-ucwa-batch-request-with-postman?forum=ucwebapi"" rel=""nofollow noreferrer"">this post</a>, like so: </p>

<pre><code>batch() {
    const boundary = Date.now()
    fetch(this.hub + this.response._links.batch.href, {
        method: 'POST',
        headers: {
            Accept: 'multipart/batching',
            Authorization: `Bearer ${this.token}`,
            'Content-Type': `multipart/batching;boundary=${boundary}`
        },
        body: `--${boundary}\r\nContent-Type: application/http; msgtype=request\r\n\r\nGET ${this.response._links.self.href + '/people/contacts'} HTTP/1.1\r\nAccept: application/json\r\nHost: ${this.hub}\r\n\r\n--${boundary}--`
    }).then(r =&gt; r.json())
    .then(data =&gt; console.log(data))
}
</code></pre>

<p>Here is the request payload:</p>

<pre><code>--1557482296198
Content-Type: application/http; msgtype=request

GET /ucwa/oauth/v1/applications/103357029549/people/contacts HTTP/1.1
Accept: application/json
Host: https://webpoolam41e02.infra.lync.com

--1557482296198--
</code></pre>

<p>This returns a 500 error, however, like this: </p>

<pre><code>{
    ""code"":""ServiceFailure"",""message"":""Your request couldn\u0027t be completed."",
    ""debugInfo"":{
        ""errorReportId"":""8d6499597a54443495627bd2b3e3c5b6""
    },
    ""reasonId"":""1000005""
}
</code></pre>

<p>I have spent a long time searching for an answer but I cannot find one that works. </p>

<p>Does anyone know how to properly format a batch request?</p>",ucwa,10445697,Kobe,no
How do I keep the screen turned on while debugging in Android?,"<p>Settings the developer's flag ""Stay awake"" might result in constant battery drain of your debugging device. So, how can you easily keep the device screen on ONLY while debugging?</p>",android|debugging,4226806,rubmz,no
Limit usb power output,"<p>I work with an embedded device that has a USB host port. I would like to connect an iPhone to it and communicate via USB. I have done development on this and ported the functionality to connect to usbmux on the iPhone and have successful communication, however there is another problem.</p>

<p>All development was done with the iPhone connected to a powered USB hub that was connected to my device, as soon as I connected it directly, after enumeration it starts to drain the battery of my embedded device and causes a tension (voltage) drop that causes my device to turn off.</p>

<p>I know that after enumeration usb devices can draw up to 500 mA from the usb port, but I was wondering if there was a way to limit that to 100 mA (while still having the iPhone registered).</p>

<p>I found various questions regarding controlling voltage on the data pins or vcc from the usb port and I understand that's not possible, I'm looking for a software solution (although hardware solutions are welcome).</p>

<p>tl;dr: Is there a way to supply the iPhone with less than 500 mA after enumeration? Could I do this in software? Or do I need a hardware solution? I don't want to turn the port on/off, just limit the power draw of the iPhone.</p>

<p>NOTE: I am using Windows CE 6.0, if it is something that can only be done by modifying the drivers, or having direct access, there is no problem.</p>

<p>P.S. also, if there is a way to do this in *nix (or some other open source OS) that I could look at the source code and port it to Windows CE please let me know.</p>",embedded|usb,7504657,cforgacs,no
IOS (Swift) Background speech,"<p>I'm writing an exercise app that runs a series of timers back to back that are determined by the users exercises and the times they have entered for them e.g. push UPS for 30 seconds, squats 20 seconds...</p>

<p>When the timer reaches zero, the app speaks the next exercise, and starts the next timer.</p>

<p>The app also allows the user to play music from playlists whilst they exercise, so I have set the Audio background mode in capabilities in swift.</p>

<p>When in the foreground, everything works as expected, and the times, and speech fire when they are meant to, however, when the app is backgrounded, only the music continues and everything else stops.</p>

<p>I understand that Apple have strict rules on background processes and multitasking, but I have downloaded a number of apps that seem to work fine in the background and continue to speak the intervals as they become due (Seconds Pro, Onyx Timer etc.)</p>

<p>I have researched this for days, but cannot come up with an answer, background fetching doesn't seem to be reliable enough for a time based app, as you can't guarantee when it will fire, I've also looked into local notifications, but they don't allow speech when they trigger, just a short sound, they also have a limit of 64 notifications, which limits the amount of intervals the user can set</p>

<p>I have set the app to keep the screen awake whilst the timer screen is running, but this means you have to keep the screen on whilst you train, which in turn will add an unnecessary drain on the battery, which seems to go against everything Apple is trying to accomplish with the limited background activity</p>

<p>Push notifications seemed like one solution, but this would mean I have to setup some sort of external server and surely this would be interrupted if the user didn't have an Internet connection.</p>

<p>I have read multiple threads about people running a silent audio stream in the background to keep their app alive in the background (not approved by Apple), but my app already plays audio in the background and has no effect on the rest of the app being suspended?</p>

<p>How would I go about achieving this?</p>

<p>I have thought of a workaround, but I don't know if it's good practice, or if it will get the app kicked if I try to upload it to the app store</p>

<p>My solution was to queue my speech based on the time set in each timer</p>

<pre><code>for timer in 0...timersArray.count{

  let sentence = timer.speech
  let speechUtterance = AVSpeechUtterance(string: ""\(sentence)"")
  speechUtterance.postUtteranceDelay = timer.time
  synth.speakUtterance(speechUtterance)
}
</code></pre>

<p>Then the speech would just trigger at the appropriate times, even though the timer wasn't running in the background</p>

<p>When I ran this code, it worked as expected and the speech triggered when the timer would have finished (just as if it was running)</p>

<p>When running this code though, I noticed that not only did it trigger the speech at the correct time, it also kept my app running in the background, which is exactly what I wanted in the first place.</p>

<p>Is this allowed practice, or will it get booted from the store?</p>

<p>As my app plays music in the background and has the audio capability set, is there a way I can use a similar approach, but with the music in the background, rather than the queued utterance approach.</p>

<p>I tried with MPMediaPlayer, AVPlayer, and AVQueuePlayer, but nothing worked, the music played in the background, but the rest of the app stopped</p>

<p>If I set ""Does not run in background"" to ""Yes"" in the Plist.info, the app will now run when the screen is locked, it still won't run in the background though?</p>

<p>There are so many apps in the App Store that seem to run happily in the background, I can't believe it's this hard to get it to work?</p>

<p>A number of the ones I have tried, are not listed under notifications, so I know it's not a local notification, they also work in airplane mode, so it can't be remote push notifications</p>",ios|timer|background|speech,5378867,jamie hancock,no
How to center one of the child widget out of 2 child widgets,"<p>Currently, I have a <code>LinearLayout</code> with <code>NumberPicker</code> &amp; <code>TextView</code> (With text ""long string string"")</p>

<p><img src=""https://i.stack.imgur.com/vcdZ3.png"" alt=""enter image description here""></p>

<p>This is not something I wish to achieve. What I wish to achieve is</p>

<ol>
<li><code>NumberPicker</code> will be at horizontal center</li>
<li>""long string string"" <code>TextView</code> will just sit nicely at the right side of <code>NumberPicker</code></li>
</ol>

<p>The following layout won't work. As it treats <code>NumberPicker</code> + <code>TextView</code> as single element, and center horizontal both of them together.</p>

<pre><code>&lt;LinearLayout xmlns:android=""http://schemas.android.com/apk/res/android""
    xmlns:tools=""http://schemas.android.com/tools""
    android:layout_width=""match_parent""
    android:layout_height=""match_parent""
    android:orientation=""vertical"" &gt;

    &lt;TextView
        android:id=""@+id/message_text_view""
        android:text=""@string/might_drain_battery""
        android:layout_width=""wrap_content""
        android:layout_height=""wrap_content"" /&gt;


    &lt;LinearLayout
        android:gravity=""center""
        android:layout_width=""match_parent""
        android:layout_height=""wrap_content""&gt;
        &lt;NumberPicker
            android:id=""@+id/number_picker""
            android:layout_width=""wrap_content""
            android:layout_height=""wrap_content"" /&gt;

        &lt;TextView
            android:text=""long string string""
            android:layout_width=""wrap_content""
            android:layout_height=""wrap_content"" /&gt;
    &lt;/LinearLayout&gt;
&lt;/LinearLayout&gt;
</code></pre>

<p>I change the code slightly. I remove <code>gravity</code> from inner <code>LinearLayout</code>, and place <code>layout_gravity</code> in <code>NumberPicker</code></p>

<pre><code>&lt;LinearLayout
    android:layout_width=""match_parent""
    android:layout_height=""wrap_content""&gt;
    &lt;NumberPicker
        android:layout_gravity=""center""
        android:id=""@+id/number_picker""
        android:layout_width=""wrap_content""
        android:layout_height=""wrap_content"" /&gt;

    &lt;TextView
        android:text=""long string string""
        android:layout_width=""wrap_content""
        android:layout_height=""wrap_content"" /&gt;
&lt;/LinearLayout&gt;
</code></pre>

<p>But, that won't work still (I was wondering why <code>NumberPicker</code> no longer in center)</p>

<p><img src=""https://i.stack.imgur.com/FU1KA.png"" alt=""enter image description here""></p>

<p>Any suggestion how can I achieve my desired layout?</p>",android|android-layout,72437,Cheok Yan Cheng,no
"Battery use, what to expect?","<p>I'm making a 2D game for Android, and I've recently been looking at optimization. </p>

<p>I looked at the battery-use in Settings and found that after leaving my game in the foreground (with the screen on) for a little over an hour, I had drained 11% of the battery (Motorola Xoom Honeycomb). </p>

<p>Is this something that users should expect from a game on their phone/tablet?</p>

<p><strong>A bit of Info:</strong></p>

<ul>
<li><p>My game uses Opengl-es for rendering (continuous render)</p></li>
<li><p>Logic runs in a separate thread for performance.</p></li>
<li><p>I used getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON); thought it was necessary as the game requires a bit of thinking time from the user.</p></li>
<li><p>Simple Particles</p></li>
</ul>

<p>So, is that kind of battery consumption normal for a game? </p>

<p>And what steps can I take to reduce the battery consumption?</p>",java|android|multithreading|performance|power-management,562562,Jack,no
Possible BUG in Android ImageDownloader class : sHardBitmapCache NOT static when it should be?,"<p>I have been trying to learn as much as possible about Android development with specific focus on performance since many apps in the Play store today are sluggish.  I have found/been directed to many articles/videos.</p>

<p>One specific article about image caching is at: <a href=""http://android-developers.blogspot.com/2010/07/multithreading-for-performance.html"" rel=""noreferrer"">http://android-developers.blogspot.com/2010/07/multithreading-for-performance.html</a></p>

<p>The author has code available at: <a href=""http://code.google.com/p/android-imagedownloader/source/browse/trunk/src/com/example/android/imagedownloader/ImageDownloader.java"" rel=""noreferrer"">http://code.google.com/p/android-imagedownloader/source/browse/trunk/src/com/example/android/imagedownloader/ImageDownloader.java</a></p>

<p>Which Google seemed to take a version of into and put into their sample classes at: <a href=""http://developer.android.com/resources/samples/XmlAdapters/src/com/example/android/xmladapters/ImageDownloader.html"" rel=""noreferrer"">http://developer.android.com/resources/samples/XmlAdapters/src/com/example/android/xmladapters/ImageDownloader.html</a></p>

<p>In general it is solid, except for what I think is a flaw in the caching.  It uses a soft / hard cache that puts / gets things into the hard cache because the Android system resets the soft cache quite often.</p>

<p>Looking at the code though, one starts to wonder if the hard cache would get accidentally reset every time the parent class is instantiated.</p>

<p>First the soft cache:</p>

<pre><code>    // Soft cache for bitmaps kicked out of hard cache
    private final static ConcurrentHashMap&lt;String, SoftReference&lt;Bitmap&gt;&gt; sSoftBitmapCache =
        new ConcurrentHashMap&lt;String, SoftReference&lt;Bitmap&gt;&gt;(HARD_CACHE_CAPACITY / 2);
</code></pre>

<p>Now take a look at the hard cache:</p>

<pre><code>    // Hard cache, with a fixed maximum capacity and a life duration
    private final HashMap&lt;String, Bitmap&gt; sHardBitmapCache =
        new LinkedHashMap&lt;String, Bitmap&gt;(HARD_CACHE_CAPACITY / 2, 0.75f, true) {
        @Override
        protected boolean removeEldestEntry(LinkedHashMap.Entry&lt;String, Bitmap&gt; eldest) {
            if (size() &gt; HARD_CACHE_CAPACITY) {
                // Entries push-out of hard reference cache are transferred to soft reference cache
                sSoftBitmapCache.put(eldest.getKey(), new SoftReference&lt;Bitmap&gt;(eldest.getValue()));
                return true;
            } else
                return false;
        }
    };
</code></pre>

<p>The <strong>hard cache</strong> is <em>not</em> <strong>static</strong>, while the soft cache is static.  So the hard cache instance and therefore items get cleared with the life of the instance of the class.</p>

<p>The reason I think this is true is that I noticed my application with a ListView/ImageView, was downloading the image every time and never caching it.  It was all done asynchronously, but still hitting the net every time. I <strong>verified</strong> this by putting a <code>Log.d()</code> statement inside my method that hits the web and seeing when/how often it was called.</p>

<p><strong>Adding the static keyword fixed the issue and my application is much more performant.</strong>    </p>

<p>I am not sure why this is the case as there is only one instance of the ImageDownloader class in my adapter as shown in the example:</p>

<pre><code>private final ImageDownloader imageDownloader = new ImageDownloader();
</code></pre>

<hr>

<p>THE QUESTION</p>

<p>With all of that said, has anyone else experienced this??? Or am I a combination of crazy/wrong somehow.  I am no Java/Android/JVM/Dalvik/WeakReference/SoftReference expert, but something seems a bit off.  I don't know why <code>sHardBitmapCache</code> was not made static, but when I made the change my application stopped hitting the web so much <strong>(saving on data costs / battery drainage / performance improvements)</strong>.</p>",java|android|performance|caching|dalvik,590774,Issa Fram,yes
Monogame - How to properly cap FPS in Monogame?,"<p>I wanted to cap FPS of my game at 30fps conditionally if being built for Windows Phone, as I don't need it to be running at 60fps on it and I heard from too many it is better to have it capped on mobile device because of battery draining.</p>

<p>I used same snippet of code used by XNA for Windows Phone 7:</p>

<pre><code>//FrameRate is 30fps by default for WindowsPhone.
TargetElapsedTime = TimeSpan.FromTicks(333333);
</code></pre>

<p>But... As it is doing its job capping FPS, it is affecting everything else too, causing stuttering and sound issues. Because of this, I suppose I'm doing something wrong. </p>

<p>Anything which would help me would be great, as I was not able to find anything on the internet regarding this issue (most people wanted quite the opposite :D )</p>",xna|windows-phone-8.1|monogame,3806390,SeriousDude,yes
Android app power consumption measurment,"<p>How to check power consumption of each applications?</p>

<p>I've tried Android studio <a href=""https://developer.android.com/studio/profile/battery-historian.html"" rel=""nofollow"">batterystats</a> and received a batterystats.txt 
.But the source itself pointed out that the category of Estimated power use(below is a part of it)</p>

<pre><code>Estimated power use (mAh)
    Capacity: 2930, Computed drain: 43.9, actual drain: 58.6-87.9
    Screen: 35.6
    Unaccounted: 14.7 ( )
    Uid u0a2618: 2.91 ( cpu=2.17 wake=0.657 wifi=0.00656 sensor=0.0732 )
    Uid 0: 2.24 ( cpu=2.23 wake=0.0000336 wifi=0.00259 )
</code></pre>

<p>""is currently an extremely rough estimate and should not be considered experiment data.""</p>

<p>I've seen a lot of applications which can measure the battery stats. But is there anyway to measure the battery stats by not using applications but other ways(using terminal window &amp; command lines)?   </p>

<p>Any help would be appreciated.</p>",android|android-studio,6642484,wadestrikers,no
Android How to measure app power consumption when plugged,"<p>How to measure app power consumption when I connect my device with my pc?</p>

<p>I've read about <a href=""https://developer.android.com/studio/profile/battery-historian.html"" rel=""nofollow"">batterystats</a> from Android Studio. And I've followed the instructions and get a batterystats dumpsys. However, I can't not let my device consistently plugged on usb port because the result of dumpsys will have a missing part called ""Estimated power use"". Which is the most important part of the whole test because the app power consumption it contained. </p>

<p>I've tried using <a href=""https://play.google.com/store/apps/details?id=es.guille.stopcharge&amp;hl=zh_TW"" rel=""nofollow"">StopCharge</a> app to interrupt phone charging. But the prerequisite is that the device need to get ROOT.</p>

<p>Other options like power tutor is outdated. Information out from the application can't quite fit my request(Android 6.0 or upper).</p>

<p>Is it possible to get the power consumption measurement of an application when it's charging or is my mind out of the roof?</p>

<p>Thank you in advance! </p>

<p>p.s the following is a sample of the method of Android Studio batterystats</p>

<pre><code>Estimated power use (mAh)
Capacity: 2930, Computed drain: 43.9, actual drain: 58.6-87.9
Screen: 35.6
Unaccounted: 14.7 ( )
Uid u0a2618: 2.91 ( cpu=2.17 wake=0.657 wifi=0.00656 sensor=0.0732 )
</code></pre>",android|performance|android-studio,6642484,wadestrikers,no
Java How to parse specific info in log files by java,"<p>I have generated a battery stats log file. I want to parse specific information inside it. Here is the log</p>

<blockquote>
  <p>Battery History (0% used, 200 used of 256KB, 5 strings using 248):<br>
                      0 (9) RESET:TIME: 2016-08-22-16-22-37<br>
                      0 (1) 081 status=charging health=good plug=usb temp=347 volt=4081 +running +wake_lock +wifi_multicast +wifi_radio +screen +plugged brightness=dim +wifi_running +wifi wifi_signal_strength=4 wifi_suppl=completed<br>
                      0 (2) 081 fg=u0a250:""com.sonymobile.lifelog""<br>
                      0 (2) 081 top=u0a119:""com.sonyericsson.home""<br>
                      0 (2) 081 user=0:""0""<br>
                      0 (2) 081 userfg=0:""0""<br>
               +2s544ms (3) 081 status=discharging plug=none temp=340 volt=8236 -plugged<br>
               +6s164ms (2) 081 -top=u0a119:""com.sonyericsson.home""<br>
               +6s165ms (2) 081 +top=u0a215:""com.skysoft.kkbox.android""<br>
  Estimated power use (mAh):<br>
      Capacity: 3430, Computed drain: 1.92, actual drain: 0<br>
      Screen: 1.08<br>
      Uid u0a215: 0.301 ( cpu=0.215 wifi=0.0860 )<br>
      Uid u0a48: 0.138 ( cpu=0.0419 wifi=0.0958 )  </p>
</blockquote>

<p>I want to parse info of uid = 'u0a2618' in this log file.
Information like this</p>

<blockquote>
  <p>Estimated power use<br>
    Uid u0a215: 0.301 ( cpu=0.215 wifi=0.0860 )  </p>
</blockquote>

<p>I want to parse it and regenerates a log file which exactly shows the power use like this mock up.</p>

<blockquote>
  <p>Uid u0a215: = 0.0352</p>
</blockquote>

<p>I'm pretty new to java and still learning it. </p>

<p>Thank you in advance</p>",java|android|parsing,6642484,wadestrikers,no
"What will be battery life of iPhone, if I use CLLocationManger with kCLLocationAccuracyThreeKilometers?","<p>If I am using CLLocationManger with kCLLocationAccuracyThreeKilometers for getting Coordinates and never stop it. 
Have you any idea that in how much time my iPhone battery will drain?</p>",iphone|ios|gps,1613747,Ajay Singh Azad,no
Android Timer which works on both background and foreground,"<p>I'm now working on an app which will track students' studying time.
The student can press start button and start studying.
And stop when he finish studying.</p>

<p>When screen is on or phone is plugged in,the text view and progress bar is updating every second .(I means it works fine)
But when the screen is off,updating the textview and progress is stopped after 10 seconds of sleeping the phone.
I think it may be the activity is pausing.
Is that right?</p>

<p>I tested by using:</p>

<ol>
<li>partial wakelock</li>
<li>service</li>
</ol>

<p>Both of these ways make the battery drains.
Is there any idea for this case?
Thanks.</p>",android|timer|android-service|wakelock|background-service,4822934,Lin Lin,no
react-native app in android: battery being drained in background,"<p>I have an app built in React-Native that is draining a lot of battery on Android devices when in background. Need to significatively reduce battery usage by the app.</p>

<p>The app tracks location using react-native-background-geolocation (mauron85) but get location updates only every 20 minutes (10 fast interval).</p>

<p>A screen of the battery usage report (most time in background):</p>

<p><a href=""https://i.stack.imgur.com/esuhp.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/esuhp.png"" alt=""enter image description here""></a></p>

<p>Maybe some dependency or wrong version?</p>

<p>My package.json:</p>

<pre><code>{
  ""name"": ""AwesomeApp"",
  ""version"": ""0.0.1"",
  ""private"": true,
  ""scripts"": {
    ""start"": ""react-native start"",
    ""test"": ""jest""
  },
  ""dependencies"": {
    ""base-64"": ""^0.1.0"",
    ""d3-interpolate"": ""^1.1.5"",
    ""es6-promise"": ""^4.1.1"",
    ""firebase"": ""^4.6.0"",
    ""lodash"": ""^4.17.4"",
    ""lodash.range"": ""^3.2.0"",
    ""moment"": ""^2.19.2"",
    ""numeral"": ""^2.0.6"",
    ""react"": ""16.0.0-alpha.12"",
    ""react-native"": ""^0.48.2"",
    ""react-native-android-location-services-dialog-box"": ""^2.3.2"",
    ""react-native-checkbox"": ""^2.0.0"",
    ""react-native-drawer"": ""^2.5.0"",
    ""react-native-fbsdk"": ""^0.6.3"",
    ""react-native-fcm"": ""^10.0.3"",
    ""react-native-firebase"": ""^3.2.0"",
    ""react-native-google-places"": ""^2.4.2"",
    ""react-native-google-signin"": ""^0.12.0"",
    ""react-native-keyboard-aware-scroll-view"": ""^0.4.1"",
    ""react-native-mauron85-background-geolocation"": ""^0.5.0-alpha.1"",
    ""react-native-navbar"": ""^2.0.1"",
    ""react-native-permissions"": ""^1.0.1"",
    ""react-native-popup-dialog"": ""^0.9.38"",
    ""react-native-push-notification"": ""^3.0.1"",
    ""react-native-router-flux"": ""^4.0.0-beta.25"",
    ""react-native-spinkit"": ""^1.1.1"",
    ""react-native-splash-screen"": ""^3.0.1"",
    ""react-native-svg"": ""^5.4.1"",
    ""react-native-tab-view"": ""0.0.70"",
    ""react-redux"": ""^5.0.6"",
    ""redux"": ""^3.7.2"",
    ""redux-persist"": ""^5.2.2"",
    ""redux-thunk"": ""^2.2.0""
  },
  ""devDependencies"": {
    ""babel-eslint"": ""^8.0.2"",
    ""babel-jest"": ""21.2.0"",
    ""babel-preset-react-native"": ""4.0.0"",
    ""eslint-config-rallycoding"": ""^3.2.0"",
    ""jest"": ""21.2.1"",
    ""react-test-renderer"": ""16.0.0-alpha.12""
  },
  ""jest"": {
    ""preset"": ""react-native""
  },
  ""rnpm"": {
    ""assets"": [
      ""./assets/fonts/""
    ]
  }
}
</code></pre>

<p>Configuration of background-geolocation:</p>

<pre><code>BackgroundGeolocation.configure({
    desiredAccuracy: 10,
    stationaryRadius: 50,
    distanceFilter: 50,
    startForeground: false,
    debug: false,
    startOnBoot: true,
    stopOnTerminate: false,
    locationProvider: BackgroundGeolocation.ACTIVITY_PROVIDER,
    interval: 1200000, //default 1200000 = 20 minutes
    fastestInterval: 600000, //DEFAULT 600000 = 10 MINUTES
    activitiesInterval: 1200000,  //default 1200000 = 20 minutes
    stopOnStillActivity: false
});
</code></pre>

<p>I appreciate any attempt to help :)</p>",android|react-native,5128626,Bruno Conterato,yes
android LocationListener not stopping GPS use,"<p>In my <code>service</code>, in some scenarios I can't stop the GPS from searching and draining the device battery. </p>

<p><em>LocationListenerAgent.java</em></p>

<pre><code>@Override
public void onCreate() {
    thisContext = this;
    // Register ourselves for location updates

    networkListener = new LocationListenerAgent();
    gpsListener = new LocationListenerAgent();

    lmgrNet = (LocationManager)this.getSystemService(Context.LOCATION_SERVICE);
    lmgrGps = (LocationManager)this.getSystemService(Context.LOCATION_SERVICE);
    gps_enabled = lmgrGps.isProviderEnabled(LocationManager.GPS_PROVIDER);
    lmgrNet.requestLocationUpdates(""network"", ONE_MINUTE, 10, networkListener);
    lmgrGps.requestLocationUpdates(""gps"", ONE_MINUTE, 10, gpsListener);

    super.onCreate();
}

@Override
public void onDestroy() {
    super.onDestroy();
    // Unregister listener
    lmgrNet.removeUpdates(this);
    lmgrNet = null;
    lmgrGps.removeUpdates(this);
    lmgrGps = null;
}
</code></pre>

<p>From some places in my app when I press ""back"" on the main activity, which destroys the app, this is called:</p>

<pre><code>@Override
protected void onStop() {
    if (mBound) {
        unbindService(mConnection); //this is a callback to the locationlisteneragent class to bind it to a service
        mBound = false;
    }
    super.onStop();
}
@Override
protected void onDestroy() {

    if (mBound) {
        unbindService(mConnection);
        mBound = false;
    }
    stopService(new Intent(this, LocationListenerAgent.class));
    super.onDestroy();
}
</code></pre>

<p>maybe my <code>super.On</code> lifecycle methods need to be before the code with the method.</p>

<p>What else do I need to do to stop the GPS??? I've seen other people having problems with this and the answers don't seem so absolute. </p>

<p>In other scenarios in my app, the GPS does stop.</p>",android|service|gps|locationlistener|location-provider,727429,CQM,yes
Use significant location change without users think their battery will drain,"<p>Our users keep complaining that the purple arrow is appearing even though the app is killed and therefore they automatically think its draining their battery.</p>

<p>We use only significant location change by calling</p>

<pre><code>    [locationManager startMonitoringSignificantLocationChanges];
</code></pre>

<p>So if we don’t stop the significant location change the purple arrow stays on (and our users think their battery will drain).</p>

<p>Even if we want to stop the significant location change when the app terminates we can't because applicationWillTerminate is rarely called.</p>

<p>So there are 3 options:</p>

<ol>
<li>Leave it as it is – but the users keep complaining because apple doesn't differentiate between apps that use the regular battery consuming location and the apps that use the significant location change.</li>
<li>Use the regular [locationManager startUpdatingLocation] so when the app terminates so does the monitoring. Problem here is that it really will consume the users' battery as long as the app is not terminated.</li>
<li><p>Call </p>

<pre><code>(void)applicationDidEnterBackground:(UIApplication *)application
{
    [locationManager stopMonitoringSignificantLocationChanges];
}
</code></pre>

<p>Problem here is that we don't benefit from the location changes in the background…</p></li>
</ol>

<p>Are there any other suggestion that will let us do this:</p>

<ol>
<li>Monitor location as long as the app is the background (purple arrow is OK here)</li>
<li>Stop the location monitoring when the app is killed (purple arrow is NOT OK here)</li>
<li>Use the Significant Location Change so to not drain the users' battery.</li>
</ol>

<p>?</p>

<p>Thank you</p>",iphone|objective-c|ios|location|core-location,237461,ozba,yes
Does android.os.Looper drain battery?,"<p>I guess, this is a silly question, but still...</p>

<p>In my app I need to run heavyweight tasks in sequence (in a separate thread of course). So, I think, that Looper is my choice for this. AsyncTask is not the case, because requests can arrive at any time and thread-safe stuff is not nessessary.</p>

<p>Does long usage of android.os.Looper drain android battery fast?</p>

<p>From Looper's <a href=""http://grepcode.com/file_/repository.grepcode.com/java/ext/com.google.android/android/4.3_r2.1/android/os/Looper.java/?v=source"" rel=""nofollow"">source code</a></p>

<pre><code>/**
 * Run the message queue in this thread. Be sure to call
 * {@link #quit()} to end the loop.
 */
public static void loop() {
    final Looper me = myLooper();
    if (me == null) {
        throw new RuntimeException(""No Looper; Looper.prepare() wasn't called on this thread."");
    }
    final MessageQueue queue = me.mQueue;

    // Make sure the identity of this thread is that of the local process,
    // and keep track of what that identity token actually is.
    Binder.clearCallingIdentity();
    final long ident = Binder.clearCallingIdentity();

    for (;;) {
        Message msg = queue.next(); // might block
        if (msg == null) {
            // No message indicates that the message queue is quitting.
            return;
        }

        // This must be in a local variable, in case a UI event sets the logger
        Printer logging = me.mLogging;
        if (logging != null) {
            logging.println(""&gt;&gt;&gt;&gt;&gt; Dispatching to "" + msg.target + "" "" +
                    msg.callback + "": "" + msg.what);
        }

        msg.target.dispatchMessage(msg);

        if (logging != null) {
            logging.println(""&lt;&lt;&lt;&lt;&lt; Finished to "" + msg.target + "" "" + msg.callback);
        }

        // Make sure that during the course of dispatching the
        // identity of the thread wasn't corrupted.
        final long newIdent = Binder.clearCallingIdentity();
        if (ident != newIdent) {
            Log.wtf(TAG, ""Thread identity changed from 0x""
                    + Long.toHexString(ident) + "" to 0x""
                    + Long.toHexString(newIdent) + "" while dispatching to ""
                    + msg.target.getClass().getName() + "" ""
                    + msg.callback + "" what="" + msg.what);
        }

        msg.recycle();
    }
}
</code></pre>

<p>I see, that here we have an infinitive loop, which is quite fine. But still, I'm afraid, that having this Looper in the background of app will burn battery quite fast, that loop is running even when all activities are off.</p>

<p>Does anyone know is that just a myth? Or should I pick up some other class for solving my problem?</p>

<p>Thank you for your time.</p>",android|performance|battery|looper,1353030,UnknownJoe,yes
How to write a test code for a Battery Class?,"<p>Write a Battery class that models a rechargeable battery. A battery has a constructor <code>public Battery(float capacity)</code> where capacity is a value measure in milliampere hours. A typical AA battery has a capacity of 2000 to 3000 mAh.</p>

<p>The method <code>public void drain(float amount)</code> drains the capacity of the battery by the given amount. The method public void <code>charge()</code> charges the battery to its original capacity. The method<br>
<code>public float getRemainingCapacity()</code> returns the remaining capacity of the battery. Create a class <code>BatteryTest</code> that exercises the methods of your Battery class.</p>

<p>I need help writing a test for the class. I wrote the code for the class, but I can't figure out how to write a test for it.  </p>

<pre><code>public class Battery 

{

float fullCharge = 3000;
float batteryCapacity;

Battery() 
   {
    fullCharge = 3000;
    }

public Battery(float capacity) 
    {

    batteryCapacity = capacity;
    fullCharge = capacity;

     }

public void charge()
    {
    batteryCapacity = fullCharge;
    }

   public void drain(float amount) 
   {
    batteryCapacity = batteryCapacity - amount;
    }

   public float getRemainingCapacity()
   {
    return batteryCapacity;
   }
}
</code></pre>

<p>So, I tried writing a test and I got:</p>

<pre><code> public class BatteryTest
{
 public static void main( String[] args )
 {
  Battery battery = new Battery(2500);

  battery.drain(2500);
  battery.charge();

  float capacity = battery.getRemainingCapacity();


  }

}
</code></pre>

<p>But, I'm not really sure. I'm fairly new to this. </p>",java,5357418,Grey,no
iPhone: Paired Devices vs iBeacon Bluetooth Battery Consumption,"<p>I've 2 apps (1 that is registers and scans for iBeacons in the background, no ranging) and the other without. Both of these apps are essentially similar with the exception of 1st being enabled for iBeacons. </p>

<pre><code>// location manager config
    + (CLLocationManager *)sharedLocationManager {
static CLLocationManager *_locationManager;

@synchronized(self) {
    if (_locationManager == nil) {
        _locationManager = [[CLLocationManager alloc] init];
    //_locationManager.desiredAccuracy = kCLLocationAccuracyBestForNavigation;
        _locationManager.desiredAccuracy = kCLLocationAccuracyThreeKilometers;
        _locationManager.pausesLocationUpdatesAutomatically = NO;
        if ([_locationManager respondsToSelector:@selector(allowsBackgroundLocationUpdates)]){
            _locationManager.allowsBackgroundLocationUpdates = YES;
        }
    }
}
return _locationManager;
}

    - (void)startMonitoringItem:(Item *)item {
    CLBeaconRegion *beaconRegion = [self beaconRegionWithItem:item];
    CLLocationManager *locationManager = [LocationTracker sharedLocationManager];
    [locationManager startMonitoringForRegion:beaconRegion];
}

- (void)stopMonitoringItem:(Item *)item {
    CLBeaconRegion *beaconRegion = [self beaconRegionWithItem:item];
    CLLocationManager *locationManager = [LocationTracker sharedLocationManager];
    [locationManager stopMonitoringForRegion:beaconRegion];
}
</code></pre>

<p>I've registered about a 100 iBeacons within the 1st app, and ran both apps on an iPhone 6 and an iPhone 6 Plus, running the same OS version within the vicinity of the 100 plus iBeacons, both with blue tooth enabled. </p>

<p>I'm only interested in entry and exit events, and essentially just implemented both of these calls in the 1st app. I ran the tests for about 14 hours, by just leaving both iPhones with bluetooth enabled within the vicinity of the iBeacons. </p>

<p>When I checked my battery status in my settings menu, the 1st app consumed at most 1% more battery than the 2nd app (eg: 1st app: 25%, 2nd app: 24%), which is the same on both devices. This is expected behaviour, as the blue tooth scanning algorithm controlled by iOS should be optimised to preserve battery. </p>

<p>However, on my client's device, the 1st app consumes 5x more battery than the 2nd app (eg: 1st app: 10%, 2nd app: 2%).  </p>

<p>When I checked his bluetooth setting, I realized that his iPhone was paired with about 8 other devices. </p>

<p>So my question is this. Will pairing with other devices caused a much larger battery drain on my 1st app even though it is just scanning for iBeacons? If yes, is there any way I can optimized by algorithm to ignore paired devices and just scan for iBeacons. </p>

<p>I've read the iOS documentation extensively and consulting stackoverflow, but did not find a satisfactory answer so far. </p>

<p>I will greatly appreciate any advice! </p>

<p>Update: Please see screenshot for an example</p>

<p><a href=""https://i.stack.imgur.com/e4O8F.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/e4O8F.png"" alt=""Battery Consumption Percentages""></a></p>

<p>In the above screenshot, the 1st and 2nd app battery usage percentages are nearly the same on my device. However, on my client's device (which is paired with 8 other devices), the 1st app was typically 5x more than the 2nd app battery usage percentage (eg: 10 % to 2 %), for both the last 24 hours and last 7 days. Both apps were running for approximately the same amount of time on his device. This is not the first time it has occured. </p>",ios|iphone|ibeacon|ios-bluetooth,1433483,Qin Zhengquan,yes
3D games for Google Glass,"<p>I'm wondering if anyone out there has experience working on 3D games for Glass.  I'm working on a Unity game that is coming along nicely, but pushes the limits of the device pretty hard.  In fact, the game is cripplingly slow if you try to play while the device is plugged in (charging), and it drains the battery pretty quickly.</p>

<p>Another unfortunate glitch is that the Unity activity overrides the gesture input, so the swipe-down-to-close action isn't recognized.  I had to hack my own together but it's not perfect.</p>

<p>I'm wondering if these kinds of issues will prevent the app from seeing the light of day.  Has anyone else had any luck submitting 3D games to Google?  I don't see any 3D stuff on Glassware (except maybe the star maps), so I'm worried that this project is a non-starter.</p>",google-glass|google-gdk,421329,scone,yes
Reduce battery drain when playing music in background,"<p>I have an app which plays white noise/ambient sounds in the background to help the user fall/stay asleep, so it's designed to run all night and play in the background and/or when the screen is locked. I'm obviously seeing battery drain as a result, but are there any steps I can take to reduce this battery drain? </p>

<p>The AVAudioPlayer and a few NSTimers should be the only things that are running while the app is backgrounded/screen-locked, but I'm not sure how to determine if there are any other processes running at the same time that could also be killing the battery. I'm sure something in Instruments could tell me, but I'm not sure which one to use - they seem designed to profile an app that's currently running, not one that's currently in the background. </p>",ios|xcode-instruments,1593765,bmueller,no
iOS - How to properly use Background Fetch and Remote Notifications in client server chat app?,"<p>I am building a simple client-server chat application (think WhatsApp,Telegram...).<br>
I am trying to figure out how to use the available background API's to keep the client data updated, specifically, how to handle a case were a chat <strong>room has one or more new messages</strong> in it and the app is in the <strong>background state</strong>.  </p>

<p>The app will target iOS 7 and up so I have these API's regrading background execution:  </p>

<ul>
<li><p>beginBackgroundTaskWithExpirationHandler</p></li>
<li><p>Background Fetch</p></li>
<li>Remote Notifications</li>
</ul>

<p>beginBackgroundTaskWithExpirationHandler doesn't really fits here because I will need to call it manualy when the user exists the app.  </p>

<p>Background Fetch doesn't seem to fit here as well because it will constantly be invoked when not needed and will drain the battery and stress the back-end.  </p>

<p>So I am left with Remote Notifications, which are essentially silent push notifications. The use case I had in mind is:  </p>

<ol>
<li><p>While app in background some new messages were generated in a chat
room.</p></li>
<li><p>The back-end send a Remote Notification to the client.</p></li>
<li>The silent push is handled and the client fetches in background any new data in the chat room.  </li>
<li><p>When fetch is over, a local notification is fired.</p></li>
<li><p>User opens the app with fresh data in chat room.  </p></li>
</ol>

<p>The problem here is that now, the Remote Notifications are my only mechanism for getting new message while in background, and Push Notifications are said to be <strong>best-effort</strong> style and you should not use them for your main means of communication.  </p>

<p>Another approach will be to leave out all the background downloading, and simply ask for new data each time the user opens the app but this will harm the user experience.  </p>

<p>So to sum it up:  </p>

<ol>
<li>Can I <strong>rely on remote notifications as my main means of
communications</strong> when in background (and maybe in foreground, inside a
chat room also) ?</li>
<li>Should I use the other background API's in this case ?  </li>
</ol>

<p><em>I know the question is quite broad in scope and lack focus, but it's mainly for the purpose of not reinventing the wheel. I assume that the scenario I described is quite common and just want to know what is the best way yo tackle it before writing code/spending time on a strategy that is not fitting to begin with.</em></p>",ios|push-notification|client-server|apple-push-notifications,412992,Yaron Levi,yes
What is recommended interval for location updates to get real-time vehicle speed?,"<p>Right now I have such settings for location updates:</p>
<p><code>private const val LOCATION_MIN_TIME_INTERVAL = 200L</code></p>
<pre><code>private val locationRequest = LocationRequest().apply {
    interval = LOCATION_MIN_TIME_INTERVAL
    fastestInterval = LOCATION_MIN_TIME_INTERVAL / 2
    priority = LocationRequest.PRIORITY_HIGH_ACCURACY
}

override fun onLocationResult(locationResult: LocationResult?) {
    super.onLocationResult(locationResult)
    val speed = locationResult?.lastLocation?.speed
}
</code></pre>
<p>Of course it may drain the battery much faster if using 200 milliseconds but I believe that to get current vehicle speed in real time (in KM/H or MPH units for example) requires such interval, so it should be appropriate for such case, isn't?</p>",android|android-location|android-gps|android-fusedlocation,7767664,user924,no
Android WorkManager: Is it possible to set task's maximum execution duration,"<p>I have a periodic task that requesting location updates on the background, but I need to restrict this task too work for a long period of time, as it will drain battery, so I need to stop it after a few minutes (3 min). Does Work Manager provide some mechanism to restrict the task's execution time ?</p>",android|android-workmanager|android-jobscheduler,8153664,Robert Apikyan,no
Force Proximity Alert to use Network Provider,"<p>Is there any way to force proximity alerts to use only network provider?
I'm worried about battery drain.
Forcing proximity alerts to take more than 4 minutes to be fired would be a good solution too.</p>

<p>Any ideas?</p>",android|locationmanager,1261084,alexandrecosta,no
"Data imported to Samsung Health doesn't show in the app, but they are imported to HealthDataStorage","<p>I'm just copying <a href=""https://developer.samsung.com/forum/board/thread/view.do?boardName=SDK&amp;messageId=367731&amp;startId=zzzzz~&amp;searchSubId=0000000032"" rel=""nofollow noreferrer"">my question from Samsung Developers portal</a> as I had no resonses from them for 2 days. </p>

<p>I've imported 3 years worth step counter data from FitBit to <a href=""https://www.samsung.com/uk/apps/samsung-health/"" rel=""nofollow noreferrer"">Samsung Health</a> via <a href=""https://developer.samsung.com/health"" rel=""nofollow noreferrer"">Samsung API</a>. </p>

<p>I can see they are there, in Samsung's storage, when I query API from my app or <a href=""https://developer.samsung.com/health/android/data/guide/dataviewer"" rel=""nofollow noreferrer"">Samsung's Data Viewer app</a> (when I manage to get it working). </p>

<p>However in the Health app itself I can only see the data which are about month old. But to make it even weirder - that month old data - I managed to upload them, but I couldn't get them deleted from the app. At least not visually, because physically they did get deleted and re-uploaded again. </p>

<p>To add more to all this - after the 3 year worth of data upload the app became very sluggish and drained my phone's battery in half day, because it was doing something in the background. After 1 day I've reinstalled the app and now it doesn't drain the battery, but imported step count data are still not showing. </p>

<p>Adding/removing steps for current day shows pretty much instantly in the app, so it's not the problem with the method, but more like with the volume and the age of the data. I've imported these 3 year data on a minute basis. </p>

<hr>

<p>Right, so today, or more specifically after something like 24 hours - my imported data are gone from the HealthDataStore... 
Will try again - don't you worry, Samsung... </p>

<p>FitBit data for the last 3 months are in HealthDataStore now. Visible both from Data Viewer and from my app via Samsung Health API. Doesn't appear in Samsung Health app again. Some phantom numbers from 17th of March until 8th of April (when I got my Galaxy Watch) are still in Samsung Health app and remains there despite me adding or removing data for those days. They only shows when 'All steps' option is picked up, but doesn't show when I choose individual devices (phone, watch or unknown0). Please see below - Samsung Health app shows data that's been/ supposed to be deleted: </p>

<p><img src=""https://i.stack.imgur.com/QuXDx.jpg"" width=""389"" height=""800""></p>

<p>Data Viewer app shows data that are updated, however they are not shown in Samsung Health app: </p>

<p><img src=""https://i.stack.imgur.com/SlNqZ.jpg"" width=""389"" height=""547""></p>

<p>And here, in my app, I can query any of uploaded date too, but it's not visible in Samsung Health app: </p>

<p><img src=""https://i.stack.imgur.com/WP2NG.jpg"" width=""389"" height=""800""></p>

<hr>

<p>Added weight records for the last 3 years from FitBit today - no problems with those - comes up on Samsung Health up within a seconds. </p>

<p>The steps that were previously gone/deleted from SamsungHealthStorage are now visible again via my app and Data Viewer app, but not via Samsung Health app. So basically these data got restored somehow. What is going on?.. </p>

<hr>

<p>Adding Heart Rate data does also work fine. So the problems remains with Step Counter data - no visual appearance in Samsung Health app - only in SamsungHealthStorage. </p>",android|fitbit|samsung-health,1380473,Donatas,no
how to implement methods in a test class?,"<p>I made this class but I cannot find a way to make the test class and implement the methods I used.</p>

<pre><code>public class Battery
{      
       private float fullCharge = 3000;
       private float batteryCapacity;
       public Battery (float capacity)
       {
            if(capacity &gt;0) 
            batteryCapacity = capacity;
            fullCharge = capacity;          
       }  
       public void drain (float amount)
      {
             batteryCapacity = batteryCapacity -= amount;
       }
       public void charge (float amount)
       {
             batteryCapacity = fullCharge;
       }
       public float getRemainingCapacity()
       {
             return batteryCapacity;
       }
}
</code></pre>",java|class|test-class,4909988,Samled,yes
Reducing iOS Background Location Battery Usage,"<p>I'm working on an iOS app that ideally needs to run the location services in the background. I've tested the significant location, and that isn't accurate enough. The accurate location is perfect, but this consumes far too much battery life to make the app viable.</p>

<p>To get around this battery issue I thought I'd found a solution that uses <code>NSTimer</code> inside <code>UIApplication:beginBackgroundTaskWithExpirationHandler:</code>.  This turns the location on and then instantly off again, which triggers a location update and resets the <code>backgroundTimeRemaining</code>.</p>

<p>However, this solution still drains a lot of battery – 15%-20% every 3-4 hours – even when the location is only turned on for one second every 9 minutes. The app is not running anything else in the background aside from this one timer. I've even tried releasing all of the views when entering the background to make sure there is nothing sitting and consuming the battery.</p>

<p>Checking inside instruments,  I found the app is using 0.0% of the CPU and 14 MB of memory while in this waiting state. I'm at a bit of a loss at this point as to the cause, especially since running the GPS for 1 second every 540 seconds does not provide an appreciable reduction in battery consumption, compared to running it 24/7. </p>

<p>I've started compiling the following questions, which might contribute to the problem, and I'm hoping somebody has an answer or an idea...</p>

<ul>
<li><p>Does running an app in this way stop the phone from entering some sort of low power mode?</p></li>
<li><p>Does starting the GPS use huge amounts of power?</p></li>
<li><p>Does the GPS keep running for a period of time even after turning off?</p></li>
</ul>",ios|background|gps|location|power-management,1320131,Andy,yes
WP7 GPS information broadcast,"<p>Is there a way to get Windows Phone 7 to “broadcast” its physical location automatically?</p>

<p>I’m trying to work around the fact that the GPS data will only be available to my app when the app is actually running. Ideally, it would somehow be possible for the user to configure the phone to continuously broadcast the location at intervals to a webservice. This way it would be possible to create a basic GPS tracker, which works even when the app is not active. When the app is launched again, it queries the same webservice to find out where the phone has been since the last time. </p>

<p>Yes, it will be a battery drain, and yes, there’s going to be privacy issues and all sorts of other problems. But it’s up to the user to decide if he/she enables the service.</p>

<p>And finally, yes, I realize the answer to this question in all likelihood is going to be “no” – at least until we get some kind of multitasking support on WP7. :)</p>",windows-phone-7|gps,10932,Jakob Gade,yes
Best way to send user location updates to the server in the background(Android),"<p>My app needs to send the user location update frequently even when he is not using the app. So I created a service that returns start_sticky and I am using Google location services to send the data as specified here 
<a href=""https://developer.android.com/training/location/receive-location-updates.html"" rel=""nofollow"">android location updates</a>. My service is implementing ConnectionCallbacks, OnConnectionFailedListener, LocationListener So whenever onLocationChanged(Location location) is being called I am sending the location to server. I want to know if doing this way can cause faster battery drain. If so what is the better way to do. While asking this question stackoverflow gave me a warning saying that the question appears subjective amd might be closed. But I cant figure out another way to ask this question. Hope  someone might help me with this. Thanks in advance </p>",android|service|location,4123984,krishna,yes
Does continuous running service affects/drains battery?,"<p>I want to observe the changes in a directory mostly the new file creations,
So I am using this methods described here -
<a href=""https://www.darshanpandya.cf/blog/fileobserver-is-kinda-dead-whats-the-alternative/"" rel=""nofollow noreferrer"">https://www.darshanpandya.cf/blog/fileobserver-is-kinda-dead-whats-the-alternative/</a></p>

<p>My point is,
if I use the methods above in a continuous service like calling BroadcastReceiver from Service's onDestroy() &amp; starting the service again from BroadCastReceiver's onReceive(),
will there be an excessive battery drain?</p>",android|android-service,6819340,DarShan,no
Android : Implement Broadcast Receiver for ClipboardManager,"<p>I want to implement a listener which will listen if some copied any thing from any application. </p>

<p>I heard about <code>ClipboardManager.OnPrimaryClipChangedListener()</code> which will listen copy action, but this is not a Receiver (As I understand). I got a <a href=""http://code.google.com/p/my-clips/source/checkout"" rel=""nofollow"">sample application</a>, logic behind this application is, start service from system boot and run a service which will listen Copy action, but I think this will drain the battery. Am I right? </p>

<p><em><strong>So how can I implement a Broadcast receiver which can listen Copy action.</em></strong> </p>",java|android|broadcastreceiver|listener|clipboardmanager,1109344,Android Learner,no
Turning off GPS in background,"<p>I am using CoreLocation to determine user's location to calculate the distance and show the route on the map. To minimize battery usage I am turning off GPS after getting location and turning it on again after 1 minute. When the application is active everything works fine, but after sending it to background and turning off GPS, the app seems to be inactive at all, it doesn't output anything (using <code>NSLog()</code>). I have added directive to <code>info.plist</code> file to allow the application to run in background. When I don't turn off the GPS in background the app works as well as in foreground.</p>

<p>So my question is the following: does GPS always need to be turned on in background to prevent the application to be suspended or there is another workaround (because the turned GPS drains the battery)?</p>

<p>P.S. I am new to iOS and mobile development at all, so maybe there are some tips that I have to know.</p>",ios5|gps|core-location|background-process,624305,haynar,no
How to make Location Services icon disappear from Status Bar?,"<p>My application doesn't need location service to constantly monitor user's location and I really don't want to drain battery, so on startup I get the location, send it to statistics server and call <code>stopUpdatingLocation</code> on my <code>CLLocationManager</code> instance. Icon disappears from status bar! :)</p>

<p>Next, in one of my tabs I have <code>MKMapView</code> in which user can ask for and see (using annotation) his current location. After I switch to another tab with different view I'd like to stop using location services. How to achieve this? I've read SO question <a href=""https://stackoverflow.com/questions/4413963/what-determines-the-presence-of-the-iphone-location-services-icon-in-the-status-b"">What determines the presence of the iPhone Location Services icon in the status bar?</a> and now I'm about to start thinking described use case is a bug in iOS (?).</p>

<p><strong>EDIT:</strong> in view with <code>MKMapView</code> I don't use <code>CLLocationManager</code> at all.</p>",iphone|objective-c|cocoa-touch|mkmapview,344036,matm,no
Core Location in Swift,"<p>This is sample code. <code>NSLocationAlwaysUsageDescription</code> key in Info.plist installed. All work fine - program receives the coordinates.... displays them.....</p>

<p>And it continues to update them permanently! In the case of the iOS simulator - it is not critical, but in the case of a real application it is very quickly drain the battery. How to make an application launched Core Location, received location, and got shut down Core Location?</p>

<pre><code>import UIKit
import CoreLocation

class ViewController: UIViewController, CLLocationManagerDelegate {

@IBOutlet var locLabel: UILabel
@IBOutlet var latLabel: UILabel
@IBOutlet var lonLabel: UILabel

var locationManager = CLLocationManager()

override func viewDidLoad() {
    super.viewDidLoad()
}

override func didReceiveMemoryWarning() {
    super.didReceiveMemoryWarning()
}

@IBAction func locButton(sender: AnyObject) {
    locationManager.delegate = self
    locationManager.desiredAccuracy = kCLLocationAccuracyBest
    locationManager.requestAlwaysAuthorization()
    locationManager.startUpdatingLocation()
}

func locationManager(manager:CLLocationManager, didUpdateLocations locations:AnyObject[]) {
    println(""locations = \(locationManager)"")
    var latValue = locationManager.location.coordinate.latitude
    var lonValue = locationManager.location.coordinate.longitude
    latLabel.text = String(latValue)
    lonLabel.text = String(lonValue)
    locLabel.text = ""success""
}
</code></pre>

<p>}</p>",swift|core-location|cllocationmanager|ios8,1758285,Alexey Nakhimov,yes
Is there a Criteria to get the most recent fix in time (and not the most accurate),"<p>This is the code I use to get the last known location without adding a listener. I don't want to drain the battery, so I used:</p>

<pre><code>public static Location getLastLoc(Context context){

    Location loc = null;

    LocationManager locationManager = (LocationManager) context
            .getSystemService(Context.LOCATION_SERVICE);
    Criteria criteria = new Criteria();
    String best = locationManager.getBestProvider(criteria, true);
    //Log.i(""***"", best);
    if (best != null) {
        loc = locationManager.getLastKnownLocation(best);
    }
    //Sometimes getLastKnownLocation return null (new device), so I use network as default when possible. 
    if (loc == null) {
        try {
            loc = locationManager
                    .getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    return loc;
}
</code></pre>

<p>I am currently trying this code and the best provider sounds to be the GPS.</p>

<p>Unfortuantely, I have moved from city A to city B this morning and I haven't got a GPS fix yet. (but GPS is turned ON)</p>

<p>So I still get the old city A while I am at city B, and the Network location knows city B (tested with Google Maps)</p>

<p>So, as I don't need accurate position, how would it be possible to get the latest fix in time (GPS is 3 hours old, and network is 10 minutes old) </p>

<p>Thanks</p>",android|gps|locationmanager,327402,Waza_Be,yes
iOS: Start uploading user location after request from server,"<p><br />
I need to achieve this: I have an app, which wants to keep track of location of family members. Since I don't want to keep the GPS running all the time, I was thinking I could just send a request from server, when some family member wants to know my location. <br />
But I ran into some problems: <br />
I can't use PUSH Notifications, because those need to be confirmed (tapped on) and only after that the app knows something happened. (This would not be great, since kids probably wouldn't tap the push notifications) <br />
The other option would be to keep the app running in the background, checking server for any news and if it found some request on server only then start the GPS tracking and upload coordinates to server. This sounds a bit better, but also battery draining. <br />
Did anyone already try this? Is there any better way to this problem? <br />
Thanks for any reactions! :)</p>",ios|gps|notifications|push-notification|tracking,678377,haluzak,yes
Android battery level intent crashes with java.util.UnknownFormatConversionException: Conversion = 'p',"<p>I have a really strange crash quite hard to reproduce as my code works 99,999999% of the time.
I'm on Android API 25. I read the battery level thanks to the Battery changed intents:</p>

<pre><code>class BatteryService {
    val batteryLevelPercent = Observable.using(
        {
            val rxObserver = BehaviorSubject.create&lt;Int&gt;()

            val receiver = object : BroadcastReceiver() {
                override fun onReceive(arg0: Context, intent: Intent) {
                    val level = intent.getIntExtra(BatteryManager.EXTRA_LEVEL, 0)
                    rxObserver.onNext(level)
                    Timber.i(""battery level = $level"")
                }
            }

            context.registerReceiver(receiver, IntentFilter(Intent.ACTION_BATTERY_CHANGED))

            receiver to rxObserver
        },
        { (_, observer) -&gt; observer },
        { (receiver, _) -&gt;
            context.unregisterReceiver(receiver)
        }
    ).replay(1)
        .refCount()
</code></pre>

<p>Easy, but in the rare cases I got crashes the battery was very low, about 0 to 1%. I got this exception:</p>

<pre><code>io.reactivex.internal.functions.Functions$Array2Func.apply Functions.java, line 529
java.util.UnknownFormatConversionException: Conversion = 'p'
java.util.Formatter$FormatSpecifier.conversion Formatter.java:2730
java.util.Formatter$FormatSpecifier.&lt;init&gt; Formatter.java:2759
java.util.Formatter$FormatSpecifierParser.&lt;init&gt; Formatter.java:2591
java.util.Formatter.parse Formatter.java:2524
java.util.Formatter.format Formatter.java:2472
java.util.Formatter.format Formatter.java:2426
java.lang.String.format String.java:2626
com.telecomdesign.amelia.settings.menu.advanced.systemUpdate.SystemUpdateViewModel$$special$$inlined$combineLatest$1.apply Observables.kt:252
io.reactivex.internal.functions.Functions$Array2Func.apply Functions.java:529
io.reactivex.internal.functions.Functions$Array2Func.apply Functions.java:516
io.reactivex.internal.operators.observable.ObservableCombineLatest$LatestCoordinator.drain ObservableCombineLatest.java:197
io.reactivex.internal.operators.observable.ObservableCombineLatest$LatestCoordinator.innerNext ObservableCombineLatest.java:237
io.reactivex.internal.operators.observable.ObservableCombineLatest$CombinerObserver.onNext ObservableCombineLatest.java:306
io.reactivex.internal.operators.observable.ObservableCombineLatest$LatestCoordinator.drain ObservableCombineLatest.java:208
io.reactivex.internal.operators.observable.ObservableCombineLatest$LatestCoordinator.innerNext ObservableCombineLatest.java:237
io.reactivex.internal.operators.observable.ObservableCombineLatest$CombinerObserver.onNext ObservableCombineLatest.java:306
io.reactivex.internal.operators.observable.ObservableMap$MapObserver.onNext ObservableMap.java:62
io.reactivex.internal.operators.observable.ObservableRefCount$RefCountObserver.onNext ObservableRefCount.java:208
io.reactivex.internal.util.NotificationLite.accept NotificationLite.java:246
io.reactivex.internal.operators.observable.ObservableReplay$BoundedReplayBuffer.replay ObservableReplay.java:698
io.reactivex.internal.operators.observable.ObservableReplay$ReplayObserver.replay ObservableReplay.java:401
io.reactivex.internal.operators.observable.ObservableReplay$ReplayObserver.onNext ObservableReplay.java:366
io.reactivex.internal.operators.observable.ObservableUsing$UsingObserver.onNext ObservableUsing.java:104
io.reactivex.internal.util.NotificationLite.accept NotificationLite.java:246
io.reactivex.subjects.BehaviorSubject$BehaviorDisposable.test BehaviorSubject.java:569
io.reactivex.subjects.BehaviorSubject$BehaviorDisposable.emitNext BehaviorSubject.java:564
io.reactivex.subjects.BehaviorSubject.onNext BehaviorSubject.java:268
com.mypackage.BatteryServiceDefault$batteryLevelPercent$1$receiver$1.onReceive BatteryService.kt:29
</code></pre>

<p>The ""BatteryService.kt:29"" line is <code>rxObserver.onNext(level)</code>. I suppose the crash does not come from RX but from the intent as it has certainly be inlined by the compiler. My theory is that the intent extra level is not properly formatted but contains a <code>p</code> instead of an integer that it can't convert string to int.</p>

<p>Did someone already report that ? Might it be an android bug in the battery level border cases ?
Thanks in advance if you have any clue.</p>",android|kotlin|rx-java,7219905,Oliver,yes
"what drains more my battery? wifi, dataconnection(3g) or gps. ANDROID","<p>I use the application profiler+ so i set some rules when to change profiles, but i am interested what drains more my android SE Arc S when the screen is off, is it if gps is turned on or WIFI ? </p>",android|gps|android-wifi|power-management,916492,denza,no
Android: Right approach for sensing the distance between current location and some point of interest?,"<p>I have a question regarding my programming approach for android - whether it's efficient or not. Just to give you an idea what I try to accomplish:</p>

<p>There are multiple points of interests on a map. If the user gets nearer to a PIT, a notification about the distance shall appear. There are let's say 3 notifications: At a distance of 1 mile, 0.5 miles and 0.1 mile. When the user is more or less exactly at the PIT, no more notifications are shown. The user is supposed to drive a car or another vehicle.</p>

<p>I'm currently using Geofences to detect whether the user has entered a radius of 1 mile. If so, I check the distance of his current location to the PIT. If it's about 0.5 or 0.1 miles away, a notification is fired. Therefore, I check the current location frequently (right now every 10 seconds). If the user is like at the PIT or rather very close, the Geofence is exited and done. </p>

<p>The code is working fine and this approach is the first thing that came to my mind while reading the Android Developer's tutorials etc. But is there another approach that is MORE EFFICIENT? </p>

<p>Although this is (currently) meeting my needs, I have two major concerns:</p>

<ol>
<li><p>It seems to drain the battery quite a lot. Since the user is most likely to be in a car where he can charge his phone during usage, this might be less of a problem. </p></li>
<li><p>I read the number of PITs from a file on the SD card. In my example I have just a few PITs. But the user is able to modify the source data so that he can add as many as he wants to. Google says that only 100 active Geofences are supported per user. But what if my user has more than 100 PITs? Since I'm using a Geofence to sense whether I have to fire the first notification or not - this is a severe problem. So is there an alternative?</p></li>
</ol>",android|google-maps|distance|android-geofence,4805356,h4wX,no
Android Google Play Services API for GPS only?,"<p>this might seem like a very stupid question to you, but I haven't found any answer to it yet.</p>

<p>In Android, there are two possibilities of making the application location aware. a) with the Android Location API or b) with the <code>Google Play Services API</code>. It is recommended to use the <code>Google Play Services API</code> since it's less battery draining and provides more accuracy. </p>

<p>But what if I only wanted to use GPS? No additional accuracy by combining some mobile data etc. Just plain GPS without having any internet connection. Is it still preferable to use the <code>Google Play Services API</code>? Also, does it require internet connection at some point? The <code>onConnect()</code> method is supposed to be called when a connection to the <code>GoogleApiClient</code>  is established. Does that mean that a connection to a Google Server is needed or only that the locally saved Google Play Services (on the device) is connected to?  </p>",android|google-maps,4805356,h4wX,no
"Android inter process communication BroadcastReceiver, AIDL","<p>I'm developing an application where it should be possible to receive some Objects from other applications (Server).
As a developer of a Client application it should be as easy as possible to implement the stuff which is needed to send Objects to my Server application.</p>

<p>I have already read alot about BroadcastReceivers, AIDL, Messenger.</p>

<p>On most sites, it is suggested to use AIDL or Messenger (which uses AIDL internally). But why not use a BroadcastReceiver? It is very easy to use and works just fine. Is it draining battery or lacking performance?</p>

<p>Which ""technology"" should I use for my application? BroadcastReceiver? AIDL? Messenger? ContentProvider? Unix pipes?</p>

<p>Are there any good websites / books which explain this kind of communication?</p>",android|performance|ipc,3860580,Ant1Zykl0n,yes
Unable to send HTTP requests on wearos bluetooth,"<p>I've developed an wear os 2.0+ app which communicates with an HTTP API. I'm using Volley to connect to this API, but it only seems to work whenever I've switched bluetooth off. Any requests I make with bluetooth simply timeout. The other end usually respond within miliseconds and returns not more than a few kilobytes.</p>

<p>The documentation states the following regarding networks access:</p>

<blockquote>
  <p>Wear OS apps can make network requests. When a watch has a Bluetooth
  connection to a phone, the watch's network traffic generally is
  proxied through the phone. But when a phone is unavailable, Wi-Fi and
  cellular networks are used, depending on the hardware. The Wear
  platform handles transitions between networks.</p>
</blockquote>

<p>So from my understanding Android should take care of making sure my requests make it to the other end, either with bluetooth (proxied through phone) or wifi.</p>

<p>The actual code which makes the HTTP request with volley:</p>

<pre><code>public &lt;T&gt; CompletableFuture&lt;T&gt; send(String url, Class&lt;T&gt; type) {
    CompletableFuture&lt;T&gt; requestCompletableFuture = new CompletableFuture&lt;&gt;();

    JsonObjectRequest request = new JsonObjectRequest(Request.Method.GET, url, null,
            response -&gt; {
                T data = serializer.fromJson(response.toString(), type);

                requestCompletableFuture.complete(data);
            }, (ex) -&gt; {
                requestCompletableFuture.completeExceptionally(ex);
    });

    request.setRetryPolicy(new DefaultRetryPolicy(15000,
            0,
            DefaultRetryPolicy.DEFAULT_BACKOFF_MULT));

    requestQueue.add(request);

    return requestCompletableFuture;
}
</code></pre>

<p>Android does provide a ConnectivityManager which gives me the ability to request a WIFI network. But creating a high bandwith network which I don't need sounds  a bit unnecessary and battery draining what I am trying to prevent.</p>",android|wear-os,2538813,Jamie,yes
"ios ""smart"" location tracker and battery drain","<p>I'm creating an activity tracker similar to the ""Moves"" app that seeks to track steps, distance, calories and active time.</p>

<p>For Iphone5s+ devices, I am using the built in M7 chip to determine Steps, and then making estimates at the rest from that.  For M7 devices I never use GPS.  There is basically no battery drain and the interpolated numbers are reasonable enough for the need.  This gets walking/running data reasonably enough.</p>

<p>However to support Iphone5 and Iphone4 at least, I need to use GPS to get location and then interpolate steps and calories from the distance.  I'm running into significant battery drain issues (somewhat expected), and am seeking advice on how to minimize this.  I'm also using the accelerometer in addition to speed to help make an educated guess on activity type (walking,running,biking,transport)</p>

<p>Some things I've tried for GPS optimization:</p>

<ol>
<li><strong>Deferred Updates</strong>:  The Iphone5 and a minimum version of IOS supports this.  The code to do this is straight forward, however whether the device actually uses it is questionable.  I've only seen it work on 1 out of 4 devices, where it does regularly.  3 other devices have never deferred updates from the same code.  Another user suggested other apps prevent the device from sleeping, including when I had ""Moves"" also installed. This thus hasn't helped much beyond theory.</li>
<li><strong>Reduce Accuracy</strong>: reduce the accuracy of continuous location polling.  I started at High, but reduced to 10m, then hundreds of meters, etc.  This doesn't seem to help and polling still seems to occur at a regular interval anyway.</li>
<li><strong>startMonitoringSignificantLocationChanges</strong>:  In order to reduce endless gps polling when the user may not be moving for hours at a time (especially at night), I switched from continuous polling to significant changes only after the device stopped moving for an arbitrary 2 minutes.  I then re enable continuous tracking after any significant location update.  This works pretty much as expected-- if it stops tracking then battery drain slows, and when it resumes continuously, battery drain resumes.  Further, if a user starts walking, there is no guarantee of a significant motion event for some time. This is very poor for accuracy.  Sometimes it doesn't seem to resume at all.</li>
</ol>

<p>I've been relatively impressed that the ""Moves"" app, among others is able to track location so well with respectable battery drain.  It can go most of a day until needing a charge.  With my code, users have reported full battery drain in a couple of hours.</p>

<p>What kind of optimizations could be used to improve this but still maintain a reasonable accuracy in tracking movement?</p>

<p><strong>PROGRESS UPDATE:</strong>
<strong>startMonitoringSignificantLocationChanges</strong>.  I set this up with a timer that switches to significant monitoring after 2 minutes of inactivity (not moving).  Normal location tracking is then resumed again on any significant change, or when the app becomes active from reopening. This seems to work well.  My phone still goes from 100% to 10% in 8 hours overnight of sitting around.  It is an old iphone with some battery troubles, but normally it might just lose 30-40% uncharged overnight with no apps running. I need to test more, but startMonitoringSignificantLocationChanges still seems to use some battery.</p>

<p>Further, startMonitoringSignificantLocationChanges has some expected accuracy issues in terms of when it restarts the app.  In rural setting, it can go several kilometers before restarting.  This could be okay for a long drive, but <strong>if I want to catch a 30 minute walk, it may miss that entirely.</strong> In urban setting it seems to kick in within 2-3 blocks of movement, which is reasonable.</p>

<p>Even if I used continuous location tracking that stopped+started on a timer to check for movement, I'd still likely have worst case of a minute of lag between restarts before resuming continuous logging.</p>

<p><strong>PROGRESS UPDATE 2</strong>:</p>

<p>Significant change updates described above have a fatal flaw for me: they don't always start fast enough.  Sometimes it takes 1-2 miles it seems!   </p>

<p>As an a better approach, I've tried keeping continuous location updates on, but toggling the ""desiredAccuracy"" property from high to low accuracy when the device is not moving.  This should essentially turn the GPS receiver off during inactivity.  I've been experimenting between 100meter and 1km accuracy for inactivity with promising results.  It does seem to use slightly more batter than only using significant change monitoring, but it seems more responsive as well.</p>",ios|gps|location|battery,1795643,Miro,yes
"FusedLocationProviderClient keeps showing ""Searching gps"" notification","<p>I would like to ask a clarification about the meaning of the ""Searching gps"" notification. I have a simple app that tries to retrieve user position via FusedLocationProviderClient with this code: </p>

<pre><code>val fusedLocationClient = LocationServices.getFusedLocationProviderClient(activity as Activity)
fusedLocationClient.lastLocation
                .addOnSuccessListener { location: Location? -&gt;
                    mMap.isMyLocationEnabled = true
                    // other trivial stuff here
                }.addOnFailureListener {
                    // showing an error here
                }
</code></pre>

<p>Even when last location is retrieved android keeps showing the ""Searching gps"" notification (Ricerca gps in the screenshot below). As far as you know, this means that app is still searching for gps updates (and so draining battery) or is a simple message to notify the user that the app is using the gps? Thanks for the clarification, my device is a Xiaomi Redmi 5 Plus (MiUI)</p>

<p><a href=""https://i.stack.imgur.com/6V1zh.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/6V1zh.png"" alt=""enter image description here""></a></p>",android|kotlin|android-gps,6275174,Nicola Gallazzi,no
Android capture media button when screen is off,"<p>I'm trying to capture when the media button is pressed while my screen is off. First I use <code>getWindow().addFlags(WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED);</code> to keep my activity up over the lock screen and <code>PowerManager.PARTIAL_WAKE_LOCK</code> (I know this drains the battery but this is will only be on for a short time). Then to listen for the media button I override <code>public boolean onKeyDown(int keyCode, KeyEvent event)</code> and use <code>if(keycode == KeyEvent.KEYCODE_HEADSETHOOK)</code>. The problem is this doesn't work if the screen is off. </p>

<p>I've seen a couple of people use BroadcastReceiver to capture the media button will that work if my screen is off? </p>

<p>If it won't work is there any way I can capture that event while the screen is off?</p>

<p>If it will work how would I implement that? because I've tried following some example on here but I cannot get it to work even when the screen is on. If the BroadcastReceiver will work I can post what I have so far that's not working even when the screen is on. </p>

<p>UPDATE</p>

<p>I found a similar answer at <a href=""https://stackoverflow.com/questions/28798116/how-to-use-the-new-mediasession-class-to-receive-media-button-presses-on-android"">use new media session class</a>. I can capture when the media button is pressed (even when the screen is off) but I don't capture when the volume button is pressed (screen on or off). Here is what I implemented:</p>

<pre><code>mediaSession = new MediaSession(getApplicationContext(), this.getLocalClassName());

if (mediaSession == null) {
    Log.e(""TEST"", ""initMediaSession: mediaSession = null"");
    return;
}

mediaSessionToken = mediaSession.getSessionToken();

myVolumeProvider = new VolumeProviderCompat(VolumeProviderCompat.VOLUME_CONTROL_RELATIVE, 1000, 0) {
    @Override
    public void onAdjustVolume(int direction) {
    Log.d(""TEST"", ""onAdjustVolume called: "");

    }
};

mediaSession.setPlaybackToRemote((VolumeProvider) myVolumeProvider.getVolumeProvider());
mediaSession.setCallback(new MediaSession.Callback()
{
    public boolean onMediaButtonEvent(Intent mediaButtonIntent) {
    Log.d(""TEST"", ""onMediaButtonEvent called: "" + mediaButtonIntent);
    return false;
    }

    public void onPause() {
    Log.d(""TEST"", ""onPause called (media button pressed)"");
    super.onPause();
    }

    public void onPlay() {
    Log.d(""TEST"", ""onPlay called (media button pressed)"");
    super.onPlay();
    }

    public void onStop() {
    Log.d(""TEST"", ""onStop called (media button pressed)"");
    super.onStop();
    }

});

mediaSession.setFlags(MediaSession.FLAG_HANDLES_MEDIA_BUTTONS | MediaSession.FLAG_HANDLES_TRANSPORT_CONTROLS);

PlaybackState state = new PlaybackState.Builder()
    .setActions(PlaybackState.ACTION_PLAY)
    .setState(PlaybackState.STATE_STOPPED, PlaybackState.PLAYBACK_POSITION_UNKNOWN, 0)
    .build();

mediaSession.setPlaybackState(state);

mediaSession.setActive(true);
</code></pre>",java|android|broadcastreceiver,6529755,Jonathon Gardner,yes
HTC One: DropBoxManagerService goes haywire after upgrade to KitKat 4.4.2,"<p>I have noticed that the LOGCAT of my HTC One is getting flooded with messages from a ""DropBoxManagerService"" after I upgraded my device to Android KitKat 4.4.2.</p>

<p>I'm seeing this message repeated over and over again:</p>

<blockquote>
  <p>02-28 16:37:39.089     773-1376/? D/DropBoxManagerService﹕ Found time mapping 1393414988780 -> 1393414988780</p>
</blockquote>

<p>It's outputting so fast that IntelliJ Idea's LOGCAT window is complaining: <b>""Too much output to process""</b>. It can go on for hours before it settles down, and then starts again at some (apparently) arbitrary point in time.</p>

<p>I have tried to reset and disable the DropBox App, but it doesn't help. I'm suspecting this ""infinite loop""-like behavior to be the culprit for a heavy battery drain issue, so I'm desperately trying to find a solution for the problem.</p>

<p>The service name is not getting listed by task-killer Apps.</p>

<p>Any good ideas are happily received!</p>",android|android-service|android-4.4-kitkat,1128284,Schm1,yes
"""Tried to send a platform message to Flutter, but FlutterJNI was detached from native C++."" After start a background service and closes the app","<p>I'm trying to build an app that uses some packages as Location (<a href=""https://pub.dev/packages/location"" rel=""noreferrer"">https://pub.dev/packages/location</a>) and Compass (<a href=""https://pub.dev/packages/flutter_compass"" rel=""noreferrer"">https://pub.dev/packages/flutter_compass</a>) and keep a background service tracking user location.
Everything works fine until I start the service to track the location.</p>
<p>With the service active the whole app never stops, for example, when I close the app without service the compass stops too, but with the service running, compass keeps running too. Actually it returns a error &quot;Tried to send a platform message to Flutter, but FlutterJNI was detached from native C++. Could not send. Channel: hemanthraj/flutter_compass&quot;. The same thing happens with location: &quot;Tried to send a platform message to Flutter, but FlutterJNI was detached from native C++. Could not send. Channel: lyokone/locationstream&quot;.
After this even if I open again the project it don't work anymore...
I'm trying to make a service totally independent from rest of project.</p>
<p>I'll show you the service implementation (Android)</p>
<pre><code>public class CompassApplication extends FlutterApplication {

    @Override
    public void onCreate() {
        super.onCreate();

        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {
            NotificationChannel channel = new NotificationChannel(&quot;messages&quot;, &quot;Messages&quot;, NotificationManager.IMPORTANCE_LOW);
            NotificationManager manager = getSystemService(NotificationManager.class);
            if (manager != null) {
                manager.createNotificationChannel(channel);
            }
        }
    }
}
</code></pre>
<pre><code>class MainActivity: FlutterActivity() {

    override fun configureFlutterEngine(@NonNull flutterEngine: FlutterEngine) {
        GeneratedPluginRegistrant.registerWith(flutterEngine)

        val intent = Intent(this, LocationService::class.java)
        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {
            startForegroundService(intent)
        } else {
            startService(intent)
        }
    }
}
</code></pre>
<pre><code>public class LocationService extends Service {

    static final long UPDATE_INTERVAL_IN_MILLISECONDS = 10 * 60 * 1000; // 10 minutes
    static final long FASTEST_UPDATE_INTERVAL_IN_MILLISECONDS = UPDATE_INTERVAL_IN_MILLISECONDS / 2;

    private LocationRequest mLocationRequest;
    private FusedLocationProviderClient mFusedLocationClient;
    private LocationCallback mLocationCallback;

    @Override
    public void onCreate() {
        super.onCreate();

        mFusedLocationClient = LocationServices.getFusedLocationProviderClient(this);

        mLocationCallback = new LocationCallback() {
            @Override
            public void onLocationResult(LocationResult locationResult) {
                super.onLocationResult(locationResult);
                onNewLocation(locationResult.getLastLocation());
            }
        };

        createLocationRequest();
        getLastLocation();
        requestLocationUpdates();

        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {
            NotificationCompat.Builder builder = new NotificationCompat.Builder(this, &quot;messages&quot;)
                    .setSmallIcon(R.mipmap.ic_launcher_foreground);

            startForeground(101, builder.build());
        }
    }

    private void createLocationRequest() {
        mLocationRequest = new LocationRequest();
        mLocationRequest.setInterval(UPDATE_INTERVAL_IN_MILLISECONDS);
        mLocationRequest.setFastestInterval(FASTEST_UPDATE_INTERVAL_IN_MILLISECONDS);
        mLocationRequest.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);
    }

    private void getLastLocation() {
        try {
            mFusedLocationClient.getLastLocation()
                    .addOnCompleteListener(task -&gt; {
                        if (task.isSuccessful() &amp;&amp; task.getResult() != null) {
                            onNewLocation(task.getResult());
                        }
                    });
        } catch (SecurityException ignored) {}
    }

    public void requestLocationUpdates() {
        Utils.setRequestingLocationUpdates(this, true);
        startService(new Intent(getApplicationContext(), LocationUpdatesService.class));
        try {
            mFusedLocationClient.requestLocationUpdates(mLocationRequest, mLocationCallback, Looper.myLooper());
        } catch (SecurityException unlikely) {
            Utils.setRequestingLocationUpdates(this, false);
        }
    }

    private void onNewLocation(Location location) {
        // TODO: deal with current location
    }

    @Nullable
    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }
}
</code></pre>
<p>Another problem is even when I don't close the app, it is draining a lot of battery.
Thanks!</p>",android|flutter|dart|service|background,9194587,Marcelo Pinheiro Montanher,no
"New Google Drive Rest API, too much dependencies","<p>It seems no one loves  to remake things that were working well for a long time. This time we are forced to implement new api because of deprecation of google drive android api. Any way I was hoping to remove old <code>gms</code> classes from my app. But when I added all dependencies to my project and reimplemented simple backup/restore functionality, I freaked out it has added about 5000 methods to the project comparing with an old way,  and about +8000 methods overall.</p>

<pre><code>implementation 'com.google.android.gms:play-services-auth:16.0.1'
implementation 'com.google.http-client:google-http-client-gson:1.26.0'
implementation('com.google.api-client:google-api-client-android:1.26.0') {
    exclude group: 'org.apache.httpcomponents'
}
implementation('com.google.apis:google-api-services-drive:v3-rev136-1.25.0') {
    exclude group: 'org.apache.httpcomponents'
}
</code></pre>

<p>That's 1.2 mb of pure apk size increase. And it is with Proguard minification. And it's about 18 k of methods without it.</p>

<p>Now I'm wondering why Google makes so much background restrictions every release for optimization's sake (now even alarms are not working). And forces developers to bloat their apk, which increases download size, memory consumption and battery drain overall.</p>

<p>Is there any way to implement simple backup/restore functionality without adding so much crap in our projects? Does any one cares about it at all?</p>",android|google-drive-api|google-drive-android-api,4288054,Oleksandr Albul,yes
Get all WiFi-Direct devices nearby,"<p>How to get the names of all WiFi-Direct devices nearby for a period of time, lets say 3 hours, while sending the own name constantly.
All is managed an by an app, the goal here is to get all names of Wifi-Direct devices you came across.
Is this draining a lot of battery?
Thx ueen</p>",android|wifi-direct,3123142,ueen,yes
RxSchedulerPurge always take periodic cpu load even in the background on Android,"<p>When I used Android studio method trace to analyze my app's battery drain problem, I observed periodic cpu load after the app was paused with the home button. This load is caused by threads that are part of RxJava.<a href=""https://i.stack.imgur.com/DYao9.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/DYao9.png"" alt=""method trace taked 2 minutes after app paused with home button ""></a></p>

<p>The code get from RxJava github source that may cause the problem.</p>

<pre><code>public static void start() {
    for (;;) {
        ScheduledExecutorService curr = PURGE_THREAD.get();
        if (curr != null &amp;&amp; !curr.isShutdown()) {
            return;
        }
        ScheduledExecutorService next = Executors.newScheduledThreadPool(1, new RxThreadFactory(""RxSchedulerPurge""));
        if (PURGE_THREAD.compareAndSet(curr, next)) {

            next.scheduleAtFixedRate(new ScheduledTask(), PURGE_PERIOD_SECONDS, PURGE_PERIOD_SECONDS, TimeUnit.SECONDS);

            return;
        } else {
            next.shutdownNow();
        }
    }
}
</code></pre>

<p><a href=""https://github.com/ReactiveX/RxJava/blob/2.x/src/main/java/io/reactivex/internal/schedulers/SchedulerPoolFactory.java"" rel=""noreferrer"">https://github.com/ReactiveX/RxJava/blob/2.x/src/main/java/io/reactivex/internal/schedulers/SchedulerPoolFactory.java</a></p>

<p>I tried to change the purge period time, 
I add the following code in my app's application onCreate, but it seems not work.</p>

<pre><code>System.setProperty(""rx2.purge-period-seconds"", ""3600"");
</code></pre>",android|rx-java,3668304,robert,no
"Android: connectivity issues in background thread after alarm when ""always-on"" turned off","<h2>Problem description:</h2>

<p>In my android App, I experience connectitity issues when doing a remote HTTP
(""polling"") call from an AsyncTask that was started after an alarm went off.</p>

<p>The lookup works very well when the standard Android setting <strong>""Enable always-on
mobile data""</strong> (Settings -> Wireless &amp; networks -> Mobile networks) is turned
to <strong>""on""</strong>.</p>

<p>Solution that works: alarm goes of, Android ""Service"" receives an alarm intent,
starts a background thread (AsyncTask). The new thread acquires a partial wake
lock, establishes the connection (polling), notifies the user and releases the
wake lock.</p>

<p>So far, so good. The issue is that, when <strong>always-on</strong> is turned <strong>""off""</strong>, the polling fails most of the time if
the phone was in standby for a while (> 30 min).</p>

<p>Since the polling thread sends a notification, I directly get feedback on the
unsuccessful polling attempt.</p>

<h2>Motivation:</h2>

<p>A lot of users turn of ""always-on"" to reduce battery drain. So, it's likely
that app users run into issues. I want to handle or prevent the ""errors"" that users will face.</p>

<h2>Solution attempts:</h2>

<p>I have experimented a lot without any major break-throughs:</p>

<ul>
<li>multiple retries and intermediate sleeps to give the phone some time to establish the connection</li>
<li>http parameters (timeouts, etc.)</li>
<li>different HttpClient (Apache)</li>
</ul>

<h2>Questions:</h2>

<ul>
<li>What <strong>excactly</strong> does the setting ""always-on"" mean and what do developers have to regard?</li>
<li>I am wondering if it is <strong>generally</strong> possible to implement an <strong>alarm-based polling mechanism</strong> that is able to establish a data connection even if ""always-on"" is
turned ""off"".</li>
<li>Are there any <strong>alternative solutions</strong> (no C2DM possible)?</li>
</ul>

<h2>Update:</h2>

<p>It seems that not all Android devices have the ""always-on"" setting. It seems to be device or, more likely, provider-dependent.</p>",android|polling|alarm|android-alarms,745640,Jörg,yes
process running after kill/uninstall,"<p>I'm working on an app with many libraries included. Later I noticed a couple of occasions where the app process was still draining CPU after closing the app.</p>
<p>I killed the process first, but it kept going. I uninstalled the app - and it was still there! (using &quot;Show CPU usage&quot; option from developer options).</p>
<p>I am pretty sure we are not doing anything that advanced in the app and the problem is in some of the libraries. Do you know how you can achieve such 'virus-y' effect?</p>
<p>Thanks,
Dan</p>
<p>EDIT: after uninstallation of the xxxx app, (I ran adb uninstall com.xxxx.android)this is what I get:</p>
<p>adb shell top -m 10</p>
<blockquote>
<p>PID PR CPU% S  #THR     VSS     RSS PCY UID      Name</p>
<p>13309  0  77% Z     8      0K      0K     u0_a57   m.xxxx.android</p>
</blockquote>
<p>There is a weird thing here: the app is com.xxxx.android, and what is see is only &quot;m&quot;. So now I know it continues to drain battery after uninstallation (or at least process connected with this). So my question is : how is this possible?</p>",android|cpu-usage,232798,Danail,yes
Should movement be predicted to avoid GPS battery kill?,"<p>I have been working on a navigation application where I update my location as I pull GPS location changes. The problem I am encountering is that, in order to keep battery life up, I have implemented a fused location provider that attempts to set my request intervals:</p>

<pre><code>locationRequest = LocationRequest.create();
locationRequest.setInterval(ARBITRARY_INTERVAL_TIME);
locationRequest.setFastestInterval(ARBITRARY_MIN_TIME);
locationRequest.setSmallestDisplacement(ARBITRARY_MIN_DIST);

// locationRequest.setPriority(LocationRequest.PRIORITY_BALANCED_POWER_ACCURACY);
locationClient.requestLocationUpdates(locationRequest, this);
</code></pre>

<p>Where my values are:</p>

<p><code>ARBITRARY_INTERVAL_TIME = 30000
 ARBITRARY_MIN_TIME = 15000
 ARBITRARY_MIN_DIST = 25</code></p>

<p>And drawing my navigation icon like so:</p>

<pre><code>// Draw navigation icon
if(navigationMarkerHolder != null){
    navigationMarkerHolder.remove();
}
LatLng coords = new LatLng(latitude,longitude);
BitmapDescriptor navigationIcon = BitmapDescriptorFactory.fromResource(R.drawable.navigation);
    navigationMarker.title(""Current position"");
    navigationMarker.icon(navigationIcon);
    navigationMarker.position(coords);
    navigationMarker.anchor(.5f,.5f);
    navigationMarker.rotation(loc.getBearing());
navigationMarkerHolder = map.addMarker(navigationMarker);
</code></pre>

<p>The issue I have with this is that, in only pulling updates every ~20 seconds, I only update my navigation icon every ~20 seconds which makes my navigation icon look choppy. Native Android navigation seems to constantly update your position and bearing, but to pull constant updates seems like it would drain the battery pretty quickly. Is Google really predicting movement or is it actually pulling updates? If it is getting updates, how is it doing it without risking battery drain. When I tried to get GPS updates every 5-10 seconds my battery life suffered pretty severely.</p>",android|google-maps|navigation|gps|location,2387054,zgc7009,yes
TCP push-pull socket server design,"<p>I am designing a cross-platform messaging service as a learning exercise.  I have programmed socket-based servers before, but always a ""client-polls-server"" design, like a web server.  I want to be able to target mobile platforms, and I read that polling is a battery drain, so I would like to do push notification.</p>

<p>The server will be TCP-based, written in C++.  What I'm having trouble getting my head around is how to manage the bi-directional nature of the design.  I need a client to be able to send packets to the server as normal, but also listen for packets.  How do I mitigate situations like,  the client is sending data when the server is trying to send to it, or it's blocked listening for data but then needs to send something?</p>

<p>For example, consider the following crude diagram:</p>

<p><img src=""https://i.stack.imgur.com/5dLCB.png"" alt=""crude diagram""></p>

<p>So, let's say client A is in the middle of sending a chunk of data (arrow 1).  While this is happening, client B sends a message (arrow 2), which causes the server to attempt to send data back to client A (arrow 3), but client A hasn't finished sending arrow 1 yet.  What happens in this instance?  Should I setup 2 separate ports on each client, one for inbound, one for outbound?  Do I need to keep track of the state of each connection?</p>

<p>Or is there a better approach to this altogether?</p>",c++|sockets|tcp,1824064,amnesia,yes
Most power efficient way of implementing an Android notification app,"<p>I'm developing an Android notification app which gets XML data in an MQTT message to build the notification but also contains data to perform an Intent when the Notification is clicked on.
I implemented Push messaging over using Polling/Pull messaging as I assumed it would be much more efficient to wait for a message to arrive and do something with it over polling a web server for an update and parsing results which may not have any new data.</p>

<p>However, Android's default power saving scheme turns off wi-fi when the screen is off to save power, which means my connection to the MQTT server drops. When I turn back on the screen, my server connection is re-established and the last message on the MQTT server is delivered.</p>

<p>So now I'm faced with a choice. Implement a wi-fi lock in my service code, or use Alarm manager to have my service periodically wake,check for an MQTT publsh and then exit.</p>

<p>This <a href=""http://goltermann.cc/2011/11/android-accessing-wifi-even-in-standby-using-wakelock-wifilock-alarmmanager-and-services/"" rel=""nofollow"">wifi wakelock vs. alarm manager</a> suggests that wifilocks are very power inefficient and I should use alarm manager.
If that's the case, I loose the ""instant deliver"" advantage of push notification and I'm effictively polling for data.
How do apps like Google's cloud messaging/WhatsApp/Viber do instant messaging while allowing the device to sleep and not draining the battery by keeping wi-fi active?</p>",android|notifications|wifi|push|mqtt,1325094,user1325094,yes
Drawing power from USB device to android tablet through OTG cable,"<p>I am working on a project which involves communication between a android device and arduino. The final assembly of the project would be a box-like structure with only the android device's screen being visible (the remaining sides would be enclosed) . Space is Important; i'd like the apparatus to be as small as possible &amp; using minimum cables.
Communication with the arduino has been established using usb host apis.
Now; the android tablet and arduino are connected through:</p>

<ul>
<li>USB OTG cable on the Android tablet (micro-usb male &amp; usb female)</li>
<li>Mini-usb to usb on arduino (USB male &amp; mini-usb male)</li>
</ul>

<p>The problem: I want the android tablet to charge itself through the connection.</p>

<p>Currently the arduino powers itself from the android tablet. However; finally the tablet and arduino will be connected for hours together; and that'll drain out the battery. The arduino board will be getting power from an external source. I'd like the tablet to draw power from arduino. This is working when the Tablet is switched off; however the tablet stops charging itself and begins discharging as soon as it is turned on.</p>

<p>This is probably because the tablet goes in the Host mode (as USB HOST) and the arduino as  the device/accessory. Usually in such connections, the host sends the power and the accessory charges itself. Can this be the other way around??</p>

<p>My understanding is that in these kinds of connections Host Negotiation Protocol (HNP) is implemented first to determine the host. Is it possible to forcibly make arduino host and the tablet an accessory? and in such a case will proper communication be possible?</p>

<p>Alternatively, is it possible to enable and disable host mode from within an android app?</p>

<p>The main purpose is to be able to draw power from usb otg cable (I'm trying to avoid using additional cables)</p>

<p>Please if anyone can provide assistance , it would be appreciated.</p>

<p>Thanx a lot in advance :)</p>",android|usb|arduino|host|usb-otg,2056679,MMss,no
Which one is better for a background task? foreground service or whitelist permission?,"<p>I am developing an application that monitors buses' icons on the google map and triggers a notification once they get close to the bus station. Everything works perfectly fine as long as the app is visible to the user. Right when the phone's screen is turned off, the app is no longer responsive to the runnable running in the background. I am aware of the doze mode and researched a lot on the web. Currently, I was able to overcome this by using a service in the foreground that binds to the application. However, this creates a notification in the status bar and might not be pleasant to the user. I have another option, ask the user to grant the permission to my app to be on the whitelist apps for battery optimization exempt. I want to know which one is better and are there other approaches that are working better in my situation? Please note that my app needs to get data from a server every 5 seconds, and this synchronization will not last long, maybe 30 minutes maximum, so I am not worried about battery drain. </p>",android|google-maps|android-studio|android-service|whitelist,7988717,Mahmoud H,yes
Android GPS tracking and WakeLock,"<p>I need to do background GPS tracking on an Android phone, and I'm currently planning on having two scenarios:</p>

<ol>
<li>When the phone is connected to a (car) charger, get frequent GPS locations (every minute).</li>
<li>When the phone is not connected to a charger, only poll for a location once every 5-30 minutes, depending on how much the battery is affected.</li>
</ol>

<p>I know that I'll need to implement the tracking in a service, and probably show a notification to keep the service alive. However, I gather that the phone might go into sleep mode at any time, which would stop the GPS tracking.</p>

<p>For these scenarios, <strong>what is the best way to do continuous background GPS tracking, without the phone going to sleep, and without draining too much power?</strong></p>

<p>So far I gathered the following:</p>

<p>For scenario 1, I'll probably need a acquire a WakeLock, and keep the CPU awake all the time (but the screen may sleep). The MyTracks application seems to be doing this in <a href=""http://code.google.com/p/mytracks/source/browse/MyTracks/src/com/google/android/apps/mytracks/services/TrackRecordingService.java"" rel=""nofollow noreferrer"" title=""TrackRecordingService"">TrackRecordingService</a>. OpenGPSTracking seems to do <a href=""http://code.google.com/p/open-gpstracker/source/browse/trunk/OpenGPSTracker/trunk/application/src/nl/sogeti/android/gpstracker/logger/GPSLoggerService.java"" rel=""nofollow noreferrer"">the same</a>.</p>

<p>For scenario 2, I can use AlarmManager to schedule a check every x minutes. My service will need to acquire a temporary WakeLock, wait for a single GPS location, then stop and release the WakeLock again.</p>

<p>How would the power usage compare for these two methods (permanent WakeLock vs AlarmManager)? Can the GPS receive an accurate location in a reasonable amount of time when only checking every 30 minutes?</p>

<p>There are a few related questions on StackOverflow, but none with satisfying answers. Some semi-useful ones:</p>

<ul>
<li><a href=""https://stackoverflow.com/questions/6291729/how-to-keep-application-running-in-background-keep-collecting-data"">how to keep application running in background? keep collecting data?</a> (pointed me to MyTracks)</li>
<li><a href=""https://stackoverflow.com/questions/7700924/tracking-users-sms-and-geo-position-in-the-background-is-my-idea-working"">Tracking user&#39;s sms and geo position in the background - is my idea working?</a></li>
<li><a href=""https://stackoverflow.com/questions/6934991/android-service-with-always-on-gps"">Android service with always on GPS</a></li>
</ul>",android|gps|wakelock,214837,Ralf,no
How to detect memory leak / battery drain in an iPhone app,"<p>I'm afraid I introduced a memory leak or something to version 1.2 of my iPhone app. When I use 1.2 version I notice that my battery drains a lot quicker then with 1.1 version. For comparison, with 1.1 version the battery would last whole day and still have plenty of juice in the evening but with 1.2 I find that I have to plug it in mid afternoon.</p>

<p>Would a memory leak (or a lot of them) cause an increased battery drainage, or do I have something else going on?</p>

<p>The only interesting thing my app uses is AVAudioPlayer class to play some caf audio files. Other than that it's just couple of views with a table view.</p>

<p>I do call AudioSessionSetAcvie(false) in my applicationWillTerminate method, so I don't think it's the audio session that's causing this. I don't have to have my app active for the battery to get drained. It's enough to use it for a while and then exit. So I'm pretty sure I'm leaving something behind, I'm just not sure what.</p>

<p>I tried playing with Instruments tool, but it looks like you can't used with the app running on the device (for some reason my app stopped working in the Simulator)</p>

<p>Any ideas on how to go about finding what's causing the battery to drain?</p>",iphone|cocoa-touch,44091,subjective-c,yes
How to assign value into a breeze Matrix in flatMap Scala-Spark?,"<p>i want to initialize a matrix using data in flatMap , this is my data:</p>

<pre><code>-4,0,1.0 ### horrible . not-work install dozen scanner umax ofcourse . tech-support everytime call . fresh install work error . crummy product crummy tech-support crummy experience .
2,1,1.0 ### scanner run . grant product run windows . live fact driver windows lose performance . setup program alert support promptly quits . amazon . website product package requirement listing compatible windows .
1,2,1.0 ### conversion kit spare battery total better stick versionand radio blow nimh charger battery . combination operation size nimh battery . motorola kit . rechargable battery available flashlight camera game toy .
-4,3,1.0 ### recieive part autowinder catch keep place sudden break . hold listen music winder wind . extremely frustrated fix pull little hard snap half . flush drain .
</code></pre>

<p>and this is my code:</p>

<pre><code>val spark_context = new SparkContext(conf)
 val data = spark_context.textFile(Input)
 val Gama=DenseMatrix.zeros[Double](4,2)
 var gmmainit = data.flatMap(line =&gt; {
   val tuple = line.split(""###"")
   val ss = tuple(0)
   val re = """"""^(-?\d+)\s*,\s*(\d+)\s*,\s*(\d+).*$"""""".r
   val re(n1, n2, n3) = ss // pattern match and extract values

   if (n1.toInt &gt;= 0) {
     Gama(n2.toInt, 0) += 1
   }
   if (n1.toInt &lt; 0) {
     Gama(n2.toInt, 1) += 1
   }
 })

 println(Gama)
</code></pre>

<p>but it doesn't change Gama matrix,</p>

<p>how can i modify my code to solve this problem?</p>",scala|apache-spark|flatmap,5379527,hadiye,yes
recieving location updates after app is terminated,"<p>I need to keep track of the user location all the time (but not drain the battery).
I understand the only way to get updates after app is terminated is using startMonitoringSignificantLocationChanges.</p>

<p>From Apple's Location Awareness Programming Guide on startMonitoringSignificantLocationChanges:</p>

<blockquote>
  <p>If you start this service and your application is subsequently
  terminated, the system automatically relaunches the application into
  the background if a new event arrives. In such a case, the options
  dictionary passed to the application:didFinishLaunchingWithOptions:
  method of your application delegate contains the key
  UIApplicationLaunchOptionsLocationKey to indicate that your
  application was launched because of a location event. <strong>Upon relaunch,
  you must still configure a location manager object and call this
  method to continue receiving location events. When you restart
  location services, the current event is delivered to your delegate
  immediately. In addition, the location property of your location
  manager object is populated with the most recent location object even
  before you start location services.</strong></p>
</blockquote>

<p>I would be glad if someone could demonstrate in the code (give an example) which methods i should use</p>

<p>In the following code i'm tring to :
- start the location manager at appdelegate which strats the signinficant monitor changes update and startupdating. 
- in didUpdateToLocation i'm calling stopupdating
- in didFinishLaunchingWithOptions when i check if i got a UIApplicationLaunchOptionsLocationKey in order to know if i'm in the background and launched due to siginificant monitor location update.
- if so, i call startMonitoringSignificantLocationChanges again (not sure why...)
  and begin a UIBackgeoundTaskIdentifier for calling startupdating method.</p>

<pre><code>LocationController.m : 
+ (LocationController*)sharedInstance {
    @synchronized(self) {
        if (sharedCLDelegate == nil) {
            [[self alloc] init];
        }
    }
    return sharedCLDelegate;
}

- (id)init
{
    self = [super init];
    if (self != nil) {
        self.locationManager = [[[CLLocationManager alloc] init] autorelease];
        self.locationManager.delegate = self;
        self.locationManager.desiredAccuracy = kCLLocationAccuracyNearestTenMeters;
        [self.locationManager startUpdatingLocation];
        [self.locationManager startMonitoringSignificantLocationChanges];

    }
    return self;
}
- (void) startMonitoringSignificantLocationChanges
{
    [self.locationManager startMonitoringSignificantLocationChanges];
}
- (void) stopMonitoringSignificantLocationChanges
{
    [self.locationManager stopMonitoringSignificantLocationChanges];
}
-(void) start{
    [self.locationManager startUpdatingLocation];
}
- (void)locationManager:(CLLocationManager *)manager 
    didUpdateToLocation:(CLLocation *)newLocation 
           fromLocation:(CLLocation *)oldLocation{
    if ( abs([newLocation.timestamp timeIntervalSinceDate: [NSDate date]]) &lt; 30) {
        self.lastLocation = newLocation;
        [self updateLocation]; //sending location to server
        [self.locationManager stopUpdatingLocation];
    }
}
- (void)locationManager:(CLLocationManager*)manager
       didFailWithError:(NSError*)error{
    [self.locationManager stopUpdatingLocation];
}

AppDelegate.h : 

@interface AppDelegate : NSObject &lt;UIApplicationDelegate&gt; {
    UIBackgroundTaskIdentifier bgTask;
}

AppDelegate.m : 

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {    
        id locationValue = [launchOptions objectForKey:UIApplicationLaunchOptionsLocationKey];
        if (locationValue) {
            [[LocationController sharedInstance] startMonitoringSignificantLocationChanges];
            UIApplication *app  = [UIApplication sharedApplication];
            bgTask = [app beginBackgroundTaskWithExpirationHandler:^{ 
                [app endBackgroundTask:bgTask]; 
                bgTask = UIBackgroundTaskInvalid;
            }];
            [[LocationController sharedInstance] start]; //startupdating
            return YES;
        }
    else { 
            [[LocationController sharedInstance] init];
    }
}
-(void) applicationDidEnterBackground:(UIApplication *) application
{
    NSLog(@""entered background Mode"");
}

-(void) applicationDidBecomeActive:(UIApplication *) application
{
    NSLog(@""application Did Become Active"");
}
</code></pre>

<p>Thank you.</p>",cllocationmanager|cllocation,1103897,Liatz,yes
Tracking user location all the time algorithm for an iphone app,"<p>I'm developing an iphone app that tracks the user location all the time.</p>

<p>The location can be in accuracy of handerts of meters (up to 400-500). And should be updated at least once an hour (even if there is no change in user's location,  I would like to keep track on it)   </p>

<p>I would like to know what is the best way to do that.</p>

<p>If I use CLLocation, I would like to use startupdatinglocation once in an hour and then use startmonitoringsignificantlocationchanges. Do you think it's the best way to do that causing minimum battery drain</p>

<p>The other option is using a geolocation api like geoloqi but i assume that using the realtime tracking mode  all the time would cause a battery drain and the passive mode is not good enough accuracy (as i understood it gives accuracy like in wich city are you)</p>

<p>I would be glad if someone has any idea for a recommended api i could use or an efficient algorithm to use CLLocation to solve my problem.     </p>

<p>Thank you!</p>",iphone|geolocation,1103897,Liatz,yes
Android periodically get location and post to server using Service,"<p>I use a service class that implements LocationListener, to get the location at periodic intervals, and post to server at only when there is considerable change in the latlon(min 100 meters). Because, continuously updating server drains battery quickly. I start this service from onCreate() of myActivity, and don't call stopService() as it has to run forever.</p>

<p>When the user reboots the device, How to start the service again without opening the app? or</p>

<p>Is there any native or third party library to handle this part?</p>",android|android-service|alarmmanager|locationlistener,2459623,ABI,no
Reduce battery drain using Voip and Location services Enabled,<p>We have implemented a chat based application based on mqtt.But recently we implemented calling feature by enabling voip and using Sinch frame work. After  enabling voip battery consumption in settings showing as 85% - 90%.How to improve battery life.</p>,ios|ios10|voip|battery|sinch,3077366,Aruna M,no
"iOS CoreLocation, Determine user leaving a location","<p>I've been working in a iOS location tracking application, and we've found a way to determine when users are leaving a place, but we're doing it by constantly listening to location updates, which ends draining our battery.</p>

<p>What is the most efficient way to do a thing like this? i would like to get a battery consumption similar to the reminders application.</p>

<p>Any idea is welcome! </p>

<p>Thanks!</p>",ios|core-location,2561989,paganotoni,yes
Android Emulator Drained Battery Mbp m1 12.3.1 monterey,"<p>i have development mobile apps with mbp m1 from january 2021 until now jun 2022.</p>
<pre><code>Android Studio Chipmunk | 2021.2.1 Patch 1
Build #AI-212.5712.43.2112.8609683, built on May 19, 2022
Runtime version: 11.0.12+0-b1504.28-7817840 aarch64
VM: OpenJDK 64-Bit Server VM by JetBrains s.r.o.
macOS 12.3.1
GC: G1 Young Generation, G1 Old Generation
Memory: 2048M
Cores: 8
Registry: external.system.auto.import.disabled=true, ide.balloon.shadow.size=0
Non-Bundled Plugins: dev.polek.adbwifi (1.2.4), com.genymotion.idea (1.0.9), com.github.copilot (1.1.25.1678), com.mallowigi (50.2.0), com.robohorse.robopojogenerator (2.3.5), Dart (212.5744), org.intellij.plugins.markdown (212.5457.16), com.thoughtworks.gauge (212.4746.52), org.jetbrains.kotlin (212-1.7.0-release-281-AS5457.46), zielu.gittoolbox (212.9.0), io.flutter (68.1.2), com.chrisrm.idea.MaterialThemeUI (6.9.1)
</code></pre>
<p>but i tired about when i want using android emulator instead of physical device its still on drained my battery ... usually i code with vscode. now i want to test but its still not solved on drained battery when using emulator android.</p>
<p>anyone have solution ?</p>
<pre><code>Pixel 4 API Tiramisu
Android API Tiramisu arm64-v8a

RAM 1536 MB
VM Heap 256 MB
Internal Storage 2048 MB
Studio-Managed 2048 MB
</code></pre>
<p>20 minute drained &gt; 10 percent battery
without android emulator i can coding until 1,5 - 2 days.
but if i want to debug with emulator (only 3-4 hours of my macbook 20% battery).
if my physical device has another task so I can't use it.</p>",android|emulation|apple-m1,8122500,Yogi Arif Widodo,no
Signing my android application as system app,"<p>In my company, we would want total control for battery consumption in the field, using only 2g and gps could drain the battery awfully fast. What we decided is that we need to have root access to the mobile phone, So that when phone is idle, we would turn off those needless battery consumption.
And also we would not allow users to uninstall it and clear data to it.</p>

<p>My Question is :</p>

<ol>
<li>Where do I get these signature key?</li>
<li>Is it going to like a root access If ever I successfully managed to
sign it?</li>
<li>What is the difference between Root vs Signed with key?</li>
</ol>",android|android-permissions,3974048,david,no
While loop before if-else statement not working?,"<p>I have a code illuminating an LED using a few different inputs. I'm not sure why but the (while) command to turn off the light when the battery is low, isn't executing. Currently it's draining below the 3v level all the way down to 1.9v. Could it be because of my code structure?</p>
<p><code>While</code>- measures battery and shuts off when under 3v</p>
<p><code>if (rf95.available())</code>- listens for a radio signal and switch command</p>
<p><code>if(digitalRead(SWITCH))</code>- listens for physical switch command
else- leaves the LED on if no commands are sent</p>
<p><code>Watchdog.sleep</code>- deep sleep command to save battery</p>
<pre><code>void loop(){
    Serial.begin(115200);
    
    uint8_t buf[RH_RF95_MAX_MESSAGE_LEN];      
    uint8_t len = sizeof(buf);  
   
     float measuredvbat = analogRead(VBATPIN);
     measuredvbat *= 2; // we divided by 2, so multiply back
     measuredvbat *= 3.3; // Multiply by 3.3V, our reference voltage
     measuredvbat /= 1024; // convert to voltage
     measuredvbat /=1.61; //  fudge factor
    
     Serial.print(&quot;VBat: &quot; ); 
     Serial.println(measuredvbat);

         while(measuredvbat &lt; 3.00){
           analogWrite(LED,0);
           Serial.print(&quot;VBat: &quot; ); 
           Serial.println(measuredvbat);
           Serial.println(&quot;Battery Low&quot;);
           
           int sleepMS = Watchdog.sleep(3600000);
         }
 
         if (rf95.available()){                       
          if (rf95.recv(buf, &amp;len)) {
           if(strncmp(buf, &quot;TurnOn&quot;, strlen(buf)) == 0){
            Serial.println(&quot;Turn Up For WAT !!&quot;);
            analogWrite(LED,75);
           }
          }
         }
          
         if(digitalRead(SWITCH)){
          Serial.println(&quot;SWITCH-ON-12&quot;);
          analogWrite(LED, 75);           
         }
         
         else{
          Serial.println(&quot;SWITCHED ON-12&quot;);
          analogWrite(LED, 112);
         }
  }
</code></pre>",while-loop,19624065,LAAAD,yes
Google Tango - Using 3D Reconstruction,"<p>I’m currently working with Google Tango and I’m trying to get an example scene to run on Unity. The scene is called „ExperimentalMeshBuilderWithColor“ and can be found in the folder Assets>TangoSDK>Examples>Scenes after importing the Tango SDK to Unity.</p>

<p>So far, the app always crashes at the same location in the code but not consistent, meaning that the app runs for a seeming random amount of time and then stops working. The only reproducible observation is the location in the code itself, but not the time it takes to crash (which varies from 10 seconds to 5 minutes runtime). 
The location is in the function of <code>API.Tango3DR_extractPreallocatedMeshSegment(m_context, ref gridIndex, ref mesh);</code> which is called in the script „Tango3DReconstrucion.cs“ (Assets>TangoSDK>Core>Scripts>TangoWrappers).</p>

<p>It seems to me that the crash occurs within the „tango_3d_reconstruction.so“ library (Assets>Plugins>Android>libs>armeabi-v7a) which is imported using <code>[DllImport(TANGO_3DR_DLL)]</code> and <code>private const string TANGO_3DR_DLL = „tango_3d_reconstruction“;</code> in the aforementioned script „Tango3DReconstrucion.cs“. As this library is not open-source, I cannot search further than I have up to now. 
I’m adding the crash dump file logged with logcats adb and hope somebody has had similar problems and can suggest a way to solve the problem.</p>

<p>Other things I’ve tried so far without success:<br>
- Disabled „Draw Default Ux Exceptions“ in Tango Ux Script<br>
- Disabled „Dynamic Batching“ in Player Settings<br>
- Enabled „Selective Meshing“ in Tango Dynamic Mesh Script<br>
- Varying ""Resolution"", ""Mesh Min Vertices"" and ""Point Cloud Max Points"" in Tango Manager<br>
- Enabled „Allow out of Date API“ in Tango Manager</p>

<pre><code>I/Unity   (18880): API Tango 3DR extraction of mesh segment
I/Unity   (18880): (Filename: ./artifacts/generated/common/runtime/UnityEngineDebugBindings.gen.cpp Line: 42)
F/tango   (18880): mesh-toolbox.cc:652 'faces_in' Must be non NULL
F/libc    (18880): Fatal signal 6 (SIGABRT) at 0x000049c0 (code=-6), thread 18901 (UnityMain)
W/st-log  (16075): Initial features: Max - 7749, Min - 8877
D/NvOsDebugPrintf(  171): FlashError: Flash Parameter Error!!
D/NvOsDebugPrintf(  171): FlashError: TorchBrightness is 0!!
D/NvOsDebugPrintf(  171): FlashError: Torch on midtone common gain is 0!!
D/NvOsDebugPrintf(  171): FlashError: Torch on highlight common gain is 0!!
D/NvOsDebugPrintf(  171): FlashError: Torch on luma is 0!!
I/DEBUG   (  161): ***
I/DEBUG   (  161): Build fingerprint: 'google/tango/yellowstone:4.4.2/KOT49H.160920/160920002:user/release-keys'
I/DEBUG   (  161): Revision: '0'
I/DEBUG   (  161): pid: 18880, tid: 18901, name: UnityMain  &gt;&gt;&gt; com.ICVR.Hirtc &lt;&lt;&lt;
I/DEBUG   (  161): signal 6 (SIGABRT), code -6 (SI_TKILL), fault addr --------
W/st-log  (16075): Final features: 12445
W/st-log  (16075): Initial features: Max - 7748, Min - 8872
I/DEBUG   (  161):     r0 00000000  r1 000049d5  r2 00000006  r3 00000000
I/DEBUG   (  161):     r4 00000006  r5 00000000  r6 000049d5  r7 0000010c
I/DEBUG   (  161):     r8 4fc0ee9c  r9 493b2bd8  sl 493b2a74  fp 493b2a78
I/DEBUG   (  161):     ip 4fc0da30  sp 493b25e8  lr 40045011  pc 40053f78  cpsr 000f0010
I/DEBUG   (  161):     d0  6e20656220747375  d1  0a4c4c554e206e6f
I/DEBUG   (  161):     d2  6361662720323536  d3  4d20276e695f7365
I/DEBUG   (  161):     d4  bfa1999900000000  d5  3f800000be59999b
I/DEBUG   (  161):     d6  7fc000007fc00000  d7  7fc0000000000004
I/DEBUG   (  161):     d8  0000000000000000  d9  000000004479999a
I/DEBUG   (  161):     d10 0000000000000000  d11 0000000000000000
I/DEBUG   (  161):     d12 0000000000000000  d13 0000000000000000
I/DEBUG   (  161):     d14 0000000000000000  d15 0000000000000000
I/DEBUG   (  161):     d16 0000000000000000  d17 0000000000000000
I/DEBUG   (  161):     d18 404ec923fbf77686  d19 0000000000004400
I/DEBUG   (  161):     d20 0000000000000000  d21 3f3280f6be826169
I/DEBUG   (  161):     d22 8000000080000000  d23 0000000080000000
I/DEBUG   (  161):     d24 3f3280f600000000  d25 0000000000000000
I/DEBUG   (  161):     d26 8000000080000000  d27 3f8000003f800000
I/DEBUG   (  161):     d28 00000000be826169  d29 8000000080000000
I/DEBUG   (  161):     d30 3f3280f6be826169  d31 beba7ea2bf0ff884
I/DEBUG   (  161):     scr 3000009b
I/DEBUG   (  161): 
I/DEBUG   (  161): backtrace:
I/DEBUG   (  161):     #00  pc 00021f78  /system/lib/libc.so (tgkill+12)
I/DEBUG   (  161):     #01  pc 0001300d  /system/lib/libc.so (pthread_kill+48)
I/DEBUG   (  161):     #02  pc 00013221  /system/lib/libc.so (raise+10)
I/DEBUG   (  161):     #03  pc 00011f57  /system/lib/libc.so
I/DEBUG   (  161):     #04  pc 0002182c  /system/lib/libc.so (abort+4)
I/DEBUG   (  161):     #05  pc 0000684b  /system/lib/libcutils.so (__android_log_assert+86)
I/DEBUG   (  161):     #06  pc 0005e69d  /data/app-lib/com.ICVR.Hirtc-2/libtango_3d_reconstruction.so
I/DEBUG   (  161): stack:
I/DEBUG   (  161):          493b25a8  00000000  
I/DEBUG   (  161):          493b25ac  4479999a  /system/lib/libmedia_jni.so (android::JMediaCodec::JMediaCodec(_JNIEnv*, _jobject*, char const*, bool, bool)+177)
I/DEBUG   (  161):          493b25b0  00000000  
I/DEBUG   (  161):          493b25b4  000003ff  
I/DEBUG   (  161):          493b25b8  4fc5e484  
I/DEBUG   (  161):          493b25bc  4fc0ee60  /data/app-lib/com.ICVR.Hirtc-2/libtango_3d_reconstruction.so
I/DEBUG   (  161):          493b25c0  4fc0da30  /data/app-lib/com.ICVR.Hirtc-2/libtango_3d_reconstruction.so
I/DEBUG   (  161):          493b25c4  4fc0ee9c  /data/app-lib/com.ICVR.Hirtc-2/libtango_3d_reconstruction.so
I/DEBUG   (  161):          493b25c8  493b2bd8  [stack:18901]
I/DEBUG   (  161):          493b25cc  493b2a74  [stack:18901]
I/DEBUG   (  161):          493b25d0  40028439  /system/lib/libcutils.so
I/DEBUG   (  161):          493b25d4  5579c454  [anon:libc_malloc]
I/DEBUG   (  161):          493b25d8  493b264c  [stack:18901]
I/DEBUG   (  161):          493b25dc  00000000  
I/DEBUG   (  161):          493b25e0  df0027ad  
I/DEBUG   (  161):          493b25e4  00000000  
I/DEBUG   (  161):     #00  493b25e8  00000006  
I/DEBUG   (  161):          493b25ec  00000000  
I/DEBUG   (  161):          493b25f0  000049d5  
I/DEBUG   (  161):          493b25f4  4fc0da30  /data/app-lib/com.ICVR.Hirtc-2/libtango_3d_reconstruction.so
I/DEBUG   (  161):          493b25f8  4fc0da30  /data/app-lib/com.ICVR.Hirtc-2/libtango_3d_reconstruction.so
I/DEBUG   (  161):          493b25fc  40045011  /system/lib/libc.so (pthread_kill+52)
I/DEBUG   (  161):     #01  493b2600  00000006  
I/DEBUG   (  161):          493b2604  00000000  
I/DEBUG   (  161):          493b2608  4fc0ee60  /data/app-lib/com.ICVR.Hirtc-2/libtango_3d_reconstruction.so
I/DEBUG   (  161):          493b260c  40045225  /system/lib/libc.so (raise+14)
I/DEBUG   (  161):     #02  493b2610  493b261c  [stack:18901]
I/DEBUG   (  161):          493b2614  40043f5b  /system/lib/libc.so
I/DEBUG   (  161): 
I/DEBUG   (  161): memory near r1:
I/DEBUG   (  161):     000049b4 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     000049c4 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     000049d4 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     000049e4 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     000049f4 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a04 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a14 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a24 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a34 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a44 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a54 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a64 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a74 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a84 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a94 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004aa4 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161): 
I/DEBUG   (  161): memory near r6:
I/DEBUG   (  161):     000049b4 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     000049c4 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     000049d4 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     000049e4 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     000049f4 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a04 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a14 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a24 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a34 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a44 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a54 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a64 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a74 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a84 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004a94 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     00004aa4 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161): 
I/DEBUG   (  161): memory near r8:
I/DEBUG   (  161):     4fc0ee7c 5495de30 5495e028 5002c6ac 5495de48  
I/DEBUG   (  161):     4fc0ee8c 5495de30 5495e028 5002c6ac 00000100  
I/DEBUG   (  161):     4fc0ee9c 00000001 4b25f014 4b26562c 4b26a334  
I/DEBUG   (  161):     4fc0eeac 4b263634 4b26833c 4b266344 4b25f644  
I/DEBUG   (  161):     4fc0eebc 00000000 4b26163c 00000000 00000000  
I/DEBUG   (  161):     4fc0eecc 4b25c2c4 4b2ff014 4b27094c 4b25c248  
I/DEBUG   (  161):     4fc0eedc 4b25c27c 4b25c27c 4edf8014 4b25c280  
I/DEBUG   (  161):     4fc0eeec 4b25c2b4 4b25c2b4 4b26e954 4edfa00c  
I/DEBUG   (  161):     4fc0eefc 4b26c32c 4b26c95c 4edfc004 00000000  
I/DEBUG   (  161):     4fc0ef0c 00000000 00000000 00000000 00000000  
I/DEBUG   (  161):     4fc0ef1c 00000000 00000000 00000000 00000000  
I/DEBUG   (  161):     4fc0ef2c 3ff00000 00000000 00000000 00000000  
I/DEBUG   (  161):     4fc0ef3c 00000000 00000000 00000000 00000000  
I/DEBUG   (  161):     4fc0ef4c 00000000 00000000 00000000 00000000  
I/DEBUG   (  161):     4fc0ef5c 00000000 00000000 00000000 00000000  
I/DEBUG   (  161):     4fc0ef6c 00000000 00000000 00000000 00000000  
I/DEBUG   (  161): 
I/DEBUG   (  161): memory near r9:
I/DEBUG   (  161):     493b2bb8 00000000 00000000 56902894 567ddfac  
I/DEBUG   (  161):     493b2bc8 0000028c 5579c454 4fc0992c 00000000  
I/DEBUG   (  161):     493b2bd8 4fc09940 4fc097d0 56067b94 56067b94  
I/DEBUG   (  161):     493b2be8 56067b95 56067b94 56067bc4 56067d94  
I/DEBUG   (  161):     493b2bf8 4fc5d620 00000018 56067b94 4fc09954  
I/DEBUG   (  161):     493b2c08 00000006 00000000 00001002 00000000  
I/DEBUG   (  161):     493b2c18 00000000 00000000 00000000 00000000  
I/DEBUG   (  161):     493b2c28 00000000 00000000 00000000 00000000  
I/DEBUG   (  161):     493b2c38 00000000 00000000 00000000 00000000  
I/DEBUG   (  161):     493b2c48 00000000 00000000 00000000 00000000  
I/DEBUG   (  161):     493b2c58 00000000 00000000 00000000 00000000  
I/DEBUG   (  161):     493b2c68 00000008 493b2c28 4fc5d620 00000000  
I/DEBUG   (  161):     493b2c78 00000120 493b2bdc 4fc5d908 4fc5dcc4  
I/DEBUG   (  161):     493b2c88 4fc5e3b8 fffffffd 400801c0 00000000  
I/DEBUG   (  161):     493b2c98 00000000 00000000 00000000 493b2fb0  
I/DEBUG   (  161):     493b2ca8 493b3410 fffff020 493b3360 4f53a14d  
I/DEBUG   (  161): 
I/DEBUG   (  161): memory near sl:
I/DEBUG   (  161):     493b2a54 4f4f86a1 4fb07064 567fdfec 56067ba8  
I/DEBUG   (  161):     493b2a64 493b2a80 493b2a88 493b2a8c 493b2fb0  
I/DEBUG   (  161):     493b2a74 4fc5e490 56902894 0000028c 5579c454  
I/DEBUG   (  161):     493b2a84 fffffffd 567fdfec 567ddfac 561b2a9c  
I/DEBUG   (  161):     493b2a94 5684bca0 493b2bc0 493b2fb0 00000000  
I/DEBUG   (  161):     493b2aa4 493b2fb0 493b3410 493b2b38 493b3360  
I/DEBUG   (  161):     493b2ab4 4f539f5d fffffffd ffffffff ffffffff  
I/DEBUG   (  161):     493b2ac4 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     493b2ad4 ffffffff 4fc0da30 ffffffff 55dd1d30  
I/DEBUG   (  161):     493b2ae4 00000000 493b2bc0 493b2b28 ffffffff  
I/DEBUG   (  161):     493b2af4 00000000 ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     493b2b04 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     493b2b14 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     493b2b24 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     493b2b34 ffffffff 561b2a9c ffffffff ffffffff  
I/DEBUG   (  161):     493b2b44 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161): 
I/DEBUG   (  161): memory near fp:
I/DEBUG   (  161):     493b2a58 4fb07064 567fdfec 56067ba8 493b2a80  
I/DEBUG   (  161):     493b2a68 493b2a88 493b2a8c 493b2fb0 4fc5e490  
I/DEBUG   (  161):     493b2a78 56902894 0000028c 5579c454 fffffffd  
I/DEBUG   (  161):     493b2a88 567fdfec 567ddfac 561b2a9c 5684bca0  
I/DEBUG   (  161):     493b2a98 493b2bc0 493b2fb0 00000000 493b2fb0  
I/DEBUG   (  161):     493b2aa8 493b3410 493b2b38 493b3360 4f539f5d  
I/DEBUG   (  161):     493b2ab8 fffffffd ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     493b2ac8 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     493b2ad8 4fc0da30 ffffffff 55dd1d30 00000000  
I/DEBUG   (  161):     493b2ae8 493b2bc0 493b2b28 ffffffff 00000000  
I/DEBUG   (  161):     493b2af8 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     493b2b08 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     493b2b18 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     493b2b28 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     493b2b38 561b2a9c ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     493b2b48 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161): 
I/DEBUG   (  161): memory near ip:
I/DEBUG   (  161):     4fc0da10 4fc0a1e0 4fa88ccc 4fc0a2a0 4fc0a2c8  
I/DEBUG   (  161):     4fc0da20 4fc0a2b8 4fa8a5ec 4fbcc9f8 4fbcca94  
I/DEBUG   (  161):     4fc0da30 00000000 00000000 00000000 4005ae85  
I/DEBUG   (  161):     4fc0da40 4005af81 4003fc45 4003fc31 40040820  
I/DEBUG   (  161):     4fc0da50 40040924 40028739 400579f9 40050b55  
I/DEBUG   (  161):     4fc0da60 40040f78 40040d90 40044f55 40040ca8  
I/DEBUG   (  161):     4fc0da70 40040d6c 40055a9c 40040600 40040d2c  
I/DEBUG   (  161):     4fc0da80 4003f258 400287f5 4005453c 40053b58  
I/DEBUG   (  161):     4fc0da90 40055091 40061da1 4b2fb9d9 40053fb8  
I/DEBUG   (  161):     4fc0daa0 4b2fba9d 400a56a4 40094514 40094504  
I/DEBUG   (  161):     4fc0dab0 4033e8dc 4033e060 4033e24c 4033e328  
I/DEBUG   (  161):     4fc0dac0 4033e154 4033e2c4 4033e3dc 4033e364  
I/DEBUG   (  161):     4fc0dad0 4033e314 4033e140 4033e04c 4033e378  
I/DEBUG   (  161):     4fc0dae0 4033eb20 4033e4d0 4033e074 4033e788  
I/DEBUG   (  161):     4fc0daf0 4033e3b4 4033e088 4033e864 4033e8a0  
I/DEBUG   (  161):     4fc0db00 4033e3c8 4033e128 4033e418 4033e42c  
I/DEBUG   (  161): 
I/DEBUG   (  161): memory near sp:
I/DEBUG   (  161):     493b25c8 493b2bd8 493b2a74 40028439 5579c454  
I/DEBUG   (  161):     493b25d8 493b264c 00000000 df0027ad 00000000  
I/DEBUG   (  161):     493b25e8 00000006 00000000 000049d5 4fc0da30  
I/DEBUG   (  161):     493b25f8 4fc0da30 40045011 00000006 00000000  
I/DEBUG   (  161):     493b2608 4fc0ee60 40045225 493b261c 40043f5b  
I/DEBUG   (  161):     493b2618 ffffffff ffffffdf ffffffff ffffffff  
I/DEBUG   (  161):     493b2628 ffffffff a717134c ffffffff 5579c454  
I/DEBUG   (  161):     493b2638 4fc5e484 40053830 40028439 4002884f  
I/DEBUG   (  161):     493b2648 493b2a5c 6873656d 6f6f742d 786f626c  
I/DEBUG   (  161):     493b2658 3a63632e 20323536 63616627 695f7365  
I/DEBUG   (  161):     493b2668 4d20276e 20747375 6e206562 4e206e6f  
I/DEBUG   (  161):     493b2678 0a4c4c55 ffffff00 ffffffff ffffffff  
I/DEBUG   (  161):     493b2688 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     493b2698 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     493b26a8 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161):     493b26b8 ffffffff ffffffff ffffffff ffffffff  
I/DEBUG   (  161): 
I/DEBUG   (  161): code around pc:
I/DEBUG   (  161):     40053f58 e8bd00f0 e3700a01 912fff1e e2600000  
I/DEBUG   (  161):     40053f68 ea006f7c e92d50f0 e3a07f43 ef000000  
I/DEBUG   (  161):     40053f78 e8bd50f0 e3700a01 912fff1e e2600000  
I/DEBUG   (  161):     40053f88 ea006f74 e92d50f0 e3a070ee ef000000  
I/DEBUG   (  161):     40053f98 e8bd50f0 e3700a01 912fff1e e2600000  
I/DEBUG   (  161):     40053fa8 ea006f6c 00000000 e1520003 8a0000ab  
I/DEBUG   (  161):     40053fb8 f5d1f040 e92d4001 e3520000 11500001  
I/DEBUG   (  161):     40053fc8 08bd8001 f5d1f000 f5d1f040 e3520020  
I/DEBUG   (  161):     40053fd8 3a00008f e3520080 3a000084 e2603000  
I/DEBUG   (  161):     40053fe8 e213303f 0a000015 e0422003 e1b0cf83  
I/DEBUG   (  161):     40053ff8 44d1c001 44c0c001 24d1c001 24c0c001  
I/DEBUG   (  161):     40054008 24d1c001 24c0c001 e1b0ce83 5a000001  
I/DEBUG   (  161):     40054018 f4a1030d f480031d 3a000001 f421070d  
I/DEBUG   (  161):     40054028 f400071d e1b0cd83 5a000001 f4210a0d  
I/DEBUG   (  161):     40054038 f4000a2d 3a000001 f421020d f400023d  
I/DEBUG   (  161):     40054048 f5d1f080 f5d1f0c0 e3520902 3a000004  
I/DEBUG   (  161): 
I/DEBUG   (  161): code around lr:
I/DEBUG   (  161):     40044ff0 447b4b13 42b3e010 4812d10e 44786a1e  
I/DEBUG   (  161):     40045000 ec90f7fb e9d8f00d 46224631 efaef00e  
I/DEBUG   (  161):     40045010 d00a3001 e00b2400 2b00681b 480ad1eb  
I/DEBUG   (  161):     40045020 44782403 ec7ef7fb f001e002 6804fa1b  
I/DEBUG   (  161):     40045030 fa18f001 46206005 bf00bd70 0003b3b2  
I/DEBUG   (  161):     40045040 0003b3a6 0003b39e 0003b37a bf7ef7ff  
I/DEBUG   (  161):     40045050 4a3e4b3d 43f0e92d 4606b08b 447b460d  
I/DEBUG   (  161):     40045060 6823589c 930946a1 f9fcf001 8000f8d0  
I/DEBUG   (  161):     40045070 d0482d00 f0104628 280ff80b d8444604  
I/DEBUG   (  161):     40045080 ffe4f7ff d1064286 4629200f e8a2f00d  
I/DEBUG   (  161):     40045090 d03c2800 482ee02e f7fb4478 482debc2  
I/DEBUG   (  161):     400450a0 e0154478 d11342b0 482b6a06 f7fb4478  
I/DEBUG   (  161):     400450b0 4a2aec3a 46332120 447aa801 fc24f013  
I/DEBUG   (  161):     400450c0 a8012101 ff22f01a 46061c42 e011d104  
I/DEBUG   (  161):     400450d0 28006800 e02cd1e6 46294630 f00d4622  
I/DEBUG   (  161):     400450e0 1c43e8de d11e4607 f9bcf001 29046801  
W/st-log  (16075): Final features: 12670
W/st-log  (16075): Initial features: Max - 7811, Min - 8820
D/NvOsDebugPrintf(  171): FlashError: Flash Parameter Error!!
D/NvOsDebugPrintf(  171): FlashError: TorchBrightness is 0!!
D/NvOsDebugPrintf(  171): FlashError: Torch on midtone common gain is 0!!
D/NvOsDebugPrintf(  171): FlashError: Torch on highlight common gain is 0!!
D/NvOsDebugPrintf(  171): FlashError: Torch on luma is 0!!
W/st-log  (16075): Final features: 13076
I/BootReceiver(  899): Copying /data/tombstones/tombstone_04 to DropBox (SYSTEM_TOMBSTONE)
W/ActivityManager(  899):   Force finishing activity com.ICVR.Hirtc/com.google.unity.GoogleUnityActivity
W/st-log  (16075): Initial features: Max - 8554, Min - 9290
D/NvOsDebugPrintf(  171): FlashError: Flash Parameter Error!!
D/NvOsDebugPrintf(  171): FlashError: TorchBrightness is 0!!
D/NvOsDebugPrintf(  171): FlashError: Torch on midtone common gain is 0!!
D/NvOsDebugPrintf(  171): FlashError: Torch on highlight common gain is 0!!
D/NvOsDebugPrintf(  171): FlashError: Torch on luma is 0!!
W/InputDispatcher(  899): channel '65134b70 com.ICVR.Hirtc/com.google.unity.GoogleUnityActivity (server)' ~ Consumer closed input channel or an error occurred.  events=0x9
E/InputDispatcher(  899): channel '65134b70 com.ICVR.Hirtc/com.google.unity.GoogleUnityActivity (server)' ~ Channel is unrecoverably broken and will be disposed!
W/InputDispatcher(  899): Attempted to unregister already unregistered input channel '65134b70 com.ICVR.Hirtc/com.google.unity.GoogleUnityActivity (server)'
I/WindowState(  899): WIN DEATH: Window{65134b70 u0 com.ICVR.Hirtc/com.google.unity.GoogleUnityActivity}
W/MediaFocusControl(  899):   AudioFocus   audio focus client died
I/MediaFocusControl(  899): AudioFocus  removeFocusStackEntry(): removing entry for android.os.BinderProxy@64d37158
E/Sensors (  899): [nosae] setDelay: 8000000 sec
D/Sensors (  899): Writing packet 54 32 0A 04 40 1F 00 00 74 
I/tango   (16075): TangoService.cc:176 ThreadLoop attempting disconnect number 1.
I/tango   (16075): tango_context.cc:617 TangoContext::StopRuntime() /data/data/com.google.tango/files/datasets/
I/tango   (16075): tango_application.cc:310 TangoApplication: Stopping...
I/tango   (16075): tango_hal_device_wrapper.cc:187 HAL device wrapper calling stop.
W/tango   (16075): tango_image_callback.cc:48 Could not promote most recent yuv image.
W/tango   (16075): tango_image_callback.cc:48 Could not promote most recent yuv image.
I/WindowState(  899): WIN DEATH: Window{6514a170 u0 SurfaceView}
D/Sensors (  899): Writing packet 54 36 0B 00 74 
D/phs:ipc-loc(  180): Socket 11: hangup from client ""com.ICVR.Hirtc""
W/ActivityManager(  899): Exception thrown during pause
W/ActivityManager(  899): android.os.DeadObjectException
W/ActivityManager(  899):   at android.os.BinderProxy.transact(Native Method)
W/ActivityManager(  899):   at android.app.ApplicationThreadProxy.schedulePauseActivity(ApplicationThreadNative.java:660)
W/ActivityManager(  899):   at com.android.server.am.ActivityStack.startPausingLocked(ActivityStack.java:768)
W/ActivityManager(  899):   at com.android.server.am.ActivityStack.finishActivityLocked(ActivityStack.java:2473)
W/ActivityManager(  899):   at com.android.server.am.ActivityStack.finishTopRunningActivityLocked(ActivityStack.java:2347)
W/ActivityManager(  899):   at com.android.server.am.ActivityStackSupervisor.finishTopRunningActivityLocked(ActivityStackSupervisor.java:2045)
W/ActivityManager(  899):   at com.android.server.am.ActivityManagerService.handleAppCrashLocked(ActivityManagerService.java:9569)
W/ActivityManager(  899):   at com.android.server.am.ActivityManagerService.makeAppCrashingLocked(ActivityManagerService.java:9462)
W/ActivityManager(  899):   at com.android.server.am.ActivityManagerService.crashApplication(ActivityManagerService.java:10107)
W/ActivityManager(  899):   at com.android.server.am.ActivityManagerService.handleApplicationCrashInner(ActivityManagerService.java:9658)
W/ActivityManager(  899):   at com.android.server.am.NativeCrashListener$NativeCrashReporter.run(NativeCrashListener.java:86)
D/Sensors (  899): Writing packet 54 31 0B 00 74 
E/Sensors (  899): [nosae] setDelay: 10000000 sec
D/Sensors (  899): Writing packet 54 32 0A 04 10 27 00 00 74 
I/ActivityManager(  899): Process com.ICVR.Hirtc (pid 18880) has died.
D/Sensors (  899): Writing packet 54 36 10 00 74 
D/Sensors (  899): Writing packet 54 31 10 00 74 
I/art     (  899): Heap trim of managed (duration=15.580083ms, advised=2000KB) and native (duration=3.711084ms, advised=1388KB) heaps. Managed heap utilization of 67%.
W/st-log  (16075): Final features: 15209
I/ActivityManager(  899): Killing 14992:com.google.android.youtube/u0a70 (adj 15): empty #17
I/art     (  165): Process 18880 terminated by signal (6)
I/art     ( 1218): GcCauseBackground sticky partial concurrent mark sweep GC freed 10044(598KB) AllocSpace objects, 22(599KB) LOS objects, 5% free, 16MB/17MB, paused 5.245ms total 30.962ms
I/CastMediaRouteProvider(10905): in onDiscoveryRequestChanged: request=null
W/MdnsClient_Cast(10905): Multicast lock held. Releasing. Subtypes:""233637DE""
W/MdnsClient(10905): unicast receiver thread is already dead.
W/GCoreFlp(11146): No location to return for getLastLocation()
W/FusedLocationProvider(11146): location=null
W/GCoreFlp(11146): No location to return for getLastLocation()
W/FusedLocationProvider(11146): location=null
D/NvOsDebugPrintf(  171): routeResultFromCAM: WARNING: only 0 requests in flight on sensor 0, frame drops likely
D/NvOsDebugPrintf(  171): routeResultFromCAM: WARNING: only 0 requests in flight on sensor 1, frame drops likely
D/NvOsDebugPrintf(  171): NvCamScaler_OutputThread-- (error 0x0)
I/art     ( 1218): GcCauseBackground partial concurrent mark sweep GC freed 8107(513KB) AllocSpace objects, 18(3MB) LOS objects, 6% free, 13MB/14MB, paused 7.073ms total 27.552ms
D/NvOsDebugPrintf(  171): SensorBayer_SetPowerLevel 1
E/Sensors (  899): [nosae] setDelay: 10000000 sec
D/Sensors (  899): Writing packet 54 32 0A 04 10 27 00 00 74 
I/Camera2ClientBase(  171): Closed Camera 1
I/tango   (16075): tango_hal_device_wrapper.cc:190 HAL device wrapper stop call succeeded.
I/tango   (16075): image-cache-inl.h:356 Starting ImageCache drain.
I/tango   (16075): image-cache-inl.h:385 Finished ImageCache drain.
I/tango   (16075): image-cache-inl.h:356 Starting ImageCache drain.
I/tango   (16075): image-cache-inl.h:385 Finished ImageCache drain.
I/tango   (16075): tango_application.cc:347 TangoApplication: Joined successfully.
I/tango   (16075): TangoService.cc:182 ThreadLoop stopped Tango Runtime.
I/tango   (16075): tango_context.cc:637 TangoContext::DestroyRuntime()
I/tango   (16075): tango_context.cc:1755 TangoContext: Destroying Tango Service Application.
I/tango   (16075): tango_context.cc:1599 Logging 2 events.
I/tango   (16075): tango_application.cc:310 TangoApplication: Stopping...
I/tango   (16075): image-cache-inl.h:356 Starting ImageCache drain.
I/tango   (16075): image-cache-inl.h:385 Finished ImageCache drain.
I/tango   (16075): image-cache-inl.h:356 Starting ImageCache drain.
I/tango   (16075): image-cache-inl.h:385 Finished ImageCache drain.
I/tango   (16075): tango_application.cc:347 TangoApplication: Joined successfully.
I/tango   (16075): tango_context.cc:1764 Trying to reset application_.
I/tango   (16075): image-cache-inl.h:356 Starting ImageCache drain.
I/tango   (16075): image-cache-inl.h:385 Finished ImageCache drain.
I/tango   (16075): image-cache-inl.h:356 Starting ImageCache drain.
I/tango   (16075): image-cache-inl.h:385 Finished ImageCache drain.
I/tango   (16075): tango-hal-interface.cc:96 Average feature detection frequency: 10.0257
D/NvOsDebugPrintf(  171): NvCamScaler_OutputThread-- (error 0x0)
D/NvOsDebugPrintf(  171): SensorBayer_SetPowerLevel 1
D/Sensors (  899): Writing packet 54 36 0A 00 74 
D/Sensors (  899): Writing packet 54 31 0A 00 74 
I/tango   (16075): tango_hal_wrapper.cc:112 Closing Tango HAL.
I/tango   (16075): tango_hal_device_wrapper.cc:216 HAL device wrapper calling close, buffer balance at: 0
I/tango   (16075): tango_hal_device_wrapper.cc:224 HAL device wrapper close call succeeded.
I/tango   (16075): feature_tracker.cc:49 Total num. of frame-frame matches before RANSAC: 301924
I/tango   (16075): manager.cc:131 IMU average latency 0.52253ms variance 0.498342 max 9.95973ms hz 100.067
I/tango   (16075): manager.cc:137 VIO average latency 17.8815ms variance 49.9061 max 51.4582ms hz 10.0159
I/tango   (16075): tango_context.cc:1767 Done resetting application_. (Took 0.710731 seconds.)
I/tango   (16075): tango_context.cc:1599 Logging 4 events.
I/Camera2ClientBase(  171): Closed Camera 0
I/tango   (16075): tango_context.cc:1772 TangoContext: Runtime has shut down! (Took 0.713128 seconds.)
I/tango   (16075): TangoService.cc:187 ThreadLoop destroyed Tango Runtime.
I/art     ( 1700): Heap trim of managed (duration=1.129500ms, advised=104KB) and native (duration=578.166us, advised=0B) heaps. Managed heap utilization of 56%.
E/WifiController(  899): Not handled here 155652
D/WifiController(  899): battery changed pluggedType: 2
I/DownloadManagerWrapper( 1143): onReceive() : Charging = false
I/PlayCommon(17218): [831] PlayEventLogger.uploadEventsImpl: Preparing logs for uploading
I/PlayCommon(17218): [831] PlayEventLogger.uploadEventsImpl: No file ready to send
</code></pre>",android|unity3d|google-project-tango|3d-reconstruction,7041978,C. Hirt,yes
Prevent CloudKit Sync and Trigger sync manually,"<p>CloudKit sync with Core Data is quite an energy expensive task which can drain the battery quickly.</p>
<p>As far as I found out, CloudKit triggers a sync when it thinks it's convenient to do so.
I discovered, that in my app the sync is triggered almost every time I save the context, which is quite often.</p>
<p>In my case it's only necessary to sync after certain events happened and not every time I save the context. So it's quite an energy waste right now.</p>
<p>Since I am not able to reduce the amount of context saves, I try to Implement a logic that enables me to prevent the sync until I release it again.</p>
<p>So far I was not able to find any built in methods that would allow me to do that.
Any Ideas how I could implement that?
Is there a way to temporarily disable CloudKit completely without harm?</p>",swift|core-data|cloudkit,12740074,wildcard,yes
Disconnect Callback in Motorola's ICS Bluetooth Low Energy API,"<p>I'm using Motorola's ""Bluetooth Low Energy ICS_R2 API"". So far, I was able to connect to a TI 2540 keyfob and to write characteristics. What I need in addition is a callback or intent that is triggered when the keyfob gets out of range. My current solution is a watchdog that periodically starts a characteristics discovery. If the characteristics discovery fails, the watchdog considers the keyfob lost. However, I think this drains the keyfob's battery too fast. Is anyone aware of a better solution?</p>

<p>UPDATE</p>

<p>The actions in com.motorola.bluetoothle.BluetoothGatt seemed interesting. However, I guess that these are just relics of the old Motorola BLE API.</p>

<p>It seems that BluetoothDevice.ACTION_ACL_DISCONNECTED works for low energy devices, as well.</p>",android|motorola|bluetooth-lowenergy,1793878,Konny,yes
Is there an alternative for using JSON + NSTimer for fetching datafrom server?,"<p>Im using NSTimer for constant data fetching from my server using JSON.</p>

<p>Using this technique has a lot of disadvantages, such as unwanted data fetching, and battery life drain.</p>

<p>An example of this usage is to get chat messages from the server.</p>

<p><strong>Is there a good alternative for constant data fetching?</strong></p>

<p>Thanks!</p>",ios|json|nstimer|fetch,1671404,Tomer Rubin,no
Livestreaming app for the SmartEyeglass - Localhost,"<p>I have downloaded the <a href=""https://developer.sonymobile.com/2016/01/28/livestreaming-app-for-smarteyeglass-available-as-open-source-project/"" rel=""nofollow noreferrer"">Livestreaming App</a> for the SmartEyeglass and I want to enter certain things to it but I don't know how.For the App to work you need to install it to your phone and open the localhost web page in your computer.In the localhost web page, there is a camera view which displays what the wearer of the Smarteyeglass is seeing and a textbox in which you can write what you want the wearer to see. In this webpage I want to add another textbox in which I will be able to take feedback from the wearer.But I have no idea in which part of the code I can add that. Can you help me? How do I change the layout in the localhost webpage?</p>

<pre><code>public final class LivestreamingControl extends ControlExtension {

/**
 * Uses SmartEyeglass API version
 */
private static final int SMARTEYEGLASS_API_VERSION = 3;
public final int width;
public final int height;
// The application context.
private final Context context;

private static final String[] BUTTONS1 = {""Βράχος"", ""Φυτό"", ""Ρομπότ""};
private static final String[] BUTTONS2 = {""Κίνηση"", ""Αναπνοή"", ""Και τα δύο""};
private static final String[] BUTTONS3 = {""Ζωικό"", ""Φυτικό"", ""Και τα δύο""};
private static final String[] BUTTONS4 = {""Ζωικό"", ""Φυτικό"", ""Και τα δύο""};
private static final String[] BUTTONS5 = {""Ουσίες"",""Πλη/φορίες""};
private static final String[] BUTTONS6 = {""Σωστό"", ""Λάθος""};
private static final String[] BUTTONS7 = {""Σωστό"", ""Λάθος""};
private static final String[] BUTTONS8 = {""Σωστό"", ""Λάθος""};
private static final String[] BUTTONS9 = {""Σωστό"", ""Λάθος""};
private static final String[] BUTTONS10 = {""Ιοί"", ""Μύκητες"", ""Και τα δύο""};

private boolean q1 =false;
private boolean q2 =false;
private boolean q3 =false;
private boolean q4 =false;
private boolean q5 =false;
private boolean q6 =false;
private boolean q7 =false;
private boolean q8 =false;
private boolean q9 =false;
private boolean q10 =false;
private boolean aq =false;
private int qn = 0;


private boolean dialogClosed;
private int question =0;
private int count=0;

/**
 * Instance of the Control Utility class.
 */
private final SmartEyeglassControlUtils utils;
private boolean cameraStarted = false;
private int recordingMode = SmartEyeglassControl.Intents.CAMERA_MODE_STILL;
private int pointX;
private int pointY;

private SharedPreferences sharedPref;

private SocketClient socket;

private String serverIP = """";

/**
 * Creates an instance of this control class.
 *
 * @param context            The context.
 * @param hostAppPackageName Package name of host application.
 */
public LivestreamingControl(final Context context, final String hostAppPackageName) {
    super(context, hostAppPackageName);
    this.context = context;
    sharedPref = PreferenceManager.getDefaultSharedPreferences(context);
    serverIP = sharedPref.getString(""ipAddress"","""");

    // Checking if server IP address was not set yet on mobile
    if (serverIP.equals("""")) {
        updateDisplay();
    }
    else {
        // Start socket client connection to server
        socket = new SocketClient(serverIP);
        socket.connect();
    }

    // Initialize listener for camera events
    SmartEyeglassEventListener listener = new SmartEyeglassEventListener() {
        // When camera operation has succeeded
        // handle result according to current recording mode
        @Override
        public void onCameraReceived(final CameraEvent event) {
            // Retrieve image data
            String imageEncoded = Base64.encodeToString( event.getData(), Base64.DEFAULT);
            // Send image data as message over socket client
            socket.sendMessage(""new image"", imageEncoded);

            Log.d(Constants.LOG_TAG, ""Stream Event coming: "" + event.toString());
            updateDisplay();
        }

        @Override
        public void onDialogClosed(int code) {
            dialogClosed = true;
            //Η ΣΩΣΤΕΣ ΑΠΑΝΤΗΣΕΙΣ ΚΑΘΕ ΕΡΩΤΗΣΗΣ
            if(question== 1)
            {
                if (code == 0) {
                    utils.showDialogMessage(""ΛΑΘΟΣ:Tο Φυτό"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    cameraStarted = true;
                } else if (code == 1) {
                    utils.showDialogMessage(""ΣΩΣΤΟ"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    count++;
                    cameraStarted = true;
                }
                else if (code == 2){
                    utils.showDialogMessage(""ΛΑΘΟΣ:Tο Φυτό"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    cameraStarted = true;
                }
            }
            else if(question ==2)
            {
                if (code == 0) {
                    utils.showDialogMessage(""ΛΑΘΟΣ:Και τα δύο"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    cameraStarted = true;
                } else if (code == 1) {
                    utils.showDialogMessage(""ΛΑΘΟΣ:Και τα δύο"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    cameraStarted = true;
                }
                else if (code == 2){
                    utils.showDialogMessage(""ΣΩΣΤΟ"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    count++;
                    socket.message = """";
                    cameraStarted = true;
                }

            }
            else if(question ==3)
            {
                if (code == 0) {
                    utils.showDialogMessage(""ΛΑΘΟΣ:Και τα δύο έχουν      πυρήνα"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    cameraStarted = true;
                } else if (code == 1) {
                    utils.showDialogMessage(""ΛΑΘΟΣ:Και τα δύο έχουν      πυρήνα"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    cameraStarted = true;
                }
                else if (code == 2){
                    utils.showDialogMessage(""ΣΩΣΤΟ"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    count++;
                    cameraStarted = true;
                }
            }
            else if(question ==4)
            {
                if (code == 0) {
                    utils.showDialogMessage(""ΛΑΘΟΣ:Τα φυτικά         κύτταρα"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    cameraStarted = true;
                } else if (code == 1) {
                    utils.showDialogMessage(""ΣΩΣΤΟ"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    count++;
                    cameraStarted = true;
                }
                else if (code == 2){
                    utils.showDialogMessage(""ΛΑΘΟΣ:Τα φυτικά         κύτταρα"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    cameraStarted = true;
                }
            }
            else if(question ==5)
            {
                if (code == 0) {
                    utils.showDialogMessage(""ΣΩΣΤΟ"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    count++;
                    cameraStarted = true;
                } else if (code == 1) {
                    utils.showDialogMessage(""ΛΑΘΟΣ:Αποθηκεύονται   χρήσιμες ουσίες"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    cameraStarted = true;
                }
            }
            else if(question ==6)
            {
                if (code == 0) {
                    utils.showDialogMessage(""ΛΑΘΟΣ:Ο πυρήνας αποτε-  λεί το κέντρο ελέγχου"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    cameraStarted = true;
                } else if (code == 1) {
                    utils.showDialogMessage(""ΣΩΣΤΟ"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    count++;
                    cameraStarted = true;
                }
            }
            else if(question ==7)
            {
                if (code == 0) {
                    utils.showDialogMessage(""ΛΑΘΟΣ:Δεν έχουν                 σκελετό"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    cameraStarted = true;
                } else if (code == 1) {
                    utils.showDialogMessage(""ΣΩΣΤΟ"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    count++;
                    cameraStarted = true;
                }
            }
            else if(question ==8)
            {
                if (code == 0) {
                    utils.showDialogMessage(""ΛΑΘΟΣ:Στους χλωροπλά-   στες"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    cameraStarted = true;
                } else if (code == 1) {
                    utils.showDialogMessage(""ΣΩΣΤΟ"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    count++;
                    cameraStarted = true;
                }
            }
            else if(question ==9)
            {
                if (code == 0) {
                    utils.showDialogMessage(""ΣΩΣΤΟ"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    count++;
                    cameraStarted = true;
                } else if (code == 1) {
                    utils.showDialogMessage(""ΛΑΘΟΣ"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    cameraStarted = true;
                }
            }
            else if(question ==10)
            {
                if (code == 0) {
                    utils.showDialogMessage(""ΛΑΘΟΣ:Και τα δύο"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    cameraStarted = true;
                } else if (code == 1) {
                    utils.showDialogMessage(""ΛΑΘΟΣ:Και τα δύο"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    cameraStarted = true;
                }
                else if (code == 2){
                    utils.showDialogMessage(""ΣΩΣΤΟ"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    count++;
                    cameraStarted = true;
                }
            }
            else if(qn ==1)
            {
                    socket.message = """";
                    String message0 = """";
                    aq=true;
                    qn=0;
                    utils.showDialogMessage(""ΣΩΣΤΟ ή ΛΑΘΟΣ?"", message0, BUTTONS6);
            }
            else if(aq)
            {
                if (code == 0) {
                    utils.showDialogMessage(""ΛΑΘΟΣ"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    aq=false;
                    cameraStarted = true;
                } else if (code == 1) {
                    utils.showDialogMessage(""ΣΩΣΤΟ"", SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
                    socket.message = """";
                    aq=false;
                    count++;
                    cameraStarted = true;
                }
            }
        }

        // Called when camera operation has failed
        // We just log the error
        @Override
        public void onCameraErrorReceived(final int error) {
            Log.d(Constants.LOG_TAG, ""onCameraErrorReceived: "" + error);
        }

        // When camera is set to record image to a file,
        // log the operation and clean up
        @Override
        public void onCameraReceivedFile(final String filePath) {
            Log.d(Constants.LOG_TAG, ""onCameraReceivedFile: "" + filePath);
            updateDisplay();
        }
    };
    utils = new SmartEyeglassControlUtils(hostAppPackageName, listener);
    utils.setRequiredApiVersion(SMARTEYEGLASS_API_VERSION);
    utils.activate(context);

    width = context.getResources().getDimensionPixelSize(R.dimen.smarteyeglass_control_width);
    height = context.getResources().getDimensionPixelSize(R.dimen.smarteyeglass_control_height);

    // Switch WLAN mode ON to achieve higher speed on live stream
    utils.setPowerMode(SmartEyeglassControl.Intents.POWER_MODE_HIGH);
}

// Respond to tap on touch pad by triggering camera capture.
@Override
public void onTouch(final ControlTouchEvent event) {
    if (event.getAction() == Control.TapActions.SINGLE_TAP) {
        if (!cameraStarted) {
            initializeCamera();
        } else {
            cleanupCamera();
        }
        updateDisplay();
    }
}

// Call the startCamera, and start the camera.
private void initializeCamera() {
    try {
        Time now = new Time();
        now.setToNow();
        // Start camera without filepath for other recording modes
        Log.d(Constants.LOG_TAG, ""startCamera "");
        utils.startCamera();
    } catch (ControlCameraException e) {
        Log.d(Constants.LOG_TAG, ""Failed to register listener"", e);
    }
    Log.d(Constants.LOG_TAG, ""onResume: Registered listener"");
    cameraStarted = true;
}

// Call the stopCamera, and stop the camera.
private void cleanupCamera() {
    utils.stopCamera();
    cameraStarted = false;
}

// When app becomes visible, set up camera mode choices
// and instruct user to begin camera operation
@Override
public void onResume() {
    socket = new SocketClient(serverIP);
    socket.connect();
    // Note: Setting the screen to be always on will drain the accessory
    // battery. It is done here solely for demonstration purposes.
    setScreenState(Control.Intents.SCREEN_STATE_ON);
    pointX = context.getResources().getInteger(R.integer.POINT_X);
    pointY = context.getResources().getInteger(R.integer.POINT_Y);

    // Read the settings for the extension.
    SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(context);
    int recMode = Integer.parseInt(prefs.getString(context.getString(R.string.preference_key_recordmode), ""2""));
    int preferenceId = R.string.preference_key_resolution_still;

    recordingMode = SmartEyeglassControl.Intents.CAMERA_MODE_JPG_STREAM_LOW_RATE;
    preferenceId = R.string.preference_key_resolution_movie;

    // Get and show quality parameters
    int jpegQuality = Integer.parseInt(prefs.getString(context.getString(R.string.preference_key_jpeg_quality), ""1""));
    int resolution = Integer.parseInt(prefs.getString(context.getString(preferenceId), ""6""));

    // Set the camera mode to match the setup
    utils.setCameraMode(jpegQuality, resolution, recordingMode);

    cameraStarted = false;
    updateDisplay();
}

// Clean up any open files and reset mode when app is paused.
@Override
public void onPause() {
    socket.disconnect();
    // Stop camera.
    if (cameraStarted) {
        Log.d(Constants.LOG_TAG, ""onPause() : stopCamera"");
        cleanupCamera();
    }
}

// Clean up data structures on termination.
@Override
public void onDestroy() {
    utils.deactivate();
    socket.disconnect();
}

private void updateDisplay()
{
    Bitmap displayBitmap = Bitmap.createBitmap(width, height, Bitmap.Config.ARGB_8888);
    displayBitmap.setDensity(DisplayMetrics.DENSITY_DEFAULT);
    Canvas canvas = new Canvas(displayBitmap);
    Paint paint = new Paint();
    paint.setStyle(Paint.Style.FILL);
    paint.setTextSize(16);

    paint.setColor(Color.WHITE);

    // Update layout according to current state of the app
    if (serverIP.equals("""")) {
        canvas.drawText(""First open the Stream Test app and set the ip address"", pointX, pointY, paint);
    }
    else if (cameraStarted) {

    //ΟΙ ΕΡΩΤΗΣΕΙΣ!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

            if (socket.message.equals(""1"") &amp;&amp; !q1) {
                cameraStarted = false;
                q1=true;
                question=1;
                String title0 = ""Ποιό από αυτά"";
                String message0 = ""είναι έμβιο όν;"";
                utils.showDialogMessage(title0, message0, BUTTONS1);
            }
            else if(socket.message.equals(""2"")&amp;&amp; !q2) {
                cameraStarted = false;
                q2=true;
                question=2;
                String title0 = ""Λειτουργία της"";
                String message0 = ""ζωής είναι η:"";
                utils.showDialogMessage(title0, message0, BUTTONS2);
            }
            else if(socket.message.equals(""3"") &amp;&amp; !q3) {
                cameraStarted = false;
                q3=true;
                question=3;
                String title0 = ""Ποιά κύτταρα"";
                String message0 = ""έχουν πυρήνα;"";
                utils.showDialogMessage(title0, message0, BUTTONS3);
            }
            else if(socket.message.equals(""4"")&amp;&amp; !q4) {
                cameraStarted = false;
                q4=true;
                question=4;
                String title0 = ""Ποιά κύτταρα έχουν"";
                String message0 = ""κυτταρικό τοίχωμα;"";
                utils.showDialogMessage(title0, message0, BUTTONS4);
            }
            else if(socket.message.equals(""5"")&amp;&amp; !q5) {
                cameraStarted = false;
                q5=true;
                question=5;
                String title0 = ""Στο χυμοτόποιο"";
                String message0 = ""αποθηκεύονται:"";
                utils.showDialogMessage(title0, message0, BUTTONS5);
            }
            else if(socket.message.equals(""6"")&amp;&amp; !q6) {
                cameraStarted = false;
                q6=true;
                question=6;
                String title0 = ""Ο πυρήνας αποτελεί"";
                String message0 = ""εργοστάσιο ενέργειας."";
                utils.showDialogMessage(title0, message0, BUTTONS6);
            }
            else if(socket.message.equals(""7"")&amp;&amp; !q7) {
                cameraStarted = false;
                q7=true;
                question=7;
                String title0 = ""Όλα τα φυτά"";
                String message0 = ""έχουν σκελετό."";
                utils.showDialogMessage(title0, message0, BUTTONS7);
            }
            else if(socket.message.equals(""8"")&amp;&amp; !q8) {
                cameraStarted = false;
                q8=true;
                question=8;
                String title0 = ""Στα μιτοχόνδρια"";
                String message0 = ""γίνεται η φωτοσύνθεση."";
                utils.showDialogMessage(title0, message0, BUTTONS8);
            }
            else if(socket.message.equals(""9"")&amp;&amp; !q9) {
                cameraStarted = false;
                q9=true;
                question=9;
                String title0 = ""Η χλωροφύλλη"";
                String message0 = ""είναι πράσινη."";
                utils.showDialogMessage(title0, message0, BUTTONS9);
            }
            else if(socket.message.equals(""10"")&amp;&amp; !q10) {
                cameraStarted = false;
                q10=true;
                question=10;
                String title0 = ""Μονοκύτταροι είναι"";
                String message0 = ""ποιοι οργανισμοί;"";
                utils.showDialogMessage(title0, message0, BUTTONS10);
            }
            else if(socket.message.endsWith(""?"")) {
                String title0 = """";
                cameraStarted = false;
                 qn =1;
                utils.showDialogMessage(socket.message, SmartEyeglassControl.Intents.DIALOG_MODE_TIMEOUT);
            }
            else if(socket.message.equals(""s"")) {
                canvas.drawText(""SOS: δώσε προσοχή"", pointX, (pointY * 3), paint);
            }
            else if(socket.message.equals(""x"")) {
                canvas.drawText(""Ξυπνήστε!!!"", pointX, (pointY * 3), paint);
            }
            else {
                canvas.drawText(""JPEG Streaming..."", pointX, pointY, paint);
                canvas.drawText(""Tap to stop."", pointX, (pointY * 2), paint);
                canvas.drawText(socket.message, pointX, (pointY * 3), paint);
                canvas.drawText(""Έχεις απαντήσει σωστά ""+count+""/10 ερωτήσεις"", pointX, (pointY * 4), paint);
            }

    } else {
        canvas.drawText(""Tap to start JPEG Stream."", pointX, pointY, paint);
    }
    Log.d(Constants.LOG_TAG, ""updateDisplay() : updating SmartEyeglass display"");
    showBitmap(displayBitmap);
}
</code></pre>

<p>SocketClient Class</p>

<pre><code>public class SocketClient {

    public Socket mSocket;
    private String SERVER_URL;
    private Activity activity;
    private Context ctxt;
    public static String message = """";

    public SocketClient(String ipAddress) {
        SERVER_URL = ""http://""+ipAddress+"":80"";
    }

    public void connect() {


        //Try to connect to the socket
        try {
            Log.d(""mySony"", ""connecting to socket : ""+SERVER_URL);
            mSocket = IO.socket(SERVER_URL);
            mSocket.on(Socket.EVENT_CONNECT_ERROR, onConnectError);
            mSocket.on(Socket.EVENT_CONNECT_TIMEOUT, onConnectTimeout);
            mSocket.on(""new chat message"",  new Emitter.Listener() {
                @Override
                public void call(final Object... args) {
                    Log.d(""mySony"", args.toString());
                    message = args[0].toString();
                }
            });

            mSocket.connect();

        } catch (URISyntaxException e) {
            throw new RuntimeException(e);
        }
    }

    public void sendMessage(String socket, String message) {
        mSocket.emit(socket, message);
    }

    public void disconnect() {
        mSocket.disconnect();
        mSocket.off(Socket.EVENT_CONNECT_ERROR, onConnectError);
        mSocket.off(Socket.EVENT_CONNECT_TIMEOUT, onConnectError);
        mSocket.off(""new chat message"", onNewMessage);
    }

    private Emitter.Listener onConnectError = new Emitter.Listener() {
        @Override
        public void call(Object... args) {
            Log.d(""mySony"", ""Connection error!! "");
            for (int x=0; x&lt;args.length; x++) {
                Log.d(""mySony"", x+"" = ""+args[x].toString());
            }
        }
    };

    private Emitter.Listener onConnectTimeout = new Emitter.Listener() {
        @Override
        public void call(Object... args) {
            Log.d(""mySony"", ""Connection timed out!!"");
        }
    };

    private Emitter.Listener onNewMessage = new Emitter.Listener() {
        @Override
        public void call(final Object... args) {
            JSONObject data = (JSONObject) args[0];
            Log.d(""mySony"", ""data = "" + data.toString());
        }
    };
}
</code></pre>",localhost|sony|sony-smarteyeglass,4929979,Kat Dale,no
how to use zulu-8.jdk work with kapt on android studio m1,"<p>Current JDK version 1.8 has a bug that prevents Room from being incremental this look like
<a href=""https://stackoverflow.com/questions/58822538/current-jdk-version-1-8-has-a-bug-that-prevents-room-from-being-incremental"">Current JDK version 1.8 has a bug that prevents Room from being incremental</a> , but....</p>
<p>m1 device optimize using zulu jdk</p>
<p><code>/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home</code></p>
<p>m1 device is not optimize when using sdk from Android Studio</p>
<p><code>/Applications/Android Studio.app/Contents/jre/jdk/Contents/Home</code></p>
<p>before i was use kapt <code>'androidx.room:room-compiler:2.3.0'</code> where i have active to the plugin <code>id 'kotlin-kapt'</code></p>
<blockquote>
<p>so how i can use zulu sdk instead of android jdk without <code>error bug that prevents Room from being incremental</code> ? any have trick ?</p>
</blockquote>
<blockquote>
<p>my device is lagging, hot, and drained battery when use android jdk.</p>
</blockquote>
<p><code>Current JDK version 1.8.0_292-b10 has a bug </code>(<a href=""https://bugs.openjdk.java.net/browse/JDK-8007720"" rel=""nofollow noreferrer"">https://bugs.openjdk.java.net/browse/JDK-8007720</a>) <code>that prevents Room from being incremental. Consider using JDK 11+ or the embedded JDK shipped with Android Studio 3.5+.</code> but what i have research the jdk 11+ is not support on android studio.</p>
<p><strong>edit 1</strong>
I have try with Zulu-11.jdk
<code> ./gradlew assembleDebug --stacktrace</code> the exception is same</p>
<pre><code>java.lang.Exception: No native library is found for os.name=Mac and os.arch=aarch64. path=/org/sqlite/native/Mac/aarch64
</code></pre>",java|android|kotlin,8122500,Yogi Arif Widodo,no
What is com.google.android.gms.persistent and why is it always using the CPU?,"<p>Even when nothing else is happening this system process seems to use a steady 1-2% of the CPU.  Over the course of a day this drains a significant amount of battery even when the device wasn't used for anything. I haven't been able to correlate it to any other apps because even when they have only used a few seconds of CPU time each over the course of several hours this process is using minutes.</p>

<p>It still seems to run even if I:</p>

<ul>
<li>turn off WiFi</li>
<li>turn off BlueTooth</li>
<li>turn off location services</li>
<li>turn off everything except the most bare minimum of syncing (e.g. GMail)</li>
</ul>

<p>I wrote a little test app that monitors <code>/proc/&lt;pid&gt;/stat</code> every 10ms and writes to logcat any time <code>com.google.android.gms.persistent</code>, hoping that it would write something to logcat itself which would pinpoint what app or other service is using ""persistent"" for its services.  I don't see much, but here are a few things I did see:</p>

<pre><code>InputReader: Reconfiguring input devices.  changes=0x00000010
WifiService: acquireWifiLockLocked: WifiLock{NlpWifiLock type=2 binder=android.os.BinderProxy@f73f0b8}
LocationFilter: Forcing stable location. Original location:Location[...
ConnectivityService: notifyType CAP_CHANGED for NetworkAgentInfo [WIFI () - 246]
</code></pre>

<p>Each line above was at a different time, immediately preceding (within 10ms of) a log message detecting CPU usage by <code>com.google.android.gms.persistent</code> but without any clear indication whether or not it is related.   Unfortunately, none of the above reports more than 10ms of CPU time taken, and so - even if accurate in denoting what is using ""persistent"" represents only a small portion of the actual CPU time being used.</p>

<p>Other attempts to research what uses this process have suggested various things (such as wearables) which I don't have and have never had connected to my device.</p>

<p>What is using this process?  I am looking either for this information directly, or for additional ways I can deduce this information similar to my attempts via logcat.</p>

<p>Update: I have been looking for the source (e.g. com.google.android.gms.persistent.java or something like that) on <a href=""https://android.googlesource.com"" rel=""noreferrer"">https://android.googlesource.com</a> without any luck. Is this not part of the public source code?  What is really strange is that there doesn't even appear to be any documentation, e.g. here: <a href=""https://android.googlesource.com/platform/frameworks/base/+/33fca8e/docs/html/reference/com/google/android/gms"" rel=""noreferrer"">https://android.googlesource.com/platform/frameworks/base/+/33fca8e/docs/html/reference/com/google/android/gms</a></p>

<p>Update 2: I disabled all syncing under Settings -> Accounts.  This seems to reduce CPU usage a bit more, and battery drop seems to have dropped to a crawl - except periodically com.google.android.gms.persistent still seems to take a burst of CPU.  </p>

<p>My working theory now is that it has an Alarm that is firing at approximately 60 second intervals regardless of whether it is needed or not, and that code is checking for syncing work, and if nothing needs to be synced it gives up the time slice right away and lets the CPU go right to sleep.  However, I halfway can't believe that such a horrible design would be used, as anything that wakes up the CPU every minute is sure to drain the battery a lot faster even if it just goes back to sleep, and why would polling be used instead of something interrupt driven for syncing anyway?</p>

<p>As far as I can tell (due to not being able to find it) the source code for com.google.android.gms.persistent is not open source or available online anywhere.  If I am wrong, I would accept as an answer to my question, any answer which would point to the source code as I could browse it and determine for myself why the CPU usage.</p>",android|android-6.0-marshmallow,543873,Michael,yes
Adding audio(wav file) to android Media Store,"<p>I have an <code>Android</code> app that records and play audio. I have a problem with the recordings, they are not recognized immediately by the android default audio player(<code>Walkman</code> in my case). Also, the recordings are not seen by the Computer's explorer when I connect the phone to the PC. I should add each recording to the <code>Media Store</code>? If yes, how should I do this by not triggering a whole <code>SD</code> card scan, but only including the recording itself into the <code>Media Server</code> database? </p>

<p>I want to avoid if possible the line below because I think will trigger whole <code>SD</code> card to be scanned so this will drain the battery:</p>

<pre><code>sendBroadcast(new Intent(Intent.ACTION_MEDIA_MOUNTED, Uri.parse(""file://""+ Environment.getExternalStorageDirectory())));
</code></pre>",android|mediastore|android-mediascanner,285553,Alexandru Circus,yes
Is it possible to implement MQTT connection with WorkManager?,"<p>I am developing an application in which we maintain a mqtt connection to the server to receive jobs from server in real-time. 
Currently we are using an approach in which we use a foreground service to keep the connection alive even when the app is killed.
The problem is that the long running service drains battery so fast. And also I'm not sure how it is gonna react in devices from different vendors.
For example in Xiaomi devices, if the auto-start setting is not enabled for the app, the service can not start in foreground when the application gets killed. I've solved this problem, but I'm not sure if it is going to work on all other versions of MIUI and other vendors.
Beside I've read that newer android versions are going to use machine learning algorithms to put battery consuming applications to sleep.
So I'm looking for another solution instead of foreground service. So I'm asking is it possible to implement this scenario with WorkManager? Is it a good idea to use WorkManager instead of foreground service? Is there a better solution for this?</p>",android|mqtt|android-workmanager|foreground-service,5014944,Behrad Ranjbar,yes
starting an Android Service on TCP connection attempt,"<p>Android can kill a process at any time, it is only possible to change the likelihood that a process will be killed by doing things such as making it foreground.  So it seems to me that servers that sit on a TCP port waiting for a connection are problematic, although I do see apps that do this.  Is there some mechanism these servers use to make sure that they are always available to answer requests?  Periodic intents to start the process would drain battery power too quick.  Starting with the sticky bit isn't foolproof in making sure a service gets restarted after being killed, and neither is foregrounding.  That leaves me thinking that perhaps there might be some way to request an Intent when a particular TCP port receives a SYN request on.  Obviously the service would have to be started and somehow open the port before an ACK was returned or else the initial connection attempt would fail and have to be retried.</p>

<p>Is there something like this going on or available?</p>",android|sockets|tcp|server,543873,Michael,yes
Not releasing MediaPlayer causes battery drain,"<p>I'm working on an app that uses a MediaPlayer object to play H.264 MP4 videos from a WallpaperService as it is a live wallpaper app. Battery drain occurs while the device (Nexus 5, Android 6.0.1) is idle and sleeping if I pause/stop the MediaPlayer with mediaPlayer.pause() or mediaPlayer.stop(). The drain is about 3-7%/hour as tested multiple times overnight. As soon as I release the media player with mediaPlayer.release(), the battery drain goes back to a more normal 1%/hour. I pause/stop the mediaPlayer when onVisibilityChanged calls false. The phone is reporting to be going to sleep in both the stock Android battery chart and Better Battery Stats. </p>

<p>How can this battery drain be explained if the CPU is going into a sleep state successfully?</p>

<p>EDIT: Something new I've discovered is that when calling mediaPlayer.setSurface(null) right before mediaPlayer.pause(), the idle battery use comes back to normal. I can then do mediaPlayer.setSurface(surface) to set it back before mediaPlayer.start(). The problem is there's some black artifacting for a couple of seconds after restarting.</p>",android|service|cpu|battery,1736277,Flyview,yes
"In an android app, can I just use the application context instead of a service service?","<p>I made an app that uses the application context to share data and run functions between activities (or when the activity is closed). I also have a <code>BroadcastReceiver</code> that processes intents, plus it spawns new threads to run common functions stored in the App Context. Since all the activities and the Broadcast receiver can access the App Context by calling <code>this.getApplicationContext()</code>, it seems to be a much easier way to run stuff in the background while sharing data and functions throughout the app. </p>

<p>But I have a few questions:
Is there a downside to doing it this way? 
Why would I want to create a service if this works flawlessly? (and so far, it has)
Is there a larger battery drain doing it this way vs. the service?</p>",android|service|this|android-context,496854,user496854,yes
Is my Android App Draining Battery?,"<p>I'm developing a game for Android. It uses a surface view and uses the sort of standard 2D drawing APIs provided. When I first released the game, I was doing all sorts of daft things like re-drawing 9-patches on each frame and likewise with text. I have since optimised much of this by drawing to Bitmap objects and drawing them each frame, only re-drawing onto the Bitmap objects when required. </p>

<p>I've received complaints about battery drain before, and following my modifications I'd like to know (scientifically) if I've made any improvements. Unfortunately, I don't have any prior data to go by, so it would be most useful to compare the performance to some other game.</p>

<p>I've been running Traceview, and using the results of it mostly for the purposes of identifying CPU-time-consuming methods. </p>

<p>So -- <strong>what's the best way of determining my app's battery performance, and what's a good benchmark?</strong></p>

<p>I know I can look at the %s of different apps through the settings, but this is again unscientific, as the figure I get from this also depends on what's happening in all of the other apps. I've looked through (most of) Google's documentation, and although the message is clear that you <em>should</em> be saving battery (and it gives the occasional tip as to how), there is little indication of how I can measure how well my app is performing. The last thing I want are more complaints of battery drain in the Android Market!</p>

<p>Thanks in advance.</p>

<hr>

<h2>EDIT</h2>

<p>Thanks for all your helpful advice/suggestions. What I really want to know is <strong>how I can use the data coming from Traceview (ie: CPU time in ms spent on each frame of the game) to determine battery usage</strong> (if this is at all possible). Reading back on my original question, I can see I was a bit vague. Thanks again.</p>",java|android|optimization|battery,209838,Tom R,yes
AudioManager issue in Android 12,"<p>I have an issue with a Samsung Galaxy Note20, Android 12, phone.  When a notification is received for the app, the notification listener executes the code below to adjust the volume of the sound that will be played (different sounds depending on notification data received). The code had issues in Android 10 in very specific models but the issues dissappeared when those phones upgraded to Android 11. Now I have the same issue in one Android 12 phone,but not sure if this will become more recurrent. The issue is that when the phone receives the notification and is about to play the sound the phone hangs and stays hanged making a strange noise and basically it becomes useless until the battery is drained and it can be reboot.  Even more strange is that no crash report is recorded in crashlytics neither the performance tab in google play console.  This was the same behaviour as in Android 10 for those very specific models.  I found that it was an Android 10 issue thanks to this post: <a href=""https://github.com/google/ExoPlayer/issues/8191"" rel=""nofollow noreferrer"">https://github.com/google/ExoPlayer/issues/8191</a>. But now I am not sure if this is again an Android issue or not, and there is no available upgrade for that Galaxy Note 20 yet.  Please advise. Thanks</p>
<pre><code> AudioManager audioManager = (AudioManager) getApplicationContext().getSystemService(Context.AUDIO_SERVICE);
        if (audioManager != null) {
            volumen_maximo= audioManager.getStreamMaxVolume(3);
        }
        if (audioManager != null) {
            volumen_actual=audioManager.getStreamVolume(3);
        }

        for (i=1; volumen_actual&lt; (0.5*volumen_maximo); i++ ){

            if (audioManager != null) {
                audioManager.adjustVolume(AudioManager.ADJUST_RAISE, AudioManager.FLAG_PLAY_SOUND);
            }
            if (audioManager != null) {
                volumen_actual=audioManager.getStreamVolume(3);
            }
        }
</code></pre>",android|android-audiomanager,14006119,Julio Emen,yes
Geolocation on-demand via text messaging. Is it possible?,"<p>I know this might sound crazy, but my nana somehow gets extremely worried about me and where I am. So I don't want to use apps like life360. Is there any way to have a setup to whenever she texts me with something like &quot;where are you?&quot; She'll be sent a set of coordinates or something that could geolocate my phone without having to constantly drain my battery?</p>",android|geolocation|sms|messaging,18166116,Daniel Zahr,no
Too many requests FirebaseError,"<p>I've come across this error with Firebase saying too many requests. I've read the nest api saying that they have limited the number of requests to avoid battery drainage on the device. But on the official nest android app you can switch on/off (changing to heating/off) the thermostat without an issue.</p>

<p>Any idea why this is limited in the developer api?</p>",java|android|firebase|nest-api,1425849,Mr.Noob,yes
Pause and Resume Google Admob Banner ads when app enters background Objective c,"<p>I am using Google Admobs with ad mediations in my iOS application.
It seems like there is battery draining issue because google ads are running even when app is in background.
Is there something that i have to do to Pause google Ads when app enters background and resume when app become active.
Thanks in advance.</p>",ios|objective-c|admob|mobile-ad-mediation,5185586,Akhil,yes
Battery drain of iPhone while using location services,"<p>It would be great to know what the battery drain rate is for different accuracy settings for the iOS standard location service while it is updating location constantly (I'm not talking about the significant changes service). I've tried using Instruments' Energy Usage tool but I can't seem to capture any info. At the same time, it is gonna take too long to sit there and time my iPhone to see how long it takes to die.</p>

<p>I know that the lesser the accuracy, the lesser the battery drain. But what are the solid numbers on this? Does anyone know?</p>

<p>Thanks!</p>",iphone|objective-c|gps|location|cllocationmanager,459289,samxli,yes
How to reduce iPhone battery consumption while using GPS,"<p>I am using GPS to actually monitor if I have entered a regions (radius 100 m). </p>

<p>I am using a hybrid of <code>significantLocationChange</code>s and hardware GPS, <code>startUpdatingLocation</code>. </p>

<p>As <code>significantLocationChanges</code> are not as accurate as I require I am using them only to check if I have entered a outer circle of X m. Then I use hardware GPS to check if the user enters an inner circle (100m). </p>

<p>The problem with it is that battery is getting drained pretty quickly, can anyone help me out. </p>",iphone|ios|cocoa-touch|gps,500596,Mann,yes
What may be the issues using HTTP push for mobile devices/apps?,"<p>I have to devise a push notification plan for some mobile devices where push is not yet officially supported by C2DM / APNS / BES ,etc. MQTT was also a good option but I could not get an MQTT Client for my required platform. (Blackberry Playbook, ActionScript only)</p>

<p>Going back to basics, I had the options of Long Polling and streaming. Streaming using a high keep-alive value seems good to me, as the development of the mobile app (it is not a browser) and the server code are both in my control. To maintain the connection open, I just need to ping the server occasionally.</p>

<p>What issues I may be facing in this approach ? I understand this would constantly open an HTTP connection from the device to the server. Would the battery life of mobile device drain quickly just by persistently opening a server connection ? ...Afterall the data is not being transferred, just by keeping the connection open...right ?</p>",http|mobile|push-notification|server-push|mqtt,720564,WinOrWin,no
Node js reuse response object,"<p>First, a little background:</p>

<p>I'm trying to write a mobile phone app that receives data from a nodejs server at an irregular interval. Since this is a mobile app, I would prefer not to poll the server or use a websocket, as I believe that would drain the battery. Instead, I'd like the server to keep track of client IP addresses and push data.</p>

<p>My plan is to have the app send a simple message to the server whenever the phone's connection status changes (i.e, if the phone goes from a wifi connection to mobile data one, send a message since the client IP would have changed). The server would do something like this:</p>

<pre><code>app.get('/clientupdate',(req,res)=&gt;{
    // save off the 'res' object here
    res.send('received update');
});
</code></pre>

<p>Then later, when the server wants to push data to a client, it would retrieve the saved 'res' object and use it to send the data:</p>

<pre><code>// retrieve the saved 'res' object here
res.send(data);
</code></pre>

<p>Is this possible?</p>",node.js|http|mobile,1935089,redsoxfantom,no
Realm - consuming battery in background,"<p>I change my Android project to use Realm recently.
But when it runs at some devices, it consumes battery a lot.
My user report an issue, that is, when my application is in the background, the CPU rate will raise up to 100% occasionally and drains battery to zero.
It's not happened in the previous version of my application which didn't include Realm.
But I can't reproduce this problem on my test device or emulator.
So I can't get the method tracing.</p>

<p>Here's the device information:</p>

<blockquote>
  <p>Asus PadFone 2 (A68) Android 4.4 with 2G RAM</p>
</blockquote>

<p>And the user's device is rooted by this apk:<a href=""http://root.360.cn/"" rel=""nofollow"">http://root.360.cn/</a></p>

<p>I've asked the user to monitor the files which Realm created to see if it's updated frequently.
But no, it's not updated after my application is in background.
And the database file grew up correctly, so the data should already been stored.</p>

<p>And here's the codes how I initialize Realm:</p>

<pre><code>Realm.init(this);
RealmConfiguration realmConfiguration = new RealmConfiguration.Builder()
                .schemaVersion( REALM_DATABASE_VERSION ) // Must be bumped when the schema changes
                .migration( migration ) // Migration to run instead of throwing an exception
//                .deleteRealmIfMigrationNeeded()
                .build();

Realm.compactRealm( realmConfiguration );
Realm.setDefaultConfiguration(realmConfiguration);
</code></pre>",android|realm,3109401,Kimi Chiu,yes
How to run code periodically in the background in Tizen 5.5?,"<p>I need to run a code every x minutes and show a notification if needed.</p>
<p>How can I run a code in the background periodically while the app is closed?</p>
<hr />
<p>So far what I've reached to is that I lock the CPU and call a timer to run periodically. The problem with this is that it drains the battery and the watch shows a notification suggesting to close the app.</p>
<pre><code>public static void LockCpu()
{
    Power.RequestLock(PowerLock.Cpu, 0);
}

public static void ReleaseCpu()
{
    Power.ReleaseLock(PowerLock.Cpu);
}
</code></pre>
<p>It's for Tizen .NET for wearable watches.</p>
<p>Thanks.</p>",c#|tizen|tizen-wearable-sdk,5108149,Blendester,yes
My Swift App drains battery very fast while using Location Manager,"<p>In my <code>Swift</code> application I'm checking user's location and sending it to my backend code.</p>

<p>My code for that is all placed in <code>AppDelegate</code> and it looks like this:</p>

<pre><code>func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -&gt; Bool {

    NotificationCenter.default.addObserver(self, selector:
        #selector(AppDelegate.notificationConfirmationSent),
        name: NSNotification.Name(rawValue: locationUpdKey), object: nil)

   initLocationManager()

   return true
}

func locationManager(_ manager: CLLocationManager, didUpdateLocations locations: [CLLocation]) {
    location = locations.last
    let coord = location.coordinate
    longitude = coord.longitude
    latitude = coord.latitude
    NotificationCenter.default.post(name: Notification.Name(rawValue: locationUpdKey), object: self)
    location_fixed = true;
}


func notificationConfirmationSent()
{

    if(defaults.object(forKey: ""uniqueId"") != nil) {
        let currentTime = Date().timeIntervalSince1970
        if (currentTime - timeInterval &gt; 30) {
            print(""SENDING DATA TO WEBSERVICE FROM NOTIFICATION"")
            timeInterval = currentTime
            sendCurrentUserPositionToWebService(self.longitude, latitude: self.latitude, uniqueId: defaults.string(forKey: ""uniqueId"")!)
        }
    }
}
</code></pre>

<p>Besides that I'm also using these two methods:</p>

<pre><code>func locationManager(_ manager: CLLocationManager, didChangeAuthorization status: CLAuthorizationStatus) {
    switch status {
    case .notDetermined:
        print(""NotDetermined"")
    case .restricted:
        print(""Restricted"")
    case .denied:
        print(""Denied"")

    case .authorizedAlways:
        print(""AuthorizedAlways"")
    case .authorizedWhenInUse:
        print(""AuthorizedWhenInUse"")
        locationManager.distanceFilter = 200
        locationManager.startUpdatingLocation()
    }
}

func initLocationManager() {
    print(""init location manager app delegate"")
    locationManager = CLLocationManager()
    locationManager.delegate = self
    locationManager.desiredAccuracy = kCLLocationAccuracyHundredMeters

    if CLLocationManager.authorizationStatus() == .authorizedWhenInUse {
        //locationManager.startMonitoringSignificantLocationChanges()

        locationManager.distanceFilter = 200

        locationManager.startUpdatingLocation()
    } else {

        locationManager.requestWhenInUseAuthorization()
    }

}
</code></pre>

<p>Now, after using my app for some time the battery drains really fast, also, the whole phone is getting hot. I want to change this behavior and fix it, so the phone only sends the location once (when it's <code>fixed</code>) and then does so when there are significant changes to the location.
Can you give me a hint how could I proceed from here and why exactly the battery is draining so fast?</p>",ios|swift|core-location|locationmanager,3766930,user3766930,yes
battery status command for Ratpoison on ubuntu,"<p>I have begun <a href=""http://www.nongnu.org/ratpoison/"" rel=""nofollow noreferrer"">Ratpoison</a> as a tiling window manager for my ubuntu laptop.
One thing I have noticed is that there is no support for battery alerts leading me to completely draining my laptop battery before realizing that the battery was low.</p>

<p>Thus I performed the following in a terminal window.</p>

<ul>
<li><a href=""https://askubuntu.com/questions/69556/how-to-check-battery-status-using-terminal"">alias bat='upower -i /org/freedesktop/UPower/devices/battery_BAT0| grep -E ""state|to\ full|percentage""'</a></li>
<li>ratpoison -c ""echo $(bat)""</li>
</ul>

<p>Even when I execute </p>

<ul>
<li>ratpoison -c ""echo $(upower -i /org/freedesktop/UPower/devices/battery_BAT0| grep -E ""state|to\ full|percentage"")""</li>
</ul>

<p>I get satisfactory results by seeing the battery status in the <a href=""http://www.nongnu.org/ratpoison/doc/The-Status-Bar.html"" rel=""nofollow noreferrer"">message popup</a> of ratpoison.</p>

<p>However when I execute this single command using the <a href=""http://www.nongnu.org/ratpoison/doc/Other-Commands.html#Other-Commands"" rel=""nofollow noreferrer"">exec command</a> in ratpoison
I get the message </p>

<p>/bin/sh -c ""exec ratpoison -c ""echo $(bat)"""" finished (1)</p>

<p><strong>What is causing this behaviour?</strong></p>

<p>Is it because I am invoking the ratpoison -c command and also the bat alias? The docs say that exec is for a single command.?</p>

<p>Any help is appreciated.</p>

<p><strong>Also</strong></p>

<p>typing alert in the terminal makes an alert popup show.
doing exec alert in ratpoison shows a similar message that /bin/sh -c ""alert"" finished (127)</p>

<p><strong>What are the numbers in brackets?</strong></p>",bash|ubuntu,3419728,arjoonn,yes
Ionic app - IOS low power mode preventing videos from loading,"<p>So I noticed a quirky bug, that I am not sure how to circumvent. When an IOS user puts their phone into low-power mode, videos stop loading on my Ionic application. </p>

<p>The videos are stored on Cloudinary and are being delivered to the device correctly, but they are not displaying. So instead of a normal video, it just displays a white background. </p>

<p>According to Apple <a href=""https://developer.apple.com/documentation/foundation/nsprocessinfo/1617047-lowpowermodeenabled?language=objc"" rel=""nofollow noreferrer"">docs</a>:</p>

<blockquote>
  <p>In Low Power Mode, iOS conserves battery life by enacting certain energy-saving measures, such as reducing CPU and GPU performance, reducing screen brightness, and pausing discretionary and background activities.</p>
</blockquote>

<p>Which an <a href=""https://www.howtogeek.com/229224/how-to-use-low-power-mode-on-an-iphone-and-what-exactly-it-does/"" rel=""nofollow noreferrer"">article</a> I found states that: </p>

<blockquote>
  <p>Background activities and <strong>networking</strong> are paused to prevent unnecessary power drain in the background.</p>
</blockquote>

<p>But I wouldn't imagine that this would affect video loading, even if they are set in normal <code>video</code> tags, would it?</p>

<p>Here is the relevant code for loading the video:</p>

<pre><code>&lt;video[muted]=""true"" playsinline loop preload=""auto""&gt;
   &lt;source [src]=""media.url"" type=""video/mp4""&gt;
&lt;/video&gt;
</code></pre>

<p>I tried changing the preload tag to the other available attributes, but it didn't change anything. The videos still do not load.</p>

<p>I checked other applications (non-Ionic), such as Facebook and Instagram, and their videos appear to load just fine within the application, so I believe it has something to do with the HTML5 video tag.</p>

<p>According to this <a href=""https://www.radiantmediaplayer.com/docs/latest/autoplay-support.html"" rel=""nofollow noreferrer"">article</a>  </p>

<blockquote>
  <p>According to our testing when an iOS 11+ device is in low power mode autoplay even muted is forbidden by the OS. This does not apply to iOS 10 and below. Radiant Media Player will properly handle autoplay requests when low power mode is engaged in iOS 11+ by providing a play button to initiate playback (a user interaction will be needed in such case as autoplay would have failed).</p>
</blockquote>",ios|ionic-framework|html5-video,3507670,Jordan Benge,no
How to achieve ios local push notification based on user location without running app in the background and draining battery?,"<p>We got a requirement that the app need to send local push notifications when the user goes to particular location using the users current latitude and longitude values.eg.shopping mall.</p>

<p>Requirement 1.
The app should able to send the notification even if the app is not running in the background.</p>

<p>Requirement 2.
The should not drain too much battery.</p>

<p>I request all ios experts to help me on achieving this functionality. I have tried everywhere but unable to find solutions for this.</p>

<p>I saw ibotta app achieved the same functionality. </p>

<p>Thanks for your help!</p>

<p>Regards,
Eniyan R</p>",ios|objective-c,1215273,Eniyan R,yes
How to create Async ActionResult to create async-await pattern for following polling logic?,"<p>I have a loop that actually waits for some process for completion of a Job and returns result.</p>

<p>I have <code>MyRestClient.FetchResult(id)</code> and <code>MyRestClient.FetchResultAsync(id)</code> both available to me, which fetches result from some remote service and returns boolean value if it is complete.</p>

<pre><code> public class StatusController: ActionController {

    public ActionResult Poll(long id){
        return new PollingResult(()=&gt;{
            return MyRestClient.FetchResult(id) == SomethingSuccessful;
        });
    }
 }

 public class PollingResult : ActionResult{

     private Func&lt;bool&gt; PollResult;

     public PollingResult(Func&lt;bool&gt; pollResult){
         this.PollResult = pollResult;
     }

     public override void ExecuteResult(ControllerContext context)
     {
         Response = context.HttpContext.Response;
         Request = context.HttpContext.Request;

         // poll every 5 Seconds, for 5 minutes
         for(int i=0;i&lt;60;i++){
             if(!Request.IsClientConnected){
                 return;
             }
             Thread.Sleep(5000);
             if(PollResult()){
                  Response.WriteLine(""Success"");
                  return;
             }

             // This is a comet, so we need to 
             // send a response, so that browser does not disconnect
             Response.WriteLine(""Waiting"");
             Response.Flush();
         }

         Response.WriteLine(""Timeout"");

     }
 }
</code></pre>

<p>Now I am just wondering if there is anyway to use Async Await to improve this logic because this thread is just waiting for every 5 seconds for 5 minutes.</p>

<p><strong>Update</strong></p>

<p>Async Task pattern usually finishes all work before sending result back to client, please note, if I do not send intermediate responses back to client in 5 seconds, client will disconnect.</p>

<p><strong>Reason for Client Side Long Poll</strong></p>

<p>Our web server is on high speed internet, where else clients are on low end connection, making multiple connections from client to our server and then relaying further to third party api is little extra overhead on client end.</p>

<p>This is called Comet technology, instead of making multiple calls in duration of 5 seconds, keeping a connection open for little longer is less resource consuming. </p>

<p><strong>And of course, if client is disconnected, client will reconnect and once again wait. Multiple HTTP connections every 5 seconds drains battery life quicker compared to single polling request</strong></p>",c#|asp.net-mvc|asynchronous|async-await,85597,Akash Kava,yes
I'm uploading data from my Swift app to Amazon S3 and it drains battery like nothing else. How can this be avoided?,"<p>In my 'Swift' app I have a feature of uploading photos to my <code>Amazon S3</code> bucket. When the user is connected to <code>WiFi</code> or <code>LTE</code>, there's no problem, but when the connection is a little slower (e.g. <code>3G</code>), then the upload takes a lot of time (up to one minute) and iphone can lose 15-20% of battery! I resize photos down to around 200-300kb, so that should not be a problem. The code that I use for that is:</p>

<pre><code>func awsS3PhotoUploader(_ ext: String, pathToFile: String, contentType: String, automaticUpload: Bool){

        let credentialsProvider = AWSCognitoCredentialsProvider(regionType:CognitoRegionType,
                                                                identityPoolId:CognitoIdentityPoolId)
        let configuration = AWSServiceConfiguration(region:CognitoRegionType, credentialsProvider:credentialsProvider)
        AWSServiceManager.default().defaultServiceConfiguration = configuration

        let uploadRequest = AWSS3TransferManagerUploadRequest()
        uploadRequest?.body = URL(string: ""file://""+pathToFile)
        uploadRequest?.key = ProcessInfo.processInfo.globallyUniqueString + ""."" + ext
        uploadRequest?.bucket = S3BucketName
        uploadRequest?.contentType = contentType + ext

        uploadRequest?.uploadProgress = { (bytesSent, totalBytesSent, totalBytesExpectedToSend) -&gt; Void in
            DispatchQueue.main.async(execute: { () -&gt; Void in
                if totalBytesExpectedToSend &gt; 1 {
                    print(totalBytesSent)
                    print(totalBytesExpectedToSend)
                }
            })
        }
        let transferManager = AWSS3TransferManager.default()
        transferManager?.upload(uploadRequest).continue({ (task) -&gt; AnyObject! in

            if (task.isCompleted) {
                  print(""task completed"")
            }

            if let error = task.error {
                 print(""Upload failed ❌ (\(error))"")

            }
            if let exception = task.exception {
                 print(""Upload failed ❌ (\(exception))"")

            }
            if task.result != nil {
                let s3URL: String = ""https://myAlias.cloudfront.net/\((uploadRequest?.key!)!)""
                print(""Uploaded to:\n\(s3URL)"")
            }
            else {
                print(""Unexpected empty result."")
            }
            return nil
        }
        )

}
</code></pre>

<p>Is there anything that comes up to your mind of what am I doing wrong here and how could this huge battery consumption be avoided?</p>",ios|swift|amazon-web-services|amazon-s3,3766930,user3766930,no
Is it Possible to use pyAutoGui and Dim the Screen in Windows,"<p>I am running an application that uses <code>pyautogui.moveTo()</code> and <code>pyautogui.click()</code> for a long period of time (an hour+).  To decrease the battery drain on my laptop, I'd ideally want the screen to turn off in this period, but because the autogui functions mimic using the mouse, the computer will not turn the screen off.  I'm using Windows 10, and I'm not sure if I could use some functions from PyWin32 or WMI as demonstrated in this post, because the screen will brighten again when the mouse moves each time. </p>

<p>Having the laptop turning off and on the screen repeatedly doesn't seem like it would save too much power, but I'm not sure.   </p>",python|windows|operating-system|pyautogui,10090476,JoeTheShmoe,yes
Fetch continuous location changes with less battery drainage,"<p>I want to fetch the user location continuously and update the same in my database.
I am using FusedLocationApi to get the continuous location changes.
To get the location the user has to turn on GPS and Internet connection has to be there.
Keeping the GPS turned for a long time and using INTERNET continuously are the main culprit for battery drainage.
So I want to know what should be done to use the minimum battery power and fetch the continuous location changes.</p>

<p>This is how i am fetching the location,</p>

<pre><code>public class LocationActivity extends Activity implements
    LocationListener,
    GoogleApiClient.ConnectionCallbacks,
    GoogleApiClient.OnConnectionFailedListener {

private static final String TAG = ""LocationActivity"";
private static final long INTERVAL = 1000 * 10;
private static final long FASTEST_INTERVAL = 1000 * 5;
Button btnFusedLocation;
TextView tvLocation;
LocationRequest mLocationRequest;
GoogleApiClient mGoogleApiClient;
Location mCurrentLocation;
String mLastUpdateTime;

protected void createLocationRequest() {
    mLocationRequest = new LocationRequest();
    mLocationRequest.setInterval(INTERVAL);
    mLocationRequest.setFastestInterval(FASTEST_INTERVAL);
    mLocationRequest.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);
}

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Log.d(TAG, ""onCreate ..............................."");
    //show error dialog if GoolglePlayServices not available
    if (!isGooglePlayServicesAvailable()) {
        finish();
    }
    createLocationRequest();
    mGoogleApiClient = new GoogleApiClient.Builder(this)
            .addApi(LocationServices.API)
            .addConnectionCallbacks(this)
            .addOnConnectionFailedListener(this)
            .build();
    mGoogleApiClient.connect();  
    setContentView(R.layout.activity_main);
    tvLocation = (TextView) findViewById(R.id.tvLocation);

    btnFusedLocation = (Button) findViewById(R.id.btnShowLocation);
    btnFusedLocation.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View arg0) {
            updateUI();
        }
    });

}

@Override
public void onStart() {
    super.onStart();
    if (mGoogleApiClient.isConnected()) {
        startLocationUpdates();
        Log.d(TAG, ""Location update resumed ....................."");
    }
}

@Override
public void onStop() {
    super.onStop();
    Log.d(TAG, ""onStop fired .............."");
    mGoogleApiClient.disconnect();
    Log.d(TAG, ""isConnected ...............: "" + mGoogleApiClient.isConnected());
}

private boolean isGooglePlayServicesAvailable() {
    int status = GooglePlayServicesUtil.isGooglePlayServicesAvailable(this);
    if (ConnectionResult.SUCCESS == status) {
        return true;
    } else {
        GooglePlayServicesUtil.getErrorDialog(status, this, 0).show();
        return false;
    }
}

@Override
public void onConnected(Bundle bundle) {
    Log.d(TAG, ""onConnected - isConnected ...............: "" + mGoogleApiClient.isConnected());
    startLocationUpdates();
}

protected void startLocationUpdates() {
    PendingResult&lt;Status&gt; pendingResult = LocationServices.FusedLocationApi.requestLocationUpdates(
            mGoogleApiClient, mLocationRequest, this);
    Log.d(TAG, ""Location update started ..............: "");
}

@Override
public void onConnectionSuspended(int i) {

}

@Override
public void onConnectionFailed(ConnectionResult connectionResult) {
    Log.d(TAG, ""Connection failed: "" + connectionResult.toString());
}

@Override
public void onLocationChanged(Location location) {
    Log.d(TAG, ""Firing onLocationChanged.............................................."");
    mCurrentLocation = location;
    mLastUpdateTime = DateFormat.getTimeInstance().format(new Date());
    updateUI();
}

private void updateUI() {
    Log.d(TAG, ""UI update initiated ............."");
    if (null != mCurrentLocation) {
        String lat = String.valueOf(mCurrentLocation.getLatitude());
        String lng = String.valueOf(mCurrentLocation.getLongitude());
        tvLocation.setText(""At Time: "" + mLastUpdateTime + ""\n"" +
                ""Latitude: "" + lat + ""\n"" +
                ""Longitude: "" + lng + ""\n"" +
                ""Accuracy: "" + mCurrentLocation.getAccuracy() + ""\n"" +
                ""Provider: "" + mCurrentLocation.getProvider());
    } else {
        Log.d(TAG, ""location is null ..............."");
    }
}

@Override
protected void onPause() {
    super.onPause();
    stopLocationUpdates();
}

protected void stopLocationUpdates() {
    LocationServices.FusedLocationApi.removeLocationUpdates(
            mGoogleApiClient, this);
    Log.d(TAG, ""Location update stopped ......................."");
}

@Override
public void onResume() {
    super.onResume();
    if (mGoogleApiClient.isConnected()) {
        startLocationUpdates();
        Log.d(TAG, ""Location update resumed ....................."");
    }
}
}
</code></pre>",android|android-gps|android-fusedlocation|batterylevel,5989261,hasan_shaikh,yes
Application with maps for Android: General Strategy,"<p>Before developing an application I researched what solutions might apply while creating lightweight application with maps for Android.</p>

<p><em>Basic usage of app is while hiking</em> and therefore below are <strong>requirements app must meet</strong>:</p>

<ol>
<li>Must be using hardware resources as few as possible.</li>
<li>Must have ability to save map data for further offline usage for selected local area.</li>
<li>Must have ability to load custom data generated by 3dparity like kml files and custom markers.</li>
</ol>

<p><strong>Application basic flow</strong> is:</p>

<p>Some site community contributes custom markers and kml (or other layer data type) files for desired region.</p>

<p>Application combines some map provider map (like Google Maps, OpenStreetMaps) + Community data for desired region and gives offline usage ability to users. Where users can prepare map with internet connection before hiking and use it offline while hiking.</p>

<p><strong>Strategy and primary problems to solve:</strong></p>

<ol>
<li>Choose lightweight map sdk.</li>
<li>Solve offline maps problem.</li>
</ol>

<p><strong>Choosing lightweight maps sdk and problems related to it:</strong></p>

<p>While hiking people often use older versions of smartphones which drain less battery power because they come with older version of Android therefore apps for older versions of android use less computing power.</p>

<p>Common solution here is Google Maps SDK 2.0 which by itself is provided by Google Play SDK but Google Play SDK is getting heavier over time and it requires that user had installed almost later version of Google Play Services as I guess.</p>

<p>Pros of Google Maps SDK 2.0 is that it provides great codebase for further extension and also a great MapView component ready with all UI tweaks.</p>

<p>Cons of Google Maps SDK 2.0 is that it requires user to have Google Play Services installed which by itself drains phone charge. Also new MapView UI components might require more computing resources.</p>

<p><strong>Solving offline maps problem</strong>:</p>

<p>As I researched it is possible to provide custom tiles stored anywhere on device in Google Maps SDK 2.0 using <strong>TileProvider</strong> interface which gives great controls over tiles.  Main abstract method of it is:</p>

<pre><code>public Tile (int width, int height, byte[] data).
</code></pre>

<p>Other SDKs:</p>

<p>MapBox android sdk comes closer to Google Maps SDK 2.0. It is promissing but is still beta and is opensource. Compared to other less known android map sdks MapBox has gentle documentation, nice tools, is almost lightweight and has community but comes with still bugs.</p>

<p>Also I tried an app by my opinion developed using Google Maps SDK 2.0 <a href=""https://play.google.com/store/apps/details?id=com.vecturagames.android.app.gpxviewer"" rel=""nofollow"">https://play.google.com/store/apps/details?id=com.vecturagames.android.app.gpxviewer</a></p>

<p>In my best guesses this app is using Google Maps SDK MapView to display maps from various sources like OpenStreetMap, MapBox and from almost every map provider available online including google.</p>

<p><strong>Questions:</strong></p>

<ol>
<li>What are your best practices for developing lightweight apps for android with maps and offline tile base support?</li>
<li>Is it possible avoid Google Play Services dependency while using Google Maps SDK 2.0?</li>
<li>Are there any other opensource map sdks which are performance friendly? For example using OpenStreetMaps map base.</li>
</ol>",android|google-maps|google-play-services|google-maps-android-api-2,1503846,BIOHAZARD,no
Measure apps' battery drainage,"<p>There are a lot of questions on here about ""My app drains battery! Why?"". That is not what I am looking for. I am wondering about how to create an app which can get which apps are draining the most battery.</p>

<p>I know it's possible, because I've seen apps that can do this. </p>",android|android-service|battery,2922064,jlynch630,no
How to programatically detect backlight is on in iOS?,"<p>I want iOS code that can show if the screen is lit or not, so that my app can monitor battery power drain due to the (power hungry) backlight activity.  This code must use the public API only, as I intend to submit the app to the App Store eventually.</p>

<p>Initially I thought this may be simply a matter of checking the <a href=""https://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIScreen_Class/Reference/UIScreen.html#//apple_ref/occ/instp/UIScreen/brightness"" rel=""nofollow"">brightness</a> property of the UIScreen, like so:</p>

<pre><code>-(BOOL)isBackLightOn {
    float brightness = [UIScreen mainScreen].brightness;
    return brightness &gt; 0;
}
</code></pre>

<p>but this is <strong>incorrect</strong> because <code>[UIScreen mainScreen].brightness</code> represents the value of the slider chosen by the user in the Settings->Brightness screen, <strong>not</strong> the current light output of the screen.</p>

<p>Apple clearly have a way to determine this value, since it is included in the energy diagnostics that can be viewed in Instruments (e.g. see <a href=""https://developer.apple.com/library/ios/#recipes/instruments_help-energy-measurement-help/Logging_Energy_Usage_in_an_iOS_Device/10_Logging_Energy_Usage_in_an_iOS_Device.html"" rel=""nofollow"">Logging Energy Usage in an iOS Device</a>), but maybe this measurement has not been exposed through the public API?</p>",objective-c|ios|backlight,1579889,boultoa,no
Can Android's MulticastLock be used to monitor 802.11 Probe Requests from other devices?,"<p>I am a little confused about Android's ability to receive multicast packets using the <code>WifiManager.MulticastLock</code>.  From the <a href=""http://developer.android.com/reference/android/net/wifi/WifiManager.MulticastLock.html"" rel=""nofollow noreferrer"">documentation</a>:</p>
<blockquote>
<p>Class Overview</p>
<p>Allows an application to receive Wifi Multicast packets. Normally the Wifi stack filters out packets not explicitly addressed to this device. Acquring a MulticastLock will cause the stack to receive packets addressed to multicast addresses. Processing these extra packets can cause a noticable battery drain and should be disabled when not needed.</p>
</blockquote>
<p>802.11 Probe Request frames, which are sent out by client's looking for wireless networks in range, generally use the broadcast MAC address as the destination.  Does this imply that an Android app that has acquired a multicast lock is capable of receiving these Probe Requests, or is my understanding of the <code>MulticastLock</code> misguided?  I suspect the term <em>multicast</em> may be in reference to Layer 3, (as opposed to Layer 2 <em>broadcast</em>), but because the class overview states <em>Allows an application to receive <strong>Wifi</strong> Multicast packets</em>, I'm a little uncertain and would like some clarification.</p>",android|wifi|multicast|android-wifi,129475,Bryce Thomas,no
Profiling blackberry application. GraphicsInternal.updateDisplayFromBackBuffer0(...) drains battery a lot,"<p>I'm currently profiling a blackberry application, to know where part of the application drains battery. In one of my <code>MainScreen</code>, I noticed that when I push this screen the <strong>CPU Utilization</strong> increases upto <strong>100%</strong>, then I saw that the method <code>GraphicsInternal.updateDisplayFromBackBuffer(...)</code> method uses upto <strong>70%</strong> of the CPU. Now my question is, why is it that this method consumes that amount of resources?</p>",blackberry|java-me|profiling,1909242,Jj Tuibeo,yes
Representing a small battery powered motor,"<p>I have an application that I am working on and I want to create a class that would represent a small battery powered motor that has these methods:</p>

<ul>
<li>constructor: DCMotor(Battery bat1, Battery bat2)</li>
<li><code>drain()</code> - drains the battery by the constant amount</li>
<li><code>runTIme()</code> - shows how long the motor has been running and gives a warning when the battery drops to 90% capacity</li>
<li><code>start()</code> - starts the motor and displays the running time and remaining capacity of the battery. (If the motor can not be started be cause the capacity is to low a warning message is displayed)</li>
<li><code>stop()</code> - stops the motor</li>
</ul>

<p>The battery capacity for the motor is the sum of the capacity for each battery, in this case two batteries.  When the motor is started, the motor will continually display its status until it is stopped or the battery capacity is too low.</p>

<p>What I have so far I know is pretty low-level but I can't figure out how to code it correctly and get the results I want.</p>

<p>Here is my code:</p>

<pre><code>public class DCMotor {

double capacity = 7000.0;

public DCMotor(Battery bat1, Battery bat2)
{
     bat1 = new Battery(3500.0);
     bat2 = new Battery(3500.0);
}

public void drain() //drains the battery by a constant amount
{
    do
    {
        capacity -= 50.0;
    }while(capacity &lt;= 7000.0 &amp;&amp; capacity &gt; 0);

}

public String runTime() //shows how long the battery has been running
{
    if (capacity == 6300.0)
        System.out.println(""90% battery remaining."");
    return ""90% battery remaining."";
}

public void start() //starts the motor and displays the running time and available capacity
{
    start();
    //try{ Thread.sleep(1000);} catch (InterruptedException ex) {}
    System.out.println(""Remaining Capacity: "" + capacity);
}

public void stop() //stops the motor
{
    stop();
}
}
</code></pre>",java|driver|battery,3765527,user3765527,yes
How can I show number of unread articles on a live tile on Windows Phone?,"<p>I am looking for a way to show the number of unread articles from an RSS feed on a live tile on Windows Phone. How can I do that? I know that I can use background tasks, but I want to use them effectively, so I don't drain the battery of the phone by checking the feed over and over again. Also, I want to reset that number when I open the app.</p>",c#|windows-phone-8|tile|rss-reader,1981483,Julian Atanasoae,yes
Is it normal to receive that many GET requests when running rails server?,"<p>Whenever I run rails server, it starts logging a lot of GET requests, specifically to the compiled Style Sheets files (every half a second or so.) 
They look like this:</p>

<pre><code>Started GET ""/assets/application.self-0c7a55ee32b2e31e48453f9129ff2cd12bc8eb34c8a0e51e59e9f4a6adda82cd.css?body=1&amp;_=1450936645614"" 
</code></pre>

<p>I wouldn't mind about them, but my laptop battery drains pretty quickly when running rails server, and I don't know if this is the cause.</p>

<p>I would really like to know if this is normal behaviour. And, if it is not, then what could be the cause that many requests per second.</p>

<p>Thank you very much!</p>

<p><strong>EDIT:</strong></p>

<p>Here is my show your config/enviroments/development.rb file, @uDaY</p>

<pre><code>Rails.application.configure do
config.cache_classes = false
config.eager_load = false
config.consider_all_requests_local       = true
config.action_controller.perform_caching = false
config.action_mailer.raise_delivery_errors = false
config.active_support.deprecation = :log
config.active_record.migration_error = :page_load
config.assets.debug = true
config.assets.digest = true
config.assets.raise_runtime_errors = true
end
</code></pre>",ruby-on-rails|server,1233239,Rodrigo Murillo,yes
AlarmManager RTC_WAKEUP drains battery,"<p>I have a service running in the background which periodically downloads data from the server. I need to download the data after every one hour. But the battery is draining fast. The code is as below. How do I make the alarm power efficient? </p>

<pre><code>public class BackgroundFetchService extends Service {

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {

        int s = super.onStartCommand(intent, flags, startId);

        BackgroundFetchManager.getSharedInstance().setAlarmStatus(false);

        TherapyManager.getSharedInstance().downloadData(new DataManager.DataManagerListener() {
            @Override
            public void onCompletion(AppError error) {
                stopSelf();
            }
        });

        return s;
    }

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public void onDestroy() {
        //restart this service again in one hour

        if(!BackgroundFetchManager.getSharedInstance().getAlarmStatus()) {
            AlarmManager alarm = (AlarmManager) getSystemService(ALARM_SERVICE);
            alarm.set(
                    alarm.RTC_WAKEUP,
                    System.currentTimeMillis() + (1000 * 60 * 60),
                    PendingIntent.getService(this, 0, new Intent(this, BackgroundFetchService.class), 0)
            );
            BackgroundFetchManager.getSharedInstance().setAlarmStatus(true);
        }

        super.onDestroy();
    }
}
</code></pre>",android|android-service|alarmmanager,2189878,user2189878,yes
Android Application that displays new messages posted on a server,"<p>I am looking for reading resources or sample applications that can help me hammer out the following application workflow:</p>

<ol>
<li><p>The client application establishes a connection to our server</p></li>
<li><p>The client application scans for updates on a regular interval</p></li>
<li><p>If an administrator has posted a new message, the new message is displayed in a widget.</p></li>
</ol>

<p>I currently have 2 concerns:</p>

<ol>
<li><p>I want to ensure that the monitoring service is not a major battery drain. </p></li>
<li><p>What is the most secure and simple method to establish the connection to retrieve data?
....There are a lot of suggestions out there... I need to know what method I should be researching over all others. Currently, all options are on the table because I have yet configure our server.</p></li>
</ol>",android|sockets|connection|power-management,705199,rywem,yes
Track user location like Google does,"<p>I'm developing an application that must track user location and send it to a remote server. I know there's already a ton of other questions here about this, but I was unable to find exactly what I need.</p>

<p>Basically I'm using <code>FusedLocationProviderApi</code> to receive location updates. It's really useful and easy to use. The problem is that I need to query for locations very often and it's draining the battery real quick (although maybe part of the battery use can be from the network operations to send the location to the server). However, I only need frequent updates while the user is moving.</p>

<p>So what I'm looking for is something like Google does to track Android users (as we can see in <a href=""https://maps.google.com/locationhistory/b/0"" rel=""nofollow"">LocationHistory</a>). Does anyone know if the locations obtained by Google from the smartphone are available somewhere? Or maybe a strategy to implement something similar?   </p>",android|fusedlocationproviderapi,1531647,Tinadm,yes
How to code an app in android wear to always keep the screen active? (always in interactive mode),"<p>I need to know if there is a way to keep an android wear app always in interactive mode. (i knonw this will drain battery life)</p>

<p>Is the 'rotate away' gesture adressable or will the watch just go in ambient whenever the watch goes on it outer side?</p>",wear-os|interactive-mode,1375825,cosmopolice,no
Battery optimization not available on WearOS,"<p>I'm developing a tracking application that runs on Wear OS watches. I have some troubles when the watch goes to sleep. As soon as the watch goes to Deep Idle mode, all sensors acquisition stops. For that I'll need to whitelist the app using:</p>
<pre><code>Intent intent = new Intent();
intent.setAction(Settings.ACTION_REQUEST_IGNORE_BATTERY_OPTIMIZATIONS);
intent.setData(Uri.parse(&quot;package:&quot; + packageName));
context.startActivity(intent);
</code></pre>
<p>This piece of code works well on mobile version but nothing happen on Wear OS version. I realized that Wear OS as no UI to set the battery optimization mode which should be the cause of the fact that nothing happens when trying to change the optimization.
I also used a wake lock to keep the CPU partially awake with:</p>
<pre><code>PowerManager powerManager = (PowerManager) getSystemService(POWER_SERVICE);
wakeLock = powerManager.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, &quot;MY-WAKELOCK&quot;);
</code></pre>
<p>But even with that the watch goes to deep sleep after about 15min ?
The last solution I see is to force the screen on or at least dimmed but it will drain the battery very fast.
Is there another solution to keep sensors working ? How can I whitelist my app on a Wear OS device as no UI seems available ? As anyone already encountered this issue?</p>",android|wear-os|battery,19025622,Loïc Zimmermann,yes
Exiting a C++ app immediately?,"<p>I find myself in a situation in which I need to exit a cross-platform C++ application immediately, without running destructors, and also without causing a crash. How can I do that?</p>

<ul>
<li><code>exit(0)</code> runs the destructors;</li>
<li><code>quick_exit(0)</code> is not implemented in VC++;</li>
<li><code>abort()</code> causes a crash;</li>
<li><code>_Exit(0)</code> does not seem implemented in VC++ (or at least does not appear in MSDN);</li>
<li>the documentation of <code>_exit(0)</code> is unclear as to whether it calls destructors – apparently, it calls them under Windows.</li>
</ul>

<p>I believe that I can use <code>quick_exit</code> under non-Windows platforms, but I am lacking a solution for VC++.</p>

<p><strong>Clarification</strong> (since people ask why I wish to avoid destructors) This is an optimization scenario. I am dealing with a large application that manipulates Gigabytes of RAM, allocated in complex graphs, with several processes, numerous threads, thread-safe reference-counting, watchdogs, etc. The memory management/resource deallocation mechanism is optimized for keeping the application responsive during runtime use and/or monitor possible errors (depending on build flags), but these mechanisms are clearly overkill during shutdown, keeping the CPU very busy for many seconds, draining the battery, etc – long after we are sure that all file descriptors/handles have been closed. This makes users unhappy, so I am experimenting how to improve this, preferably without having to refactor everything.</p>

<p>The call <code>quick_exit</code> was designed specifically for such scenarios, but isn't supported by VC++. So I'm looking for an alternative for that platform.</p>",c++|cross-platform|exit,249696,Yoric,yes
Constant Android Service,"<p>I've been looking through many questions about services, but I couldn't find one that suited me. 
I need a service that both starts on BOOT_COMPLETED (not bound to an Activity) and runs ALL the time (therefore I can't user AlarmReceiver). I know it might drain my battery but so far I don't care. It is just for research purposes.</p>

<p>I have a service that monitors sensor's data. What I managed to do so far was: either start the service as a regular Activity, but it runs only for +-20s and it is stopped (I think the SO cuts it down to release its memory); or start a service that runs in foreground. It worked to keep the process running, however the class that actually runs the service somehow was not started, besides an annoying notification which is required.</p>

<p>The code I refered as the one that runs the service in foreground was taken from here:
<a href=""https://stackoverflow.com/questions/3687200/implement-startforeground-method-in-android"">Implement startForeground method in Android</a></p>

<p>I mean, how does an app like WhatsApp run constantly? Is it running in foreground? Because looking at Settings it seems the service is very stable, and it does not show any permanent notification, since it is not possible for a foreground service run without one. 
( <a href=""https://stackoverflow.com/questions/10962418/startforeground-without-showing-notification"">How to startForeground() without showing notification?</a> )</p>

<p>Any advice?</p>",android|service|foreground,2105657,Teo Inke,yes
iOS today extension target membership of container classes or userdefaults?,"<p>I have an iOS app that also has a today extension. I am trying to feed the today extension data from the main container application but have a lot of decodable model classes that are used to hold data. </p>

<p>My questions are: </p>

<ol>
<li><p>Is it better to use userDefaults to get/set the data from container
into the extension or include the today extension target in all of
the model classes? </p></li>
<li><p>Does including a lot of classes in the todayExtension target cause
    performance issues or battery drain or anything like that?</p></li>
</ol>

<p>Thanks.</p>

<p>*EDIT
An example of my model class is:</p>

<pre><code>class Alert : Codable {
var type : String?
var sequence : Int?
var status : String?
var issueTimeText : String?
var expiryTime : String?
var alertId : String?
var alertBannerText : String?
var alertHeaderText : String?
var bannerColour : String?
var zones : [String]?
// TEXT IS [STRING], STRING FOR TESTING
var text : String?
var tcisURL : String?

enum CodingKeys: String, CodingKey {
    case type = ""type"";
    case sequence = ""sequence"";
    case status = ""status"";
    case issueTimeText = ""issueTimeText"";
    case expiryTime = ""expiryTime"";
    case alertId = ""alertId"";
    case alertBannerText = ""alertBannerText"";
    case alertHeaderText = ""alertHeaderText"";
    case bannerColour = ""bannerColour"";
    case text = ""text"";
    case zones = ""zones"";
    case tcisURL = ""tcisURL"";
}

init(inType: String, inIssueTimeText:String, inBannerText:String, inText: String, inColor: String) {
    self.type = inType
    self.issueTimeText = inIssueTimeText
    self.alertBannerText = inBannerText
    self.text = inText;
    self.bannerColour = inColor
}
</code></pre>",ios|swift|today-extension,2965721,manapate,no
CLLocationManager and distanceFilter?,"<p>i want to change the <code>distanceFilter</code> value on the basis of current speed. I try to change <code>distanceFilter</code> value after calling <code>startUpdatinglocation</code> on the basis of current speed, but it doesn't make any difference. Its giving location updates for every 10 meters because in starting i set <code>distanceFilter</code> value to 10. What i think i need to call <code>stopUpdatingLocation</code> and then <code>startUpdatingLocation</code> to make changes is <code>distanceFilter</code> value. But my concern is if i call <code>stopUpdatingLocation</code> and <code>startUpdatingLocation</code> frequently then will it drain more battery ? or in simple words if i try to start/stop GPS receiver more frequently then will it consume more power or not ?</p>",objective-c|ios|ios5|cllocationmanager|cllocation,672531,saadnib,no
Looking for APIs to measure battery use of a process,"<p><strong>Question</strong> Is there an API for Windows and/or Linux that will let me find out which processes are draining battery?</p>
<p>A few notes:</p>
<ul>
<li>It doesn't have to be precise, I'd be ok with only three levels (low energy cost/fair energy cost/high energy cost) if that's all I can get.</li>
<li>I already have CPU load information, that's not what I am looking for, as experience shows that processes with very low CPU use can nevertheless drain battery by having high I/O, high swapping or frequent wakeups. This is why I'd like to piggyback on whatever the OS is already using: OS developers are much more likely than me to have actually tested this.</li>
<li>I found a partial solution for macOS. See answers.</li>
<li>MSDN doesn't seem to indicate any energy-related API.</li>
<li>I cannot request admin/root rights for running my task manager, so I cannot simply parse the syslogs looking for power usage alerts.</li>
</ul>",c++|linux|window|battery|energy,249696,Yoric,yes
Where should I transcode video (in mobile phone or at server) - 1 min. video is captured by mobile app (iOS and Android),"<p>I am building a mobile app (first in iOS), where user records one minute video and share. I searched on Internet to find out about best practices for transcoding, but nothing fruitful showed up.</p>

<p>My questions are: 
1) Where should I transcode the video (to h264 format .mp4), in the mobile phone or send the raw video to server and then transcode there? </p>

<p>2) Is it even possible to transcode video locally in iOS and Android?</p>

<p>3) If I send video to server, then it will consume hell lot of bandwidth of user's network :(, in other hand if I transcode video locally (if thats possible), then it will drain battery and use lots of resources.</p>

<p>4) Any idea what would be the average file size of 1 minute of recorded video on iOS and Android? (I know its influenced by many factors and hence differs)</p>

<p>I checked Twitter's android mobile app, and they send 30 seconds video to server for transcoding and from their h264 .mp4 gets accessed by their web and mobile (may be)</p>

<p>Any suggestion and/or pointer would be appreciated</p>",android|ios|video|mobile|transcoding,1560470,JVK,yes
HM-10 battery uses too much energy on ibeacon mode,"<p>I m using hm-10 to deploy ibeacon with CR2450 battery.</p>

<p>But in several configurations, CR2450 battery drains too fast. </p>

<p>I need AT+MODE2 </p>

<p>And AT+ADTY0 commands for ota and battery level.</p>

<p>In AT+ADTY3 mode device cannot send battery level in advertising data. </p>

<p>Is it possible to work battery level data in AT+ADTY3 mode or AT+ADTY3 mode with low power consumption?</p>

<p>Thanks</p>",bluetooth-lowenergy|ibeacon|hm-10,2100814,gokhangokce,yes
FTDI device draining battery of Android device,"<p>I'm currently developing a mobile app that communicates with an external FTDI USB-C device. I use a device filter with the vendor and product ID to automatically open the application when the device is connected. The serial communication is done using Android's UsbManager and other native communication classes. The problem I'm having is that the battery life of the smartphone changed drastically. The autonomy of the Samsung Galaxy A50 is usually somewhere between 3 to 4 days. With the FTDI device attached, the autonomy is reduced to 1 day. After communicating with the FTDI device, I make sure that all connections (UsbManager, UsbDeviceConnection...) are closed. Is there anything I can do here to improve battery life of the smartphone?</p>
<p>Thanks in advance!</p>
<p>Best regards</p>",android|kotlin|usb|ftdi,7735132,pieterbus,no
Drain a 3V coin battery with Labview to test the lifetime of the battery?,"<p>I want to simulate/measure the lifetime of a 3V coin battery. This is the circuit which will give the burst to the battery: </p>

<p><a href=""http://img339.imageshack.us/img339/8206/schematicpicturev2.png"" rel=""nofollow noreferrer"">link text</a> </p>

<p>The burst is controlled with the CTRL1 and CTRL2 lines with some timing rquirements.</p>

<p>One burst is:</p>

<pre><code>                ARM    TX   RX     TX      RX   TX
CTRL1           L      H    H      H       H    H
CTRL2           H      H    L      H       L    H
Length (ms)     3.72   2.6  0.84   4.04    0.8  1

H = 10 V
L = 0 V
</code></pre>

<p>Now I want to drain the battery by applying one Burst gap one Burst gap etc..
The gap should be variable. First I want to use 10 seconds as a gap. I want to draw the battery characteristic. I wanna simulate for example 5 years which should be 1.2 days in the simulation. I have the NI PCI 6221 (37 pin) DAQ card. Can somebody help me to make a VI for this project. The bursts should be in a loop which I should be able to control how long it should run (i.e. 1 day, or 1.5 days) And how I can apply 10 V or 0 V to the CTRL1 and CTRL2 lines in Labview?</p>

<p>Thanks in advance.</p>

<p><strong>EDIT:</strong></p>

<p>Ok I have now made a continously acquiring voltage and graphing VI which has a physical channel as an input from where the voltage is acquired. But I dont know how to do the counters part which will output the timed signals for the TTL (MOSFET) to create the burst signal with gaps which then will drain the batterry.</p>",measurement|labview,426595,billz,yes
Behavior of android OS when both Wifi and Mobile Data are enabled,"<p>Can someone please tell me how the android OS behaves when <strong>both Wifi and Mobile Data are enabled</strong>? That is when both are enabled in the phone, <em>which</em> connection does the phone use?</p>

<p>If it favours Wifi over Mobile Data when both are on, will the mobile data then be <em>switched off</em>, meaning that the Mobile data connection, even though is left ON, does it still impact on the phone in terms of <strong>battery drainage, Mobile data money balance, and phone heating</strong>?</p>",android|android-wifi|3g|4g,2786452,SoulRayder,no
What is the best way to use GPS in a Android Service without drain the batery? Is there a good library for this?,<p>I want to consult the user's location when the application is closed or in background to send message Push. What's the best way for not drain battery. Is there a good library for this?</p>,android|gps|android-gps,3561164,Cleber Amâncio,no
Re-enable the idle timer prior to app crashing out or user hitting the main exit button?,<p>I am writing an app that disables the idle timer. How do I re-enable it prior to app crashing out or user hitting the main exit button? This could be real bad by draining the battery otherwise.</p>,objective-c|ios|cocoa-touch|idle-timer,767829,jdl,yes
Android - Reliably getting the current location,"<p>My app checks at a specific time whether a user is at a given location. I use the alarm manager to start a service that makes this call:</p>

<pre><code>locationManager.requestLocationUpdates(bestProvider, 0, 0, listener);
</code></pre>

<p>And also checks:</p>

<pre><code> locationManager.getLastKnownLocation(bestProvider);
</code></pre>

<p>But I'm having problems when running on a real device. For one thing, <code>getLastKnownLocation</code> is most likely the last place the GPS was on, which could be anywhere (i.e., it could be miles from the user's current location).  So I'll just wait for <code>requestLocationUpdates</code> callbacks, and if they aren't there within two minutes, remove the listener and give up, right? </p>

<p>Wrong, because if the user's location is already stable (i.e., they've used GPS recently and haven't moved) then my listener will never be called because the location doesn't change. But the GPS will run until my listener is removed, draining the battery...</p>

<p>What is the right way to get the current location without mistaking an old location for the current location? I don't mind waiting a few minutes.</p>

<p>EDIT: It's possible that I'm wrong about the listener not being called, it may just take a little longer than I thought... Hard to say. I'd appreciate a definitive answer still.</p>",android|geolocation|gps,12034,noah,yes
Which one drains more battery: listen to volume change or accelerometer?,"<p>My app need to play music whenever user want even in screen off mode. I know 2 ways to do it:
- Use a fake MediaPlayer with volume = 0 to listening to volume button.
- Use accelerometer to dectect shake.</p>

<p>so, which one drains more battery? which one i should choose? Is there any other way?
Thanks for ur helps</p>",android|accelerometer|android-mediaplayer,2713346,giaosuta,yes
Manually show current location blue dot MKMapView ios,"<p>I'm building an iPhone app. There is a screen with a map (MKMapView) always showing. But to preserve battery, I don't want user location to be updated all the time, only automatically (every 15 minutes) and manually (onclick).</p>

<p>But, I also want to show this user location on the map.
The problem is, if I <code>showsUserLocation</code> for my MapView, it automatically starts updating location, hence drains battery.</p>

<p>I tried activating the <code>showsUserLocation</code> option, saving the <code>MKUserLocation</code>, then deactivating the <code>showsUserLocation</code> then adding the saved <code>MKUserLocation</code> as an annotation by hand, but it actually shows a WARNING and reactivate the <code>showsUserLocation</code> option !</p>

<p>So I guess the last way is by hand:</p>

<p>I built a blue dot annotation myself but it doesn't have the glowing effect and the accuracy circle around. Do you have any idea how to do this? Or if there is any other way, please share.</p>

<p>Thanks !</p>",ios|iphone|location|mkmapview|mapkit,1809736,Noé Malzieu,yes
Upload files with showing determinate Progress Bar in Notification bar using React Native,"<p>I am trying to achieve a scenario where file is uploading and I want to make this upload process keep running with having percentage bar when the app was kill. And The process will resume upload process when the phone off with any reason (battery drain or out services).
I have tried this with local notification with Firebase and react-native-local-notifications. But it is not working. </p>",react-native|file-upload|notifications|progress-bar|android-notifications,6414666,Pankaj Negi,yes
Connecting two android with BLE,"<p>Is it possible to connect two anonymouse android device  (without identity sharing) with bluetooth low energy?
I am trying to make an application which allows content sharing  at small crowded location.I dont think P2P Wifi is suitable for me since it drains lots of battery power.
thanks</p>",android|bluetooth|bluetooth-lowenergy,3925294,burakpat,no
Constant FPS Android OpenGLES,"<p>Hello android developers,</p>

<p>I am developing a simple game for Android in Eclipse using OpenGLES 1.0. I am using Samsung Galaxy S2 Android(2.3) as a device for development.</p>

<p>And I have a question about dual core and making frame rate constant.</p>

<p>So I have managed creating GLSurfaceView and override onDrawFrame() function where I call LogicUpdate(deltatime) function and Render() function.</p>

<p>Yes, all in single thread for now.</p>

<p>The problem I am getting is with dual core. If I disable dual core by going to Setting->Power saving and check System power saving I realize that rendering is automatically locked at 30 FPS. But if I enable dual core by unchecking System power saving I see that rendering is locked at 60 FPS but, phone gets hot and it drains battery really fast.</p>

<p>So the idea is keep my game run at 30 FPS to save some battery.</p>

<p>So to do this I use the code bellow.</p>

<p>Before I do logic update I call this peace of code, remember all this is done in onDrawFrame().</p>

<pre><code>if( CONST_FPS &gt; 0 &amp;&amp; StartTime &gt; 0 )
{           
    /////////////////////////////////////////////////////////////////
    // Get frame time
    ////////////////////////////////////////////////////////////////
    long endTime  = System.currentTimeMillis(); 
    long time     = endTime - StartTime;
    //              
    long wantedtime = 1000 / CONST_FPS;
    //
    long wait = 0;
    if( time &lt; wantedtime )
    {
        wait = wantedtime - time;
        //                  
        Thread.sleep(wait);
    }
    else
    {
        //Time to big game will slow down
    }                           
}
</code></pre>

<p>Where CONST_FPS = 30</p>

<p>And then</p>

<pre><code>StartTime = System.currentTimeMillis(); //

UpdateLogic(1.0 / CONST_FPS);
Render();
</code></pre>

<p>Gameplay at 30 FPS is very smooth mainly because it does not need to lock FPS.
BUT, when trying to lock 60FPS to 30 FPS I get stuttering. I did some research and found out that Thread.Sleep() is not precise. Is this true? What else can I do to make gameplay more smooth when locking 60FPS to 30FPS.</p>

<p>Thanks for the answer ...</p>",android|opengl-es|constants|frame|frame-rate,1509693,Slide,no
Checking for internet connection constantly with android,"<p>I making an app. The app needs internet for 5 activities, the 4 other activities don't need internet. </p>

<p>The Activity's that need to have internet need it because they have to do a CRUD and do httppost to the website to communicate with the DB. 
So at the moment on the onCreate I do a check for an internet connection like this</p>

<pre><code>ConnectionDetector cd = new ConnectionDetector(getApplicationContext());
Boolean isInternetPresent = cd.isConnectingToInternet(); // true or false
if(isInternetPresent)
    Log.e(""Internet available"",""Internet available"");
    //Do httpPost logic here
else
    Log.e(""Internet not available"",""Internet not available"");
    //Tell the user that he needs internet
</code></pre>

<p><strong>ConnectionDetector</strong></p>

<pre><code>import android.content.Context;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;

public class ConnectionDetector {
    private Context context;

    public ConnectionDetector(Context context) {
        this.context = context;
    }

    public boolean isConnectingToInternet() {
        ConnectivityManager connectivity = (ConnectivityManager) context
                .getSystemService(Context.CONNECTIVITY_SERVICE);
        if (connectivity != null) {
            NetworkInfo[] info = connectivity.getAllNetworkInfo();
            if (info != null)
                for (int i = 0; i &lt; info.length; i++)
                    if (info[i].getState() == NetworkInfo.State.CONNECTED) {
                        return true;
                    }
        }
        return false;
    }
}
</code></pre>

<p>But what <strong>after</strong> the onCreate? What if the user enters the Activity, the check passes in the onCreate, he fills in the form and then he got disconnected from the internet. How do I check this part? And how do I implement that with my current code? 
That's is why in the first requirement I wanted constant internet connection checking. But that'll drain battery like cbrulak pointed out</p>",android|android-networking|android-internet,1442054,mXX,no
How to check for widget Home screen,"<p>I want to check whether user is facing the widget Homescreen(ie where the widget are placed) or using some other screen .ie he may be playing game or texting or something else..If  user is on some other screen i don't want execute my code..</p>

<p>For instance a clock widget doesn’t need to run once a minute if it’s not visible on the screen.  In order to cut down on battery drain it would be really nice if home screen widgets could be informed of their visibility</p>",android|widget|homescreen,1842414,Shakeeb Ayaz,yes
Battery Usage - IOS,"<p>I want to show battery usage of the app on the status bar of the app. It uses GPS, so GPS signal and details of battery usage by app would be useful for the users about the battery drain. </p>

<p>Is there a way to get the battery usage from the device? and to show only the amount of battery drained by <em>my app</em> alone. On instruments it shows the graph over the time. </p>

<p>I want to show battery usage in numerical format, not a graph.</p>",ios|batterylevel,1909513,Manoj,no
Database INSERT sends event to back-end,"<p>I have an Android application which pulls information from the internet into a list. I know one of the ways of downloading the new content only is to use an <code>IntentService</code>, for example, which would query the <code>createdOn</code> attribute of each entry in the table. However, this would probably drain battery especially if I want the list in my app to be <code>up-to-date every minute</code>. This would make for a new service launched every minute.</p>

<p>My question is, is there a way for a developer to receive a message (fire an event) from MySQL when an insert was performed, so that only then an intent service is started to download the new content. Are there any other efficient ways? </p>

<p>Thank you!</p>",android|mysql|events|service|backend,4543112,iBobb,yes
Authorization of ADB on Nexus 7 2013 edition,"<p>I was wondering if there is any POSSIBLE way of being able to Authorize the ADB debug on a nexus 7 2013 edition without the touchscreen responding... I've been researching while studying for exams and have yet to find any answer to this problem. I'm able to connect adb but the device remains to be unauthorized, and if no way of doing it i'll try to do restart my device when it dies after a battery drain...</p>",android|authorization|adb|nexus-7,3014960,user3014960,yes
Interpreting energy levels in Xcode,"<p>I am profiling an iPhone application in Xcode. When I observe the battery impact, I am able to see this result:</p>

<p><a href=""https://i.stack.imgur.com/6TGGk.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/6TGGk.png"" alt=""enter image description here""></a></p>

<p>The problem I have with interpreting this data, is that I am unable to translate what the dial means in respect to battery drain, and what ""Low"" is defined as. Looking at the documentation, found <a href=""https://developer.apple.com/library/archive/documentation/Performance/Conceptual/EnergyGuide-iOS/MonitorEnergyWithXcode.html"" rel=""nofollow noreferrer"">here</a>, I can tell that consumer facing apps should be within the ""Low"" energy impact zone but no further details are provided. Looking at other posts on stack, several mention public software for profiling ( only supported for older IOS versions now however ) and a point based system of 20 that comes with Xcode. They can be reached at these locations: </p>

<p><a href=""https://stackoverflow.com/questions/9917221/what-units-of-power-energy-consumption-have-energy-levels-in-the-energy-instrume"">What units of power/energy consumption have Energy Levels in the Energy Instrument for an iOS app?</a></p>

<p><a href=""https://stackoverflow.com/questions/8737612/energy-usage-instruments-ios"">Energy Usage Instruments - iOS</a></p>

<p>However, reverting back to an old version of IOS is a non starter. The 20 point based system also seems to be vaguely defined to meet scientific needs. </p>

<p>There are also hardware solutions, such as this <a href=""https://bottleofcode.com/2015/07/12/using-monsoon-power-monitor-with-iphone-5s/"" rel=""nofollow noreferrer"">guide</a> , to show how one can disassemble an iphone and connect the prongs to main power to determine consumption. However, after testing, it seems that the locked state on modern IOS platforms and new iDevices is near impossible to bypass.</p>

<p>What I'd want to know is as follows:</p>

<ol>
<li><p>How can I use the Energy impact dial to interpret power consumption in more common terms, such as used mA?</p></li>
<li><p>How can I estimate battery life given ""Low Energy Impact""?</p></li>
<li><p>If XCode is not the right tool for this, what can I use to get a very accurate power consumption estimate for my IOS apps?</p></li>
</ol>",xcode,5655414,angryip,yes
Objective C - Ensuring that the iPhone user has un divided attention for the app. Disabling all notfications,"<p>I have to develop an app that has to have an undivided attention of the user. Following things should NOT happen while the user is using the app:</p>

<ol>
<li>Incoming Phone Call</li>
<li>Device going to sleep</li>
<li>Battery draining</li>
<li>Push notes from other apps</li>
<li>Local Notifications for Calendar Events </li>
<li>Alarms/Reminders</li>
</ol>

<p>I have to see if all of these are viable to achieve directly or indirectly. Here is my report for all</p>

<ol>
<li><p>Incoming call</p>

<ul>
<li>Can't 
<ol>
<li>Cannot block phone to take calls.</li>
<li>Prevent user from seeing the incoming call screen</li>
</ol></li>
<li>Can
<ol>
<li>Alert user before starting the operation that he should put his phone on <code>Do Not Disturb</code> mode.</li>
</ol></li>
</ul></li>
<li><p>Device going to sleep</p>

<blockquote>
  <p>[UIApplication sharedApplication].idleTimerDisabled = YES;</p>
</blockquote></li>
<li><p>Battery Draining</p>

<ul>
<li>Can
<ol>
<li>Checking the battery status and compare it to minimum required battery so that the operation performs.</li>
<li>If the enough battery is not left, alert the user that he should put the battery on charge.</li>
<li>Monitoring the battery and keeping a check until the operation is complete.</li>
</ol></li>
</ul></li>
<li><p>Push Notes from other apps</p>

<ul>
<li>Can't 
<ol>
<li>Cannot disable push notes form other apps form my app</li>
</ol></li>
<li>Can
<ol>
<li>Can check the status of internet connectivity (wifi, GSM, etc)</li>
<li>Alert the user and tell him to disable all the internet connectivity options</li>
</ol></li>
</ul></li>
</ol>

<p>These are my compromises in <em>Can</em> sections. Please help me find a way for 5, 6 points
Also, if you can suggest a better solution (approach) for 1,2,3,4.</p>

<p>Thank you </p>",ios|objective-c|push-notification|apple-push-notifications|phone-call,751026,thesummersign,no
Interpolating missing values in SQL,"<p>I have a dataset that tracks snapshots of cellphone battery levels and connection.  However, when a cellphone loses connection, it will report the same numbers as its last good connection, for example: </p>

<pre><code>   id           timestamp connection bat_level
1   1 2019-09-12 20:00:00       TRUE         4
2   1 2019-09-12 20:05:00       TRUE         4
3   1 2019-09-12 20:10:00       TRUE         4
4   1 2019-09-12 20:15:00       TRUE         4
5   1 2019-09-12 20:20:00       TRUE         3
6   1 2019-09-12 20:25:00      FALSE         3
7   1 2019-09-12 20:30:00      FALSE         3
8   1 2019-09-12 20:35:00      FALSE         3
9   1 2019-09-12 20:40:00      FALSE         3
10  1 2019-09-12 20:45:00      FALSE         3
11  1 2019-09-12 20:50:00      FALSE         3
12  1 2019-09-12 20:55:00      FALSE         3
13  1 2019-09-12 21:00:00       TRUE         1
14  1 2019-09-12 21:05:00       TRUE         1
15  1 2019-09-12 21:10:00      FALSE         1
16  1 2019-09-12 21:15:00      FALSE         1
17  1 2019-09-12 21:20:00      FALSE         1
18  1 2019-09-12 21:25:00      FALSE         1
19  1 2019-09-12 21:30:00      FALSE         1
20  1 2019-09-12 21:35:00      FALSE         1
21  1 2019-09-12 21:40:00      FALSE         1
22  1 2019-09-12 21:45:00      FALSE         1
23  1 2019-09-12 21:50:00      FALSE         1
24  1 2019-09-12 21:55:00      FALSE         1
25  1 2019-09-12 22:00:00      FALSE         1
</code></pre>

<p>My objective is to create a fifth column that essentially interpolates what is happening when <code>connection</code> = FALSE.  I would like to interpolate the battery drain rate at .05 per minute (cannot go lower than 0), starting from the value of the <strong>last TRUE connection</strong>, so the output would be : </p>

<pre><code>   id           timestamp connection bat_level theoretical_bat_level
1   1 2019-09-12 20:00:00       TRUE         4                    NA
2   1 2019-09-12 20:05:00       TRUE         4                    NA
3   1 2019-09-12 20:10:00       TRUE         4                    NA
4   1 2019-09-12 20:15:00       TRUE         4                    NA
5   1 2019-09-12 20:20:00       TRUE         3                    NA
6   1 2019-09-12 20:25:00      FALSE         3                  2.75
7   1 2019-09-12 20:30:00      FALSE         3                  2.50
8   1 2019-09-12 20:35:00      FALSE         3                  2.25
9   1 2019-09-12 20:40:00      FALSE         3                  2.00
10  1 2019-09-12 20:45:00      FALSE         3                  1.75
11  1 2019-09-12 20:50:00      FALSE         3                  1.50
12  1 2019-09-12 20:55:00      FALSE         3                  1.25
13  1 2019-09-12 21:00:00       TRUE         1                    NA
14  1 2019-09-12 21:05:00       TRUE         1                    NA
15  1 2019-09-12 21:10:00      FALSE         1                  0.75
16  1 2019-09-12 21:15:00      FALSE         1                  0.50
17  1 2019-09-12 21:20:00      FALSE         1                  0.25
18  1 2019-09-12 21:25:00      FALSE         1                  0.00
19  1 2019-09-12 21:30:00      FALSE         1                  0.00
20  1 2019-09-12 21:35:00      FALSE         1                  0.00
21  1 2019-09-12 21:40:00      FALSE         1                  0.00
22  1 2019-09-12 21:45:00      FALSE         1                  0.00
23  1 2019-09-12 21:50:00      FALSE         1                  0.00
24  1 2019-09-12 21:55:00      FALSE         1                  0.00
25  1 2019-09-12 22:00:00      FALSE         1                  0.00
</code></pre>

<p>I understand that one should use a cte with <code>lag()</code>, but not sure how to get start decreasing the <code>theoretical_bat_level</code> from the last <code>TRUE</code> value per <code>id</code> </p>

<pre><code>CASE WHEN connection = FALSE AND 
LAG(connection) OVER(PARTITION BY id, timestamp ASC) = True AND
connection = LAG(bat_level) OVER(PARTITION BY id, timestamp ASC) THEN  ?
WHERE connection = FALSE
</code></pre>

<p>Any guidance on the right method to use here would be helpful </p>",sql|postgresql|presto,5905425,the_darkside,yes
How to synchnorize files with mobile phone running LineageOS?,"<p>I have a mobile phone running LineageOS 16.0. I would like to organize the automatic synchronization of particular directory on mobile phone with some remote directory (e.g. exposed via FTP/SMB/SSH) on the server. Ideally would be to have an option either to make one-way (synchronize only missing files) or two-way (source and target are identical after synchronization) modes.</p>
<p>In particular above can be achieved by using the <a href=""https://en.wikipedia.org/wiki/Rsync"" rel=""nofollow noreferrer""><code>rsync</code></a> utility. I see the following options:</p>
<h3 id=""mobile-phone-is-exposing-the-folder-via-e.g.ssh-6hwt"">Mobile phone is exposing the folder via e.g. SSH</h3>
<p>This would require LineageOS running SSH server. In this case <code>rsync</code> could be run on the server (periodically or on some event).</p>
<ul>
<li>Is SSHD server already installed on LineageOS (<a href=""https://binfalse.de/2018/09/06/native-ssh-server-on-linageos/"" rel=""nofollow noreferrer"">Native SSH server on LinageOS</a>)? If not, is it possible to install it from a package?</li>
<li>Will running in the background <code>sshd</code> daemon drain the mobile battery?</li>
<li>How difficult would be to add it to startup (<a href=""https://lisas.de/%7Ealex/?p=237"" rel=""nofollow noreferrer"">SSHD on LineageOS</a>, <a href=""https://h4des.org/blog/index.php?/archives/359-Android-LineageOS-16-Execute-Script-on-Start-Up.html"" rel=""nofollow noreferrer"">Execute Script on Start Up</a>)?</li>
</ul>
<h3 id=""mobile-phone-is-running-rsync-857p"">Mobile phone is running rsync</h3>
<ul>
<li>This requires <a href=""https://github.com/LineageOS/android_external_rsync"" rel=""nofollow noreferrer""><code>rsync</code> installation to LineageOS</a>. Maybe there is ready-to-use package or will it require the compilation?</li>
<li>I would need an icon (or some other easy way) to execute <code>rsync</code> on mobile. How to organize that?</li>
</ul>
<p>If you see other more handy/easy options, please describe how to setup/organize them.</p>
<p>P.S. Dropbox or any other cloud solutions is not an option (out of scope for this question).</p>
<p>Thanks in advance!</p>",android|rsync|data-synchronization|lineageos,267197,dma_k,no
iOS 9 Defer location update not working,"<p>I want to have tasks in backgrounds using location update and using ""allowDeferredLocationUpdatesUntilTraveled""</p>

<p>But it does now deferred location, it occurred every singe seconds (It is based on accuracy), and it triggered by condition in locationManager:didFinishDeferredUpdatesWithError:</p>

<p>I tested it based on <a href=""https://developer.apple.com/library/ios/documentation/CoreLocation/Reference/CLLocationManager_Class/index.html#//apple_ref/c/data/CLLocationDistanceMax"" rel=""nofollow"">document</a></p>

<p>I set Location update background mode</p>

<pre><code>override func viewDidLoad() {
    super.viewDidLoad()
locationManager = CLLocationManager()


    if CLLocationManager.authorizationStatus() == .NotDetermined{
        locationManager.requestAlwaysAuthorization()
    }

    locationManager.delegate = self

    locationManager.pausesLocationUpdatesAutomatically = false
    locationManager.activityType = CLActivityType.Fitness

    locationManager.allowsBackgroundLocationUpdates = true
    locationManager.desiredAccuracy = kCLLocationAccuracyBest
    locationManager.distanceFilter = kCLDistanceFilterNone

    locationManager.startUpdatingLocation()
   }



func locationManager(manager: CLLocationManager, didUpdateLocations locations: [CLLocation])
{
   if UIApplication.sharedApplication().applicationState == .Background &amp;&amp; !self.bDeferringUpdates // &amp;&amp; CLLocationManager.deferredLocationUpdatesAvailable()
    {

        self.bDeferringUpdates = true;
          self.locationManager.allowDeferredLocationUpdatesUntilTraveled(CLLocationDistanceMax, timeout: 60*60)  


    }



}


    func locationManager(manager: CLLocationManager, didFinishDeferredUpdatesWithError error: NSError?) {

    self.bDeferringUpdates = false


}
</code></pre>

<p>Someone said that it did not worked in debugging mode or charing mode, so I tested it in no charging. </p>

<p>I logged events, but it happens in every single seconds and it did not deferred. </p>

<p>logs are belows</p>

<pre><code>2016-06-09 02:51:39 - didUpdateLocations
2016-06-09 02:51:40 - didUpdateLocations
2016-06-09 02:51:41 - didUpdateLocations
2016-06-09 02:51:42 - didUpdateLocations
2016-06-09 02:51:43 - didUpdateLocations
2016-06-09 02:51:44 - didUpdateLocations
2016-06-09 02:51:45 - didUpdateLocations
2016-06-09 02:51:46 - didUpdateLocations
2016-06-09 02:51:47 - didUpdateLocations
2016-06-09 02:51:48 - didUpdateLocations
2016-06-09 02:51:49 - didUpdateLocations
2016-06-09 02:51:49 - didFinishDeferredUpdatesWithError
2016-06-09 02:51:50 - didUpdateLocations
2016-06-09 02:51:50 - allowDeferredLocationUpdatesUntilTraveled
2016-06-09 02:51:51 - didUpdateLocations
2016-06-09 02:51:52 - didUpdateLocations
2016-06-09 02:51:53 - didUpdateLocations
2016-06-09 02:51:54 - didUpdateLocations
</code></pre>

<p>I tested from 1:52 AM to 8:03 AM with no charging </p>

<p>1: 52 AM ,  with 100% battery, 
8:03 AM, with 87% battery </p>

<p>It drains 13% battery during 6 hours</p>

<p>Do I miss it?</p>",swift|background|location,796146,dobiho,no
Do I need to stop periodic GcmTaskServices?,"<p>I'm trying to implement a <code>PeriodicTask</code> with the <code>GcmNetworkManager</code> API (existing since <code>Google Play Services 7.5</code>).</p>

<p>My task is scheduled as soon as my app starts and will check the content of a <code>Queue</code> of objects in order to send them as batches to my server.
If the queue is empty, the method <code>onRunTask()</code> will do pretty much nothing (it will check the queue and <code>return GcmNetworkManager.RESULT_SUCCESS</code>).</p>

<hr>

<p>I have put some logs in the implementation and noticed that the <code>PeriodicTask</code> keeps running forever, even after my app is in background or removed from memory.</p>

<p>This made me worry about my users' battery. Even though I won't perform any heavy task or HTTP request, the process is started periodically without real need.</p>

<p>At first, I thought <code>GcmNetworkManager</code> would be smart to exponentially back-off my <code>Task</code> until it stopped (or maybe I'm doing something wrong that prevents that), but, as my logs showed, that did not happen.</p>

<p>Afterwards, I have tried using <code>cancelTask()</code> and <code>cancelAll()</code> but those do not work if called from within the <code>Task</code>'s <code>onRunTask()</code> method itself. Even calling <code>stopSelf()</code> is not a good idea since <code>GcmNetworkManager</code> is the one responsible for the <code>Service</code> lifecycle so I do not want to get in the way.</p>

<p>The difficulty of actually finishing the task made me think if that is the right approach (maybe I should just let the <code>Task</code> live forever?).</p>

<hr>

<p>How can I use <code>PeriodicTask</code> properly while not draining the user's battery?</p>",android|google-cloud-messaging|google-play-services,4687299,Júlio Zynger,yes
proximity alert and battery drain,"<p>I'm working on a project where I track the position of the phone every 5 minutes using the requestSingleUpdate method.
Doing this the phone's battery last all day long.</p>

<p>I want to check if the phone is going close to special locations that I've geocoded. 
I had in mind to use proximity alert, but I don't know exactly how it works.
Will it only use the location provided by my previous requestSingleUpdate or will it set its own requestLocationUpdates ?</p>

<p>And what about the battery consumption ?</p>",android|performance|gps|proximity|battery,1206698,Alexandre MOINE,yes
iOS - How to transfer images from Broadcast Upload Extension to my container app?,"<p>I want to transfer every frames from my broadcast extension to my container app.
I want to process the frames with a delay of less than 1 second, so writing to the video and retrieving it after the session doesn't work.</p>
<p>After a few hours of research, I think I might be able to transfer the frames as files using <a href=""https://developer.apple.com/documentation/foundation/filemanager/1412643-containerurl"" rel=""nofollow noreferrer"">FileManager.default.containerURL</a>.
Although, since my app will be reading and writing dozens of files per second while it is running, I'm not sure if this is a practical way or if this is possible or if this is even allowed.</p>
<p>So, my questions are:</p>
<ol>
<li>What is the best way to transfer images from the broadcast extension to the container app?</li>
<li>Are there any docs / articles / libraries I can use for that?</li>
</ol>
<p>Any suggestions would be appreciated. Thank you.</p>
<h2>Update</h2>
<p>After a little more research, I found a mention in the guideline that concern about the &quot;excessive write cycles to the solid state drive&quot;.</p>
<blockquote>
<p>2.4.2 Design your app to use power efficiently and be used in a way that does not risk damage to the device. Apps should not rapidly drain battery, generate excessive heat, or put unnecessary strain on device resources. For example, apps should not encourage placing the device under a mattress or pillow while charging or perform excessive write cycles to the solid state drive. Apps, including any third-party advertisements displayed within them, may not run unrelated background processes, such as cryptocurrency mining.</p>
</blockquote>
<p>The solution mentioned above seems to meet this example, and even if it did not, it seems likely to &quot;generate excessive heat&quot;. Thus, I have given up trying this solution.</p>
<p>In addition, I found a solution to set up a TCP server in my container app, but this too may not work if the app is in the background for a long period of time.</p>",ios|swift|broadcast|ios-app-extension|ios-app-group,18125313,ken,yes
How much battery life can setInterval suck up?,"<p>I have a JS app that uses setInterval to update itself many times a second. Most of the time it's not doing anything and is not very CPU intensive. I have heard people say that JavaScript timers can eat up battery life on mobiles, but I have not seen any facts or evidence.</p>

<p>Is there any good way to measure the battery drain of my JS app on iOS? Or could someone explain how using setInterval to call a non CPU intensive function would be draining the battery faster?</p>",javascript|ios,80756,Glenn Sandoval,no
Phonegap + Sencha Touch 2 on Android causes battery drain,"<p>I'm working on an app built with Phonegap and Sencha Touch 2. It also uses Urban Airship plugin for push notifications.</p>

<p>My problem is that on some devices running Android 4.0.4 it uses a lot of battery and CPU (~40% for both).</p>

<p>I've already switched off GPS, removed all analytics (network requests) from UA plugin and do pause all requests app makes when inactive (in background).</p>

<p>Do you know how can I profile it to find a leak or maybe there's some ready-to-use solutions for battery issues.</p>

<p>Thanks!</p>",android|cordova|sencha-touch-2|urbanairship.com|battery,727746,Grin,yes
iOS Save State when device turns off or battery drains,"<p>I have an app that syncs records created on the phone with a web-server.</p>

<p>When app does not have internet connectivity, it store everything locally (Core Data) and then syncs it when internet is available again.</p>

<p>Now a user has come up with a valid user case scenario ... say he is in an airplane making records (without network) ... so everything is getting stored locally. All is well till the air hostess commands him to switch off the phone. While in the app he immediately turns if off. Now the data is getting lost. I am saving sate while app goes in background or even when phone is locked. But how do I warrant for this? </p>

<p>When user switches off the phone (long-pressing lock button), they still have to slide a bar and devices takes some time before switching off ... so there is some time I can save state in ... which delegate method is called during this time?</p>",ios|battery|savestate,154967,Dev,yes
iOS long lasting animations drain battery?,"<p>I'm building an app that has a gauge view with a needle that animates up and down. An Arduino sends measurements to the app at about 20 times per second over bluetooth and updates the UI every 1/8 of a second. These measurements make the needle on the gauge move with an nice animation. I wonder if this is a battery killer since it drains it at about 1% over 4 minutes (iPhone 6s). This app is meant to run over long periods of time with out being plugged in. I'd say up to two hours.</p>

<p>This is the animation code, nothing out out the ordinary</p>

<pre><code>UIView.animate(withDuration: 0.125, delay: 0.0, options: [.curveLinear], animations: {
    self.needle.transform = CGAffineTransform(rotationAngle: .toRadians(CGFloat(angle)))
})
</code></pre>",ios|iphone|animation|bluetooth,795295,pec1985,yes
How can I kill or stop cassandra immediately on os x?,"<p>After install java and Cassandra, java is running on more than 2GB of my mac memory and at least half percent of CPU for all time. I tried <code>ps -ax | grep cassandra</code> and <code>kill pid</code> or <code>ps -ax | grep java</code> but didn't work and java still running on memory! what is the solution? how can I stop Cassandra or java to stop battery draining when I don't use them?</p>

<p>I am not sure about java is draining my battery but I guess It's will!</p>

<p><a href=""https://i.stack.imgur.com/FASWl.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/FASWl.png"" alt=""enter image description here""></a></p>",java|macos|cassandra,1743242,Nasser Ghiasi,yes
Xcode - How to deal with notifications posted into NSNotificationCenter while application was in the background as soon as app comes to foreground,"<p>I am currently dealing with Smartcard reader connected to a IOS device as an external accessory. When application goes to the background and remains there for a few (let's say 10-15 seconds) the reader is disconnected by iOS in order not to drain battery. This sends notification to <code>NSNotificationCenter</code> that the reader (<code>EAAccessory</code>) has been disconnected. When app comes to the foreground, it usually takes some time till the reader is connected back.
I am able to handle with these notifications using following methods:</p>

<pre><code>[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(EAaccessoryConnect) name:EAAccessoryDidConnectNotification object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(EAaccessoryDisConnect) name:EAAccessoryDidDisconnectNotification object:nil];
</code></pre>

<p>The problem is, sometimes when application is in the background for a longer time (longer than 20 minutes), more than one <code>EAAccessoryDidDisconnectNotification</code> is obviously posted to the notification centre as well as <code>EAAccessoryDidConnectNotification</code>. 
When I receive <code>EAAccessoryDidDisconnectNotification</code> I have to adequately handle it and allow some time till the <code>EAAccessoryDidConnectNotification</code> is received. However when another <code>EAAccessoryDidDisconnectNotification</code> comes, it messes up with my settings and the user is logged out from the application. </p>

<p>My question therefore is - is it possible to check which notifications have been sent to the  NSNotificationCenter while app was in the background just after the app comes to the foreground, and remove multiple notification of the same kind - leaving only one notification of a kind. Or is there any other solution you suggest me to implement to deal with this?</p>",ios|nsnotificationcenter|eaaccessory,1424613,mbuster,no
Continuous sending location to server.. good or bad?,"<p>I am developing one tracking application where a user can track other users location continuously and show it in map.For continuous location updates i am using  <code>FusedLocationApi</code> and getting location updates correctly. My question is to send these location to other device, is it a good habit to send these location updates to server continuously? If we make connection request to server so frequently then won't it be draining battery fast? Thanks in Advance. Any help is appreciated.</p>",android|httpconnection|fusedlocationproviderapi,5761300,Ishan Khanduja,no
How to apply accent colors without affecting other theme and color resources in windows phone 7.8?,"<p>I have an unlocked hTC HD7 Windows Phone 7.8. I have some basic knowledge regarding building apps for WP7.8. In this unlocked version the developers have added some additional themes which includes 'black' as an accent color. When applying the black accent color, the home screen looks beautiful &amp; otherwise it is helpful too since it reduces battery drain, the problem is that when the black accent color is applied, the conversation-textblocks in messaging for both ends becomes black &amp; blends with the 'dark' background and it appears as if the texts are scattered. Even the alphabet menu in Zune-music turns black.
I want to write an application that will allow the phone to apply black as an accent color only to the start screen and other controls such as textblocks, texts, should not be affected by this 'black' accent.
How can I start with this project?
How can I override system colors?</p>",c#|windows-phone-7|xaml|visual-studio-2012,938133,Siddharth Thevaril,no
android query on polling server,"<p>I'm creating an app in android that would basically connect to the server and receive data which would be further processed for certain further tasks of my app. Currently I've just developed a sample app that is using Async task and connecting to the server and display the contents. Now, as I've learned that Async can be run only once, it doesnt fullfil my purpose because I want the changes in data on the server to be reflected in the app as well. I've found out that I must use IntentService, but the problem is battery drain and so i need a better solution that will help me. Could I use gcm and notify the app through server and solve the problem of battery drain? If yes, how to do it? </p>",android|android-asynctask,5431602,Suraj Jorwekar,yes
Background Service in ionic 1 Taking too much battery consumption,"<p>I am creating an IONIC application for Android &amp; iOS.
As per my requirement, I need to call background service in every 3 hours interval.
I am using <a href=""https://github.com/katzer/cordova-plugin-background-mode"" rel=""nofollow noreferrer"">cordova-plugin-background-mode cordoava plugin</a>.
I am using following code for background:</p>

<pre><code>      document.addEventListener('deviceready', function () {

        // Enable background mode
        cordova.plugins.backgroundMode.enable();
        // cordova.plugins.backgroundMode.setEnabled(true);
        // Called when background mode has been activated
        cordova.plugins.backgroundMode.setDefaults({ silent: true });

        cordova.plugins.backgroundMode.on('activate', function () {
             interval = setInterval(function () {

         **//Doing background stuff: Using Bluetooth BLE.**

        }, milliseconds); 

    }, false);
</code></pre>

<p>In IOS, If i check my battery status it shows: <strong>e.g. 5 hours in background &amp; 5  minutes on screen</strong></p>

<p>Battery drains in approx 5-6 hours. I have checked all the possibilities for optimize it but i am not able to get succeed.</p>

<p>Apart from that I have checked it in Android as well. Result is same.</p>

<p>I have check any other plug-ins as well but i am not getting any other best plugin in cordova for battery optimization in background. </p>

<p>Kindly help me for this. &amp; please provide your valuable suggestion around this.
What are the possibilities for background in cordava &amp; ionic? 
can someone suggest on this?</p>",angularjs|cordova|ionic-framework|background|battery,1719208,Deepanker Chaudhary,no
Battery consumption using android iBeacon library - short but regular scans,"<p>I only need a rough guide on this really at this point, though specific calculations would obviously be welcome too! </p>

<p>I'm looking at using Radius Network's Android iBeacon Library in an app which will listen for iBeacon advertisements. </p>

<p>I'm new to this but from what I understand it's the scanning for BT devices which is the most battery intensive part of the BLE system so it's not advised to have this running constantly, however I would like to be able to 'catch' devices when they are in a certain area, i.e. a person walking through a lobby. </p>

<p>The Android Beacon Lib's documentation states that the Battery Manager's default setting scans for 30 seconds every 5 minutes (actively scanning for 10% of the time) and this reduces the battery drain on a Nexus 5 from roughly 90mA to 37mA. </p>

<p>My question is... would scanning for 3 seconds every 30 seconds (also 10% of the time) acieve the same battery savings? Or is there an overhead involved in starting the scanning process which would mean the savings would be less? and if so by how much?</p>",android|bluetooth-lowenergy|ibeacon,1094130,Sean,yes
proximity-based fob security device with bluetooth: how it works,"<p>i have been reading about proximity security devices through bluetooth, but i am wondering how it works in reality. As far as i have been reading, there are two techniques:</p>

<ol>
<li><p>constant scanning from a master. The central device scans the target device every x minutes. When the target is into range, it gives back MAC bluetooth address and RSSI. The negative side is that being constantly into discoverable mode drains the battery, so does the master device that has to be constantly scanning for devices.</p></li>
<li><p>Paired and connected. As some product details: ""Your laptop locks itself down when you step a certain distance away, and opens again once you're in range"". It means that after paring and connected processes, the master can have information when the slave device is out of range, or get inside range again. In bluetooth 4, is going to be even as a profile.</p></li>
</ol>

<p>Regarding to the second option, which feature is this? how it works? i mean, maybe you can code a sequence number counter that counts everytime the slave sends a packet through RFCOMM every x milisecs (android or ios), but what i dont understand is how a slave can connect to master again in a transparent way, when normally two bluetooth devices disconnect when they are out of range each other (so you cant send information again from the same bluetooth socket RFCOMM connection).</p>

<p>How proximity devices works in reality? how can you code it?</p>",android|ios|bluetooth|proximity|rssi,896949,Michael Trend,yes
"bluetooth project with Android. How to scan the piconet, master and slaves","<p>I have a big issue. I would want to create an app on Android (telephone) where should act as a master, and several devices (bluetooth modules) should act as slaves (only piconet, not scatternet). I need that everytime, the master wants to check all avaliable devices near it (for example, an Inquiry process every minute to check an update list of devices around the master), he should obtain this information to know which ones are out of range, powered off or sync.</p>

<p>from lots of questions here on stackoverflow, everybody agrees that making all slaves always discoverable is impossible, because it will drain the battery super fast (so doing the process of Inquiry scan every minute is not feasible). So, which other technical solution could you advice to me?</p>

<p>I have been thinking about something after the master makes de inquiry and paging process, when up to 7 devices are set as active members (Active Member Address), and the rest (up to 256) are put on ""parked more"" (8 bit Parked Member Address), or Hold or Sniff (this two last ones doesnt get a 'MAC'). A parked device remains synchronized to the master clock and can very quickly become active and begin communicating in the piconet (so other active slave has to be put on parked mode).</p>

<p>Is there any way on Android where i can put switch devices from active to park an viceversa (through AT commands?)? could be useful? Is there any way where i can monitor ALL of them every x seconds?</p>

<p>thank you very much in advance</p>",android|bluetooth,896949,Michael Trend,no
Checking for updates from network continuously - how?,"<p>When my phone receives a text message, it will upload it to my database. On the tablet I should get a notification about the new message as soon as possible. </p>

<p>How do I efficiently check for new messages from the database? I don't think a background process that queries the database every few seconds is efficient at all. It will drain the battery and it's huge waste of network.</p>",java|android|networking,1279334,MikkoP,yes
Android Timer/Handler/Thread.sleep() with screen off don't work correctly,"<p>I'm developing an application which needs to run small chunks of code frequently (once every two seconds, for example). I've tried to make it work using the simple Thread.sleep() (or android.os.SystemClock.sleep() to avoid interrupts, and finally I've tried with Timer and Handler), but the result is that the time that the program sleeps is random (or it simply doesn't run if I use Timer or Handler as the system discards they messages when the screen is off), as the system goes to a deep sleep mode during screen off.</p>

<p>For example the code works right if I have the phone plugged into the charger, or is playing music (that avoids the deep sleep mode), but when the phone isn't doing anything the time can grow from two seconds sleep up to minutes of sleep.</p>

<p>From <a href=""https://groups.google.com/forum/#!topic/android-developers/Eqwp8Uiy2f0"" rel=""nofollow"">https://groups.google.com/forum/#!topic/android-developers/Eqwp8Uiy2f0</a> seems that the only alternative is to use the AlarmManager to force the wake, but that way will probably cause too much battery drain.</p>

<p>Is there any alternative? </p>

<p>If not, is there any way to detect when the system goes into the deep sleep mode?</p>",android|timer|screen|handler|sleep,2519155,Fran,yes
Android: correct way to use AlarmManager without draining battery,"<p>I need to do a background check in my app, basically polling various URLs for new stuff. So I've read this is done with the AlarmManager.</p>

<p>The thing is, I don't need the user to be notified as soon as new stuff arrives. Let's say I'm checking every hour, I'm perfectly fine with not doing any check while the phone is sleeping, and resuming the checks when the phone is used. That way the user eventually gets the notification, but the drain is minimal.</p>

<p>So I've tried with setInExactRepeating. I'm starting it at boot time, but also at app startup (mostly for the session after install, and to make sure it's running even if the app gets ""force killed""). How do I prevent all these checks to add up? (A new check should only be run if none is running, or the previous one needs to be stopped).</p>",android|alarmmanager,195336,erwan,yes
"How to use the call back from the android OS whenever any changes occur in of battery percentage, time, calendar, location, who is calling etc","<p>I was trying to do an app and I got stuck in retrieving the status of battery percentage, time, calendar, location, who is calling etc., and since indeed to continuously track the status of such things the polling logic is not a good idea. So, I was thinking to use the call back from the android OS whenever any changes occur in those conditions to my app, but I cannot find any relevant library file or API, neither a source to learn that.</p>

<p>I have gone through few android API classes.Even though these classes satisfy my needs, the application of these as far as I found are with polling approach which may drain the battery continuously. So I would like to use the call back approach. the api-classes I checked out are :</p>

<p><a href=""http://developer.android.com/reference/android/os/BatteryManager.html"" rel=""nofollow"">http://developer.android.com/reference/android/os/BatteryManager.html</a></p>

<p><a href=""http://www.codeproject.com/Articles/511455/Android-Phone-Status-Sample.html"" rel=""nofollow"">http://www.codeproject.com/Articles/511455/Android-Phone-Status-Sample.html</a></p>",android|callback|mobile-application|android-os-handler,4417497,Nikitha Reddy,no
Battery is draining because of alarmManager and Broadcast Receiver I think,"<p>HI i have an app like a applock (not applock) , which checks for current app running with list of selected apps by a user , if it matches then I hv my code . I have an service which doesnt have any loops  calls StartupReceiver .Class(broadcast Receiver) which inturn calls CheckRunningApplicationReceiver.Class(broadcastReceiver) which checks the current activity . I am calling CheckActivity for every 0.5 second . And i do lot of storing and retrieving strings in internal storage inside the CheckActivity.Class . Its draining my battery . Help me .</p>

<p>MyService.class</p>

<pre><code>public class MyService extends Service{
private static final String TAG = ""MyService"";

@Override
public IBinder onBind(Intent arg0) {
    // TODO Auto-generated method stub
    return null;
}


@Override
public void onCreate() {      

}

@Override
public void onStart(Intent intent, int startId) {

//Note: You can start a new thread and use it for long background processing from here.
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    // TODO Auto-generated method stub      
        getBaseContext().getApplicationContext().sendBroadcast(
                new Intent(""StartupReceiver_Manual_Start"")); 

    return START_STICKY;

}}
</code></pre>

<p>StartupReceiver.Class</p>

<pre><code>public class StartupReceiver extends BroadcastReceiver {
static final String TAG = ""SR"";
final int startupID = 1111111;


@Override
public void onReceive(Context context, Intent intent) {
    final AlarmManager alarmManager = (AlarmManager) context
            .getSystemService(Context.ALARM_SERVICE);

    try{

            Intent i7 = new Intent(context, CheckRunningApplicationReceiver.class);                        
               PendingIntent ServiceManagementIntent = PendingIntent.getBroadcast(context,
                    startupID, i7, 0);
            alarmManager.setRepeating(AlarmManager.ELAPSED_REALTIME,
                    SystemClock.elapsedRealtime(), 
                    500, ServiceManagementIntent);


        } catch (Exception e) {
            Log.i(TAG, ""Exception : ""+e);
        }}
      }  
    }
</code></pre>

<p>}</p>

<p>CheckRunningApplicationReceiver.Class</p>

<pre><code> public class CheckRunningApplicationReceiver extends BroadcastReceiver implements Serializable{




@Override
public void onReceive(Context aContext, Intent anIntent) {

    //I do lot of things here . 
   //I am not using any thread here ( i dont know about threads ) .
   //I am checking internet connectivity here , storing an retrieving
   //arraylist , strings from internal storage here , getting current 
   //running app and checking with the arraylist . 
}
</code></pre>

<ul>
<li>Here are the things I observed , when I put alarm time as 10ms , my phone when connected to laptop , detection of phone phone happened after 15 seconds delay , even when transferring files through bluetooth ,there was a delay . now i am calling for 0.2 second . So I cannot observe these problems. Whats the reason for this ?</li>
<li>I am storing arraylist and few strings in the internal storage . Should I be using Shared Preferences instead?</li>
<li>Is there any broadcast receiver which tells me if current running app is changed ?</li>
<li>Should i be using a infinite loop inside a service instead of using alarm Manager?</li>
<li>How to stop the CHeckRunningApp.Class when the phone is locked or phone goes to sleep ?</li>
<li>Solution for battery drain?</li>
</ul>",android|service|broadcastreceiver|alarmmanager|battery,4734509,sandesh hegde,yes
Android device is sleeping when locked,"<p>I m actually developping an application in which I need my phone to be active even if it's locked.</p>

<p><strong>Explanations</strong></p>

<p>The applications connect to a remote nodejs server using socket.io. In that case, it cans sends realtime messages to a socket server that can handle this and make anything it needs. The fact is the socket management is in a service class (extends Service class).</p>

<p>The problem is that, when I lock the phone, the device stop to send heartbeat, and so is disconnected (by timeout) from the nodejs socket io server.</p>

<p>Actually, the normal behaviour of an android phone locked is to sleep. Meaning no activity.</p>

<p><strong>Question</strong></p>

<p>I was wondering how does others applications to be able to receive notifications, and so handling notif by a background service. it means that there's an activity even if the phone is sleeping right ?</p>

<p>How can I do to make this without draining a lot of battery ?</p>",android|node.js|sockets|android-service,2968101,mfrachet,yes
"Keep a permanent connection (same LAN) in the background, without using GCM","<p>I need to keep an open connection in the background, even when the app is not running. It's not possible to use GCM because the connection will be in the same LAN as the server, and the device may not have a working Internet connection. 
The connection will be some kind of local Push, so the device will just get some short relevant data from time to time (in addition to the keep-alive messages).</p>

<p>My use case is quite specific so I can consider that the battery is not an issue. I may show a huge red warning saying that enabling the feature will drain the battery, or just disable it if the device is not charging.</p>

<p>On the other hand, is quite important that the process with the connection is not ""randomly"" killed by Android.</p>

<p>I thought about implementing this with a service, but I would like to hear opinions from someone else. Maybe there is a better way to do it, considering the constraints mentioned before.</p>",android|google-cloud-messaging|httpurlconnection,1966226,Esparver,yes
Using an AlarmManager to check periodically that my permanent service is running,"<p>I have a <code>Service</code> which should keep a permanent connection to a server in order to receive notifications. It's critical for my app to get the messages from the server on time.</p>
<p>I cannot use GCM Push because the connection will be in the local network and the phone may not have any internet connection. I also know about the battery issues of keeping a permanent connection within a service, but I will let the user choose this option and inform him/her about the potential battery drain (Actually the feature makes mainly sense when the device is always in the same place connected to power). I also know that the Android system can kill my Service anytime, or even the user can use a task killer to get rid of all the services running at the time.</p>
<p>Said that, I thought about using an <code>AlarmManager</code> periodically to check whether my <code>Service</code> is running and restarting it in case it is not. I'm not convinced with this option, since the server can send a message after the service was killed but not yet restarted by the <code>AlarmManager</code>.</p>
<p><strong>My question is basically whether there are better strategies to ensure that I get the messages on time?</strong></p>
<p>So far all the related info I could find stand for avoiding the permanent service and use something else, but I have no other option because of the nature of my use case.</p>",android|push-notification|android-service|alarmmanager,1966226,Esparver,yes
Fused Location Provider GoogleApiClient sometimes not updating location in background service,"<p>Below is my Location service class, it continue update the location if device changed location.</p>

<pre><code>public class LocationService extends Service
        implements LocationListener,
        GoogleApiClient.ConnectionCallbacks,
        GoogleApiClient.OnConnectionFailedListener {
    private static final long INTERVAL = 1000 * 60;
    private static final long FASTEST_INTERVAL = 1000 * 5;
    Location mLastLocation;
    private GoogleApiClient mGoogleApiClient;
    private LocationRequest mLocationRequest;
    String lat, lon;


    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        Log.d("""", ""********************** onStartCommand()"");
        int permissionCheck = ContextCompat.checkSelfPermission(LocationService.this, Manifest.permission.ACCESS_FINE_LOCATION);

        if (permissionCheck == PackageManager.PERMISSION_GRANTED) {
            //Execute location service call if user has explicitly granted ACCESS_FINE_LOCATION..
            buildGoogleApiClient();
        }
        return super.onStartCommand(intent, flags, startId);
    }

    @Nullable
    @Override
    public IBinder onBind(Intent intent) {
        Log.d("""", ""********************** onBind()"");
        return null;
    }

    @Override
    public void onConnected(Bundle bundle) {
        Log.d("""", ""********************** onConnected()"");
//        Util.appendLog(""Location Service onConnected()"");
        mLocationRequest = LocationRequest.create();
        mLocationRequest.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);
        mLocationRequest.setInterval(INTERVAL);
        mLocationRequest.setFastestInterval(FASTEST_INTERVAL);
        LocationServices.FusedLocationApi.requestLocationUpdates(mGoogleApiClient, mLocationRequest, this);

        mLastLocation = LocationServices.FusedLocationApi.getLastLocation(
                mGoogleApiClient);
        if (mLastLocation != null) {
            lat = String.valueOf(mLastLocation.getLatitude());
            lon = String.valueOf(mLastLocation.getLongitude());

            Util.WriteSharePrefrence(getApplicationContext(), ""track_lat"", """" + lat);
            Util.WriteSharePrefrence(getApplicationContext(), ""track_lng"", """" + lon);

            Util.appendLog(""Location Service onConnected(): "" + "" Latitude: "" + lat + "" Longitude: "" + lon);
        }
    }

    @Override
    public void onConnectionSuspended(int i) {
        Util.appendLog(""Location Service onConnectionSuspended()"");
    }

    synchronized void buildGoogleApiClient() {
        mGoogleApiClient = new GoogleApiClient.Builder(this)
                .addConnectionCallbacks(this)
                .addOnConnectionFailedListener(this)
                .addApi(LocationServices.API)
                .build();

        mGoogleApiClient.connect();
    }

    @Override
    public void onLocationChanged(Location location) {
        Log.d("""", ""********************** onLocationChanged()"");
//        Util.appendLog(""Location updated Latitude: "" + location.getLatitude() + "" longitude: "" + location.getLongitude());
//        Toast.makeText(LocationService.this, ""Latitude: "" + location.getLatitude() + "" Longitude: "" + location.getLongitude(), Toast.LENGTH_SHORT).show();
        if (location != null) {
            Util.WriteSharePrefrence(getApplicationContext(), ""track_lat"", """" + location.getLatitude());
            Util.WriteSharePrefrence(getApplicationContext(), ""track_lng"", """" + location.getLongitude());
        }
//        stopSelf();
    }

    @Override
    public void onConnectionFailed(ConnectionResult connectionResult) {
        Util.appendLog(""Location Service onConnectionFailed()"");
        buildGoogleApiClient();
    }

    @Override
    public void onDestroy() {
        super.onDestroy();

        Util.appendLog(""Location servcie destroyed()"");
    }
}
</code></pre>

<p>In Manifest i have declared this service as below:</p>

<pre><code>&lt;service
            android:name="".util.LocationService""
            android:enabled=""true"" /&gt;
</code></pre>

<p>I am starting this every time when user launch the app in his/her device</p>

<pre><code> if (!isMyServiceRunning(LocationService.class, context)) {
                    context.startService(new Intent(context, LocationService.class));
}
</code></pre>

<p>Note: I am not stopping service from anywhere.</p>

<p>Issues: </p>

<ol>
<li>Location update in all big brand devices Like google nexus 5, gionee, One+, Samsung....but in some device location not updating when internet or wifi not available like honor, xolo....</li>
<li>Every time when device in outdoor or on driving <code>onLocationChanged()</code> method should be called and in <code>WriteSharePrefrence()</code> new updated latitude and longitude should be changed but it is not updating frequently in some of devices.</li>
<li>Is there anything wrong in my service ? There is no battery draining matter in my app.</li>
<li>Is there anything which is stopping my service ?</li>
<li>How to continue running location update service in background and getting accurate location update from user device frequently ?</li>
</ol>",android|location|fusedlocationproviderapi,410099,Himanshu,no
Java Android - Proper Way to create a Chat/Communication?,"<p>I were wondering what's the proper way to create a chat/communication software in Java for Android?</p>

<p>I guess it's a Socket (TCP/UDP).</p>

<p>If I do it my own way like using a web calls for PHP with backend scripts why it is not so appropriate way to create a chat? What's the difference between them? Using a calls instead of raw sockets? Does it use more battery or something? I just feel that sometimes it would be more easier to parse a JSON for messages and send data through web calls, but I feel that it's not a proper way to do so and application may have a critical issues like draining a battery or something which will make the project to be discontinued.</p>

<p>I would like to be sure is there any other ways to create a chat, than sockets and do every famous developers use a sockets as primary method for creating a communication software?</p>",java|android|chat|communication,6658924,Weird E.,yes
Why Android devices won't read NFC tags after a long sleep?,"<p>I'm sorry for my bad English.</p>

<p>I develop an Android app using NFC. I added a method that stops unsecured keyguards temporarily to the app for the purpose of quickly uses NFC tags.
However, I thought stopping keyguards causes battery drains when sleeping, so I added a method that recovers keyguards when devices are sleeping.</p>

<p>As a result, I wrote codes shown below.</p>

<pre><code>public class MainActivity extends Activity {

private NfcAdapter      mAdapter;
private PowerManager    mPowerManager;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // regist screen on / off actions receiver
    IntentFilter scFilter = new IntentFilter();
    scFilter.addAction(Intent.ACTION_SCREEN_ON);
    scFilter.addAction(Intent.ACTION_SCREEN_OFF);
    scFilter.addAction(Intent.ACTION_USER_PRESENT);
    registerReceiver(mScreenReceiver, scFilter);
}

@Override
public void onNewIntent(Intent intent) {
    super.onNewIntent(intent);

    String action = intent.getAction();
    if (action != null &amp;&amp; (action.equals(NfcAdapter.ACTION_TAG_DISCOVERED)
            || action.equals(NfcAdapter.ACTION_TECH_DISCOVERED)
            || action.equals(NfcAdapter.ACTION_NDEF_DISCOVERED))) {
        // manage NFC Tags here
        Log.d(""MainActivity"", ""NFC Tags detected"");
        Toast.makeText(getApplicationContext(), ""NFC Tags detected"", Toast.LENGTH_SHORT).show();
    }
}

@Override
public void onResume() {
    super.onResume();

    // enableForegroundDispatch
    if (mAdapter == null) { 
        mAdapter = NfcAdapter.getDefaultAdapter(getApplicationContext());
    }
    if (mAdapter != null) {
        Intent nfcIntent = new Intent(this, getClass());
        nfcIntent.addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP);
        PendingIntent pendingIntent = PendingIntent.getActivity(this, 0, nfcIntent, 0);
        mAdapter.enableForegroundDispatch(this, pendingIntent, null, null);
    } else {
        Log.d(""MainActivity"", ""failed getDefaultAdapter()"");
    }
}

@Override
public void onPause() {
    if (mPowerManager != null) {
        if (!mPowerManager.isScreenOn()) {
            // clearWindowFlags only when device is sleeping
            getWindow().clearFlags(WindowManager.LayoutParams.FLAG_DISMISS_KEYGUARD);
        }
    }

    // disableForegroundDispatch
    if (mAdapter != null) {
        mAdapter.disableForegroundDispatch(this);
        mAdapter = null;
    }

    super.onPause();
}

@Override
public void onDestroy() {
    try {
        // unregist screen on / off actions receiver
        unregisterReceiver(mScreenReceiver);
    } catch (IllegalArgumentException e) {
    }
    super.onDestroy();
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    return false;
}

private BroadcastReceiver mScreenReceiver = new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) {
        if (intent.getAction() == null) {
            return;
        }
        if (intent.getAction().equals(Intent.ACTION_SCREEN_OFF)) {
            getWindow().clearFlags(WindowManager.LayoutParams.FLAG_DISMISS_KEYGUARD);
        } else if (intent.getAction().equals(Intent.ACTION_SCREEN_ON)) {
            getWindow().addFlags(WindowManager.LayoutParams.FLAG_DISMISS_KEYGUARD);
        } else if (intent.getAction().equals(Intent.ACTION_USER_PRESENT)) {
        }
    }
};
}
</code></pre>

<p>But, this code didn't perform as intended on my device.
I use Nexus 7 (1st, OS 4.3, Slide lock enabled).</p>

<p>First, when I launched the app and put my device into sleep, keyguards didn't recover with a probability of 30%. It sounds read sound effects with NFC tags even when sleeping.</p>

<p>Second, my device rarely won't read NFC tags after about an hour sleep with using the app. It will not even sound anything with NFC tags. But the condition goes off after sleep again or terminating the app.</p>

<p>Who does know causes of the bugs?</p>",android|nfc|lockscreen,3035122,Danny Cot,no
How To Create Service In Android Which Makes Persist Xmpp Connection With XMPP Server?,"<p>After searching a lot on Internet we have came to one conclusion in order to ensure an <strong>persist</strong> connection with <strong>XMPP</strong> server we have to create a service,</p>

<p>We have created one  which uses Smack library to connect with <strong>XMPP</strong> server and it is working fine with mobile and wi-fi network.</p>

<p>Every time you make something design approach always matter!!!, Smack have this reconnection mechanism already implicitly implemented in there library which listen to connection and if connection drops Smack try to reconnect with <strong>XMPP</strong> server at some interval of time.</p>

<p>Our use case scenario::<br>
                       INTERNET connectivity can be because of wifi or data network,here if connection go is idle state of someone turn off screen cpu goes to sleep now any data is sent to server on this connection there will be no response because server is no more listening to client ,on client side <strong>XMPP</strong> connection is already in connected mode connection listener is not detecting any disconnection from server,so here flow gets completed.  </p>

<p>After searching on INTERNET we found that possible solution to solve this is to ping server after a fix (we are using 1 min as fix period),after ping fail detected ,we have implemented reconnection mechanism same as smack(idea taken from Smack reconnection mechanism itself)by making use of timer task.</p>

<p>Problem:: only problem we have is battery draining ,if user is still connected with INTERNET and reconnection interval increases it will drain batty.</p>

<p>1). What is the possible solution of above problem?</p>

<p>2). Should we have to take another approach?</p>",android|xmpp|asmack,3523641,Dev,no
How to change Android configuration of USB Host to autosuspend device without rooting,"<p>I am working on an app that communicates to a device connected through the usb port.</p>

<p>The communication is made using a serial converter from FTDI, the FTD 230x. I am using the driver D2xx.</p>

<p>The problem i am having is that, when the device is connected to an ACER tablet (Model - Iconia One 7 B1-730), if it enters in sleep mode the device is supended saving battery power, but if the device is connected to a Samsung Tablet (Model-TM116), when it enters the sleep mode the device doesnt go to suspend mode and keeps draining battery.</p>

<p>Accessing the android shell i could verify that at ""/sys/bus/usb/devices/usbX/power/control"" the Acer tablet is set to ""auto"", but on the Samsung it is set to ""on"". If i try to modify this value i get ""permission denied"".</p>

<p>Can i change this value without rooting the tablet, or is there a way to change the settings to turn on the autosuspend ?</p>",android|usb|root|suspend|usb-otg,5982895,Danniel Dias,no
Synchronization service,"<p>I'm trying to write a local (remote?) service whose only duty is to check, periodically, a remote set of URLs in order to see if some change occured (and, in this case, to update its own DB accordingly).</p>

<p>The reason why <code>SyncAdapter</code> isn't a possibile choise is that I can't use a <code>LoginManger</code>: I perform the login through a web form, to a third-party website (via SAML, to be precise), keeping the session using a set of cookies. No auth token, no infinite sessions. Thus, no <code>LoginManager</code>, and ultimately, no <code>SyncAdapter</code>.</p>

<p>On the other side, SyncAdapter handles a lot of things I would really like to do, but I don't know how: it fires the update process with a non-rigid schedule, but based on battery status, network signal strength, and so on. In this way synchronization is almost continuous, and if I got a mail, Gmail app notify it 3, maybe 4, seconds later.</p>

<p>I would like to write my own service, which allow users to have app DB updated (I don't care if it's immediately or twice a day, updates are rare but important, in fact), which doesn't cause battery drains, and also (if possible, not vital), which can be fired/stopped by a foreground activity.</p>",android|synchronization,1557941,Gian Segato,no
Impacts of using Firebase Analytics,"<p>I have been using Firebase Analytics for Android and iOS apps, but I still am not able to answer some questions:</p>

<ol>
<li>
How much data does Firebase Analytics send per day (considering an app that is used for work purposes during 8h/day)?
</li>
<li>
Does Firebase Analytics have any impact on the app performance or on the device (like battery draining)?
</li>
</ol>

<p>I have researched the Internet but still were not able to find any satisfactory answer. </p>

<p>I would like to know if there is any documentation that includes the measurements I am looking for or if someone has already measured these things by themselves.</p>",firebase-analytics,4991928,Ricardo Mendes,yes
running an NSTimer in the background of a multitasking iPhone app to turn location service on/off,"<p>i am attempting to make an app that records an accurate location every 10 minutes.</p>

<p>the problem with this is that when running is best mode, the battery drains really quickly.</p>

<p>i would like a timer to turn of the location service, have didUpdateToLocation get a good location, turn of location service and then wait for the timer again.</p>

<p>i have tried a million things- but my NSTimer always gets frozen when put in background mode.</p>

<p>interestingly, didUpdateFromLocation can turn location service off, and if you use significantChangeUpdate you can use didUpdateToLocation to turn location service back on when the user passes a triangulation boundry- and record locations to coredata-</p>

<p>so in theory the only thing stopping me getting this thing running is an NSTimer in a thread that doesnt get frozen, ever.</p>

<p>i read some documents that said you CAN do simple things in the background beyond VOIP, location, audio. does anyone have any experience getting a thread running that doesnt get frozen? i know everyone thinks it can't be done- from my research it is possible, but i just cant figure it out.</p>

<p>advice based on any experience getting a thread running in the background beyond VOIP, Audio, location would be much appreciated</p>

<p>thanks guys, dave-</p>",iphone|multithreading|background|location|nstimer,183063,dave,yes
GPS update interval is faster with good signal?,"<p>I'm trying to limit my program to take location updates every 10 seconds instead of constant updates in order to reduce battery drain. This works fine when i'm debugging indoors and the signal is weak (i.e. the GPS icon flashes), but if the phone gets a proper fix (i.e. the GPS icon is static) the update interval increases to roughly a second.</p>

<p>I know that the code <code>mLocationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, updateInterval*1000, 0, this);</code> will not force the GPS to take updates exactly at the given interval, but in my opinion it shouldn't depend on the strength of the signal and fluctuate that much.</p>

<p>Any ideas?</p>

<p>UPDATE: see comment</p>",android|gps|locationmanager,416022,onik,yes
Android WifiManager and Scanning Battery Performance,"<p>To my understanding, one can request the WifiManager to start an AP scan, which is great and you get scan results back, but my question is regarding the continuous wifi scan that happens under the hood.</p>

<p>Aside from unregistering the wifi listener for scan callback, is disabling the wifi the only way to stop the hardware from scanning? So if my device is connected to some Wifi BSSID/SSID it's ALSO constantly scanning? (Yes <a href=""http://www.androidauthority.com/community/threads/how-to-get-wifi-to-stop-scanning-after-connected.7760/"" rel=""noreferrer"">http://www.androidauthority.com/community/threads/how-to-get-wifi-to-stop-scanning-after-connected.7760/</a>) So if I request a scan while connected to some Wifi, it starts to constantly scan since there's no way to actually stop the scanning without turning off the hardware... at which point you lose connectivity with the Wifi Network, NOT acceptable.</p>

<p>Seems like an oversight from Google. Why didn't they just leave the hardware alone rather than make it constantly scan?! Unless provoked to start scanning, connect, disconnect, or stop scanning, DO NOT DO ANYTHING on your own... why didn't they implement it this way? My concern is battery drainage with continuous scanning... whether or not I have a listener is irrelevant. The fact that the hardware is constantly querying for nearby networks sounds pretty resource and battery intensive.</p>

<p>Is there anything one can do in this case without rooting?</p>",android|performance|wifi|battery,857303,DritanX,yes
iPhone: Battery functions?,<p>Are there Battery related API:s available in iPhone SDK? I want to find the battery draining state and other things related to battery from my application.</p>,iphone,187532,Getsy,no
Use of SuperpoweredAndroidAudioIO interface,"<p>I create SuperpoweredAndroidAudioIO for recording, and it starts working right away, which is fine. However, when I try to use the .onForeground() method when the android activity calls .onResume() it causes a crash... Even if I call onBackground() during onPause().</p>

<p>I also never call start()/stop(), and things seem to work find without calling any of these methods. I can't tell if it's draining battery, and why the methods fail or aren't seemingly needed.</p>

<p><a href=""http://superpowered.com/docs/_superpowered_android_audio_i_o_8h_source.html"" rel=""nofollow noreferrer"">http://superpowered.com/docs/_superpowered_android_audio_i_o_8h_source.html</a></p>

<p>How should I be using these appropriately?</p>",android|superpowered,502360,Joel,yes
Use Google Fit to store raw accelerometer data,"<p>I've been experimenting with querying raw accelerometer data from an Android Wear (Moto360) watch but it seems to drain too much battery (about 15% per hour). Presumably this is because the Moto360 does not support batching of sensor data. I was wondering if the Google Fit Sensor's API can be used to intelligently store accelerometer data (x,y,z) in the Fitness Store. So far I've only come across storing activity types and not raw sensor data. I am looking for a battery efficient solution.</p>",wear-os|android-sensors|google-fit,2178486,VarsMolta,yes
Android: Widget updating a clock with custom images as numbers,"<p>What way is most efficient for updating an widget that will be a clock(Timer/Alarm), but for a clock to really works, like a clock it would be needed to update at least twice in a minute (30 sec period or less). </p>

<p>But that can't be effective? Have looked at some of the ""threads/topics"" here at StackOverFlow but haven't found any information regarding effectiveness. </p>

<p>(Don't own an android device yet, so I can't really test battery draining and cpu)</p>",android|bitmap|widget|clock,427599,HumLe,yes
CAEmitterLayer draining battery,"<p>My project deals with IOS 12+ iPhones and i am using fire emitter to follow the finger of the user across the screen (with a pan gesture recogniser). When using the following code, i have noticed that the screen becomes warmer the game is played and it tends to drain battery more rapidly than usual the more the app is used. </p>

<p>Is there any particular to have a fire emitter for following a finger on the screen and yet have a battery friendly solution? </p>

<pre><code>//set ref to the layer
 cursorEmiter = [CAEmitterLayer layer];

//configure the emitter layer
cursorEmiter.emitterPosition = CGPointMake(50, 50);
cursorEmiter.emitterSize = CGSizeMake(5, 5);
CAEmitterCell* fire = [CAEmitterCell emitterCell];


fire.birthRate = 1000; // The number of emitted objects created every second. Animatable
fire.lifetime = 0.6; // The lifetime of the cell, in seconds. Animatable
fire.lifetimeRange = 0.5;

fire.color = [[UIColor colorWithRed:1.0 green:0.4 blue:0.2 alpha:0.3]
              CGColor];

fire.contents = (id)[[UIImage imageNamed:@""PopCornSmall.png""] CGImage];

fire.velocity = 10; // The initial velocity of the cell. Animatable
fire.velocityRange = 20;
fire.scaleSpeed = 0.3;
fire.spin = 0.5;
cursorEmiter.renderMode = kCAEmitterLayerAdditive;

[fire setName:@""fire""];

//add the cell to the layer and we're done
cursorEmiter.emitterCells = [NSArray arrayWithObject:fire];
emiterNotAdded = false;
[(CAEmitterLayer *)self.layer addSublayer: cursorEmiter];
</code></pre>",ios|objective-c|iphone|xcode,1172417,stephane,no
Android - Keep Service Running to keep Data in Storage,"<p>İ have  an Android App, with a Widget, which accesses Data from Storage. The Data is cached in Memory during App runtime, but when it comes to the widget, it always has to access Fata from storage, not from Memory, because the Application properly stops. </p>

<p>Because the Application completely finishes and will be restarted, each time some calculations are done and alarms are set. </p>

<p>The widgets are updated each Minute (when screen is on), because it shows the time. This from time to time causes some battery drain, which I am trying to prevent. </p>

<p>I am thinking of keeping a service running, only to keep the Memory cache and alarms alive?</p>

<p>Is this a good idea? Or does anybody have a better idea? </p>

<p>Thank you in advance... </p>",android|caching|memory|service|storage,1988378,metinkale38,no
What are the ways to update an UI in android other than SharedPreferences and Services?,"<p>I would like to update the UI using the data which I don't want to be stored in SharedPreferences(as it is local) and also don't want it to be handled by the Services(as it may consumes lot of resources, drains battery, etc.,).</p>

<p>As intent may not provide so much functionalities as the SharedPreferences framework provide, I would like to if there is any alternatives for updating the UI than SharedPreferences, Services and Intents. </p>",android|service|sharedpreferences|storage,3959147,Senthilkumar S,no
Android - CPU usage and Battery drain,"<p>I have some navigation application, I want to know how different sample rate of sensors in my app impacts on battery drain.
I make several tests using: <code>adb shell dumpsys cpuinfo</code> command. 
Results(accelerometer and gyro):</p>

<p>0Hz - cpu usage is: 17%</p>

<p>15Hz - cpu usage is: 20%</p>

<p>100Hz - cpu usage is: 23%</p>

<p>How i can know from CPU usage, how much battery life is reduced?(for example if i use my app for 1 hour)</p>",android|performance|cpu-usage,2715054,phnmnn,no
Android Message Queue RabbitMQ vs. ZeroMQ for RPC style actions?,"<p>I am trying to figure out which is the best solution for a mobile android device for sending ""rpc"" style calls. These are basically database queries that will return information that i will serialize into java objects. Because this will be over the WAN i need something with some type of security (SSL/TLS should be fine..) but i am still not 100% sure which approach to take.</p>

<ol>
<li><p>ZeroMQ
Basically take this, use the ZMQCurve security library and build an RPC style system from scratch?</p></li>
<li><p>RabbitMQ AMPQ
Do this with some type of SSL wrapper and have RPCStyle with the reply-to header field set?</p></li>
<li><p>RabbitmQ STOMP</p></li>
</ol>

<p>Do this with some type of wss and RPC style semantics over the websocket.</p>

<p>The main thing i am looking for is</p>

<ol>
<li><p>something that can handle a lot of requests, can be distributed.</p></li>
<li><p>Something that is not going to kill the battery on the mobile device.</p></li>
</ol>

<p>I think the most important feature i am looking for is some way for the device to complete a SSL handshake 1 time with the message broker (or zeromq load balancer) and have a socket open... but no keepalive. This way I can always send requests from the device to the server, wait for my response (async) and then once the response is completed do not send keep alives or use the battery in any draining way. But, i do not want to have to do a handshake everytime i send a message.</p>

<p>What paradigm would sound best? What system? Is a REST approach possibly the best?</p>",android|rest|rabbitmq|zeromq|rpc,3554230,user3554230,yes
"telegram ,whatsapp, viber tcp connection","<p>I was analyzing chat application like telegram or whatsapp. as you know they are using a tcp connection to server.
the big problem of tcp connection is that when there is any issue in internet connection the xmpp client will be disconnected from server without telling server that i am disconnected and tcp connection will be open from server and message will be lost.</p>

<p>So one way for client and server to understand connection is lost is using ping .that is we set a time for server and client to ping each other and if connection is lost retry to connect. and again main problem of this solution is that it drains a lot of battery charge if for example we set client to ping each 10 second and if we set server to ping user each 40 second it will put a lot of load on server when we are dealing with lots of user.</p>

<p>But telegram and whatsapp doesn't have this problem because they will understand the tcp connection is lost up to 30 second and telegram is even faster and it will know in 4 or 5 second.</p>

<p>My problem is that i dont think whatsapp or telegram are using ping system actually pinging server each 10 second because it will drains battery.</p>

<p>What is your idea ? are they using ping system or they have found any solution for it.</p>

<p>I would be very thankful if anybody explain me how they are doing that</p>",android|networking|tcp|xmppframework|whatsapp,3503159,user3503159,yes
What is the performance cost of calculating values in onDraw vs reading them from memory when drawing on android canvas?,"<p>When I optimize my android app is it worth it to move all calculations from <code>onDraw()</code> to for ex.<code>onSurfaceChanged()</code> and store calculated values?
For example I got:</p>

<pre><code>onDraw(...){
...
canvas.drawText(text,
                    mBounds.left+ mLineXOffset,
                    mBounds.top + mLineYOffset,
                    mTextPaint);
</code></pre>

<p>Will it be much difference in terms in battery drain if I pre calculate all absolute values in <code>onSurfaceChanged()</code>?</p>

<p>Edit: in this case onDraw is probably called few times a second and app is always ""screen on"".</p>",java|android-activity|android-canvas|android-view,1016772,Lord_JABA,no
Use of Standard location service for tracking traveled distance in a foreground/background app,"<p>I have to develop a kind of GPS navigation application that needs to constantly keep track of the position of the user, which is moving by car.
In the specific, I don't have to display the current location on a map but just to record its position with the best possible precision in order to calculate the total distance traveled.</p>

<p>Of course the application needs to continue its work in background if the user switch to another app, a phone call come in or something like that…</p>

<p>From the tests I have made and from what I have learned from this <a href=""https://stackoverflow.com/questions/3421242/behaviour-for-significant-change-location-api-when-terminated-suspended"">useful post</a> (and from the <a href=""https://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4"" rel=""nofollow noreferrer"">documentation</a>), it seems to me that the best choice in this case is the <strong>Standard location service</strong>, with the application configured with the <strong>UIBackgroundModes = location</strong> in the .plist file.
In this way it will continue to receive the location updates even if in background and it will never be suspended by the OS (this is actually true only if [locationManager startUpdatingLocation] has been called). This is also confirmed by <a href=""https://stackoverflow.com/questions/6284504/ios-4-application-lifecycle-behavior-of-standard-location-service-running-in-bac"">this guys</a>.
I have personally verified that is true simply by running the app with Instruments and the Memory monitor module where you can see the various flags about the app states, putting the app in background first with UIBackgroundModes set to location and startUpdatingLocation active, and after without it.</p>

<ul>
<li>1) I'm now wondering <strong>what to do when the app is terminated when it is tracking the position</strong>. I don't want to loose any location updates so I need to wake up it again whenever a new update is available.
The documentation say:</li>
</ul>

<blockquote>
  <p>Important: The applicationWillTerminate: method is not called if your
  app is currently suspended.</p>
</blockquote>

<p>But because in my case it will be never suspended (it will stay in background but not suspended), my logical conclusion is that applicationWillTerminate will be always called and so I could register for a Significant location update or Region monitoring inside of this method in order to be waked up and then restart the Standard location service.
<strong>Is applicationWillTerminate the right place to put this code?</strong> </p>

<ul>
<li><p>2) An application working in background but not suspended could be terminated by the OS for no other reasons than a very low memory condition or for my app don't properly respond to a memory warning? (the user could also manually close it). I was concerned if applicationWillTerminate wouldn't be called in some way.</p></li>
<li><p>3) Could Apple not approve an app which constantly use the standard location services in background because of its quick battery drain?
Have you ever had approve problems for similar apps?</p></li>
</ul>",iphone|ios5|gps|core-location|multitasking,244250,ggould75,yes
Android AlarmManager Issue - Samsung Device,"<p>I'm trying to run a service for every 1 minute using AlarmManager with PendingIntent. With the use for setInexactRepeating function, i can able to run the service in all mobiles except <strong>Samsung Device</strong>, as far i tested till now.</p>

<p><strong>Case 1: Android 5.1</strong> - Below code runs every 1 Min in Samsung Device and later stage it turns to 5 mins interval</p>

<p><strong>Case 2: Android 6.0</strong> - Below code runs every 5 mins in Samsung Device and later stage it remains same</p>

<pre><code>alarmMgr.setInexactRepeating(AlarmManager.RTC_WAKEUP, 1, 1000 * 60, alarmIntent);
</code></pre>

<p><strong>Samsung Android 5.1 - Log</strong></p>

<pre><code>04-17 15:53:06.856 12381-13117/com.example.android.scheduler D/LL_LOG: loadFromNetwork
04-17 15:54:16.291 12381-13949/com.example.android.scheduler D/LL_LOG: loadFromNetwork
04-17 15:55:00.036 12381-14679/com.example.android.scheduler D/LL_LOG: loadFromNetwork
04-17 15:56:01.121 12381-15660/com.example.android.scheduler D/LL_LOG: loadFromNetwork
04-17 15:57:16.591 12381-16773/com.example.android.scheduler D/LL_LOG: loadFromNetwork
04-17 15:58:23.066 12381-17318/com.example.android.scheduler D/LL_LOG: loadFromNetwork
04-17 16:01:14.366 12381-19279/com.example.android.scheduler D/LL_LOG: loadFromNetwork
04-17 16:06:13.901 12381-25377/com.example.android.scheduler D/LL_LOG: loadFromNetwork
</code></pre>

<p><strong>Samsung Android 6.0 Log</strong></p>

<pre><code>04-17 15:27:18.621 12920-31956/com.example.android.scheduler D/LL_LOG: loadFromNetwork
04-17 15:32:18.681 12920-5003/com.example.android.scheduler D/LL_LOG: loadFromNetwork
04-17 15:37:18.651 12920-9665/com.example.android.scheduler D/LL_LOG: loadFromNetwork
04-17 15:42:18.641 12920-10642/com.example.android.scheduler D/LL_LOG: loadFromNetwork
04-17 15:47:18.831 12920-11739/com.example.android.scheduler D/LL_LOG: loadFromNetwork
04-17 15:52:18.741 15868-15882/com.example.android.scheduler D/LL_LOG: loadFromNetwork
04-17 15:57:18.661 15868-17146/com.example.android.scheduler D/LL_LOG: loadFromNetwork
</code></pre>

<p>Notes: As said here (<a href=""https://stackoverflow.com/questions/35380310/alarmmanager-not-working-on-samsung-devices-in-lollipop"">AlarmManager not working on Samsung devices in Lollipop</a> &amp; <a href=""https://stackoverflow.com/questions/34074955/android-exact-alarm-is-always-3-minutes-off/34085645#34085645"">Android exact Alarm is always 3 minutes off</a>) i have turned of APP Optimization.Still my issue remains same.</p>

<p>Im expecting to solve this or any alternatives to run service same way without battery drain.</p>",android|android-service|alarmmanager|samsung-mobile|repeatingalarm,934969,Parthi04,no
Sound effect on Android live wallpaper,"<p>Can Android live wallpaper create sound effects based on the touch of users? </p>

<p>I don't see alot of live wallpaper with sound effects out on the market. Is there a reason for it? For e.g, battery drain or other programming issues?</p>",android|audio|wallpaper,3895620,Silent_Hill,no
Android - Fused location with balanced profile,"<p>in my application i need to track the position of my device. The localization must run in a long life background service (it extends android.app.Service).
I need a good tradeoff between accurancy (in meters) and battery usage. The accurancy of my application is around 40-50 meters.
I found a documentation that with the new fused location the location system (GPS, wifi tracking and so on) improve accurancy and battery drain.</p>

<p><a href=""http://www.intelligrape.com/blog/2014/07/17/googles-fused-location-api-for-android/"" rel=""nofollow"">http://www.intelligrape.com/blog/2014/07/17/googles-fused-location-api-for-android/</a></p>

<p>In particular i focused on the balanced profile (accurancy around 40 m based on wifi and cellular cells). The documentation shows that the % usage of the battery should be 0.6% per hour.
My test cases show a usage around 4% per hour.</p>

<p>Here an example of my code:</p>

<pre><code>_locationRequest = LocationRequest.create();
_locationRequest.setPriority(LocationRequest.PRIORITY_BALANCED_POWER_ACCURACY);
_locationRequest.setInterval(60 * 1000);
LocationServices.FusedLocationApi.requestLocationUpdates(_googleApiClient, _locationRequest, this);
</code></pre>

<p>and the AndroidManifest.xml</p>

<pre><code>&lt;uses-permission android:name=""android.permission.ACCESS_FINE_LOCATION"" /&gt;
&lt;uses-permission android:name=""android.permission.INTERNET"" /&gt;
&lt;uses-permission android:name=""android.permission.READ_PHONE_STATE"" /&gt;
</code></pre>

<p>Since the documentation shows an usage (BALANCED_POWER 20 seconds 0.6% ~40 meters) and since my application uses BALANCED_POWER 60 seconds, why my application (based on my test) seems to drain so much? What i'm wrong?</p>

<p>Thanks in advance</p>",android|location|battery,4241199,EmbeddedLab,yes
iOS 9 Defer location update not working,"<p>Hi recently with the iOS 9 GM seed version out,I have seen location update(allowDeferredLocationUpdatesUntilTraveled:timeout:) not getting deferred. I am getting error kCLErrorDeferredFailed - The location manager did not enter deferred mode for an unknown reason.</p>

<p>Its because of this error its not entering the defer mode at all and location updates are firing continuously .
The same code used to work in iOS 8.4 and below versions.Its draining my device's battery by a huge percentage.
Is there anything we need to explicitly set or mention for iOS 9.Didn't find anything from Apple documentation?</p>

<pre><code>  -(void)locationManager:(CLLocationManager *)manager
didUpdateLocations:(NSArray *)locations {

  if (!self.deferringUpdates) {

  [self.locationManager allowDeferredLocationUpdatesUntilTraveled:CLLocationDistanceMax timeout:30];
   self.deferringUpdates = YES;
 } 
}

-(void)locationManager:(CLLocationManager *)manager
didFinishDeferredUpdatesWithError:(NSError *)error {
  // Stop deferring updates
  self.deferringUpdates = NO;

 }
</code></pre>

<p>I also set the allowsBackgroundLocationUpdates property but even that didn't help.</p>

<pre><code>      self.locationManager.allowsBackgroundLocationUpdates=YES;
</code></pre>

<p>In iOS 9 and later, regardless of deployment target, you must also set the allowsBackgroundLocationUpdatesproperty of the location manager object to YES in order to receive background location updates. By default, this property is NO, and it should remain this way until a time when your app actively requires background location updates.</p>

<p><a href=""https://developer.apple.com/library/prerelease/ios/documentation/Performance/Conceptual/EnergyGuide-iOS/LocationBestPractices.html"" rel=""nofollow"">Reduce Location Accuracy and Duration</a></p>

<p>Please let me know what additional I need to make </p>

<p>Thanks</p>",ios|core-location|ios9,2592763,IOSDevops,no
How Android O affect background service to reduce battery drain?,"<p>I create a <code>service</code> that start a new <code>thread</code> to do stuff. In <strong>Android O</strong>, the android document said if the <code>service</code> is not a <code>foreground service</code>, then it will be stopped by the system. But I tested the following code, the <code>service</code> is destroyed but the <code>thread</code> is still running.</p>

<p>My question is how the system can save user's battery if the thread is allowed to be run even if the <code>service</code> is stopped?</p>

<p><strong>MainActivity</strong></p>

<pre><code>public class MainActivity extends AppCompatActivity {

  @Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
  }

  public void startService(View view) {
    Intent intent = new Intent(this, MyService.class);
    startService(intent);
  }

  public void stopService(View view) {
    stopService(new Intent(this, MyService.class));
  }

}
</code></pre>

<p><strong>MyService</strong></p>

<pre><code>public class MyService extends Service {

  @Nullable
  @Override
  public IBinder onBind(Intent intent) {
    return null;
  }

  @Override
  public int onStartCommand(Intent intent, int flags, int startId) {
    new Thread(new Runnable() {
      @Override
      public void run() {
        while (true) {
          try {
            Thread.sleep(1000);
          } catch (InterruptedException e) {
            e.printStackTrace();
          }
          System.out.println(""run in service: "");
        }
      }
    }).start();

    return START_NOT_STICKY;
  }

  @Override
  public void onDestroy() {
    super.onDestroy();
    System.out.println(""service onDestroy"");
  }

}
</code></pre>",android|service|android-8.0-oreo,3663635,jaychang0917,no
How to implement push notification in Nokia Series 40 using Nokia Java SDK 2.0?,"<p>I want my app to be able to receive notification from the server while it is running in the background. I don't like pooling, that will drain user's battery since I need almost realtime response, does Series 40 support that?</p>",java-me|push-notification|nokia-s40,915147,imgen,no
How to check processes and services consuming lots of battery,"<p>I have created an app which consuming 48 percent of battery in some device which is highest in power management task, but in some device its 5-6 %, i am running a service in background all the time which fetches the latitude and longitude and send it on server if user is logged in. but i have checked also check by logging out from app it still consumes 48 percent.</p>

<p>to fetch latitude and longitude o am using fused location api.</p>

<p>So please tell me how to resolve this issue of battery consumption in some phone and how to check which process and service is draining battery.</p>",android|service|gps|battery|android-fusedlocation,5023302,Android,yes
How to update relative time in recyclerview?,"<p>I have a RecyclerView that displays items with a title, text and last edit time.
<a href=""https://i.stack.imgur.com/qBHff.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/qBHff.png"" alt=""enter image description here""></a></p>

<p>In the RecyclerView adapter's onBindViewHolder I use <code>getRelativeTimeSpanString</code> and compare the note object's time to current time:</p>

<pre><code>@Override
public void onBindViewHolder(@NonNull ViewHolder holder, int position) {
    Note note = getItem(position);
    holder.title.setText(note.getTitle());
    holder.text.setText(note.getText());

    String s = DateUtils.getRelativeTimeSpanString(note.getTime(), 
    System.currentTimeMillis(), 0L, DateUtils.FORMAT_ABBREV_ALL).toString();
    holder.timestamp.setText(s);
}
</code></pre>

<p>If I just added the item, it says ""0 sec ago"". How do I update that over time? </p>

<p>While writing this question, SO suggested this question: <a href=""https://stackoverflow.com/questions/3209000/updating-the-relative-time-in-android"">Updating the relative time in android</a> , however I don't think updating the RecyclerView every X seconds is the  the best idea:</p>

<ol>
<li>it drains battery</li>
<li>it updates items that don't need updating (e.g.,
last update was 6 hours ago, but it's updating <code>holder.timestamp</code>
every X seconds)</li>
</ol>

<p>Is there a more efficient way to accomplish this?</p>",java|android|android-recyclerview|android-dateutils,4673960,Akres,no
Ongoing notification that gets updated every instance,"<p>In my application, I want to implement an always updating ongoing notification, like an alarm clock running in the notification center.   </p>

<p>I tried to make a service that runs every minute to update the time in the notification center, but sadly I found it not efficient enough as it drains the battery a lot!    </p>

<p>What's the most efficient solution to make an always updating notification that doesn't drain the battery?<br>
Thank you!     </p>

<p>Codes:   </p>

<p>Service:   </p>

<pre><code>public class MyService extends IntentService {
    MyClass MyClass;
    public PrayerTimeAlarmService() {
        super(""PrayerTimeAlarmService"");
        // TODO Auto-generated constructor stub
    }

    @Override
    protected void onHandleIntent(Intent in) {
        // TODO Auto-generated method stub
        if(MyClass == null){
            MyClass = new NextSalah(this);
        }
        MyClass.updatenotification();
    }

}
</code></pre>

<p>The Update Void:</p>

<pre><code>public updatenotification(){
        title = GetTitle();/*the title is dynamically generated based on complex codes*/
        timediff = GetTimeDiff(title);/*joda time period and stuff calculations*/
        NB.setContentTitle(title);
        NB.setContentText(timedif);
        NB.setSmallIcon(R.drawable.ic_launcher);
        Notification not = NB.build();
        not.flags = Notification.FLAG_ONGOING_EVENT;
        NotificationManager notificationManager = (NotificationManager) ctx.getSystemService(Context.NOTIFICATION_SERVICE);
        notificationManager.notify(071527/*Just a random integer*/ , not);
}
</code></pre>",java|android|android-service|android-notifications,2373629,Jamil Hneini,no
How to fix extreme battery drain with NotificationListener service,"<p>I need to check the current unread notifications for my app and I was using a notification listener service to do this. However this solution seems to continually check for notifications in the background causing huge battery drain issues, 23% background drain overnight to be precise. Is there a way for me to get the active notifications only when the phone is in a certain state (specifically the lock screen)</p>

<pre class=""lang-java prettyprint-override""><code>public class NotificationListener extends NotificationListenerService {

class CancelNotificationReceiver extends BroadcastReceiver {

       @Override
       public void onReceive(Context context, Intent intent) {
           String action;
           if (intent != null &amp;&amp; intent.getAction() != null) {
               action = intent.getAction();
               if (action.equals(ACTION_NLS_CONTROL)) {
                   String command = intent.getStringExtra(""command"");
                   if (TextUtils.equals(command, ""cancel_last"")) {
                       if (mCurrentNotifications != null &amp;&amp; mCurrentNotificationsCounts &gt;= 1) {
                           StatusBarNotification sbnn = getCurrentNotifications()[mCurrentNotificationsCounts - 1];
                           cancelNotification(sbnn.getPackageName(), sbnn.getTag(), sbnn.getId());
                       }
                   } else if (TextUtils.equals(command, ""cancel_all"")) {
                       cancelAllNotifications();
                   }
               }
           }
       }

   }

   @Override
   public void onCreate() {
       super.onCreate();
       logNLS(""onCreate..."");
       IntentFilter filter = new IntentFilter();
       filter.addAction(ACTION_NLS_CONTROL);
       registerReceiver(mReceiver, filter);
       mMonitorHandler.sendMessage(mMonitorHandler.obtainMessage(EVENT_UPDATE_CURRENT_NOS));
   }

   @Override
   public void onDestroy() {
       super.onDestroy();
       unregisterReceiver(mReceiver);
   }

   @Override
   public IBinder onBind(Intent intent) {
       // a.equals(""b"");
       logNLS(""onBind..."");
       return super.onBind(intent);
   }

   @Override
   public void onNotificationPosted(StatusBarNotification sbn) {
       updateCurrentNotifications();
       logNLS(""onNotificationPosted..."");
       logNLS(""have "" + mCurrentNotificationsCounts + "" active notifications"");
       mPostedNotification = sbn;

   }

   @Override
   public void onNotificationRemoved(StatusBarNotification sbn) {
       updateCurrentNotifications();
       logNLS(""removed..."");
       logNLS(""have "" + mCurrentNotificationsCounts + "" active notifications"");
       mRemovedNotification = sbn;
   }

   private void updateCurrentNotifications() {
       try {
           StatusBarNotification[] activeNos = getActiveNotifications();
           if (mCurrentNotifications.size() == 0) {
               mCurrentNotifications.add(null);
           }
           mCurrentNotifications.set(0, activeNos);
           mCurrentNotificationsCounts = activeNos.length;
       } catch (Exception e) {
           logNLS(""Should not be here!!"");
           e.printStackTrace();
       }
   }

   public static StatusBarNotification[] getCurrentNotifications() {
       if (mCurrentNotifications.size() == 0) {
           logNLS(""mCurrentNotifications size is ZERO!!"");
           return null;
       }
       return mCurrentNotifications.get(0);
   }
}
</code></pre>",android|battery|notification-listener,8212911,Brandon Shihabi,no
Options on Android for real time sending of data to a server?,"<p>I am currently working on a small scale project to prove something works, I currently have a smart band device which has an Android SDK.</p>

<p>From this device I use the SDK to track a users heart rate in real time.</p>

<p>So my Android application receives updates to the heart rate in real time.</p>

<p>This was fairly easy to do however I now need to send this data in real time from the Android device to the server as efficiently as possible.</p>

<p>To start with battery drain is OK as initially this is just a proof of concept.</p>

<p>I have limited experience with sending large amounts of data to a server in real time and I was wondering if anyone has an ideas on what might be the best approach on Android?</p>

<p>I have looked into Sync Adapters but these seem to be more about keeping data aligned between the client and the server, this is something I am not concerned about. Another approach would be to see if the RequestQueue from Volley might work but again I am unsure if looking into this is even worthwhile?</p>

<p>Should I be looking into creating a Service and somehow using a socket to transfer the data?</p>

<p>EDIT: It looks like IntentService may be the best option for handling the task execution but I am assuming http requests would be too heavy for the client and I should look into something else for the transfer?</p>",android|networking|real-time,243999,Donal Rafferty,yes
Using Hardware layer for android WebView will drain battery too much?,"<p>On some stack overflow threads I found that using hardware layer for android WebView will increase its performance. So currently I am using hardware layer for WebView.
But one of the user of my app is complaining about draining battery too much fast. Will hardware layer impacts battery performance? If yes, then we have to use it or not for android WebView? If we should't use it, then what about WebView performance? Will performance degrade?</p>",android|android-webview,12182265,Chaitanya Karmarkar,yes
How to use FusedLocation API to monitor location updates when app is not active,"<p>The FusedLocation API is newer than LocationManager API, but it is not clear to me when to use one vs the other. I want to monitor location changes even when the user is not running the app.</p>

<p>I found this nice <a href=""http://android-developers.blogspot.com/2011/06/deep-dive-into-location.html"" rel=""nofollow"">example using the LocationManager</a> but this is from 2011. Is this information still relevant? </p>

<p>The FusedLocation API examples show how to configure a LocationRequest for continuous location updates in your Activity. My question is, how would you use it to monitor location changes when your Activity is not running?</p>

<p>I've seen other examples that use Alarm Manager, but this is basically polling and seems like overkill and might drain the battery (but maybe I am wrong?).</p>",android|android-location|android-fusedlocation|android-broadcastreceiver,5307047,sidecarcat,yes
Allow Android app to be garbage collected sooner?,"<p>I am writing an app that has audio playing throughout the duration of the app being open.  I notice that during my testing phase my battery is draining much faster than without my app on the phone.  This may be due to the amount of audio files in the app (the app ends up being 25-35 mb) or the Broadcast Receivers still being registered and taking up some computation power when the app is no longer needed.</p>

<p>My question is (and I know there is no universal ""Close App"" method) how can I put the entire app on the bottom of the stack, next in line for the garbage collection?</p>

<p>Thanks</p>",android|garbage-collection|broadcastreceiver,483709,adamacdo,yes
how to analyze threads in eclipse blackberry project?,"<p>I am creating a multithreaded application.. but it drains battery. whether i want to check what are the threads running and memory leaks etc..</p>

<p>is there any tool or plugin to check thread activity in my eclipse for blackberry application..</p>

<p>sorry for asking this here, please guide me where to post such questions and tell me solution for this..</p>",multithreading|eclipse|blackberry,287721,udhaya,yes
iOS: Monitoring Battery Level uses more battery? Should auto-save?,"<p>I have a GPS app that already uses a fair amount of battery. Because of the nature of the app, I don't want the user to loose all of their data if their battery dies without them knowing it.  So, I figured I would monitor the battery and then save and stop the GPS data if the battery is very low.  I would use:</p>

<pre><code>[[UIDevice currentDevice] setBatteryMonitoringEnabled:YES];

[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(batteryStateDidChange:)
                                             name:UIDeviceBatteryStateDidChangeNotification
                                           object:nil];

[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(batteryLevelDidChange:)
                                             name:UIDeviceBatteryLevelDidChangeNotification
                                           object:nil];
</code></pre>

<p>So, a few questions:</p>

<ul>
<li><strong>Would monitoring the battery cause even MORE battery drain?</strong></li>
<li><strong>Is it a good idea to auto-save (core-data) for the user right before the battery dies?</strong></li>
</ul>",iphone|ios|cocoa-touch|core-data|uidevice,144695,Nic Hubbard,no
Make setMyLocationEnabled only get location once,"<p>I use the following line to make sure that my map displays the current position of the device and a button that centers the camera on that location</p>

<pre><code>mMap.setMyLocationEnabled(true);
</code></pre>

<p>Which is pretty standard stuff, however this means that the app keeps firing location requests draining battery. In my use case this is not needed, only checking the location once per onResume is enough.</p>

<p>I am however unable to find a solution for this. I can create a LocationRequest and make it only update once (see below) but this does not seem to apply to the setMyLocationEnabled function. </p>

<pre><code>mLocationRequest = LocationRequest.create();
    mLocationRequest.setInterval(15000)         // 15 seconds
            .setFastestInterval(16)    // 16ms = 60fps
            .setNumUpdates(1)
            .setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);
</code></pre>

<p>I know I can set setMyLocationEnabled to false but this also removes the current location from the screen which I don't want. </p>",android|google-maps,4314844,Rekijan Kileren,no
"display time on iphone, is there a better way than Timer?","<p>i'm looking at displaying the current time in HH:mm format, and ive been checking around for the best way to do this.</p>

<p>Most examples have a Timer being executed every second, updating a textlabel for example.</p>

<p>Now, i'm imagining that this might drain a bit of battery if it's to run every second, which seems like overkill if all i'm displaying is hours and minutes. On the other hand, i don't want the minute-switch to happen 30 seconds later than the actual minute switch...</p>

<p>Is there some way to get a call when the phone clock changes minute or something like that?</p>",iphone|objective-c|timer,917748,Mathias,no
SmartWatch Battery stats?,"<p>How do I read the battery status of the SmartWatch? (Not of the host, but of the watch itself!) That's needed, since an app can have the screen always on, and drain the battery, so I want to display at least some kind of warning.</p>

<p>Thanks!</p>",sony|sony-smartwatch,963022,Eir,yes
"notification , Server to Client","<p>I was developing an android app and a server that serve this apps. The server was coded in cakePHP. I want the app to have a notification from the server when there is an update on whatever things. Is this notification function a Server to client connection ? For example the facebook , whatapps and other social app in smart phone that could receive notification when someone send you a message, tagged you etc.</p>

<p>What is the proper way of doing this? I just need an idea to start. I see someone suggesting to open a long establish connection from client to check whether there is an update, but this would drain the phone battery.</p>

<p>If it's a Server to client connection, how would the server know where to find the client? </p>",android|cakephp,2535051,June Leow,no
Geolocalisation of multiple devices android,"<p>I am currently making an app that requires me to geolocalize multiple devices on the same map. The user clicks on an imageview, a new Activity pops up and a map is shown with the position of all of the app users. However after looking through the web I didn't find anything helpful.</p>

<p>I was wondering what was the better solution : </p>

<p>1) Each time a user starts the ""MapsActivity"" it triggers notifications to each user so it can request its position
2) Every 30 seconds each user's position is updated in a database and each time a user starts the ""MapsActivity"" it sends a query to the database => This solution might drain the battery ...</p>

<p>Thanks for your help</p>",java|android|geolocation,1185458,mfahem,yes
Getting previous activity in Activity Recognition,"<p>I am designing an app which requires to get the activities using activity recognition.But i am new to android.And now i can implement and get results of activities but i have some questions here.I have completed the code.if any one answers these questions it will be very useful to me.</p>

<ol>
<li>Is there any time interval(to get updates) which is accurate and enough (not to drain the battery and getting good results).</li>
<li>how to get previous activity (here i want to compare the current activity with previous activity).</li>
</ol>",android|activity-recognition,3860537,Niranjan,yes
Starting xmobar with keyboard shortcut after xmonad start,"<p>I'm trying to configure xmonad again witout any Haskell knowledge...</p>

<p>I would like to find a way to start xmonad without any statusbar at the beginning. I want to avoid running xmobar in the background
and drain battery. 
Then, when pressing meta-b xmobar should be started.
Does anyone know a keyboard shortcut definition for the xmonad config file
that starts xmobar and connect the pipes? </p>

<pre><code>  ...  
  xmproc &lt;- spawnPipe ""xmobar ~/.xmonad/xmobar.hs""
  xmonad $ defaults  {
      logHook = dynamicLogWithPP $ xmobarPP {
            ppOutput = hPutStrLn xmproc
          , ppTitle = xmobarColor xmobarTitleColor """" . shorten 100
          , ppCurrent = xmobarColor xmobarCurrentWorkspaceColor """"
          , ppSep = ""   ""
      } 
  ...
</code></pre>

<p>is the standard one, but how can I define it as a keyboard shortcut?
When binding a simple  ""spawn xmobar"" it is not starting up (when starting xmobar it in a shell however the statusbar appears). However the simple ""spawn xmobar"" would probably not have the text from xmonad showing the workspaces connected.</p>",xmonad|xmobar,367316,Konrad Eisele,no
Xamarin IOS: BLE,"<p>I am trying to connect to my Bluetooth Low Energy Device. After finding the device and getting the peripheral object. I cannot connect to the Bluetooth Device from my iPhone and it does not call  <strong>central.ConnectedPeripheral</strong> method. </p>

<p>Another issue is that i cannot register the event <strong><em>central.ConnectedPeripheral += ConnectedPeripheral</em></strong> in the method. </p>

<p><em>Error</em>: System.InvalidOperationException: Event registration is overwriting existing delegate. Either just use events or your own delegate: </p>

<pre><code>class IOSBluetooth : IBluetooth
{
    private readonly CBCentralManager central;
    private CBPeripheral activePeripheral;
    SimpleCBCentralManagerDelegate myCentralDelegate;

    public bool IsScanning { get; private set; }

    List&lt;CBPeripheral&gt; connectedDevices = new List&lt;CBPeripheral&gt;();

    //List&lt;CBPeripheral&gt; discoveredDevices = new List&lt;CBPeripheral&gt;();
    /// &lt;summary&gt;
    /// Gets the current Bluetooth instance
    /// &lt;/summary&gt;
    /// &lt;value&gt;The Bluetooth Adapter instance&lt;/value&gt;


    public IOSBluetooth(SimpleCBCentralManagerDelegate myCenDel)
    {
        myCentralDelegate = myCenDel;
        central = new CBCentralManager(myCentralDelegate, DispatchQueue.CurrentQueue);
        InitializeEvents();

        //   central.DiscoveredPeripheral += DiscoveredPeripheral; // Called when peripheral is discovered (Working)
        //   central.UpdatedState += UpdatedState; // Method Implemented - Tells us about the bluetooth powered state (On or Off). (Working)
        //   central.ConnectedPeripheral += ConnectedPeripheral; // Devices that are connected to Iphone -&gt; Services and Characteristics discovery start from here
        //   central.DisconnectedPeripheral += DisconnectedPeripheral; // Disconnect the device from the iphone
        //   central.FailedToConnectPeripheral += FailedToConnectPeripheral;  // Failed to connect to Bluetooth Device
    }

    void InitializeEvents()
    {
        try
        {
           // central.ConnectedPeripheral += ConnectedPeripheral;
            central.FailedToConnectPeripheral += FailedToConnectPeripheral;
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message, ""Intialization Failes"");
            Console.WriteLine(""Bluetooth.Connect "" + ex.Message);
        }
    }

    public void FailedToConnectPeripheral(object sender, CBPeripheralErrorEventArgs e)
    {
        Console.WriteLine(""Failed to Connect to Peripheral"");
    }

    private void DisconnectedPeripheral(object sender, CBPeripheralErrorEventArgs e)
    {
        // when a peripheral disconnects, remove it from our running list.
        if (connectedDevices.Contains(e.Peripheral))
        {
            connectedDevices.Remove(e.Peripheral);

        }
    }

    public void ConnectToPeripheral(CBPeripheral peripheral)
    {
        central.ConnectPeripheral(peripheral, new PeripheralConnectionOptions { NotifyOnConnection = true, NotifyOnDisconnection = true, NotifyOnNotification = true  });
    }

    private void UpdatedState(object sender, EventArgs e)
    {
        throw new NotImplementedException();
    }

    //public override void DiscoveredPeripheral(object sender, CBDiscoveredPeripheralEventArgs e)
    //{
    //    Console.WriteLine(""DiscoveredPeripheral: {0}"", e.Peripheral.Name);
    //    discoveredDevices.Add(e.Peripheral);

    //}




    public void ConnectedPeripheral(object sender, CBPeripheralEventArgs e)
    {

        if (!connectedDevices.Contains(e.Peripheral))
        {
            connectedDevices.Add(e.Peripheral);

        }

        activePeripheral = e.Peripheral;
        Console.WriteLine(""Connected to "" + activePeripheral.Name);


        if (activePeripheral.Delegate == null)
        {
            activePeripheral.Delegate = new SimplePeripheralDelegate();
            //Begins asynchronous discovery of services
            activePeripheral.DiscoverServices();
        }

    }




    public async void BeginScanningForDevices()
    {
        Console.WriteLine(""BluetoothLEManager: Starting a scan for devices."");

        // start scanning
        IsScanning = true;
        central.ScanForPeripherals((CBUUID[])null); // Discover all the devices and Initiates async calls of DiscoveredPeripheral

        // in 10 seconds, stop the scan
        await Task.Delay(10000);

        // if we're still scanning
        if (IsScanning)
        {
            Console.WriteLine(""BluetoothLEManager: Scan timeout has elapsed."");
            StopScanningForDevices();


        }
    }

    /// &lt;summary&gt;
    /// Stops the Central Bluetooth Manager from scanning for more devices. Automatically
    /// called after 10 seconds to prevent battery drain. 
    /// &lt;/summary&gt;
    public void StopScanningForDevices()
    {
        Console.WriteLine(""BluetoothLEManager: Stopping the scan for devices."");
        IsScanning = false;
        central.StopScan();
    }

    public IEnumerable&lt;string&gt; ListDevices()
    {
        return myCentralDelegate.DiscoveredDevices.Keys;

    }

    public bool Connect(string DeviceName)
    {
        StopScanningForDevices();

        if (!myCentralDelegate.DiscoveredDevices.ContainsKey(DeviceName))
            return false;

        var device = myCentralDelegate.DiscoveredDevices[DeviceName];

        // central.ConnectPeripheral(device, new PeripheralConnectionOptions { NotifyOnConnection = true, NotifyOnDisconnection = true, NotifyOnNotification = true });
        central.ConnectPeripheral(device);
        return true;
    }

    public void StartScanning()
    {
        if(central.State == (CBCentralManagerState.PoweredOn)) 
            BeginScanningForDevices();
    }

    public void StopScanning()
    {
        StopScanningForDevices();
    }
}
</code></pre>",c#|ios|xamarin|bluetooth-lowenergy,3258381,Sameed Tariq,yes
Running a repeating task in background on a real time application,"<blockquote>
  <p><strong>Possible Duplicate:</strong><br>
  <a href=""https://stackoverflow.com/questions/5773998/running-a-repeating-task-in-background-on-a-real-time-application"">Running a repeating task in background on a real time application</a>  </p>
</blockquote>



<p>Hi! I'm writing an application which is continuously listening and checking the sensors (almost all available) and saving that data into the database in the device. </p>

<p>I need to make some calculations every X second with that data and throw a new event if the calculations check says so. 
I'm thinking about requesting to have the device plugged in while using the application (regarding battery drain).</p>

<p>What's the best approach for the task that needs to make the calculations and throw the event? Timer? Threads? AsynkTask? AlarmManager? Another approach?</p>

<p>I want to keep getting sensors data and saving them to the database despite if the application is not on foreground...it should save the values as long as the application is not stopped by the user. 
One option for that is wake locks (PARTIAL_WAKE_LOCK, which keeps CPU running).</p>

<p>I'm wondering how an application checking if you are on the correct way while running (imagine tha moving a few meter of your path would need to be advised) would be developed despite it is not exactly my case.
I'd like to hear different opinions.
Thanks in advance! Guillermo.</p>",android|multithreading|android-asynctask|alarmmanager,723059,polonskyg,no
Android main thread not waiting for AsyncTask,"<p>I'm trying to do some encryptions and show a progress dialog while they are running because depending on the number of encryptions it can take minutes or even hours. I'm trying to measure battery before and after to see how much battery a given number of rounds will drain. My problem is that the main thread isn't waiting for the AsyncTask to finish the encryptions.</p>

<p>Here is what I have so far:</p>

<pre><code>    private void performEncryption(String name) throws InterruptedException {
        int times = this.getNumTimes();

        float batteryPercentageBefore = (new Battery(this)).percentage();
        Log.d(""BATTERY"", String.valueOf(batteryPercentageBefore));

        long timeBefore = System.currentTimeMillis();

        EncryptionHandler algo = new EncryptionHandler(name);

        (new EncryptionWorker()).execute(new EncryptorParams(algo, times));

        float batteryPercentageAfter = (new Battery(this)).percentage();
        Log.d(""BATTERY"", String.valueOf(batteryPercentageAfter));

        long timeAfter = System.currentTimeMillis();

        float batteryUsed = batteryPercentageBefore - batteryPercentageAfter;
        Log.d(""BATTERY"", ""Change: "" + String.valueOf(batteryUsed));
        long totalTime = timeAfter - timeBefore;

        String text = ""It took "" + Double.toString(totalTime/1000.0) + "" seconds to run "" + name
                + "" algorithm "" + Integer.toString(times) + "" times, and it used "" + Float.toString(batteryUsed) + ""% of battery."";
        Toast.makeText(getApplicationContext(), text,
                Toast.LENGTH_LONG).show();
        lblEncryption.setText(text);
    }
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.menu_encryption, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        // Handle action bar item clicks here. The action bar will
        // automatically handle clicks on the Home/Up button, so long
        // as you specify a parent activity in AndroidManifest.xml.
        int id = item.getItemId();

        //noinspection SimplifiableIfStatement
        if (id == R.id.action_settings) {
            return true;
        }

        return super.onOptionsItemSelected(item);
    }

    private class EncryptionWorker extends AsyncTask&lt;EncryptorParams, Integer, Integer&gt; {
        private ProgressDialog dialog;

        @Override
        public void onPreExecute() {
            super.onPreExecute();

            this.dialog = new ProgressDialog(EncryptionActivity.this);
            this.dialog.setTitle(""Encrypting"");
            this.dialog.setMessage(""Please wait. This may take a while"");

            this.dialog.show();
        }

        @Override
        public Integer doInBackground(EncryptorParams... params) {
            for (int i = 0; i &lt; params[0].rounds; i++) {
                try {
                    params[0].encryptor.encrypt(""Performs the encryption algorithm"", ""the name of the encryption algorithm, can be: AES, 3DES, Blowfish"");
                } catch (Exception e) {
                    Log.e(""EXCEPTION"", e.getMessage());
                    return 1;
                }
            }

            return 0;
        }

        @Override
        protected void onPostExecute(Integer result) {
            super.onPostExecute(result);

            this.dialog.dismiss();
        }
    }
}
</code></pre>",java|android|multithreading|concurrency|android-asynctask,2378567,Hugo,yes
"FusedLocationProviderApi, PRIORITY_BALANCED_POWER_ACCURACY and GPS usage","<p>I'm creating an app which tracks the location through FusedLocationProviderApi in a Foreground Service.</p>

<p>When I create LocationRequest with PRIORITY_BALANCED_POWER_ACCURACY and start listening for location updates, to my surprise GPS fires up ( Location in the phone settings is set to High Accuracy). I get the location almost immediately (through wifi/cell sources I guess), but as I'm indoors I can't get a GPS fix and it just keeps on trying without end...</p>

<p>Even though I didn't ask for PRIORITY_HIGH_ACCURACY I get hit with significant battery drain and get blamed for using GPS for several minutes. </p>

<ol>
<li>Is there a way to set a timeout for GPS search (detect indoors situation)? </li>
<li>Is it possible to get a decent location using FusedLocationProviderApi without automatically triggering GPS or do I have to revert to the old location API?</li>
<li>Do I have to resort to limiting each LocationRequest to couple of minutes (setExpirationDuration) and create a new one to prevent the GPS battery drain?</li>
</ol>

<p>[EDIT]:  I think I might have found an another culprit. On a map tab in the app I have set setMyLocationEnabled(true), and this seems to be causing the GPS to flare up. I will experiment a bit more and post the results. Still I'm interested in how the location manager decides that enough is enough when it comes to GPS fix attempt.</p>

<p>Thanks in advance!</p>",android|gps|location|fusedlocationproviderapi,1779849,Nemanja Maksimovic,yes
"Problems keeping service alive through rotate, killing when leaving app, and turning screen off in landscape","<p>I have a service that I need to meet the following conditions</p>

<p>1) The service needs to be running while the app is in the foreground.</p>

<p>2) When the activity rotates, do not stop the service</p>

<p>3) The service must remain active even if you minimize the app when one specific fragment is open.</p>

<p>4) When the activity is stopped (not via rotate) and it is not the specific fragment, stop the service. </p>

<p>I'm starting/stopping my services in the onstart/onstop.  I ended up using a boolean to track if the screen was rotating.</p>

<p>I'm starting/stopping my services like this</p>

<p>context.getApplicationContext().startService(intent)</p>

<p>context.getApplicationContext().stopService(intent)</p>

<p>It worked perfectly except for one situation. </p>

<p>When you turn the screen off in landscape, Android for some reason decides it needs to recreate the whole activity, and calls through the entire life cycle. I've reproduced this in a basic app on 4.4 and 5.0.1, and it's been shown in other threads such as this.  </p>

<p><a href=""https://stackoverflow.com/questions/3407192/problems-understanding-the-life-cycle-when-screen-goes-off-and-on"">Problems understanding the life cycle when screen goes off and on</a></p>

<p>When it does this, the rotating/not rotating can't be relied on, and I'm guessing due to how quickly things were happening (multiple onStop/onStarts), it was causing race conditions. When I would return to the app, sometimes it worked, sometimes it would hang (no errors), sometimes two services would be running.</p>

<p>It became a rabbit hole where I started doing checks like, was the screen off when it came into the onStart, so the next time onStart was called it knew it was coming back in from an screen off recreation that was being flagged as rotated (since Android was now rotating it back into landscape from the portrait lock screen).  It was getting ridiculous, and not working well.</p>

<p>One thread suggested using a headless fragment for it to survive rotation, but I still need it to stop when the app is closed, so I end up getting stuck with the same problem.</p>

<p>Are there any recommended ways to go about solving this?  The service can't be allowed to remain active if the app is closed (except for the 1 fragment), it'll just be a huge battery drain, and it needs to survive rotations or it will interrupt things.</p>",android|android-fragments|android-service|android-lifecycle|android-service-binding,2408033,Ben987654,yes
Ionic keep app open in background,"<p>I'm having an issue with one of my ionic apps where on android it closes completely after about an hour or so in the background, forcing the user to have to wait for the entire app to reload when they try to open it.  </p>

<p>I attempted to use <a href=""https://ionicframework.com/docs/native/background-mode/"" rel=""nofollow noreferrer"">this plugin</a> to solve the issue, but when running a debug version of the apk I get a warning that the app is ""doing heavy tasks"" in the background.  I don't want to drain my user's battery, but I need some way to prevent the users from having to reload the app completely after an hour or so since the initial app load can be a little slow.  What would be the best way to go about achieving this?</p>",android|ionic3,8649330,Adam Batson,yes
Gallery Thumbnails are not being updated,"<p>So Here's the scenario</p>

<p>Iterate through a folder, and replace all the images with another set of images.</p>

<p>What I expect : Image to be updated in my gallery as well as it's thumbnail.</p>

<p>What I get : When I open my gallery the old image thumbnail is still there. When I open the image, the replaced version of that image appears. And to make it even stranger, some of the images, when you open them, there is a quick flash of the previous original image, followed by the replaced version, and if you zoom in on that photo, ""surprise"" it's the old photo again (Note : this is only with some images. - Not all).
All images though, doesn't have an updated thumbnail.</p>

<p>Give it 10 minutes and bam!, all images has been refreshed with no trace of the old original ones.</p>

<p>No clue why it doesn't do it instantaneously.</p>

<p>I Have also followed the instructions here. But the same problem persist.<a href=""https://stackoverflow.com/questions/9414955/trigger-mediascanner-on-specific-path-folder-how-to"">Trigger scan whole folder</a> Latest API doesn't allow scanning for whole folder besides the system doing that, since some apps scanned a folder because just one image changed thus draining battery life. </p>

<p>My Code</p>

<pre><code>//originalImagesList is the list of filepaths for all the images in a specific folder
for (String s :originalImagesList)
{
    try
    {
        File checkIfFile = new File(s);
        //replacementAppImg contains a list of images used to replace other images with
        Log.v(TAG, ""Moving file From Replace - "" + replacementAppImg.get(1));
        Log.v(TAG, ""Moving file to Replace - "" + s);

        InputStream in = new FileInputStream(replacementAppImg.get(1)); //From where
        OutputStream out = new FileOutputStream(s); //To where

        //Copy the bits from instream to outstream
        byte[] buf = new byte[1024];
        int len;
        while ((len = in.read(buf)) &gt; 0) {
            out.write(buf, 0, len);
        }
        in.close();
        out.close();

        Intent mediaScannerIntent = new Intent(Intent.ACTION_MEDIA_SCANNER_SCAN_FILE);
        //checkIfFile is the new replaces image that i want to refresh/check
        Uri fileContentUri = Uri.fromFile(checkIfFile);
        mediaScannerIntent.setData(fileContentUri);
        CustomSettings.getCustomAppContext().sendBroadcast(mediaScannerIntent);
    } catch (Exception ex) {
        Log.v(TAG2,""Exception 1 - ""  + ex.toString());
    }
}
</code></pre>",android|image|thumbnails|android-mediascanner,1713519,Ruan,yes
Location tracking in background with PhoneGap,"<p>I'm trying to create very simple application that will get the current location of the device and post it to server every 15 minutes or so.
I'm using cordova-plugin-background-fetch ( <a href=""https://github.com/transistorsoft/cordova-plugin-background-fetch"" rel=""nofollow noreferrer"">https://github.com/transistorsoft/cordova-plugin-background-fetch</a> ) and it works just fine awaking the app on about 15 minutes (or so), but the issue I'm facing is to get GPS coordinates. </p>

<p>I'm trying to get it using navigator.geolocation.getCurrentPosition and before I start BackgroundFetch, I make one test call with navigator.geolocation.getCurrentPosition to check if it works and have all the permissions. It is the same code as in example callback function and it works just fine on that first test call.</p>

<p>The problem I'm facing is that once BackgroundFetch awakes the application, in callback function navigator.geolocation.getCurrentPosition always fail (error code 3 - timeout expired).</p>

<p>I even tried to make it work with navigator.geolocation.watchPosition, but same issue. The first time I start it, it works. Once callback start it in background, it fails (again timeout expired).</p>

<p>I don't want to watch position all the time and drain the battery, I really need it only once in every 15-30 minutes.</p>

<p>Here is the code that I'm using and every help and suggestion is welcome!</p>

<p>Thank you!</p>

<pre><code>    BackgroundFetch.configure(function() {

        console.log('[js] BackgroundFetch event received');

        navigator.geolocation.getCurrentPosition(function(position){

            console.log('we have location now');

            $.post('https://www.example.com/api/location/', {
                Lat: position.coords.latitude,
                Lon: position.coords.longitude
            }, function(data){

                window.BackgroundFetch.finish();

            }, 'json').fail(function(){

                window.BackgroundFetch.finish();

            });

        }, function(error){

            console.log('Error code: ' + error.code);
            console.log('Error message: ' + error.message);

            window.BackgroundFetch.finish();

        }, {
            enableHighAccuracy: false,
            timeout:            20000,
            maximumAge:         0
        });

    }, function(error) {

        console.log('- BackgroundFetch failed', error);

    }, {
        minimumFetchInterval: 15
    });
</code></pre>",android|ios|cordova|cordova-plugins|phonegap,10627157,Marinko Zamurovic,yes
iOS 9 Background Location update and Update on server using web-service,"<p>I have developed an application that has the capability to update the location on server while application is in background as well as foreground. I have used Timer which continuously updates location with 1 minute time interval, because if the interval is more than 1 minute , <code>iOS</code> suspends the application in background.</p>

<p>The problem is with iOS 9, when application is in background, some time it stops the location update and after some random time duration it again starts.</p>

<p>These are the crash logs which I found from device logs.</p>

<pre><code>Exception Type:  00000020
    Exception Codes: 0x000000008badf00d
    Exception Note:  SIMULATED (this is NOT a crash)
    Highlighted by Thread:  2

    Application Specific Information:
    &lt;BKNewProcess: 0x15646220; com.com.com; pid: 1168; hostpid: -1&gt; has active assertions beyond permitted time: 
    {(
        &lt;BKProcessAssertion: 0x15537b80&gt; id: 1168-1B744B09-0EB7-4B01-A6FE-F167669E4439 name: Called by UIKit, from &lt;redacted&gt; process: &lt;BKNewProcess: 0x15646220; com.com.com; pid: 1168; hostpid: -1&gt; permittedBackgroundDuration: 180.000000 reason: finishTask owner pid:1168 preventSuspend  preventIdleSleep  preventSuspendOnSleep ,
        &lt;BKProcessAssertion: 0x15643480&gt; id: 1168-59515322-D982-46F8-94A5-0DD259406664 name: Called by UIKit, from &lt;redacted&gt; process: &lt;BKNewProcess: 0x15646220; com.com.com; pid: 1168; hostpid: -1&gt; permittedBackgroundDuration: 180.000000 reason: finishTask owner pid:1168 preventSuspend  preventIdleSleep  preventSuspendOnSleep 
    )}
    Elapsed total CPU time (seconds): 6.880 (user 6.880, system 0.000), 9% CPU 
    Elapsed application CPU time (seconds): 0.081, 0% CPU
</code></pre>

<p>Note: Everything is working completely fine in iOS 7 and iOS 8.</p>

<p>I have tried couple of solutions available on stackoverflow but I am not able to figure out the exact solutions which can solve the problem.</p>

<p>Also I found that if I don't lock the device then the location update and web-service calling works fine but if the device is locked, it stops updating location and calling up web-service.</p>

<p>Any help would be highly appreciated.</p>

<p>Thank you in advance.</p>

<p><strong>UPDATE</strong></p>

<p><code>AppDelegate.h</code></p>

<pre><code>@property (nonatomic, retain) CLLocation *currentLocation;
@property (nonatomic, strong) NSTimer* locationUpdateTimer;
-(void)updateUsersLocation;
-(void)distroyTimer;
</code></pre>

<p><code>AppDelegate.m</code></p>

<pre><code>-(void)callLocationManager
{
    @autoreleasepool
    {
        UIAlertView * alert;
        //We have to make sure that the Background App Refresh is enable for the Location updates to work in the background.
        if([[UIApplication sharedApplication] backgroundRefreshStatus] == UIBackgroundRefreshStatusDenied)
        {
            alert = [[UIAlertView alloc]initWithTitle:ALERTTITLE
                                              message:@""The app doesn't work without the Background App Refresh enabled. To turn it on, go to Settings &gt; General &gt; Background App Refresh""
                                             delegate:nil
                                    cancelButtonTitle:@""Ok""
                                    otherButtonTitles:nil, nil];
            [alert show];
            return;
        }
        else if([[UIApplication sharedApplication] backgroundRefreshStatus] == UIBackgroundRefreshStatusRestricted)
        {
            alert = [[UIAlertView alloc]initWithTitle:ALERTTITLE
                                              message:@""The functions of this app are limited because the Background App Refresh is disable.""
                                             delegate:nil
                                    cancelButtonTitle:@""Ok""
                                    otherButtonTitles:nil, nil];
            [alert show];
            return;
        }
        else if(![CLLocationManager locationServicesEnabled])
        {
            UIAlertView *alert = [[UIAlertView alloc]
                                  initWithTitle:@""""
                                  message:@""Please enable GPS service for HiHo Mobile From settings""
                                  delegate:nil
                                  cancelButtonTitle:@""OK""
                                  otherButtonTitles:nil];
            [alert show];
            return;
        }
        else
        {
            if (!self.locationManager)
            {
                self.locationManager = [[CLLocationManager alloc] init];
            }
            self.locationManager.delegate = self;
            // self.locationManager.distanceFilter = kCLDistanceFilterNone;
            self.locationManager.desiredAccuracy = kCLLocationAccuracyBest;
            self.locationManager.distanceFilter = 10.0f;
            self.locationManager.activityType = CLActivityTypeAutomotiveNavigation;

            if ([[[UIDevice currentDevice] systemVersion] floatValue] &gt;= 8.0)
            {
                [self.locationManager requestAlwaysAuthorization];
            }

            if ([self.locationManager respondsToSelector:@selector(allowsBackgroundLocationUpdates)])
            {
                self.locationManager.allowsBackgroundLocationUpdates  = YES;
            }
            if ([self.locationManager respondsToSelector:@selector(pausesLocationUpdatesAutomatically)])
            {
                self.locationManager.pausesLocationUpdatesAutomatically= NO;
            }
            if([self.locationManager respondsToSelector:@selector(allowsBackgroundLocationUpdates)])
            {
                [self.locationManager setAllowsBackgroundLocationUpdates:YES];
            }
            [self.locationManager stopMonitoringSignificantLocationChanges];
            [self.locationManager startUpdatingLocation];

            if ([USERDEFAULTS boolForKey:@""someFlag""]==YES)
            {
                [self distroyTimer];
                self.locationUpdateTimer =
                [NSTimer scheduledTimerWithTimeInterval:180
                                                 target:self
                                               selector:@selector(updateUsersLocation)
                                               userInfo:nil
                                                repeats:YES];
                [[NSRunLoop mainRunLoop]addTimer:self.locationUpdateTimer forMode:NSRunLoopCommonModes];
            }
            else
            {
                [self.locationManager stopUpdatingLocation];
                [self.locationManager startMonitoringSignificantLocationChanges];
            }
        }
    }
}

-(void)distroyTimer
{
    if ([self.locationUpdateTimer isValid])
    {
        [self.locationUpdateTimer invalidate];
        self.locationUpdateTimer = nil;
    }
}

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
    NSLog(@""latitude: %f, longitude: %f"",newLocation.coordinate.latitude, newLocation.coordinate.longitude);
    self.currentLocation = newLocation;
}
</code></pre>

<p>// Write your code to update location on server</p>

<pre><code>-(void)updateUsersLocation
{
    // Your code goes here.
}
</code></pre>

<p>Note: Continuous update of location services will dramatically drain your iOS device's battery. So as soon as you have no use of updated location you can use <code>significant locations</code>.</p>",ios|iphone|cllocationmanager|background-process|location-services,2056569,Vatsal K,no
Fast scanning of SD card on Android,"<p>I am trying to write an algorithm for fastest scanning of whole SD card. What I try to achieve is something in the line with QuickPic, which has ""normal speed"" initial scanning of SD card, but any subsequent refresh is incredibly fast. </p>

<p>I have tried several things, and I have some more ideas which I have not tested</p>

<p>1) Always scan entires SD card. I tried this...it's a bit slower on initial scan. but all subsequent scans are faster, but not as fast as QucikPic. </p>

<p>2) After initial scan add FileObserver to all folders. Although it only increases memory of application by approximately 1 MB, I am afraid this will affect performance or even drain battery, since it must run all the time. Also, I have database on SD card and I am constantly getting events for journal file being created/deleted. I am sure when working with other apps there will be other folders/files for which I will get constant notification. Not sure this is OK performance wise.</p>

<p>3) Using data from MediaStore. Unfortunately it seems that on my HTC Desire Media store is not always up to date with what's on SD card (not sure why), but that's not good enough.</p>

<p>3) Using ContentObserver. Haven't tried this yet, and must check documentation, but I have a feeling that if MediaStore doesn't have an image in it's DB, then I won't get it from ContentObserver either.</p>

<p>Do you guys have any other suggestion? Basically what I need is to know about all image files on SD card at some point. Initial scan can take a bit longer, subsequent scans should be as fast as possible (I know it depends on number of folders/files on SD card) but QuickPic scans (or whatever it does) entire SD card in about 0.6-0.8 seconds, and I just can't do it that fast.</p>",android|performance|mediastore,266968,gorann,no
Android: App that runs in background drain battery,"<p>I made an app that connect to my server every 5-10 minutes and check if there is some change in database.</p>

<p>So i use Service so that app can run in background and that user can close app and get messages in status bar. Inside of it i use Thread so that app sleeps for 5-10 minutes. The problem begins when i lock the phone. than  app just stops (this is because when you lock your  phone goes to ""sleep""), so i figured out that i need this:</p>

<pre><code>PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
wl = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, 'My Tag');      
wl.acquire();
</code></pre>

<p>That forces phone not to go sleep except the screen. But there i stuck. This works fine, but drains the battery to much. 10% per hour :( And i believe that there is not a problem that app have to make those web services request all the thime but that function which force that phone to be alive.</p>

<p>So, my question is, if there is any other solution that i can use, because i have some app on phone that runs in backgorund but they do not drains battery so much at all (avast, juice defender, etc..).</p>

<p>Any idea is very helpfull!</p>

<p>regards!</p>",android|service|background|battery|powermanager,1131584,Jure Možina,yes
URL Scheme alternative to push notification?,"<p>Push notifications are not reliable. Apple Push Notification Server does not guarantee the delivery of the notification.</p>

<p>We have an application, in which we present a web view, in which there is a button, that should trigger a request from the client to the server. But as the button is in the web page (presented in the webview), the server sends us a push notification asking us to start sending the request.
This is difficult in iOS, because, any notification should be accepted by the user to be called upon, and anyway, push notification can not be always relied upon.</p>

<p>One Alternative to this is to keep polling the server asking if i should trigger the request. But this will work only when app is running, and will drain a lot of battery.</p>

<p>Another alternative is creating a custom URL scheme. But I am not sure how to use that, and if that will work for android as well. Can any one explain on how we can use URL scheme to achieve our goal?</p>",android|iphone|ios|push-notification|url-scheme,1554632,Nikita P,yes
How to restrict battery drain for an application using CLLocationManager,"<p>I am developing an iPhone application in which I am updating current location of user from time to time using GPRS.</p>

<p>I found that battery is getting drained.</p>

<p>Can anyone help me in solving this issue?</p>",iphone|ios|objective-c|cllocationmanager|batterylevel,2458365,Muruganandan Pandi,yes
"Android, detecting movement with sensors with effective battery use","<p>I'm wanting to add a feature to my app (that usually runs most of it's functionality as a service) so that it can monitor for when the device is picked up.</p>

<p>My plan (although I'm not sure it's the best way) is to use the accelerometer to monitor for movement.</p>

<p>Reading the android docs it says you should unregister the sensor as soon as you can because it can drain the battery in a few hours.</p>

<p>So my question is, is there a way to use the sensor efficiently so as not to drain the battery, but still detect movements of the device when it's picked up?</p>

<p>Or is there a better way to do this.</p>

<p>At the moment I'm registering the sensor like this:</p>

<pre><code>mSensorManager.registerListener(mSensorListener, mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER), SensorManager.SENSOR_DELAY_NORMAL); 
</code></pre>",android|android-sensors,578374,Andrew,yes
find users nearby cordova like facebook nearby,"<p>I am working on an android application which can find users nearby. I need help in design that application.</p>

<p>Imagine you are in the street, you connect to the app and will see a gps view
with all other people that have the same app, so i need to see them in my map.</p>

<p>How can i archive this in cordova app? </p>

<p>I am thinking about: </p>

<blockquote>
  <ol>
  <li>When I start my application, I use API to find my location.</li>
  <li>I send that location to my server. </li>
  <li>server returns a list of other users nearby.</li>
  </ol>
</blockquote>

<p>That can be possible but for that user need to keep open or put app in background for get above task and it will drained all battery. </p>

<p>I need to get functionality that Facebook user for nearby user find. Have you any one help me on this to archive this ?</p>

<p>To be very frank i am confused to what approach i need to be use. </p>

<p>Please guide me.</p>",android|ios|cordova|geolocation|google-nearby,3139153,Naitik,no
"Infinite loop in android background service, battery drain issues?","<p>I'm writing an app that, among other things, will notify via notification pepople who everyday commute, if the public transport they usually take have some kind of delay.</p>

<p>I considered implement this function using the AlarmManager, but I found too many problems related to how many public transport are chosen and what days the user decides to receive the notifications.</p>

<p>So I came up with another solution: save the user preference into a file, and launch a background service that checks that file every 5 minutes, and if the conditions are respected, it shows the notification:</p>

<pre><code>@Override
public int onStartCommand(Intent intent, int flags, int startId) {

    while(true){
        try{              
            if (fileCheck()){
                Uri alarmSound = RingtoneManager.getDefaultUri(RingtoneManager.TYPE_NOTIFICATION);
                NotificationCompat.Builder mBuilder = new NotificationCompat.Builder(this).setSmallIcon(R.drawable.avanti).setContentTitle(getString(R.string.app_name)).setSound(alarmSound);
                mBuilder.setContentText(""Test"");
                NotificationManager mNotificationManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
                mNotificationManager.notify(0, mBuilder.build());
                Thread.sleep(300000)
            }
        } catch (Exception ignored){}
    }
}
</code></pre>

<p>And it works, but I have a doubt: is this going to cause performance or battery drain issues? Or is it safe since it sleeps most of the time?</p>",android|performance|service|infinite-loop,4887888,Ruocco,no
Stopping CoreLocation background updates,"<p>My app registers for background location updates (not Significant Change. I need more granularity than kilometers)</p>

<p>That part works fine. I just want to <strong>stop</strong> the updates after the app has been in the background for 60 minutes. The way I'm doing it right now is to call <code>stopUpdatingLocation</code> in my CLLocationManager delegate.</p>

<p>However, I am <em>unsure</em> if this will actually stop my app from receiving background location updates, or if it <em>will</em>, but will just ignore them. Ideally, I'd like to not have my app be responsible for battery drain except for a small period of time after user activity.</p>

<p>Apple's documentation tends to send me in circles on this one. Right when I think ""Executing Code in the Background"" is about to spill the answer, it directs me to ""Location Awareness Programming Guide."" Right when that one is about to get specific about this question, it sends me back to ""Executing Code in the Background."" :)</p>",iphone|objective-c|cocoa-touch|core-location|cllocationmanager,553394,Eric G,yes
"How does the step-counter from the samsung health app, count the steps?","<p>I know that when I want to use any of androids sensors, I have to register them and read their values via onSensorChanged().</p>

<p>If I am done with them, I unregister them to save power.</p>

<p>How come the step-counter in my Galaxy S7s health app is able to count steps? </p>

<p>I assume it's not e.g. the accelerometer, since the high power consumption of the sensor would drain my battery in hours.</p>",android|android-sensors,520897,tim,no
Android Service with auth dependency design approach,"<p>I am wondering what would be a good architecture design for a <code>Service</code> that runs even if the app is killed by the system (need to run indefinitely) and, that needs the user to be authenticated to communicate with a backend.</p>

<p>For instance, an app to prompts you to sign in and, while authenticated, the <code>Service</code> will notify your current location to the server. Auto login with saved credentials might be desired in this scenario.</p>

<p>I foresee a couple of design decisions that might be important:</p>

<ul>
<li>Who's in charge of the authentication?</li>
<li>Who's in charge of the communication with the backend? In the example: notify the current user location.</li>
<li>If user changes his password out of the app (in a Website for instance) and the <code>Service</code> is not aware of, it's absolutely acceptable. But, when signing in again via app it should update its credentials and run normally again.</li>
</ul>

<p>I have thought in these solutions, but might be not ideal:</p>

<ol>
<li><p>All the server communication placed in the app and the <code>Service</code> wakes up the app when necessary using <code>AlarmManager</code> &amp; <code>BroadcastReceiver</code>.</p></li>
<li><p>Place the server communication (in example, location notification) in the <code>Service</code> and notify about credentials from the app when credentials renewed (token, whatever,... trying to be a bit auth backend implementation agnostic).</p></li>
<li><p>Implement an <code>Account</code> in <a href=""http://developer.android.com/reference/android/accounts/AccountManager.html"" rel=""nofollow""><code>AccountManager</code></a> and keep both components kind of independent. <code>Service</code> relies on <code>AccountManager</code>, so doesn't need to deal with authentication and can do its work by its own.</p></li>
</ol>

<p>Advantages and inconveniences of the suggested solutions? Any other approach?</p>

<p>In (1), I do see the problem of  <code>WakeLock</code> happening too often (battery drain) if the communication with the backend is intense. (3) seems to be more isolated, but I have no experience with it and don't know the drawbacks.</p>",android|authentication|android-service,621264,atxe,no
How to detect volume buttons when screen is off in energy-saving way,"<p>I would make an application that handle the volume buttons when screen is off. The goal would be to turn on or off the front LED.</p>

<p>I know that there many topics here that talk about it, but the recommended solutions (like <a href=""http://developer.android.com/reference/android/os/PowerManager.html#PARTIAL_WAKE_LOCK"" rel=""nofollow"">PARTIAL_WAKE_LOCK</a>) seem to be energy intensive and drain the battery very quickly!</p>

<p>What I want is a solution that is <strong>as energy efficient as possible</strong>. Is this possible? Maybe some kind of hooking?</p>

<p>Please note that the solutions based on scheduled tasks <em>can not</em> be envisaged for this project because I want detect keys in real time (or close to it)!</p>",java|android|energy,2416369,Kevin Vuilleumier,yes
Firebase multiple child listeners,"<p>We're developing a mobile app (Android and iOS for now) for which we're using Firebase for chat and other real-time messages.</p>

<p>The structure we're using is:</p>

<pre><code>firebase-url/user-id/
                 contacts/child-element
                 activities/
                           joined/child-element
                           created/child-element
                 notifications/child-element
</code></pre>

<p>In order to keep my app data updated I execute a query and attach a child listener to each first level child(or second in the case of activities) of the user-id branch (contacts, joined, created, notifications). Functional wise it works perfectly and can easily keep everything up to date, but had a one hour user test today and the battery drain was pretty heavy (for one user the app was using around 26% of the battery, second most used) and always the GC collector runs quite often, my feeling is that the firebase connection might be the biggest user. Is this correct? Might it be better to have a child listener only on the user-id branch?</p>

<p>Any help would be appreciated. I will post some of the Android code if needed.</p>

<p>PS: This was for the Android version of the app.</p>",android|firebase|firebase-realtime-database,1783166,redspider,no
Need to unsubscribe Firestore/Angularfire2 subscription,"<p>I use Firestore like so.</p>

<p><strong>Use case 1:</strong></p>

<pre class=""lang-js prettyprint-override""><code>contacts$: Observable&lt;ContactDetail[]&gt;;

constructor(){    
} 

ionViewDidEnter() {
   this.contacts$ = this.contactProvider.getSpecificUserContacts(this.authenticationProvider.user.uid).valueChanges();
   this.contacts$.pipe(first()).subscribe(res =&gt; { },
      err =&gt; { },
      () =&gt; { }
   );
}
</code></pre>

<p><strong>Use case 2:</strong></p>

<pre class=""lang-js prettyprint-override""><code>getAllContactCategories() {
    this.categories$ = this.categoryProvider.getAllContactCategories().valueChanges();
    this.categories$.subscribe(res =&gt; {
       this.categorySortedList = res;          
    },
      err =&gt; { }
    );
}
</code></pre>

<p>But I have never <code>unsubscribed</code> it. So do I need to do that? Otherwise, will it lead to memory leaks and draining the battery usage?
I know we don't need to <code>unsubscribed</code> angular <code>HTTP</code> services since it does automatically by the framework itself. So what about Firestore/Angularfire2 <code>observables</code>? I have never seen such a pattern with firestore books or articles or like so.</p>",angular|firebase|ionic3|google-cloud-firestore|angularfire2,1077309,Sampath,no
what technology used in mobile chat apps to receive messages?,"<p>I'm some kind of backend developer and don't know how mobile applications work. But I need to provide architecture for mobile chat application server.</p>
<p>I know that android apps using google services to receive push notifications from firebase, so we don't need run own application in endless loop and poll for new data at server.</p>
<p>That is prefect for push notifications, but firebase notification body limited by 4KB and don't fit for big messages.</p>
<p>So I can see only one realization:</p>
<ol>
<li>Google services polling for FCM (ex-GCM) notifications</li>
<li>Receive some signal-like notification</li>
<li>According this notification my app go to server and download new message</li>
<li>Update local chat data</li>
<li>Show generated locally notification for new message</li>
</ol>
<p>This way is looking pretty complicated, so I don't believe that this is only possible (and correct) way.</p>
<p>Another way is to keep websocket session opened every time or poll server manually. But these two operations should drain battery to much.</p>
<p>So how modern chat apps stay in sync even if they closed and device screen off?</p>",android|ios|chat|messaging,13946204,rzlvmp,no
My app drains a lot of battery in background,"<p>I'm developing an application that it use the geolocation. The problem is that when the user doesn't close it and the app is in background, it drain a lot of battery and I don't know where is the problem.</p>

<p>My location activity is this:</p>

<pre><code>public abstract class LocationActivity extends FragmentActivity implements LocationListener, GooglePlayServicesClient.ConnectionCallbacks, GooglePlayServicesClient.OnConnectionFailedListener {
    /**
     * Variables.
     */
    private     AppGlobal           global;
    private     String              TAG     =   ""LOCATIONACTIVITY"";
    private     LocationRequest     mLocationRequest;
    private     LocationClient      mLocationClient;
    private     LocationListener    listener;



    /**
     * 
     */
    @Override
    public void onCreate(Bundle bundle) {
        super.onCreate(bundle);
        setContentView(getLayoutResourceId());

        global = ((AppGlobal)getApplicationContext());

        mLocationRequest = LocationRequest.create();
        mLocationRequest.setInterval(1000);
        mLocationRequest.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);
        mLocationRequest.setFastestInterval(1000);
        mLocationRequest.setSmallestDisplacement(1);

        mLocationClient = new LocationClient(this, this, this);
        if(GooglePlayServicesUtil.isGooglePlayServicesAvailable(this) == ConnectionResult.SUCCESS)
            mLocationClient.connect();
    }



    /**
     * 
     */
    protected abstract int getLayoutResourceId();



    /**
     * 
     */
    @Override
    public void onStop() {
        Log.v(TAG, ""onStop"");
        if (mLocationClient.isConnected()) {
            stopPeriodicUpdates();
        }
        mLocationClient.disconnect();
        super.onStop();
    }



    /**
     * 
     */
    @Override
    public void onPause() {
        super.onPause();
        Log.v(TAG, ""onPause"");
        if (mLocationClient.isConnected()) {
            //mLocationClient.removeLocationUpdates(listener);
            stopPeriodicUpdates();
        }
    }



    /**
     * 
     */
    @Override
    public void onResume() {
        Log.v(TAG, ""onResume"");
        super.onResume();

        if(mLocationClient.isConnected()) {
            if(listener == null)
                listener = new LocationListener() {
                @Override
                public void onLocationChanged(Location location) {
                    global.latitude = location.getLatitude();
                    global.longitude = location.getLongitude();
                }
            };
            mLocationClient.requestLocationUpdates(mLocationRequest, listener);
        } else
            mLocationClient.connect();
    }



    /**
     * 
     */
    private boolean servicesConnected() {
        Log.v(TAG, ""servicesConnected"");
        int resultCode = GooglePlayServicesUtil.isGooglePlayServicesAvailable(this);
        if (ConnectionResult.SUCCESS == resultCode) {
            Log.d(LocationUtils.APPTAG, getString(R.string.play_services_available));
            return true;
        } else {
            return false;
        }
    }



    /**
     * 
     */
    public void getLocation(View v) {
        Log.v(TAG, ""getLocation"");
        if (servicesConnected()) {
            Location currentLocation = mLocationClient.getLastLocation();
            global.latitude = currentLocation.getLatitude();
            global.longitude = currentLocation.getLongitude();
        }
    }



    /**
     * 
     */
    @Override
    public void onConnected(Bundle bundle) {
        Log.v(TAG, ""onConnected"");
        startPeriodicUpdates();
    }



    /**
     * 
     */
    @Override
    public void onDisconnected() {
        Log.v(TAG, ""onDisconnected"");
    }



    /**
     * 
     */
    @Override
    public void onConnectionFailed(ConnectionResult connectionResult) {
        Log.v(TAG, ""onConnectionFailed"");
        if (connectionResult.hasResolution()) {
            try {
                connectionResult.startResolutionForResult(this, LocationUtils.CONNECTION_FAILURE_RESOLUTION_REQUEST);
            } catch (IntentSender.SendIntentException e) {
                e.printStackTrace();
            }
        } else {
            //void
        }
    }



    /**
     * 
     */
    @Override
    public void onLocationChanged(Location location) {
        Log.v(TAG, ""onLocationChanged"");
        global.latitude = location.getLatitude();
        global.longitude = location.getLongitude();
        Log.v(TAG, ""lat:"" + global.latitude);
        Log.v(TAG, ""lon:"" + global.longitude);
    }



    /**
     * 
     */
    public void startPeriodicUpdates() {
        Log.v(TAG, ""startPeriodicUpdates"");
        mLocationClient.requestLocationUpdates(mLocationRequest, this);
    }



    /**
     * 
     */
    private void stopPeriodicUpdates() {
        Log.v(TAG, ""stopPeriodicUpdates"");
        mLocationClient.removeLocationUpdates(this);
    }


}
</code></pre>

<p>I think this should work fine but I'm not sure. Thank you very much for your help.</p>",android|battery|android-background,3090216,Yeray,yes
Use RF Receiver without transmitting all the time from RF Transmitter,"<p>I've been reading the input of this <a href=""http://tinkersphere.com/1188-thickbox_default/rf-link-transmitter-receiver-module-pair-433mhz-or-315mhz-for-arduino-raspberry-pi-b-b.jpg"" rel=""nofollow noreferrer"">RF Receiver</a> by connecting it's DATA pin to an Analog Pin from my Arduino and sending it to the Serial Monitor. If I don't transmit absolutely anything, it reads some noisy input. I already checked that the Analog Pin doesn't introduce any noise by placing a 10K resistor between it and ground. BUT when I do transmit, let's say, a constant ON-OFF pulse train with a delay of 100ms, It reads just as if there was no noise. If I look closely at the Serial Monitor I could notice that none of the zeros got disturbed at all, it's just plain zeroes and 700 (approx). So my conclusion is that the RF Receiver goes crazy if it doesn't detect anything. I've read that you are supposed to transmit some pulse train ALL the time, even if you don't want to transmit anything in particular in order to keep the Receiver at peace, and for it to not mess with your important data. My question is, is there any way to bypass this? The RF Transmitter side is going to be powered by battery, and I suppose that this constant pulse train would drain it pretty quickly. Thank you in advance.</p>",arduino|wireless,7098082,Joaquin Guevara,no
iPhone Turn off GPS with Objective-C,"<p>Does anyone know how to turn off iPhone's GPS programmatically?  Once I use the CLLocationManager to get three reads of my location I stop updating location as in the code below:</p>

<pre><code>- (void)locationManager:(CLLocationManager *)manager 
    didUpdateToLocation:(CLLocation *)newLocation
       fromLocation:(CLLocation *)oldLocation {

if((newLocation.horizontalAccuracy &gt;  0.0f) &amp;&amp;
   (newLocation.horizontalAccuracy &lt; 7000.0f) ){

    if(self.locations.count &gt; 3){
        [self.locationManager stopUpdatingLocation];
    }
    [self.locations addObject:newLocation];
}
</code></pre>

<p>But this still seems to leave the GPS on while users are using my app and draining their battery.  All I need to do is read the location three times so that I can get an accurate read, and then shut down the GPS.  Does anybody know how to shut down the GPS with objective-C?</p>",iphone|gps,148635,James Testa,yes
Android mediaserver process using processor / battery,"<p>I am building on my media player app, and am now in the alpha testing stage.  I have noticed that battery drain is increased while running my app.  When checking battery usage I see that the MediaServer process is the culprit.  </p>

<p>I used OSMonitor to investigate and found mediaserver using 15-35%, with the following error message repeating constantly:</p>

<p>MP3Extractor(109)</p>

<p>Unable to resync. Signalling end of stream.</p>

<p>Incidentally, the stock android player usage of this process is similar, and has the same error.  Should I write this off as expected result when using the SDK mediaplayer , or should I attempt to troubleshoot this error?</p>

<p>Any opinions are appreciated.</p>

<p>Thank You,
Josh McKinney</p>",android|media-player,453305,Josh,yes
update location to the firebase database every 15 minutes only if the location has been changed? Android,"<p>I have implemented location upload to the firebase database every 15 minute using Alarm Manager, But I need to stop next update if user is still on same place where he was, (next update), It is ok to use fused location API or Location manager in android. This should work when app is killed or Android system is deep seeping mode (Locked). So we need background location permission, that is also fine! But it should not turn on location service all the time because it will drain battery. So location service should be stopped until Alarm manager start for the next time.</p>
<p>This is the TimerService I used!</p>
<pre><code> public class TimerService extends BroadcastReceiver {
        public static final int REQUEST_CODE = 12346;
    
        // Triggered by the Alarm periodically (starts the service to run task)
        @Override
        public void onReceive(Context context, Intent intent) {
            Intent serviceIntent = new Intent(context, TrackingService.class);
    
            if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {
                ContextCompat.startForegroundService(context, serviceIntent);
            } else {
                context.startService(serviceIntent);
            }
        }
    }
</code></pre>
<p>This is method in TrackingService</p>
<pre><code>private void requestLocationUpdates() {

        LocationRequest request = new LocationRequest();

        request.setInterval(10000);

        request.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);
        client = LocationServices.getFusedLocationProviderClient(this);
        int permission = ContextCompat.checkSelfPermission(this,
                Manifest.permission.ACCESS_FINE_LOCATION);

        if (permission == PackageManager.PERMISSION_GRANTED) {

             locationCallback = new LocationCallback() {
                @Override
                public void onLocationResult(LocationResult locationResult) {

                    Location location = locationResult.getLastLocation();
                    if (location != null) {
                     updateFirebase(location);
                    }
                }
            };

            client.requestLocationUpdates(request,locationCallback,null);
        }else{
            stopForeground(true);
            stopSelf();
        }
    }
</code></pre>
<p>So I need to help to implement a new method something like this,</p>
<pre><code>tryLocationUpdate(Location location){
    if(location==stillInSamePlace){
        //Do not upload to the firebase database
    }else{
        uploadLocation();
    }
}
</code></pre>
<p>Can anyone help me?</p>",android|location|alarmmanager|repeatingalarm,9708440,Lakpriya Senevirathna,no
Since I activated BLE State preservation my app drains all the battery,"<p>I got an app that is connected to a BLE peripheral. It implements state-preservation and restoration for BLE and keeps the connection in background.</p>

<p>When I leave the phone next to the peripheral the peripheral shows that there is an active connection even if the app is not running, and if left for 12 hours, it will <strong>decrease significantly the amount of battery</strong> (even if no data transfer occurred).</p>

<p>Is this a common problem?</p>

<p>I found a similar problem for <strong>geolocation</strong>. Is there a way to set the refresh rate for ""BLE State-preservation""?</p>",ios|bluetooth|bluetooth-lowenergy|batterylevel|ble-state-preservation,382788,mm24,yes
Does enabling Wi-Fi drain more or less battery when tracking location?,"<p>I have a mobile app (iOS and Android) that pings the location ~ every 15 seconds and is used in urban areas.</p>

<p>From my understanding</p>

<ul>
<li>If Wi-Fi is disabled the app will use just GPS for location</li>
<li>If Wi-Fi is enabled the app will either use a mixture of Wi-Fi and GPS or just Wi-Fi</li>
</ul>

<p>Generally Wi-Fi on drains more battery however if you are tracking location then it might actually save battery since GPS is more battery intensive than Wi-Fi (I think!)</p>

<p>Does anyone have data if enabling (but not connecting to) Wi-Fi will be better or worse for battery life?</p>",android|ios|gps|wifi,296446,Robert,yes
what is the battery drain for sending one http request in iPhone/iPad?,"<p>I want to know how much of the battery is drained if I do <code>x</code> number of HTTP requests. </p>

<p>In other words, if I want to let the iPhone battery be drained by 10%, how many HTTP request would I have to make?</p>

<p>Just to make it clear how I want to approach this calculation, it is perfect if the power usage during the handling of the response is not counted. If it is counted the answer would vary depending on the response length, making it a subjective and scenario-driven answer.</p>

<p>The goal is to let a developer optimize how many HTTP requests are justified, but they can only do this if they know the numbers.</p>",iphone|ios|optimization|power-management,658428,Samyak Bhuta,no
How are LoRaWAN devices working in confirmed mode?,"<p>When the device is in confirmed mode, it waits for a downlink confirmation (ACK) from the network after each uplink. If the confirmation is not received by the device, it will repeat (up to a maximum of 8 times and increasing the SF of the UL if it was lowered before) the uplink until it receives a confirmation. It may take about 30 seconds to send the 8 repetitions.</p>
<p>If the device does not see a confirmation and needs to send another uplink (e.g. alarm or new periodic measurement), it will send the new uplink and forget the previous one. To operate in confirmed mode, the device must be declared in confirmed mode (or ACK) on the network platform. You can activate it via the IoT configurator in the network parameters</p>
<p>Be aware that this operation consumes much more battery power than a traditional operation, even more, if the network quality is poor.
If the transmitter loses a lot of frames, it would be better to reposition the transmitter (if possible) or the GW (if possible) to improve the transmission rather than activating the ACK which will drain the battery faster than &quot;expected&quot; depending on the network condition.</p>
<p>Is this answer correct or not?</p>",iot|azure-iot-hub|lora|lorawan,14557058,Ariful Islam Arif,no
Android's FusedLocationApi doesn't activate GPS and returns very old dates,"<p>I've written some logic in an app that is used to sample the user's location every 15 minutes. I'm only interested on getting a sample of the user's location and not track him continuously.</p>

<p>Once tested on a real device (with locations settings on) I've found out that I only manage getting location while connected to WiFi. But when I'm not connected (say, walking in the street) the FusedLocationApi.getLastLocation function returns the old location sampled when being connected to the WiFi, and never activating the GPS to try and get the real current location.</p>

<p>While I understand I can filter out old locations, I'm not sure how to get the FusedLocationApi to activate the GPS (or at least return an up to date location).
Another constraint is that I don't want to leave the GPS on for too long, not to drain the user's battery.</p>

<p>In the code below I connect to GoogleApiClient and try to get the last known location. If this is null, I register to get location updates from it, and as soon as I get one (or the allowed wait time elapses) I disconnect.</p>

<p>I've tested this for a whole day and the FusedLocationApi keeps returning the same old location it had sampled in WiFi in the morning.</p>

<pre><code>/**
 * First function in the location collection chain.
 * This function is called from outside whenever a client wants to get the user's current location.
 */
public void GetCurrentLocation(Context context, final LocationCallbackable callback) {
    currentContext = context;

    // Create an instance of GoogleAPIClient.
    if (mGoogleApiClient == null) {
        mGoogleApiClient = new GoogleApiClient.Builder(context)
                .addConnectionCallbacks(this)
                .addOnConnectionFailedListener(this)
                .addApi(LocationServices.API)
                .build();
    }

    // Add the given callback to the callback list. This will be used to return the location to whoever requested it.
    callbacks.add(callback);

    // Connect to GoogleApiClient. When connected, this will trigger onConnected and then we'll be able to request the user's location.
    mGoogleApiClient.connect();
}

@Override
public void onConnected(@Nullable Bundle bundle) {
    // Create a location request.
    LocationRequest locationRequest = createLocationRequest();

    // Check if we don't have permissions to get fine location.
    if (ActivityCompat.checkSelfPermission(currentContext, android.Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED) {
        // If we no permissions were granted - call the given callback with null.
        runCallback(null);
        return;
    }

    // If we got here, we have permissions :)
    Location location = LocationServices.FusedLocationApi.getLastLocation(mGoogleApiClient);
    if (location != null) {
        // Disconnect from GoogleApiClient.
        disconnect();

        // Call the callback that the caller has supplied us with, with the location we have.
        runCallback(location);
    }
    // Location was null - that means the GoogleApiClient didn't have enough time to get the current location.
    else {
        // In that case we should check if location settings are valid, and if so register to locationUpdated.
        // If the settings are not valid, we will terminate.
        VerifyLocationSettingsAndContinue(locationRequest);
    }
}

/**
 * Verify if the device's settings are valid for location sampling.
 * If they are - register to get location updates and unregister once we got it.
 * If they are not - the sampling chain is terminated, returning null to the client.
 */
private void VerifyLocationSettingsAndContinue(final LocationRequest locationRequest) {
    LocationSettingsRequest.Builder builder = new LocationSettingsRequest.Builder().addLocationRequest(locationRequest);
    final LocationManager _this = this;

    // Make sure the user's settings are satisfied.
    PendingResult&lt;LocationSettingsResult&gt; result = LocationServices.SettingsApi.checkLocationSettings(mGoogleApiClient, builder.build());

    // Set a callback for the pending result.
    result.setResultCallback(new ResultCallback&lt;LocationSettingsResult&gt;() {
        @Override
        public void onResult(LocationSettingsResult result) {
            final Status status = result.getStatus();
            switch (status.getStatusCode()) {
                case LocationSettingsStatusCodes.SUCCESS:
                case LocationSettingsStatusCodes.RESOLUTION_REQUIRED:
                    LocationServices.FusedLocationApi.requestLocationUpdates(mGoogleApiClient, locationRequest, _this);

                    // We can get stuck waiting for an update from FusedLocationApi.requestLocationUpdates.
                    // To solve this, we wait 10 seconds and terminate our self (if we haven't already finished).
                    new android.os.Handler().postDelayed(
                            new Runnable() {
                                public void run() {
                                    // Only try to stop the operation if we didn't get a location update.
                                    if (!isLocationUpdated) {
                                        stopLocationUpdatesAndDisconnect();
                                        runCallback(null);
                                    }
                                }
                            },
                            10000);
                    break;
                case LocationSettingsStatusCodes.SETTINGS_CHANGE_UNAVAILABLE:
                default:
                    // Location settings are not satisfied. Terminate the location sampling by calling the callback with null.
                    disconnect();
                    runCallback(null);
                    break;
            }
        }
    });
}

@Override
public void onLocationChanged(Location location) {
    isLocationUpdated = true;
    // We got our location sample - unregister ourselves from requesting location updates and disconnect.
    stopLocationUpdatesAndDisconnect();
    // Call the callback with the location we just got.
    runCallback(location);
}

private void stopLocationUpdatesAndDisconnect() {
    LocationServices.FusedLocationApi.removeLocationUpdates(mGoogleApiClient, this);
    disconnect();
}

private LocationRequest createLocationRequest() {
    final LocationRequest locationRequest = new LocationRequest();
    locationRequest.setInterval(4000);
    locationRequest.setFastestInterval(1000);
    locationRequest.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);
    // Set that we only want one update.
    locationRequest.setNumUpdates(1);
    // If we don't get an update, kill the request after 30 seconds.
    locationRequest.setExpirationDuration(30000);

    return locationRequest;
}
</code></pre>",java|android|android-location,1183228,RanM,no
Android: Best way of handling continuous pulling from server?,"<p>To start of, i should mention that i'm a newbie in Android (Not that much experience in Java at all tbh), so be easy on me.</p>

<p>I am making an app that continuously pulls data from a server, and then returns data through a http post request. The question is, what is the best way to handle the actual pulling from the server? Should i be using AsyncTask or create another thread and let it run on that? Are there better methods for this purpose?</p>

<p>I will be pulling data every 5 minutes. (I am aware that this will drain the battery very fast, and i should definately be using Androids C2DM framework. But i have no experience in it before and i'm on a deadline, so this'll have to do until i have time to learn how to implement it.)</p>

<p>I'm grateful for any advice!</p>",android|multithreading|android-asynctask|pull-request,290790,qwerty,yes
Android acceleromter in service,"<p>First of all sorry to repost the question as I didn't post my code earlier just written some lines now I am failing to explain.So posting the question again with codes.
 I have written a code that will log the acceleromter data and save the data in a csv file. What I need to do is I have to run the acceleromter in background as a service. So,I m done with writing the codes for 
1.running the accelerometer, 
2.shown the data in textbox, 
3.write the data in a csv file. 
 Things that are left is making it a service. I m giving the code below(Howfar I have done) </p>

<pre><code>        @SuppressWarnings(""deprecation"")
public class AccelerometerVaue extends Activity implements SensorListener {

    SensorManager sm = null;

    TextView xacc= null;
    TextView yacc = null;
    TextView zacc = null;
    TextView xorient = null;
    TextView yorient = null;
    TextView zorient = null;
    TextView text = null;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        sm = (SensorManager) getSystemService(SENSOR_SERVICE);
        setContentView(R.layout.activity_main);


        xacc = (TextView) findViewById(R.id.xvalue);
        yacc = (TextView) findViewById(R.id.yvalue);
        zacc = (TextView) findViewById(R.id.zvalue);
        xorient = (TextView) findViewById(R.id.xvalues);
        yorient = (TextView) findViewById(R.id.yvalues);
        zorient = (TextView) findViewById(R.id.zvalues);


    }



    @SuppressLint(""SdCardPath"")
    public void onSensorChanged(int sensor, float[] values) {
        synchronized (this) {

            if (sensor == SensorManager.SENSOR_ORIENTATION) {
                xorient.setText(""Orientation X: "" + values[0]);
                yorient.setText(""Orientation Y: "" + values[1]);
                zorient.setText(""Orientation Z: "" + values[2]);
            }
            if (sensor == SensorManager.SENSOR_ACCELEROMETER) {
//              Time now = new Time();
//              now.setToNow();
                SimpleDateFormat sdf = new SimpleDateFormat(""HH:mm:ss"");
                String currentDateandTime = sdf.format(new Date());
                Log.d(""Time"",currentDateandTime);


                xacc.setText(""Accel X: "" + values[0]);
                yacc.setText(""Accel Y: "" + values[1]);
                zacc.setText(""Accel Z: "" + values[2]);
                String res=String.valueOf(currentDateandTime+""#""+values[0])+""#""+String.valueOf(values[1])+""#""+String.valueOf(values[2]);

                Log.d(""test"", res);


                CSVWriter writer = null;
                try 
                {
                    //Log.d(""check"",""pasla"");
                    //Environment.getExternalStorageDirectory().getPath();
                writer = new CSVWriter(new FileWriter(""/sdcard/AccelData.csv"",true), ',');
                String[] entries = res.split(""#""); // array of your values

                writer.writeNext(entries); 
                //FileWriter
                writer.close();
                } 
                catch (IOException e)
                {
                //error
                }
            }            
        }
    }

    public void onAccuracyChanged(int sensor, int accuracy) {
        String tag = null;
        Log.e(tag,""onAccuracyChanged: "" + sensor + "", accuracy: "" + accuracy);

   }


    @Override
    protected void onResume() {
        super.onResume();
        sm.registerListener(this, 
                SensorManager.SENSOR_ORIENTATION |
                SensorManager.SENSOR_ACCELEROMETER,
                SensorManager.SENSOR_DELAY_NORMAL);
    }

    @Override
    protected void onStop() {
        sm.unregisterListener(this);
        super.onStop();
    }    


}
</code></pre>

<p>So, now I need to run a background service which will keep taking accelerometer data in background and also keep saving into that csv file. How can I do this? One more I like to ask is it possible to take the acc data after a certain period of time? Suppose here I m logging all the data continuously which is huge and thew battery drain will be huge. So, I need to implemented the service in such a way so that it will run in background for 15mins and log the data for 10 seconds at the beginning of each minute.</p>",android|csv|accelerometer,1576039,SaberTooth,no
iBeacon to detect accessory proximity (whilst app in background),"<p>I would like to use <a href=""https://developer.apple.com/ibeacon/"" rel=""nofollow"">iBeacon</a> to detect the proximity to a hardware (emitting iBeacon signals) when the app runs in background. </p>

<ul>
<li>Is there a way to get <strong>CLLocationManager</strong> to detect the location/proximity to an iBeacon whilst the app is running in background?</li>
<li>Does using iBeacon affect the iOS battery performance in a variable way  depending on the <strong>transmission frequency</strong> of the iBeacon hardware? In other words, if we have an iBeacon that has a high <strong>transmission frequency</strong> will the iOS device drain more <strong>battery</strong> as it will be receiving more signal than when using an iBeacon with a lower transmission frequency?</li>
</ul>",ios|bluetooth-lowenergy|ibeacon|battery,382788,mm24,no
ESP8266 WeMos D1 using deepsleep drains too much battery,"<p>I've developed a fingerprint sensor using NodeMCU D1 mini powered by a 1000mah battery.</p>

<p>Everything seems working correctly except for battery energy consumption.
I have read several topic where user says that using deepsleep fuction on NodeMCU 1000mah battery should last more than 3 month but mine doesn't reach 2 days.</p>

<p>This is <a href=""https://i.stack.imgur.com/j9qBX.png"" rel=""nofollow noreferrer"">my circuit schematic</a></p>

<p>I also report here my code snipped that I'm currently using. The circuit should wake up from deepsleep when the button is pressed and start reading the fingerprint sensor. If it detect a valid fingerprint, a message is sent to MQTT broker.</p>

<pre><code>#include &lt;Adafruit_Fingerprint.h&gt;
#include &lt;ESP8266WiFi.h&gt;
#include &lt;PubSubClient.h&gt;


const char* _ssid = ""ZZZXXXYYY"";
const char* _password = ""pass"";
const char* mqttServer = ""IPADDRESS"";
const int mqttPort = 1883;
const char* mqttUser = ""USER"";
const char* mqttPassword = ""PASS"";
long initialMillis = 0;
unsigned int raw=0;

// On Leonardo/Micro or others with hardware serial, use those! #0 is green wire, #1 is white
// uncomment this line:
//#define mySerial Serial

// For UNO and others without hardware serial, we must use software serial...
// pin #2 is IN from sensor (GREEN wire)
// pin #3 is OUT from arduino  (WHITE wire)
// comment these two lines if using hardware serial
SoftwareSerial mySerial(4, 5);

WiFiClient espClient;
PubSubClient client(espClient);
Adafruit_Fingerprint finger = Adafruit_Fingerprint(&amp;mySerial);

void setup()  
{
  Serial.begin(9600);
  pinMode(A0, INPUT);
  // Connect to Fingerprint. Set the data rate for the sensor serial port
  finger.begin(57600);
  delay(5);
  if (finger.verifyPassword()) {
    Serial.println(""Found fingerprint sensor!"");
  } else {
    Serial.println(""Did not find fingerprint sensor :("");
    ESP.deepSleep(10 * 1000000);
  }

  finger.getTemplateCount();

  // Connect to WIFI
  WiFi.mode(WIFI_STA);
  WiFi.begin(_ssid, _password);
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(""."");
  }
  Serial.println("""");
  Serial.println(""WiFi connected"");

  // Connect to MQTT
  client.setServer(mqttServer, mqttPort); 
  while (!client.connected()) {
    Serial.println(""Connecting to MQTT..."");

    if (client.connect(""ESPFingerprint"", mqttUser, mqttPassword )) { 
      Serial.println(""Connected to MQTT server"");   
    } else { 
      Serial.print(""failed with state "");
      Serial.print(client.state());
      delay(2000); 
    }
  }

  // Calculate battery percentage
  raw = analogRead(A0);
  String bLevel = ""{\""Battery\"":"" + String(raw) + ""}"";
  Serial.print(""Battery: "");
  Serial.print(raw);
  Serial.print("" -&gt; "");
  Serial.println(bLevel);

  initialMillis = millis();
  client.publish(""tele/fingerprint/LWT"", ""Online"");
  client.publish(""tele/fingerprint/STATE"", (char*)bLevel.c_str(), true);

  Serial.print(""MQTT subscribed: "");
  Serial.println(WiFi.localIP());
}

void loop()
{
  unsigned long currentMillis = millis();
  int fid = getFingerprintIDez();
  if(fid != -1) {
    String fpIdstr = String(fid);
    client.publish(""cmnd/fingerprint/RESULT"", (char*)fpIdstr.c_str());
    Serial.println(""Fingerprint correct. Going to sleep."");
    client.publish(""tele/fingerprint/LWT"", ""Offline"");
    // trigger disconnection from MQTT broker to correctly send the message before going to sleep
    client.disconnect(); 
    espClient.flush();
    // wait until connection is closed completely
    while(client.state() != -1){  
      delay(10);
    }
    ESP.deepSleep(0);
  }
  else if(currentMillis - initialMillis &gt;= 15000){
    Serial.println(""Timeout expired. Going to sleep."");
    client.publish(""tele/fingerprint/LWT"", ""Offline"");
    ESP.deepSleep(0);
  }
  delay(50);            //don't ned to run this at full speed.
}

uint8_t getFingerprintID() {
  uint8_t p = finger.getImage();
  switch (p) {
    case FINGERPRINT_OK:
      Serial.println(""Image taken"");
      break;
    case FINGERPRINT_NOFINGER:
      Serial.println(""No finger detected"");
      return p;
    case FINGERPRINT_PACKETRECIEVEERR:
      Serial.println(""Communication error"");
      return p;
    case FINGERPRINT_IMAGEFAIL:
      Serial.println(""Imaging error"");
      return p;
    default:
      Serial.println(""Unknown error"");
      return p;
  }

  // OK success!

  p = finger.image2Tz();
  switch (p) {
    case FINGERPRINT_OK:
      Serial.println(""Image converted"");
      break;
    case FINGERPRINT_IMAGEMESS:
      Serial.println(""Image too messy"");
      return p;
    case FINGERPRINT_PACKETRECIEVEERR:
      Serial.println(""Communication error"");
      return p;
    case FINGERPRINT_FEATUREFAIL:
      Serial.println(""Could not find fingerprint features"");
      return p;
    case FINGERPRINT_INVALIDIMAGE:
      Serial.println(""Could not find fingerprint features"");
      return p;
    default:
      Serial.println(""Unknown error"");
      return p;
  }

  // OK converted!
  p = finger.fingerFastSearch();
  if (p == FINGERPRINT_OK) {
    Serial.println(""Found a print match!"");
  } else if (p == FINGERPRINT_PACKETRECIEVEERR) {
    Serial.println(""Communication error"");
    return p;
  } else if (p == FINGERPRINT_NOTFOUND) {
    Serial.println(""Did not find a match"");
    return p;
  } else {
    Serial.println(""Unknown error"");
    return p;
  }   

  // found a match!
  Serial.print(""Found ID #""); Serial.print(finger.fingerID); 
  Serial.print("" with confidence of ""); Serial.println(finger.confidence); 

  return finger.fingerID;
}

// returns -1 if failed, otherwise returns ID #
int getFingerprintIDez() {
  uint8_t p = finger.getImage();
  if (p != FINGERPRINT_OK)  return -1;

  p = finger.image2Tz();
  if (p != FINGERPRINT_OK)  return -1;

  p = finger.fingerFastSearch();
  if (p != FINGERPRINT_OK)  return -1;

  // found a match!
  Serial.print(""Found ID #""); Serial.print(finger.fingerID); 
  Serial.print("" with confidence of ""); Serial.println(finger.confidence);
  return finger.fingerID; 
}
</code></pre>

<p>Can somebody let me know if there is something wrong in my code or circuit? </p>",esp8266,9067832,CrazYoshi,no
How can I utilize OOP with this basic calculation script?,"<p>I am trying to write a simple calculator to calculate how fast my battery will drain from 100% to 0% by taking a time and percentage for start and subtracting it from the finish time and percentage. </p>

<p>I was able to make a quick and dirty script to accomplish this, but I am learning OOP, and I would like some feedback on how to improve my code and implement OOP for this task. I added in some verbose print statements to make it easier for me to remember what everything is when I run it, and I intend to wrap it up into a simple bash script or maybe implement tkinter for GUI. </p>

<p>Any thoughts or suggestions will help! My main environment is python 3, but I added the error handling for those who run with python2 because it doesn't like a preceding 0 in the time number.</p>

<pre><code>from datetime import timedelta

# Getting inputs for time and percentage

try:
    start_time = str(input('What is the starting time in 24 hour time? Format: HHMM &gt;&gt; '))
    start_time_hr = start_time[:2]
    start_time_min = start_time[2:]
except SyntaxError:
    print('Try entering the time again without the preceding 0. \n')
    start_time = str(input('What is the starting time in 24 hour time? Format: HHMM &gt;&gt; '))
    start_time_hr = start_time[0]
    start_time_min = start_time[1:]

start_perc = int(input('What is the starting battery percentage? &gt;&gt; '))

try:
    end_time = str(input('What is the finish time in 24 hour time? Format: HHMM &gt;&gt; '))
    end_time_hr = end_time[:2]
    end_time_min = end_time[2:]
except SyntaxError:
    print('Try entering the time again without the preceding 0. \n')
    end_time = str(input('What is the finish time in 24 hour time? Format: HHMM &gt;&gt; '))
    end_time_hr = end_time[0]
    end_time_min = end_time[1:]

end_perc = int(input('What is the ending battery percentage? &gt;&gt; '))

# Turning numbers into times for calculation

start = timedelta(hours=int(start_time_hr), minutes=int(start_time_min))
end = timedelta(hours=int(end_time_hr), minutes=int(end_time_min))

# Calculating and printing the results

perc_difference = float(-(end_perc - start_perc))
time_difference = end - start
time_difference_minute = time_difference.total_seconds() / 60
discharge = (100.0 * time_difference_minute / perc_difference) / 60

print()
print()
print('*****')
print('Percentage Difference = ' + str(perc_difference))
print('Minutes Passed = ' + str(time_difference.total_seconds() / 60))
print('100% to 0% in ~' + str(round(discharge, 2)) + ' hours.')
print('*****')
print()
print()
print()
</code></pre>",python|oop,12482051,Eric Learner,no
How to find battery consuming part in application,"<p>I have a hybrid android application which using different features like vibration, WIFI,bluetooth etc. Recently i have made changes into WIFI locks which i need to keep available event phone goes into sleep mode as i want to do a streaming in background as well. </p>

<p>Currently i am facing a problem as phone battery started drain very quickly. I want to figure out how i can find out which part of application is very so long or taking too much CPU. I have tried DDMS tool to and use method profiling but result not showing anything interested here. I also tried battery historian but have no clue why my application consuming battery very quickly. Can someone tell me is there any other tool which i can used to figure out this problem?</p>",android|performance|bluetooth|battery,8316275,user565,yes
Flutter app continues running in background and causes unwanted battery drain,"<p>I am developing a Flutter app that is meant to be used to control IoT devices that are connected to the local network.</p>
<p>Unfortunately, while testing the app, I have experienced the following issue: According to the iOS settings app, the app is responsible for a large percentage of the current battery drain, even when the screen time is low. In other words, the app is draining the phone's battery while it is running in the background.</p>
<p>I have done some research on the issue and came to the conclusion that Flutter apps are meant to be suspended when the user returns to the Home Screen or switches to a different app.
In fact, there are countless articles that describe ways to still execute code even after the app has been suspended.</p>
<p>This does not seem to be the case for me. For testing purposes, I have created a periodic timer that prints a message any time a second passes. I am also listening to app life cycle state changes via the <code>WidgetsBindingObserver</code>.
This is the output I am getting:</p>
<p><a href=""https://i.stack.imgur.com/Tjix5.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/Tjix5.png"" alt=""terminal screenshot"" /></a></p>
<p>As you can see, the timer is still active even after the app has been paused (by means of me pressing the Home button).</p>
<p>Is there a way to properly suspend the app when the user sends it to the background?</p>
<p><strong>Technical info:</strong></p>
<p>Flutter Doctor output:</p>
<pre><code>[✓] Flutter (Channel stable, 2.2.0, on macOS 11.3.1 20E241 darwin-arm, locale en-US)
[✓] Android toolchain - develop for Android devices (Android SDK version 30.0.3)
[✓] Xcode - develop for iOS and macOS
[✗] Chrome - develop for the web (Cannot find Chrome executable at /Applications/Google Chrome.app/Contents/MacOS/Google Chrome)
    ! Cannot find Chrome. Try setting CHROME_EXECUTABLE to a Chrome executable.
[✓] Android Studio (version 4.1)
[✓] VS Code (version 1.56.2)
[✓] Connected device (2 available)

! Doctor found issues in 1 category.
</code></pre>
<p>The console output was generated on an iPhone 8 running iOS 14.4, however I have observed the issue on Android as well.</p>
<p>Thanks in advance, ThePC007.</p>",flutter|background-process|battery|suspend,8386988,ThePC007,yes
Registering an accelerometer listener with a custom rate,"<pre><code>private static int SENSOR_DELAY_SLOW = 5000000;

sensMngr = (SensorManager) getSystemService(SENSOR_SERVICE);

sensMngr.registerListener(this, sensMngr.getDefaultSensor(Sensor.TYPE_ACCELEROMETER), SENSOR_DELAY_SLOW);
</code></pre>

<p>I want to capture the sensor's data every 5 seconds but it ignores my desired rate. The listener captures values even over 400 times per second.</p>

<p>Of course I can filter incoming data manually in the <em>onSensorChanged(SensorEvent event)</em> method, but my primary aim is to reduce the battery drain.</p>

<p><a href=""http://developer.android.com/reference/android/hardware/SensorManager.html#registerListener%28android.hardware.SensorEventListener,%20android.hardware.Sensor,%20int%29"" rel=""nofollow"">Documentation</a></p>

<p>What am I doing wrong?</p>

<p>Thank you.</p>",android|accelerometer|sensors|frequency|rate,953682,EyesClear,yes
Android server-initiated TCP connection,"<p>I am new to Android development and I would like to know if there is any way to establish a server-initiated tcp connection on an Android device.</p>

<p>What I'm trying to achieve is making an external server able to access data from the Android phone at any time without using a battery-draining permanent connection. </p>

<p>As it is not possible for the phone to do something similar to an <code>accept()</code> when it is on 3G, I was wondering if there might be a system of ""hidden"" notifications that could be used to tell the phone to connect to the server.</p>

<p>Another option would be for the phone to try a connection every X seconds but I don't like the idea, and I'd rather have the connection to be created as soon as it's needed.</p>

<p>Are there any 'clean' solutions to do this?</p>",android|tcp|connection,352876,Jukurrpa,yes
Android: HttpURLConnection or sockets?,"<p>I have an Android App that calls a URL every 2 seconds.
This drains battery, I know. But I need the connection because there must always be a connection between the app and the webserver.</p>

<p>Now my question: is it better for performance and battery to realise this with ""HttpURLConnection "" every 2 seconds or with a socket.
If socket, which socket? Asynctask, thread, websocket, or using this way?:
<a href=""https://stackoverflow.com/questions/13863610/socket-programming-using-android-and-php"">Socket Programming using android and php</a></p>",java|android|sockets,3575373,newcoder,no
Using XMPP for frequent communication with mobile app,"<p>A mobile app I'm working on requires the server to communicate with it frequently over a short period of time, including real-time (or very close) things for the app to show (from other users).</p>

<p>It will be an iOS and Android app.</p>

<p>I was researching C2DM and on this page <a href=""http://code.google.com/android/c2dm/quotas.html"" rel=""nofollow"">http://code.google.com/android/c2dm/quotas.html</a>, at the bottom it recommends considering ""implementing XMPP or your own protocol to exchange messages"".</p>

<p>What I want to communicate between the server and the app does not fall easily into XMPP's usual chat roll, how would you go about actually implementing it?</p>

<p>Would it be a case of choosing appropriate XMPP libraries for the server and mobile app languages, then making a custom server (and client side)? Wouldn't this drain the battery on the phone? Can it be done over a RESTful architecture?</p>

<p>(If it helps, there are currently no decisions made for the server - other than it has to be highly scalable).</p>",android|ios|xmpp,404409,Jon Cox,no
iOS app with real-time updates from server: Socket (using streams) or Apple Push Notification service?,"<p>I'm trying to make an iOS 5 app that features real-time things coming from the server. It will only use these whilst the app is running.</p>

<p>To make it real-time without polling I have been evaluating two design routes:</p>

<p><br />
<strong>Creating a socket from the app to the server, and exchanging information via streams.</strong></p>

<ul>
<li><em>Pros:</em> Relatively simple and would not involve a 3rd party. </li>
<li><em>Cons:</em> Battery life drain. </li>
<li>For an overview of how this might work, check
out this excellent tutorial:
<a href=""http://www.raywenderlich.com/3932/how-to-create-a-socket-based-iphone-app-and-server"">http://www.raywenderlich.com/3932/how-to-create-a-socket-based-iphone-app-and-server</a></li>
</ul>

<p><strong>Using standard HTTP to communicate with the server, and with each request from the app let the server know what they are viewing. If something new is available for user, send an Apple Push Notification (with no visible alert) to let app know it can go and download new thing.</strong></p>

<ul>
<li><em>Pros:</em> Not opening up a new TCP connection, so battery life not drained unnecessarily.</li>
<li><em>Cons:</em> Feels like a poor hack.</li>
<li>The official docs on APNs <a href=""http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ApplePushService/ApplePushService.html"">http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ApplePushService/ApplePushService.html</a></li>
</ul>

<p><br /> 
I think a socket would be the way to go, but before I commit to it I wanted a second opinion, as this is the first time I've made anything like this!</p>",ios|ios5|iostream|apple-push-notifications,404409,Jon Cox,no
Why might my android app occasionally drain battery extremely fast?,"<p>Several users of my app have reported their battery draining at around 1% a minute with my app running in the background. I have been unable to replicate this issue even when using the same account credentials on the same device model that the user had the error on. Reinstalling the app apparently does not solve the problem, and there does not seem to be any specific Android version or device associated with the issue. All the reports I've had are Samsung devices running 4.x, but this is also fairly representative of my user base overall. My background service listens for GCM messages and contact list changes as well as firing off an http request roughly every hour using a ScheduledExecutorService.</p>

<p>I should also note that I do not use any wake locks in the app.</p>

<p>I am wondering if anyone has any ideas as to what sorts of bugs might cause an issue like this, or even what tools or methods might be effective in narrowing down my problem scope.</p>",java|android|background-process|battery|power-saving,1159479,rhnoble,yes
Android best way to get location repeatedly in background considering battery as well,"<p>I need to request for location continuously in my app and it should always be a background service.</p>

<p>I need latlng for like every two minute or so. I thought of using a Service and in <code>onStartCommand</code> i would use <code>locationmanager.requestLocationUpdates(LocationManager.GPS_PROVIDER, MINIMUM_TIME_INTERVAL, MINIMUM_DISTANCE, this);</code> as well as  <code>locationmanager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, MINIMUM_TIME_INTERVAL, MINIMUM_DISTANCE, this);</code></p>

<p>But i am afraid as time goes this requestLocationUpdates stops giving me location. So i thought of using <code>AlarmManager</code> so it keeps on giving me location.</p>

<p>My question is , is it necessary to use <code>AlarmManager</code> to remind to get location or if i use <code>AlarmManager</code> will it drain lot of battery.</p>

<p>I just wanted to know best approach to get location in background.
Thanks in advance.</p>",android|service|gps|location|alarmmanager,2273628,Nav,no
"Ever since Mac battery drained (and shut down), Rails app can't post anything to database","<p>My Mac battery ran out while I was running a Rails 3 app, and after I plugged my Mac in and restarted it, I tried running my Rails app's development server (using mysql for the database). Upon trying to update something, I got ""Errno::ECONNREFUSED (Connection refused - connect(2))"". It turns out that I get this every time I try to post or update now.</p>

<p>There doesn't seem to be any actual problem with the database. I can create new rails apps that work with sqlite, mysql, or postgres, but this old app, which worked fine before, can't work with any of the databases, and I get the same ""Connection refused - connect(2)"" error no matter which I try. I've never seen this error before, I should note. Also, I don't know that it would matter, but I'm running Rails 3.0.1 on Ruby 1.9.2.</p>

<p>Does anyone know what went wrong? Something went sideways, but I'm at a loss, losing hair and sleep...</p>",ruby-on-rails|database-connection,349838,Steve Cotner,yes
Play sound with screen turned off / don't let iPhone go to sleep,"<p>So I have an application and I want to keep it working even if the screen is turned off.
Previously when I wanted to do that I used this hack/trick - I play a silent/empty sound in a loop in the background (AudioServicesPlaySystemSound) so if user presses the on/off button the application still works in the background - so it never allow iPhone to go to sleep mode - it just turned off the screen and maybe things like wifi or bluetooth (and on the iPod Touch accelerometers as far as I remember). And it worked. I wanted to use the same trick in my new application but when I was testing it now it seems it doesn't work anymore. The sound in the background plays (when I replace ""empty"" audio file with some sound I can hear it play) even with screen turned off but the sound it should play (using AVAudioPlayer) doesn't play (even when I turn the screen on again).
I don't know at which point it stopped working (it worked on 3.x OS for sure). Am I doing something wrong? Did Apple changed/fixed the ""hack"" that allowed your app to work even with screen turned off? Is there another way to allow the device to go to sleep (and drain the battery less) but continue to work?</p>

<p>This is the code I use to play background/silent sound:</p>

<pre><code>-(void) playSilentSound
{ 
 CFBundleRef mainBundle = CFBundleGetMainBundle ();
 CFURLRef silentUrl = CFBundleCopyResourceURL (mainBundle, CFSTR (""silence""), CFSTR (""aiff""), NULL);
 AudioServicesCreateSystemSoundID (silentUrl, &amp;silentSound);
 silentTimer = [NSTimer scheduledTimerWithTimeInterval: 2.0 target: self selector:@selector(playSilence) userInfo: nil repeats: YES];
}

-(void) playSilence
{
 AudioServicesPlaySystemSound (silentSound);
}
</code></pre>

<p>And this is how I play the sound that should play even if the screen is turned off:</p>

<pre><code>-(BOOL) playSound: (NSString *) path withLoops: (BOOL) loops stopAfter: (int) seconds
{
 NSError *error;
 player = [[AVAudioPlayer alloc] initWithContentsOfURL: [NSURL fileURLWithPath: path] error: &amp;error];
 player.delegate = self;
 player.numberOfLoops = 0;
 player.volume = volume;
 secondsPlayed = 0;
 loop = loops;
 BOOL played = [player play];

 if(played &amp;&amp; seconds &gt; 0)
 {
  timer = [[NSTimer scheduledTimerWithTimeInterval: 0.5 target: self selector: @selector(stopPlaying:) userInfo: [NSNumber numberWithInt: seconds] repeats: YES] retain];
  secondsLimit = seconds;
 } else {
  secondsLimit = -1;
 }
}

-(void) stopPlaying:(NSTimer*)theTimer
{
 if(secondsLimit &gt; 0 &amp;&amp; (secondsPlayed + [player currentTime]) &gt;= secondsLimit)
 {
  [player stop];
  [timer release];
  timer = nil;
 }
}

- (void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)sender successfully:(BOOL)flag
{
 if(sender == player)
 {
  if(flag) { secondsPlayed += sender.duration; }
  if(loop) { [player play]; }
 }
}
</code></pre>

<p>The code is a bit complicated maybe - it could be just the first few lines - it's made that way so you can play only X seconds of sound (if sound is shorter than X it will play few loops until the total time is >= X). And of course everything is working fine when the screen is left on.</p>

<p>Also - if you find the code useful in your projects (like playSound:withLoops:stopAfter:) - feel free to use it (but it would be cool if you send me a message so I would know that I helped :)).</p>",iphone|objective-c|iphone-sdk-3.0|ios|ios4,230438,shw,yes
Pushing or Pulling notifications,"<p>We want to implement a back end server [Java EE] for mobile application that sends notification to mobile on some events, I'm asking about the best/simplest approach whether Pushing or Pulling notifications, here you are my ideas/questions<br>
1-  The requirement is to send instantly the notifications to the mobile as long as the application is running no need to send if it's not running<br>
2- I read that to push notifications to IOS or Android, I will need to connect to apple/google notifications servers, I felt that this is complicated especially that it requires low level socket programming, but based on number 1 and the project has limited time and budget, do we really need pushing ? and is it really complex<br>
3- I read that pulling date may drain battery and consume data, but what if implementing a simple job on the mobile that runs only 3 or 4 times a day, invoking a simple web service on back end server asking for the notifications<br>
P.S will be much appreciated if you can provide some tutorials for similar cases :)</p>",java|android|ios|mobile|push-notification,1146603,Mira,no
Network resource constraints in Windows RT,"<p>According to page 20 of <a href=""http://www.microsoft.com/en-us/download/details.aspx?id=27411"" rel=""nofollow"">Introduction to Background Tasks</a>, under <em>Network resource constraints</em>, the background task can download 4.69 MB every 15 minutes. </p>

<p>Does it mean, in Windows RT, if we are downloading 20MB file via IE10 metro in background, it would take 40+ minutes? (otherwise we have to keep the download progress in front)</p>

<p>Also, as a background application, you are not allowed to use more than 0.002% CPU.</p>

<p>On the same page, they argued it like:</p>

<blockquote>
  <p>Network usage can represent a significant drain on a device battery, and so it is also constrained during background task execution. However, if a device is running on AC power, then background tasks are not network constrained. They are free to use as much network bandwidth as they need (gated, of course, by any carrier-specific bandwidth or usage constraints). Note that CPU usage for a background task is always resource constrained even if the device is running on AC power. </p>
</blockquote>

<p>For these very reasons, we cannot implement a download manager for Windows RT? How about <strong>with</strong> user consent?</p>",windows-8|microsoft-metro|windows-store-apps,1712065,Annie,no
Proper optimized way to monitor battery level in android,"<p>I want to monitor the battery level and if it reaches certain level, i want to DO-SOMETHING. <strong>What I am worried about is draining too much battery unnecessarily.</strong></p>

<p>Using a service will keep on running in the background. Also if i used android.intent.action.BATTERY_CHANGED intent, it will check for every single change in the battery level. This two methods might drain unnecessary battery according to my requirements.</p>

<p>So, if I use AlarmManager(which is also a service handled by OS), it will check that battery level every user-defined(appropriate time).</p>

<p>The following are codes which I have implemented.</p>

<pre><code>import android.app.Activity;
import android.app.AlarmManager;
import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;

public class MainActivity extends Activity {

private AlarmManager mAlarmManager;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.fragment_main);

        mAlarmManager= (AlarmManager) getSystemService(Context.ALARM_SERVICE);

        Intent intentAlarm = new Intent(this, AlarmReceiverTest.class);

        // User defined time
        long fiveMin= (AlarmManager.INTERVAL_FIFTEEN_MINUTES/3); // adjustment here

        mAlarmManager.setRepeating(AlarmManager.RTC,
                    System.currentTimeMillis()+fiveMin, oneMin, 
                    PendingIntent.getBroadcast(this,1,  intentAlarm, PendingIntent.FLAG_UPDATE_CURRENT));

    }

}
</code></pre>

<p>Broadcast receiver:</p>

<pre><code>public class AlarmReceiverTest extends BroadcastReceiver {

@Override
public void onReceive(Context pContext, Intent arg1) {

    IntentFilter ifilter = new IntentFilter(Intent.ACTION_BATTERY_CHANGED);
    Intent batteryStatus = pContext.registerReceiver(null, ifilter);

    int level = batteryStatus.getIntExtra(BatteryManager.EXTRA_LEVEL, -1);
    int scale = batteryStatus.getIntExtra(BatteryManager.EXTRA_SCALE, 100);
    int percent = (level*100)/scale;

    if(percent== myThreshold)
        //DO-SOMETHING
}
</code></pre>

<p>}</p>

<p>In manifest:</p>

<pre><code>&lt;receiver android:name=""AlarmReceiverTest""&gt;
    &lt;intent-filter&gt;
        &lt;action android:name=""android.intent.action.BATTERY_CHANGED""/&gt;
    &lt;/intent-filter&gt;
&lt;/receiver&gt;
</code></pre>

<p>Permission:</p>

<pre><code>android.permission.BATTERY_STATS
</code></pre>

<p>Since its a repeating alarm, it will keep on checking even if the application is closed.</p>

<p>eg.: DO-SOMETHING: might be lock the application if the application was already opened <strong>OR</strong> not allowed to open the application if it was already closed.</p>

<p><strong>Is this the proper way to do and is my understanding correct?</strong>
Kindly suggest me if there is any other proper way to do.</p>

<p><strong>EDITED:</strong></p>

<p><strong>If I were to check the battery level for every 5-10 hours of interval, what would be the best way to do so?</strong></p>",java|android|broadcastreceiver|alarmmanager|android-broadcast,2508414,OnePunchMan,no
how to stop the update of the widget android when I turn off the screen?,"<p>i'm creating an application with widget. The widget is updated every 10 seconds through AlarmManager, but I would that the AlarmManager stops when the screen is off, to prevent a possible battery drain. How can I do? I tried using PowerManager but without success. 
I have implemented the AlarmManager in WidgetProvider, and through broadcast calls the class WidgetReceiver, which updates the values</p>

<p>-WIDGET PROVIDER:</p>

<pre><code>public void onUpdate(Context context, AppWidgetManager appWidgetManager,
        int[] appWidgetIds) {
    AlarmManager alarmManager = (AlarmManager) context
            .getSystemService(Context.ALARM_SERVICE);
    alarmManager.setRepeating(AlarmManager.RTC,
            System.currentTimeMillis() + 1000, 1000 * 5, update(context));
}

public static PendingIntent update(Context context) {
    Intent intent = new Intent();
    intent.setAction(""com.aaa.intent.action.UPDATE_TIME"");
    if (service == null) {
        service = PendingIntent.getBroadcast(context, 0, intent,
                PendingIntent.FLAG_UPDATE_CURRENT);
    }
    return service;
}
</code></pre>

<p>-WIDGET RECEIVER:</p>

<pre><code>public void onReceive(Context context, Intent intent) {
    if (intent.getAction().equals(""com.gabriele.intent.action.UPDATE_TIME"")) {
        updateWidget(context);
    }

}

private void updateWidget(Context context) {

    update my widget
}
</code></pre>",android|widget|alarmmanager|powermanager,4630394,gabg,yes
iOS Google Maps SDK - Using location in background,"<p>I am utilizing the Google Maps iOS SDK in my app and am utilizing a <code>GMSMapView</code> with <code>myLocationEnabled = TRUE</code>. The user has authorized for location usage in app.</p>

<p>The problem is that when a user opens the screen with the map, then closes the app with that screen visible, the map continues to use the user's location, even if the user only allowed location usage <code>""While Using the App""</code>. This is a huge problem as it is a big drain on battery, and have no clue how to fix it.</p>

<p>I am using the latest version of the SDK (1.11.1).</p>

<p>Any ideas?</p>",ios|google-maps|cocoa-touch|core-location|google-maps-sdk-ios,1364413,benjih555,yes
"App causing battery drain, possible caching issue?","<p>Just about finished with my first android app, but I noticed recently a pretty significant battery drain. It happens even after the app is closed, even after it's been force stopped, until the phone is turned off. Logcat is giving me nothing.</p>

<p>I finally managed to get battery historian going and investigated, and while I can't make sense of most of it I did see that the app seems to constantly be spending time caching.</p>

<p>Since I'm still new to this, it's entirely possible I'm saving something wrong, or retrieving something wrong, or just doing something wrong in general, but it's a pretty simple app so there aren't any obvious places to start looking at what's causing this.</p>

<p>I should add this problem seems to happen even if the user only opens the app and closes it, without doing anything at all.</p>

<p>If there's any more information I can provide, I'd be happy to.</p>

<p>Anyone have any ideas on where to start looking for the problem?</p>",android|caching|battery,8844428,amp502,yes
SpriteKit Battery/Energy Drain,"<p>I have been developing a game for a little while now and have come to realize that my app quickly drains the device battery. I have measured the energy drain through XCode instruments and it is generally in the 17/20 range. I have a handful of background animations and disabling those does seem to help. Out of curiosity, I started a project with the following simple code:</p>

<pre><code>import SpriteKit
import GameplayKit

class GameScene: SKScene {

let NumberOfSprites = 1


override  func didMove(to view: SKView)
{
    view.showsDrawCount = true
    view.showsFPS = true
    view.showsNodeCount = true

    // Set scene to 414x736 with anchorPoint in the bottom left corner
    self.anchorPoint = CGPoint(x: 0, y: 0)
    self.size = CGSize(width: 414, height: 736)

    var spriteArray = [SKSpriteNode]()

    for _ in 0..&lt;NumberOfSprites
    {
        let sprite = SKSpriteNode(color: .black, size: CGSize(width: 50, height: 50))
        sprite.position = CGPoint(x: Int(arc4random_uniform(UInt32(414))), y: Int(arc4random_uniform(UInt32(736))))
        self.addChild(sprite)
        spriteArray.append(sprite)
    }


    let moveAction = SKAction.move(by: CGVector(dx: 50, dy: 50), duration: 1.0)
    let moveAction2 = SKAction.move(by: CGVector(dx: -50, dy: -50), duration: 1.0)

    let repeatAction = SKAction.repeatForever(SKAction.sequence([moveAction, moveAction2]))

    for sprite in spriteArray
    {
        sprite.run(repeatAction)
    }

}


}
</code></pre>

<p>This code will put one black box on the screen and move it x+50, y+50, then x-50, y-50 indefinitely. Below is the energy impact of doing this. I measured an Energy Usage Level on the device around 7-8/20 on average.</p>

<p><a href=""https://i.stack.imgur.com/icFBa.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/icFBa.png"" alt=""enter image description here""></a></p>

<p>I was able to add up to 200,000 nodes (just change the NumberOfSprites variable) and the energy impact increased to 18/20. That of course makes sense to me, though I find it interesting that my app which has maybe 120 nodes on the screen at a given time, with only a handle full of actions, is generating almost as much energy drain.</p>

<p>My question is: If one simple action causes such an energy impact, how are developers handling this in their games? There are many complex games in the app store that don't seem to drain battery nearly this quickly. Am I missing something? </p>

<p>Thanks in advance for any help.</p>",ios|xcode|sprite-kit,5520785,MikeL,yes
GPS not turning off after FusedLocationProvider request finished,"<p>I'm having a problem on a One Plus 3T device which is causing the GPS to stay activity after <code>removeLocationUpdates</code> has been called correctly (waiting for the PendingIntent status to return success, and then disconnecting the API client).</p>

<p>The image shown below shows the GPS remaining active for 19 minutes when it should only have been active for about 10 seconds (when the logs indicated the request was removed successfully). I'm not sure why the GPS is not turning off, this causing very high battery drain which can bee seen below.</p>

<p><a href=""https://i.stack.imgur.com/XUNjv.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/XUNjv.png"" alt=""GPS active for 19 minutes""></a></p>

<p>This is how the location request is removed and client disconnected:</p>

<pre><code>PendingResult&lt;Status&gt; result = LocationServices.FusedLocationApi.removeLocationUpdates(mGoogleApiClient, mLocationListener);
result.setResultCallback(new ResultCallback&lt;Status&gt;() {
     @Override
     public void onResult(@NonNull Status status) 
         // Something went wrong! Throw RunTimeException on main thread
         // this will crash the application
         if(!status.isSuccess()){
             throw new RuntimeException(""Could not remove location updates!"");
         }else{
             Log.i(TAG, ""Location request removed successfully"");
         }
         mGoogleApiClient.disconnect();
     }
});
</code></pre>

<p>edit: I've discovered when the location request is removed the location controller (part of the OS?) outputs the following:</p>

<pre><code>05-02 15:52:06.394 21277 21425 I LocationControllerImpl:  areActiveHighPowerLocationRequests package:android
05-02 15:52:06.394 21277 21425 I LocationControllerImpl:  areActiveHighPowerLocationRequests getOp:42 opEntry:false
05-02 15:52:06.394 21277 21425 I LocationControllerImpl:  areActiveHighPowerLocationRequests package:com.google.android.gms
05-02 15:52:06.394 21277 21425 I LocationControllerImpl:  areActiveHighPowerLocationRequests getOp:42 opEntry:false
05-02 15:52:06.394 21277 21425 I LocationControllerImpl:  areActiveHighPowerLocationRequests package:com.google.android.googlequicksearchbox
05-02 15:52:06.395 21277 21425 I LocationControllerImpl:  areActiveHighPowerLocationRequests getOp:42 opEntry:false
05-02 15:52:06.395 21277 21425 I LocationControllerImpl:  areActiveHighPowerLocationRequests package:me.twrp.twrpapp
05-02 15:52:06.395 21277 21425 I LocationControllerImpl:  areActiveHighPowerLocationRequests getOp:42 opEntry:false
05-02 15:52:06.395 21277 21425 I LocationControllerImpl:  areActiveHighPowerLocationRequests package:com.myapp.xxx
05-02 15:52:06.395 21277 21425 I LocationControllerImpl:  areActiveHighPowerLocationRequests getOp:42 opEntry:false
</code></pre>

<p>But for the times where the GPS is kept alive and <code>GnssLocationProvider</code> wakelocks is still active nothing is outputted after the removal of the request.</p>

<p>edit: Further to the above, it looks like that output is from when a broadcast happens with the action <code>LocationManager.HIGHPOWER_REQUEST_CHANGE_ACTION</code> which from the <a href=""http://atetric.com/atetric/javadoc/org.robolectric/android-all/6.0.0_r1-robolectric-0/src-html/android/location/LocationManager.html"" rel=""nofollow noreferrer"">source</a> indicates:</p>

<blockquote>
  <p>that a high power location requests has either started or stopped
  being active</p>
</blockquote>

<p>More info:
Force stopping the app or Google Play services does not clear the wakelock. It appears it can only be removed by restarting the device.</p>",android|fusedlocationproviderapi,2544098,Ryan,yes
Constantly monitor a sensor in Android,"<p>I am trying to figure out the best way to monitor the accelerometer sensor with a polling rate of less than .25 milliseconds. I have implemented a UI option for the user to switch to a constant monitoring state and made it clear of the battery drain ramifications. Would a remote service be the best way over a daemon thread because of the way Android handles cleaning up memory and threads? The point is to make the accelerometer monitored as close to constantly as possible, battery drain be damned. And this monitoring needs to be long running, maybe even more than 24 hours straight, again I realize the power consumption consequences. Any suggested reading or code snippets will be appreciated.</p>

<p>Just a newbe looking for advice from the wisdom of the Android community. Thanks in advance,</p>

<p>-Steve</p>

<p>CLARIFICATION: I am trying to detect the instant there is a change in acceleration. My code discriminates by axis, but getting real time data from the accelerometer is my goal.</p>",android|multithreading|daemon,549510,Kingsolmn,yes
Track android app battery consumption?,<p>I'm making an app that collects sensor values and sends them to a server. The main issue is battery draining. I looked for apps and software to have an idea of the energy consumption (per hour for example) because I've used two approaches to achieve what I want and I want to be able to justify my choice (to pick one approach over the other) based on a real experiment or a mathematical formula.</p>,android|android-sensors|battery|batterylevel,7502796,future engineer,yes
Keep Android awake for incoming network connections?,"<p>I'm writing an HTTP server for Android devices, implemented via NanoHTTPD.</p>

<p>A goal of mine is to have the device allow incoming connections even with the screen off.</p>

<p>I started small, with a persistent notification, thinking that would keep my app in memory and running in the background.  After locking the device, I could keep navigating the webpages it serves up as long as I don't leave it alone for about a minute.  Once I do, it totally stops responding.</p>

<p>I escalated my attempt by including a CPU partial wakelock, which made no difference.  I then added a full WifiLock to keep the radio on, and finally, in desperation, a MulticastLock (I thought maybe it'd keep the radio listening for connections).  Still, after not making any connections for about a minute, the device stops responding, even with all these locks.</p>

<p>Is there anything specific I can do to keep the device listening for incoming connections?  It seems like hitting the device with periodic requests keeps it awake... can I somehow emulate this behavior programmatically?  I cannot think of a way.</p>

<p>Thanks!</p>

<p>EDIT: for the purpose of this question, battery drain can be disregarded.</p>

<p>EDIT: NanoHTTPD is being run as a service, as well.</p>",android|android-networking|android-wake-lock|nanohttpd,1903064,bob,yes
Android battery drain - application design,"<p>I am designing an Android application that needs to receive constantly changing information (so the update interval must be very small). </p>

<p>Right now I am reading this information by consuming a REST WebService, but I am wondering if this is the best approach, regarding the battery drainage. This application would have to refresh the data being shown very often (specifically GPS data read from another system).</p>

<p>I have been reading about Google Cloud Messaging but I didn't find any comparisons between the two approaches.. Theoretically both approaches fit my needs since the data changes so frequently that it doesn't really matter whether it is updated by request or on a timer..</p>

<p>So my question is: Should I stick with WebServices or shift to GCM? Is there another battery-efficient solution?</p>

<p>Thanks in advance!</p>",android|web-services|google-cloud-messaging|batterylevel,1756496,pteixeira,no
Android WiFi Direct Service Discovery and Battery Life,"<p>I'm trying to use <a href=""http://developer.android.com/training/connect-devices-wirelessly/nsd-wifi-direct.html"">Wifi P2P NSD</a> to share a small string between phones and ""hubs"" (servers and clients, respectively)</p>

<p>Since phones move around and the hubs will be in fixed places (think beacons), it would be ideal for the phone to constantly advertise its service and its DNS record. I execute the following:</p>

<pre><code>mManager = (WifiP2pManager) getSystemService(Context.WIFI_P2P_SERVICE);
mChannel = mManager.initialize(this, getMainLooper(), null);
mRecord = new HashMap&lt;String, String&gt;();
mRecord.put(AppConstants.RECORD_KEY, val);
mService = WifiP2pDnsSdServiceInfo.newInstance(
    AppConstants.SERVICE_INSTANCE, AppConstants.SERVICE_REG_TYPE, mRecord);

mManager.addLocalService(mChannel, mService, addServiceListener);
mManager.setDnsSdResponseListeners(mChannel, dnsSdServiceResponseListener,
    dnsSdTxtRecordListener);
mManager.addServiceRequest(mChannel, mRequest, addServiceRequestListener);

mManager.discoverServices(mChannel, serviceDiscoveryListener);
</code></pre>

<p>After making the call to discoverServices, the service is on the framework it would seem permantly (unless I clear it or close the channel/reset the wifi).</p>

<p>However, I am burning a ton of battery. Just looking at the system's battery preferences it seems like Google Play Services is burning the majority of my battery, while nothing is attributed to the ""Wifi"" component. Additionally, in my baseline state (airplane mode, screen off, wifi on but idle), the phone gets down to drawing ~20mA, while after executing the above code once, it doesn't go below ~130mA draw from the battery.</p>

<p>My question is, what exactly is going on that is consuming battery? Does just supporting the framework keep the wifi or phone awake and is there any way around this? I'm just confused because the battery drain doesn't seem to be attributed to any non-idling of the wifi component.</p>",android|battery|power-management|wifi-direct|service-discovery,2831774,thegeebe,yes
How can we reduce the power consumption of our iOS game?,<p>We just developed an iOS game and users have been complaining that it drains their battery power. It plays at 60 frames-per-second and uses a proprietary gaming engine (written in C#). May one of those be the issue or are there other common factors that should be investigated first?</p>,c#|iphone|ipad|game-engine|battery,446718,user446718,yes
Foreground(/Background) Service Or Geofencing API,"<p>I am working on an android app that has to update location every 10 seconds. Means I have to do polling for every 10 seconds when user wanted to do. </p>

<ul>
<li>Which one is better to use Service or Geofencing API.</li>
<li>Which will be better for reducing battery draining.</li>
</ul>

<p>Thanks</p>",android|location|polling|android-intentservice|android-workmanager,8220852,UserAT152,no
How can I simulate battery drain on an android phone in a controlled fashion?,"<p>I want an app that drains the battery by using the CPU resources in a controlled fashion. Her, by controlled fashion, what I meant to say is that let's say 'X units/ms' is the maximum amount of the battery drain rate and the 'Y units/ms' is the minimum amount of battery drain rate. </p>

<p>Now, I want to give an integer from 1 to 100 as an input to the program and my app generates a battery drain corresponding to its value. Assume, only this app is running on the system. </p>

<p>So, is there any way to do this?</p>",android|performance-testing|battery|batterylevel,673919,VoodooChild92,no
How can I simulate different types of load in an Android device?,"<p>I'm trying to test my app's behavior in various situations like let's say there's a lot of RAM  and CPU being used or network being consumed by some other apps or battery being drained away by another. </p>

<p>Now, what I've is let's say I want (100-X)% of RAM to be used away(render unavailable) and my app has only X% to use, how can I simulate that and run my app in that condition?</p>

<p>Similarly, let's say I've only Y% of network available due to various other apps running on the system, now I want to render (100-Y)% of the network availability to be simulated and run my app in that condition.</p>

<p>CPU being busy for (100-Z)% and available only Z% of time for my app that I want to test.</p>

<p>These are the situations that I want to simulate. Can someone show me a tool or explain me a way to do this?</p>",android|emulation|cpu-load,673919,VoodooChild92,yes
Difference between Android Battery Optimization and Samsung's Unmonitored Apps,"<p>My app was put to deep sleep, just like force killed when Samsung ask to fix the battery drain apps, even my sticky backend service got killed. Looks like there is some way to bring user to the battery optimization feature to disable battery optimization for my app. Anyone know the difference between Samsung's unmonitored apps feature and this Android original battery optimization feature?</p>",android|samsung-mobile|battery,885086,Ziwei Zeng,no
Correct way to do polling in Android app,"<p>I have to develop a simple application that every 5 seconds fetch a json from a server. I know that this will drain the battery but since I don't have control on the server, this is the only solution I have at the moment, so stay with me. (It's a demo app, the final release will be totally different)</p>

<p><strong>What I did:</strong></p>

<p>I created an IntentService and in his onHandleIntent I do the http request and manage the response asynchronously. Reading the docs, the IntentService is preferred to the Service. At the end, as seen in other topics, I use the AlarmManager class to recreate the intentService. That's the method:</p>

<pre><code>private void repeat() {
    lastTrigger = System.currentTimeMillis();
    alarmManager = (AlarmManager) getSystemService(Context.ALARM_SERVICE);

    Intent serviceIntent = new Intent(this, StatusPollingService.class);
    PendingIntent pendingIntent = PendingIntent.getService(this, 0, serviceIntent, PendingIntent.FLAG_UPDATE_CURRENT);
    alarmManager.set(AlarmManager.RTC_WAKEUP, lastTrigger + UPDATE_INTERVAL, pendingIntent);
}
</code></pre>

<p>In my onCreate in my first Activity, I simply start the service:</p>

<pre><code>    serviceIntent = new Intent(BaseActivity.this, StatusPollingService.class);
    startService(serviceIntent);
</code></pre>

<p><strong>My issues:</strong></p>

<ol>
<li>When I close my application (using back button), the intentService continues to do the requests and recreates itself (as expected), so I have to kill it manually</li>
<li>I'd like to stop to do polling every time my app goes in background and restart when goes in foreground, to limit the battery drain</li>
</ol>

<p><strong>My other issues:</strong></p>

<p>I implemented a class that triggers a listener when the app goes in background/foreground. I implemented the interface in my BaseActivity and in my IntentService. When the app goes in background, a boolean became false and I don't execute the <em>repeat()</em> method. When I go in foreground, in my method <em>onBecameForeground</em> I simply create the service:</p>

<pre><code>    serviceIntent = new Intent(BaseActivity.this, StatusPollingService.class);
@Override
public void onBecameForeground() {
    startService(serviceIntent);
}
</code></pre>

<p>Going in background there's no problem, but going in foreground multiple intentService are created, one intentService per every Activity I have in that moment (I see it in the log).</p>

<p><strong>My questions:</strong></p>

<ol>
<li>Is this the best way to do this job? How could I resolve these problems?</li>
<li>If this is the best (or the less bad) way, how can I create a single instance of the IntentService?</li>
</ol>

<p>Thank you so much for your help</p>",android|polling|intentservice,1701070,Giuseppe Giacoppo,no
How does Cloud to Device Messaging (C2DM) work?,"<p>can somebody explain to me how googles Push Service work?
I know google has a persistent connection to its servers but how come that a persistent connection doesnt drain the battery for no good?</p>

<p>I understand polling on the otherside constantly wake up the system and boot up the radio. But how is this different from a constant connection to a googleserver?
For my understanding you need a permanent active radio to hold that connection?</p>

<p>How can this be more efficient in battery usage than polling?</p>

<p>thanks</p>",android|android-c2dm,335868,Michele,no
Reduce battery drain due to background activity programmatically in iOS,"<p>I tried to use the Energy Log, Network Activity Log etc.., But these tools giving the graphs combining my app with other apps even though I selected my app in the instruments setup. I need to find my individual app battery drain due to background activity.</p>

<p>Is there any alternatives to Instruments in Xcode or process/ steps to find and reduce the battery drain when app is in background mode.   </p>",ios|xamarin.ios|battery|xcode-instruments,4239313,vavilapalli harikrishna,yes
Defining chained string transform functions in Javascript,"<p><a href=""http://javascriptissexy.com/beautiful-javascript-easily-create-chainable-cascading-methods-for-expressiveness/"" rel=""nofollow noreferrer"">Chaining Methods, also known as Cascading</a>, refers to repeatedly calling one method after another on an object, in one continuous line of code. </p>

<p>Writing code like this:</p>

<pre><code>str.replace(""k"", ""R"").toUpperCase().substr(0,4); 
</code></pre>

<p>is not just pleasurable and convenient but also succinct and intelligible. It allows us to read code like a sentence, flowing gracefully across the page. It also frees us from the monotonous, blocky structures we usually construct.</p>

<p><a href=""http://javascriptissexy.com/beautiful-javascript-easily-create-chainable-cascading-methods-for-expressiveness/"" rel=""nofollow noreferrer"">This blog</a> talks about how to do it generally, however considering extending the String prototype will be good enough for my case, I don't know whether it is an overkill or not. </p>

<p>Basically I don't know enough Javascript to make the judgement call of,</p>

<ul>
<li>whether go with the above general way, </li>
<li>or just extend the String prototype, knowing that it is <a href=""https://stackoverflow.com/questions/14034180/"">generally a bad practice</a></li>
<li>or maybe using <a href=""https://blog.sentry.io/2016/02/03/wrap-javascript-functions"" rel=""nofollow noreferrer"">function wrapper</a> (or maybe it is totally irrelevant)</li>
<li>I also know the following is another option, but it's kind of rigid, I.e., translated into my case, it means the string transform can only be<br>
<code>replace(""k"", ""R"")</code> then followed by <code>toUpperCase()</code> then followed by substr(0,4). </li>
</ul>

<p><div class=""snippet"" data-lang=""js"" data-hide=""false"" data-console=""true"" data-babel=""false"">
<div class=""snippet-code"">
<pre class=""snippet-code-js lang-js prettyprint-override""><code>// https://medium.com/javascript-scene/javascript-factory-functions-with-es6-4d224591a8b1
console.log('Begin');

const withConstructor = constructor =&gt; o =&gt; {
  const proto = Object.assign({},
Object.getPrototypeOf(o),
{ constructor }
  );
  return Object.assign(Object.create(proto), o);
};

const pipe = (...fns) =&gt; x =&gt; fns.reduce((y, f) =&gt; f(y), x);
// or `import pipe from 'lodash/fp/flow';`
// Set up some functional mixins
const withFlying = o =&gt; {
  let isFlying = false;
  return {
...o,
fly () {
  isFlying = true;
  return this;
},
land () {
  isFlying = false;
  return this;
},
isFlying: () =&gt; isFlying
  }
};
const withBattery = ({ capacity }) =&gt; o =&gt; {
  let percentCharged = 100;
  return {
...o,
draw (percent) {
  const remaining = percentCharged - percent;
  percentCharged = remaining &gt; 0 ? remaining : 0;
  return this;
},
getCharge: () =&gt; percentCharged,
get capacity () {
  return capacity
}
  };
};
const createDrone = ({ capacity = '3000mAh' }) =&gt; pipe(
  withFlying,
  withBattery({ capacity }),
  withConstructor(createDrone)
)({});
const myDrone = createDrone({ capacity: '5500mAh' });
console.log(`
  can fly:  ${ myDrone.fly().isFlying() === true }
  can land: ${ myDrone.land().isFlying() === false }
  battery capacity: ${ myDrone.capacity }
  battery status: ${ myDrone.draw(50).getCharge() }%
  battery drained: ${ myDrone.draw(75).getCharge() }%
`);
console.log(`
  constructor linked: ${ myDrone.constructor === createDrone }
`);

console.log('End');</code></pre>
</div>
</div>
</p>

<p>To make it simple, I need to define my own functions like</p>

<pre><code>str.transform1(""k"", ""R"").transform2().transform3(0,4); 
</code></pre>

<p>that do just as</p>

<pre><code>str.replace(""k"", ""R"").toUpperCase().substr(0,4); 
</code></pre>

<p>In reality each function will be a set of complicated <code>replace()</code> function call, but let's make it simple for this question. </p>

<p>What best should I do? </p>",javascript|ecmascript-6|chaining|method-chaining,2125837,xpt,no
"google fit app to sync to fit.google.com (raspberry pi, Google Fit REST API)","<p>I would like to track steps on raspberry pi trough Google Fit REST API and act upon step count....</p>

<p>Because of the price and availability I got mi band which sync trough mi fit to google fit app (mobile phone), but data will get to the fit.google.com web just few times a day. So data (mi fit app to fit.google.com web) is delayed even 5h. Which is not really suited for daily tracking.</p>

<p><a href=""https://developers.google.com/fit/overview"" rel=""nofollow noreferrer"">https://developers.google.com/fit/overview</a>
I think I understand why google divided web and android fit API and why it might intentionally not sync to google fitness store more often. But it is a mess.  </p>

<p>questions:</p>

<ol>
<li>can I somehow force google fit app to sync to fit.google.com more often? </li>
<li>is there a work around? or google is the only one who can fix it?</li>
<li>any suggestion on wearable step counter with hourly update API database? eliminating google fit. Fitbit forces GPS to sync to android, so fitbit is battery drain. Garmin API, I have not tested. </li>
</ol>

<p>thanks</p>",android|python|google-fit,10518798,mdgarf,no
iPhone: Battery Efficient way of Realtime GPS Reporting,"<h2>What I want to do:</h2>

<p>I want to have my iPhone to frequently (formally defined later) upload my GPS location to a central server. I want to do this in the most battery efficient way.</p>

<h2>Research I'm aware of:</h2>

<p>Apple Documentation:</p>

<p><a href=""https://developer.apple.com/library/ios/#documentation/CoreLocation/Reference/CLLocation_Class/CLLocation/CLLocation.html#//apple_ref/doc/uid/TP40007126"" rel=""nofollow noreferrer"">https://developer.apple.com/library/ios/#documentation/CoreLocation/Reference/CLLocation_Class/CLLocation/CLLocation.html#//apple_ref/doc/uid/TP40007126</a></p>

<p>Stack Overflow Links:</p>

<p>Response 1</p>

<blockquote>
  <p>Response: proof of existence; some other tool can do it</p>
  
  <p><a href=""https://stackoverflow.com/questions/7646170/how-to-reduce-iphone-battery-consumption-while-using-gps"">How to reduce iPhone battery consumption while using GPS</a></p>
</blockquote>

<p>Response 2</p>

<blockquote>
  <p>Response: track only cell tower changes</p>
  
  <p><a href=""https://stackoverflow.com/questions/8689626/iphone-gps-battery-draining-extremely-fast"">iPhone GPS - Battery Draining Extremely Fast </a></p>
  
  <p><a href=""https://stackoverflow.com/questions/7349417/iphone-running-periodical-process-in-the-background-battery-optimized-way"">iPhone running periodical process in the background - battery optimized way</a></p>
</blockquote>

<h2>Question</h2>

<p>My question is a bit vague in that my definition of ""frequently"" is really dependent on what the battery life can tolerate. For example, if the battery can take updates of every 5 minutes, I'd like to do it every five minutes; if the battery could do this every 10 seconds, I'd like to do it every 10 seconds.</p>

<p>I really want to understand</p>

<ul>
<li>the different ways (change on significant location, timer, background?) continuously uploading GPS locations can be implemented</li>
<li>advantages / disadvantages</li>
<li>approximately how long the battery life can last in each case</li>
</ul>

<p>This seems like a fairly generic and common problem. Does anyone know of either:</p>

<ul>
<li>an in depth analysis of the various methods</li>
<li>or if there is a single ""optimal"" way to do this?</li>
</ul>

<p>[Moderators: feel free to mark this comment wiki. I'd love to just get lots of different answers + cost benefit analysis of them.]</p>",iphone|gps,1416711,user1416711,yes
Windows 8.1 Auto start up,<p>I have a Windows 8.1 tablet that I need to be on 24/7. So if the power cuts out and the battery drains to 0% I need it to automatically start as soon as the power is back on and starting to charge the unit. How can I set this to happen?</p>,windows|settings|startup,5100856,Brett,yes
Predict value in python,"<p>I have a device that periodically sends data in the cloud consisting of pairs (timestamp, battery level) and I need to estimate the remaining battery time using python. For example, if battery level is 80%, python script uses data in the cloud to make a prediction of the remaining battery time.
Also, as you can see from the picture (<a href=""https://i.stack.imgur.com/WafRD.png"" rel=""nofollow noreferrer"">https://i.stack.imgur.com/WafRD.png</a>), I know what is the progress of the battery drain (x axis of chart represents the seconds elapsed when the device is turned on).</p>

<p>I am just a beginner and I tried with polynomial regression of scikit-learn. Following a tutorial, I wrote this function:</p>

<pre><code>#x_energy and y_time are list
def predict(x_energy, y_time):
   from sklearn.preprocessing import PolynomialFeatures
   import numpy as np

   X = np.array(x_energy) [:, np.newaxis]
   Y = np.array(y_time)

   pr = linear_model.LinearRegression()
   quadratic = PolynomialFeatures(degree=2)
   X_quad = quadratic.fit_transform(X)

   X_fit = np.arange(0, max(X), 1)[:, np.newaxis]
   pr.fit(X_quad, Y)
   y_quad_fit = pr.predict(quadratic.fit_transform(X_fit))

   return y_quad_fit[0]
</code></pre>

<p>but I did not have satisfactory results. This image is an example: <a href=""https://i.stack.imgur.com/OETJK.png"" rel=""nofollow noreferrer"">https://i.stack.imgur.com/OETJK.png</a>. I have to reduce as much as possible the distance between the prediction (blue line) and the correct remaining time (red line). </p>

<p>Can anyone help me? </p>",python|regression|predict,5899407,darko,yes
Reading values from BLE device,"<p>I'm owning a Polar H10 chest strap which operates with blueooth low energy and provides heart rate and heart rate variability.</p>

<p>I want to read out these values with an Android app. I'm able to connect to the device thanks to the help in the <a href=""https://developer.android.com/guide/topics/connectivity/bluetooth-le.html#close"" rel=""nofollow noreferrer"">official BLE tutorial</a>. The problem now is to read out the heart rate and heart rate variability values from the device. Everytime a new value is available on the device I want to read out this value (and there are at least every second new values).</p>

<p>I have found the following pieces of code:</p>

<pre><code>private static double extractHeartRate(
            BluetoothGattCharacteristic characteristic) {

        int flag = characteristic.getProperties();
        Log.d(TAG, ""Heart rate flag: "" + flag);
        int format = -1;
        // Heart rate bit number format
        if ((flag &amp; 0x01) != 0) {
            format = BluetoothGattCharacteristic.FORMAT_UINT16;
            Log.d(TAG, ""Heart rate format UINT16."");
        } else {
            format = BluetoothGattCharacteristic.FORMAT_UINT8;
            Log.d(TAG, ""Heart rate format UINT8."");
        }
        final int heartRate = characteristic.getIntValue(format, 1);
        Log.d(TAG, String.format(""Received heart rate: %d"", heartRate));
        return heartRate;
    }



private static Integer[] extractBeatToBeatInterval(
            BluetoothGattCharacteristic characteristic) {

        int flag = characteristic.getIntValue(BluetoothGattCharacteristic.FORMAT_UINT8, 0);
        int format = -1;
        int energy = -1;
        int offset = 1; // This depends on hear rate value format and if there is energy data
        int rr_count = 0;

        if ((flag &amp; 0x01) != 0) {
            format = BluetoothGattCharacteristic.FORMAT_UINT16;
            Log.d(TAG, ""Heart rate format UINT16."");
            offset = 3;
        } else {
            format = BluetoothGattCharacteristic.FORMAT_UINT8;
            Log.d(TAG, ""Heart rate format UINT8."");
            offset = 2;
        }
        if ((flag &amp; 0x08) != 0) {
            // calories present
            energy = characteristic.getIntValue(BluetoothGattCharacteristic.FORMAT_UINT16, offset);
            offset += 2;
            Log.d(TAG, ""Received energy: {}""+ energy);
        }
        if ((flag &amp; 0x16) != 0){
            // RR stuff.
            Log.d(TAG, ""RR stuff found at offset: ""+ offset);
            Log.d(TAG, ""RR length: ""+ (characteristic.getValue()).length);
            rr_count = ((characteristic.getValue()).length - offset) / 2;
            Log.d(TAG, ""RR length: ""+ (characteristic.getValue()).length);
            Log.d(TAG, ""rr_count: ""+ rr_count);
            if (rr_count &gt; 0) {
                Integer[] mRr_values = new Integer[rr_count];
                for (int i = 0; i &lt; rr_count; i++) {
                    mRr_values[i] = characteristic.getIntValue(
                            BluetoothGattCharacteristic.FORMAT_UINT16, offset);
                    offset += 2;
                    Log.d(TAG, ""Received RR: "" + mRr_values[i]);
                }
                return mRr_values;
            }
        }
        Log.d(TAG, ""No RR data on this update: "");
        return null;
    }
</code></pre>

<p>How can I use it to extract the heart rate and r-r intervals (beat to beat intervals) assuming that I have a connection to the device? I would be happy if somebody could make a short example. Addtionally, I would like to use a service so that it runs in the background and I can do other work and it drains less battery. But the service should have highest priority so that it get not killed.</p>

<p>In the <code>extractBeatToBeatInterval()</code> method there is a <code>int offset = 1;</code> with the description </p>

<blockquote>
  <p>This depends on hear rate value format and if there is energy data</p>
</blockquote>

<p>I don't understand the meaning of this offest. What offset value should I use?</p>

<p>Second, if the connection breaks I would like to get a notification so that I can handle it (e.g. displaying a message). How can I do that?</p>",android|bluetooth-lowenergy|android-bluetooth,1684118,machinery,no
iOS : Region monitoring and battery usage,"<p>I would like to use region monitoring in iOS , for location based alerts/calculations.</p>

<p>I'm worried that it would drain the battery. 
I searched for it on the iOS reference , and couldn't find any evidence for it. </p>

<p>Is that service available at all times , regardless of the region monitoring (i.e. scanned every minute or so...)  or should I use the ""significant location change"" API instead ? </p>

<p>update : so , battery usage isn't dramatic. Its pretty good actually. 
would like to receive some advice regarding switching between the modes (region/standard).</p>",ios|core-location|power-management,764575,Nir Golan,yes
android app go to sleep mode when running on background,"<p>could my app does not use power and data when running on the background?</p>

<p>my app is native app and i want my app does not need run when on the background. But after I test use software LittleEye, my app consump power, memory, and data when running on background. How the way my app go to sleep when running on the background? (for prevent battery drain)</p>",android|background|sleep,3217512,umi533,yes
"Launching a service periodically, drains to much battery","<p>I am designing a service that runs in the background and triggers every hour for some small work. While the app is running, the service will trigger every 10 seconds, and after app quit go back to 1 hour interval.</p>

<p>It is very important for my app to not be interrupted so I am using a WakefulBroadcastReceiver like recommended in the google docs on this topic.</p>

<p>But it seems that my app drains a lot of battery. Enough to make charging significantly slower. And battery status shows 60% on system, screen etc. and no notice of my app. So I am thinking, that my app accidentally keeps the phone awake but uses no CPU itself.</p>

<p>Since I want to be sure to not have this caused by my app (and drain other peoples phones) I want to ask you if there is something obviously wrong in the way I am implementing the service. </p>

<p><strong>Main Activity</strong></p>

<pre><code>/*import*/
public class MainActivity extends Activity {

    public static String versionname;
    public static int versioncode;


    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        AlarmManager alarmMgr;
        PendingIntent alarmIntent;
        alarmMgr = (AlarmManager)getApplicationContext().getSystemService(Context.ALARM_SERVICE);
        Intent newintent = new Intent(getApplicationContext(), WakefulTickReceiver.class);
        alarmIntent = PendingIntent.getBroadcast(getApplicationContext(), 0, newintent, 0);
        alarmMgr.set(AlarmManager.ELAPSED_REALTIME_WAKEUP,
                SystemClock.elapsedRealtime() +
                        1 * 1000, alarmIntent);

        pm.setComponentEnabledSetting(receiver,
                PackageManager.COMPONENT_ENABLED_STATE_ENABLED,
                PackageManager.DONT_KILL_APP);

        setContentView(R.layout.activity_main);
    }
}
</code></pre>

<p><strong>WakefulBroadcastReceiver</strong></p>

<pre><code>/*import*/
public class WakefulTickReceiver extends WakefulBroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        // Start the service, keeping the device awake while the service is
        // launching. This is the Intent to deliver to the service.
        Intent service = new Intent(context, TickIntendService.class);
        service.setAction(intent.getAction());
        startWakefulService(context, service);
    }
}
</code></pre>

<p><strong>IntentService</strong></p>

<pre><code>/*import*/
public class TickIntendService extends IntentService {

    public static final int NOTIFICATION_ID = 1;
    private NotificationManager mNotificationManager;
    NotificationCompat.Builder builder;

    public void sheduleIntent(){
        AlarmManager alarmMgr;
        PendingIntent alarmIntent;
        alarmMgr = (AlarmManager)getApplicationContext().getSystemService(Context.ALARM_SERVICE);
        Intent newintent = new Intent(getApplicationContext(), WakefulTickReceiver.class);
        alarmIntent = PendingIntent.getBroadcast(getApplicationContext(), 0, newintent, 0);
        alarmMgr.set(AlarmManager.ELAPSED_REALTIME_WAKEUP,
                SystemClock.elapsedRealtime() +
                        60 * 60 * 1000, alarmIntent);
    }

    /**
     * The IntentService calls this method from the default worker thread with
     * the intent that started the service. When this method returns, IntentService
     * stops the service, as appropriate.
     */
    @Override
    protected void onHandleIntent(Intent intent) {
        Log.i(""IdleHacker"",""#~# starting service intent on "" + intent.toString());



        if (intent.getAction() != null &amp;&amp; intent.getAction().equals(""android.intent.action.BOOT_COMPLETED"")) {
            Log.i(""IdleHacker"",""starting boot service intent on "" + intent.toString());
            sheduleIntent();
            return;
        }

        Bundle extras = intent.getExtras();
        // Do the work that requires your app to keep the CPU running.

        // Normally we would do some work here, like download a file.
        sheduleIntent();
        // Release the wake lock provided by the WakefulBroadcastReceiver.
        WakefulTickReceiver.completeWakefulIntent(intent);
    }

    /**
     * A constructor is required, and must call the super IntentService(String)
     * constructor with a name for the worker thread.
     */
    public TickIntendService() {
        super(""TickService"");
    }

}
</code></pre>

<p><strong>Manifest</strong></p>

<pre><code>&lt;?xml version=""1.0"" encoding=""UTF-8""?&gt;
&lt;manifest xmlns:android=""http://schemas.android.com/apk/res/android"" &gt;
    &lt;application&gt;
        &lt;activity android:name="".view.MainActivity""&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=""android.intent.action.MAIN"" /&gt;
                &lt;category android:name=""android.intent.category.LAUNCHER"" /&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
        &lt;service android:name="".service.TickIntendService""&gt;&lt;/service&gt;
        &lt;receiver android:name="".service.WakefulTickReceiver""
            android:enabled=""false""&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=""android.intent.action.BOOT_COMPLETED""&gt;&lt;/action&gt;
            &lt;/intent-filter&gt;
        &lt;/receiver&gt;
    &lt;/application&gt;
    &lt;uses-permission android:name=""android.permission.RECEIVE_BOOT_COMPLETED""/&gt;
    &lt;uses-permission android:name=""android.permission.WAKE_LOCK""/&gt;
&lt;/manifest&gt;
</code></pre>

<p>I tried to remove everything unnecessary, if something is missing, please write a comment!</p>",android|battery-saver,1275025,reggaemuffin,no
Compact Framework - System.Threading.Timer stops when the user turns off the screen,"<p>I have an application that needs to ""poll"" a webservice to see if the user has any new messages waiting.  I have no control over the webservice so I cannot switch to a ""push"" mechanism, I'm stuck making a request every X number of seconds to see what's available.</p>

<p>I am using a System.Threading.Timer to make the request every so often, but am encountering a few problems.  The biggest is that it stops running when the phone is sent into ""standby"" mode (screen off, but still able to get calls and email/txt notifications).  </p>

<p>I'd really like it to behave like other background applications.  What can I do to make it work without being too big of a drain on the battery?</p>",compact-framework|power-management,22383,Jake Stevenson,yes
Meaning of Criteria.POWER_LOW for LocationManager,"<p>The <a href=""https://developer.android.com/reference/android/location/Criteria#NO_REQUIREMENT"" rel=""nofollow noreferrer"">Criteria class</a> is not documented in much detail.<br />
Can someone please explain what <code>POWER_HIGH</code> and <code>POWER_LOW</code> change exactly?<br />
Is it about battery drainage?</p>
<pre><code>criteria.setPowerRequirement(Criteria.POWER_LOW);                
criteria.setAccuracy(Criteria.ACCURACY_FINE);
...
locationManager.requestSingleUpdate(criteria, locationListener, null);
</code></pre>
<hr />
<p><strong>Update</strong>:
I went through some of the source code. It turns out this parameter is ignored in my example because an accuracy is set as well.</p>
<p><code>createFromDeprecatedCriteria()</code> in  <code>LocationRequest.java</code>:</p>
<pre><code>    ...
    int quality;
    switch (criteria.getAccuracy()) {
        case Criteria.ACCURACY_COARSE:
            quality = ACCURACY_BLOCK;
            break;
        case Criteria.ACCURACY_FINE:
            quality = ACCURACY_FINE;
            break;
        default: {
            if (criteria.getPowerRequirement() == Criteria.POWER_HIGH) {
                quality = POWER_HIGH;
            } else {
                quality = POWER_LOW;
            }
        }
    }
    ...
</code></pre>",android|gps|locationmanager|android-gps,962638,einUsername,no
Are there any technical reasons for video bitrate limitation on some browsers?,"<p>We'll be using Netflix as a real case example. Netflix can stream on most browsers (chrome, firefox) at max 720p, while in Edge and in the windows app at 1080p. Scouring the web I found some news articles, but none gave any reason (technical or marketing or otherwise). <a href=""http://www.ghacks.net/2016/01/12/want-1080p-playback-on-netflix-dont-use-firefox-or-chrome/"" rel=""nofollow noreferrer"">This article</a> seems to imply there is some technology in the Edge engine that takes advantage of some Windows 10 ""platform features"", but nothing is clearly explained. <a href=""https://blogs.windows.com/windowsexperience/2016/07/13/get-better-quality-video-with-microsoft-edge/"" rel=""nofollow noreferrer"">This Microsoft blog</a> (cited in the previous article) just brags how Edge offers better streaming quality while draining less power, again without giving a explicit reason. I want to mention that the 720p limitation exists on desktops so battery efficiency can't be a factor.</p>

<p>The only case where streaming throughput is actually limited across devices and the limitation makes sense is when some hardware is involved. E.e. different cable standards, different chipsets, etc.</p>

<p>I can't think of a technical sound reason why streaming throughput would have different limits on different browsers. In the context of <strong>the same streaming source, and on the same machine, same OS, same ISP, same everything except browsers</strong>.</p>

<blockquote>
  <p>As quality increases, so does the need for strong Digital Rights
  Management (DRM), systems that protect media streams so that they can
  only be played by users authorized by the streaming service.  This is
  important now as companies make decisions to stream 1080p, and will
  become even more important as video resolutions increase. Content
  owners will not stream premium content if it can be easily saved and
  shared outside the service.</p>
  
  <p>Microsoft Edge was built to take advantage of platform features in
  Windows 10.  It is optimized to use PlayReady Content Protection and
  the media engine’s Protected Media Path, whereas Chrome and Opera
  implement Widevine, and Firefox implements both Adobe Access and
  Widevine.  Like video decode efficiency, content protection in the
  platform and closer to the hardware can offer superior performance. 
  Likewise, the better the content protection, the better the video
  quality the service is likely to provide to that browser.</p>
</blockquote>

<p>It looks like Content Protection is at fault here. But then again why would a library - any library - be able to successfully play 720p videos, but fail for 1080p? Did we go back to the era where if your game score would go above 255 it would overflow and become negative?</p>

<hr>

<p>tldr; Technical/technological reasons why a browser can't play a video stream above a certain bitrate? (and it's not the internet connection).</p>",html|google-chrome|video-streaming|html5-video|microsoft-edge,2805305,bolov,no
Acquiring WifiManager.MulticastLock on Android devices - reliable and consistent?,"<p>I am thinking of developing an Android app that would, as part of it's function, send-to and receive-from broadcast messages from all devices that are currently connected to a WiFi network.</p>

<p>While a lot of developers have suggested that such a requirement would need the application to acquire the MulticastLock, there are <a href=""http://codeisland.org/2012/udp-multicast-on-android/"" rel=""nofollow"">experiences out there</a> that say:</p>

<ol>
<li>Acquiring the MulticastLock successfully cannot be relied upon since the acquire() method does not return any status on the operation requested.</li>
<li>And even if you do acquire the lock, it's not guaranteed that the WiFi stack does not filter out packets that are not directed at the device.</li>
</ol>

<p>There are others that say multicastlock works reliably on versions 2.3.3 and above and that the problem of reliability is only for devices running 2.3.2 and below.</p>

<p>Some of them say nothing is guaranteed (now or for future devices) as support for broadcast and multicast is a chipset controlled functionality and that OEMs have the final say. They cite battery drain being the primary motivation for OEMs to either allow or deny software configuration of the chipset.</p>

<p>So, before i delve into my project, i wish to know what the current state of this issue is and if what i am trying to do is feasible i.e no guess work involved. If there is a work around, i am willing to implement that as long as i know it will work reliably. Kindly share your opinions and experiences. Thanks in advance.</p>",android|jmdns,693959,VJ Vélan Solutions,yes
Performing an action based on location,"<p>I'm creating an app wherein I'm need to perform an action when I'm within a certain radius of a location. But I don't want to be continuously polling the location because that'll drain the battery.</p>

<p>I thought about just putting an option for the user to specify how often to query the location.  However, I'm concerned that if the user sets it too long, then my app will miss performing the action when it's near the location.</p>

<p>I in one Google IO session that Pay With Square had an auto tab feature, I'm not sure if they're constantly polling the location, have setting for the delay between querying the location or a third option that's efficient without draining the battery.</p>

<p>I would like to ask for suggestions on how to approach this.
Thanks in advance.</p>",android|geolocation|gps,415952,raistdejesus,yes
Socket connections and Polling. Which is a better solution in terms of battery life?,"<p>So... I'm making an application for Android. The application needs to send and receive realtime chat data (needs to be a socket) but it also needs to send commands (which don't as the client knows when it is sending something). </p>

<p>I need to know what is a better solution in terms of saving the user's battery.</p>

<p><strong>a)</strong> Opening and Closing the connection every time a command is sent, if the chat tab is opened then keep the connection constant. </p>

<p><strong>b)</strong> Keep the connection constant all the time. </p>

<p>I've taken a look around the internet but have gotten mixed answers, some say keeping a persistent connection is bad for battery life and others say that it isn't (Example: <em>""Are you asking if holding a TCP connection open will drain battery-life? Maybe I am WAY off here but, holding a connection open shouldn't waste battery life... If you think it will I would love to know where you got that information. It sounds SO strange to me.""</em>)</p>

<p>Or if there is another solution that would be better. I don't think that Google's C2DM would be very useful at all in this situation either. </p>

<p>Basically, what drains the battery more: having a persistent connection, or opening and closing the connection unless the chat tab is open?</p>

<p>Thanks!</p>",android|sockets|tcp|polling|battery,1091077,shadrx,yes
Battery conservation with camera preview in Google Glass,"<p>I am developing a Google Glass app and one of the major problems I seem to be having is that the <strong>device will overheat</strong> after the <strong>camera preview is displayed for a period longer than about 5 minutes</strong>. </p>

<p>My question is: <strong>Are there settings that can be adjusted such that the camera preview display uses less power from the battery?</strong> This is in hopes that using less power will keep the device from overheating as well. (When tested, the app can run ~50 minutes before draining the battery from 100% to 0%)</p>",android|google-glass|battery|overheating,1792850,King_Kumar,yes
Creating background services for Bluetooth low energy on Android,"<p><strong>Background</strong>:</p>

<p>Ideally I would like my Android device to be scanning for Bluetooth Low Energy devices all the time an the ability to start an application whenever a new device with specific properties appears.</p>

<p>So the broadcast packet in BLE will for instance enumerate a set of services provided by the broadcasting device. An app would then be able to register an interest for certain services and automatically be started when a device with this services comes into range.</p>

<p>From what I understand this is not how the Android BLE API works? So how can I get something similar?</p>

<p><strong>Simplest possible example</strong>:</p>

<p>I have a BLE sensor that logs ambient temperature over time. Whenever my Android phone is close enough I want to connect and download all the data, sending it to some cloud storage solution. This app would not need any GUI (at least not after configuration is done). But how should it run in the background without draining the battery, but still give me a fairly good chance of connecting the device quickly once it is in range?</p>

<p><strong>Question</strong>:</p>

<p>Do I need to set a timer and wake the app every once in a while and then manually start scanning? What kind of intervals should I then choose. How long can I leave the scanner running without adversely affecting the battery?</p>

<p><strong>Possible solution</strong>:</p>

<p>This is what I've come up with so far.</p>

<ul>
<li>A configuration activity to set the intervals and devices to scan for</li>
<li>The configuration activity will set up an WakefulBroadcastReceiver similar to the <a href=""https://android.googlesource.com/platform/developers/samples/android/+/d26c23e/background/alarms/Scheduler/"" rel=""noreferrer"">Scheduler</a> example</li>
<li>When the receiver get's the onReceive event I start a BLE scan service (that I've written) as a wakeful service.</li>
<li>The scan service starts scanning (with a registered callback).</li>
<li>The service might get adv reports that it can act upon</li>
<li>After a timeout the service will stop the scanner and end the wakeful service.</li>
</ul>

<p>This works, but I'm not sure it's the best way. I also don't know how small intervals I can have and still avoid destroying the battery life. What I would want is to start scanning every two minutes, scanning for 10-20 seconds. But I'm afraid that would be rather frequently to wake up the device?</p>",android|bluetooth-lowenergy,104776,Vegar Westerlund,yes
"Android getting GPS Location on a fixed interval, how much impact on Battery and what goes in the background If we are getting location per hour","<p>When getting GPS location on a fixed interval (say per hour), does this drain the battery every hour, every minute or only when either actually getting the location each hour or updating the location.  I'm eager to know what goes on in the background.  </p>

<p>Here is what <a href=""http://developer.android.com/reference/android/location/LocationManager.html#requestLocationUpdates%28long,%20float,%20android.location.Criteria,%20android.app.PendingIntent%29"" rel=""nofollow"">this reference</a> says</p>

<blockquote>
  <p><strong>""Background services should be careful about setting a sufficiently high minTime so that the device doesn't consume too much power by keeping the GPS or wireless radios on all the time. In particular, values under 60000ms are not recommended. ""</strong></p>
</blockquote>

<p>So I'm hoping that when the location is changed, or after minTime, the GPS radios are on, and after getting location, the GPS radios are off</p>

<p>Can anyone confirm this to be true?  </p>",android|gps|location|power-management,369371,Gajendra Bang,no
CLLocationManager geo-fencing/startMonitoringForRegion: vs. startMonitoringForSignificantLocationChanges: vs. 10-minute startUpdating calls,"<p>I am trying to set up an app that will be able to check people's locations in the background, see if they are at a given location, and send a ping to a server if they are.  We do not want to drain the energy of our users, so we are attempting to figure out the best solution.</p>

<p>I've done substantial reading and I have not found very much information on these methods.  I'll go through the pros and cons as I understand them right now</p>

<p><strong>startMonitoringForSignificantChanges</strong></p>

<p>Description: Based off of wi-fi and cell tower changes the system wakes up the app.</p>

<p><a href=""http://developer.apple.com/library/ios/documentation/CoreLocation/Reference/CLLocationManager_Class/CLLocationManager/CLLocationManager.html#//apple_ref/occ/instm/CLLocationManager/startMonitoringSignificantLocationChanges"" rel=""nofollow noreferrer"">Docs</a>:</p>

<blockquote>
  <p>Apps can expect a notification as soon as the device moves 500 meters
  or more from its previous notification. It should not expect
  notifications more frequently than once every five minutes. If the
  device is able to retrieve data from the network, the location manager
  is much more likely to deliver notifications in a timely manner.</p>
</blockquote>

<p>Pros:</p>

<ul>
<li>Most battery efficient</li>
</ul>

<p>Cons:</p>

<ul>
<li>Dependent on wi-fi/cell tower changes</li>
<li>Can only assume that this will be called every 200m to 2km (if not more in certain areas)</li>
<li><a href=""http://longweekendmobile.com/2010/07/22/iphone-background-gps-accurate-to-500-meters-not-enough-for-foot-traffic/"" rel=""nofollow noreferrer"">More on accuracy</a></li>
<li>Thus, inconsistent and imprecise</li>
</ul>

<p><strong><a href=""https://stackoverflow.com/questions/6347503/how-do-i-get-a-background-location-update-every-n-minutes-in-my-ios-application"">10-minute start-updating</a> or ""n-minute updating"":</strong></p>

<p>Description: This basically asks the app for more time, when that extra time is about to expire, it calls [self.locationManager startUpdating], grabs the location and extends the background thread for 10 more minutes.</p>

<p>Pros:</p>

<ul>
<li>Consistent </li>
<li>Can be as accurate as you want it to be as consistently as you
want it</li>
</ul>

<p>Cons:</p>

<ul>
<li>Has to do a call every ten minutes or less to keep the app running in the
background (ie n can't be greater than 10 for the calls)</li>
</ul>

<p>Questions:
What effect does this have on the battery? Does waking up the GPS and shutting it off hurt the battery more?  I couldn't imagine running a brief location check in the background would drain the battery that much... but then again, I don't know what goes into powering up the GPS and getting a usable signal.</p>

<p><strong>startMonitoringForRegion (geo-fencing):</strong></p>

<p>Simply put, your app gets woken up when you enter into a pre-defined region. This is the oddball of them, it is more recent and there is less documentation on it.  I can't find a good description on how the ""system monitors"" the boundary crossing.  For all I know it is some really smart algorithm, or they are constantly pinging the GPS which would make it less effective than the other methods for doing this.</p>

<p>Pros:</p>

<ul>
<li>Simple implementation </li>
<li>Managed by the system so you don't have to invent your own ad hoc geo-fences Only triggers on boundary crossing... no unnecessary data to just throw out in exchange for a battery hit</li>
<li>Thus, should be the best for this sort of thing, accurate, managed by the system</li>
</ul>

<p>Cons:</p>

<ul>
<li><a href=""https://stackoverflow.com/questions/9053029/does-startmonitoringforregion-actually-work"">People question its effectiveness</a></li>
<li>Huge conflicts on whether or not it is good for battery life or if it
drains battery life terribly.</li>
<li>How is the system monitoring this!?</li>
<li>Basically, indeterminate behavior.</li>
</ul>

<p>I guess my question boils down to how does startMonitoringForRegion: compare to these other methods of testing user location in the background when it comes to battery life, consistency, and precision.  Has anyone thoroughly tested this?  Or used it in their app and gotten at least some feedback?  Likely, for my purposes, the trade-off is between geo-fencing and the 10 minute update method.  (Also given what Apple has publicly said about iOS7 there will be some background tasks... will this change the calculus for the trade-off between these two methods?) Does anyone have an idea of how these two compare?</p>

<p>Thanks so much! Looking forward to seeing if we can get to the bottom of how to compare these methods.</p>",iphone|ios|objective-c|core-location|cllocationmanager,1642663,AdamG,yes
Why is my dialog working so hard only for landscape layout?,"<p>I have a custom dialog that is showing in the logcat non-stop complains per second like this:</p>
<pre><code>...
I: Relayout returned: old=(85,32,2400,1048) new=(85,32,2400,1048) req=(2187,1016)0 dur=11 res=0x1 s={true 528095150080} ch=false fn=5
I: Relayout returned: old=(85,32,2400,1048) new=(85,32,2400,1048) req=(2187,1016)0 dur=9 res=0x1 s={true 528095150080} ch=false fn=5
I: Relayout returned: old=(85,32,2400,1048) new=(85,32,2400,1048) req=(2187,1016)0 dur=9 res=0x1 s={true 528095150080} ch=false fn=5
I: Relayout returned: old=(85,32,2400,1048) new=(85,32,2400,1048) req=(2187,1016)0 dur=7 res=0x1 s={true 528095150080} ch=false fn=5
I: Relayout returned: old=(85,32,2400,1048) new=(85,32,2400,1048) req=(2187,1016)0 dur=9 res=0x1 s={true 528095150080} ch=false fn=5
I: Relayout returned: old=(85,32,2400,1048) new=(85,32,2400,1048) req=(2187,1016)0 dur=7 res=0x1 s={true 528095150080} ch=false fn=5
I: Relayout returned: old=(85,32,2400,1048) new=(85,32,2400,1048) req=(2187,1016)0 dur=8 res=0x1 s={true 528095150080} ch=false fn=5
I: Relayout returned: old=(85,32,2400,1048) new=(85,32,2400,1048) req=(2187,1016)0 dur=5 res=0x1 s={true 528095150080} ch=false fn=5
I: Relayout returned: old=(85,32,2400,1048) new=(85,32,2400,1048) req=(2187,1016)0 dur=10 res=0x1 s={true 528095150080} ch=false fn=5
I: Relayout returned: old=(85,32,2400,1048) new=(85,32,2400,1048) req=(2187,1016)0 dur=6 res=0x1 s={true 528095150080} ch=false fn=5
I: Relayout returned: old=(85,32,2400,1048) new=(85,32,2400,1048) req=(2187,1016)0 dur=9 res=0x1 s={true 528095150080} ch=false fn=5
I: Relayout returned: old=(85,32,2400,1048) new=(85,32,2400,1048) req=(2187,1016)0 dur=9 res=0x1 s={true 528095150080} ch=false fn=5
...
</code></pre>
<p>This is for the landscape version of the layout... which does not contain any relative layout! The portrait layout does not show any problem, and the code does not distinguishes between the layouts.</p>
<p>If I add</p>
<pre><code>android:theme=&quot;@android:style/Theme.Dialog&quot;
</code></pre>
<p>to the AndroidManifest file overriding the app theme, I do not see this problem, but I do see an error:</p>
<pre><code>This custom view should extend androidx.appcompat.widget.AppCompatImageView instead
</code></pre>
<p>since the dialog has a view that extends <code>androidx.appcompat.widget.AppCompatImageView</code>.</p>
<p>Why is it working so hard (draining the battery)?</p>",android|android-layout|dialog,1483390,Luis A. Florit,no
How to sync a ValueAnimator with a MediaPlayer loop?,"<p>My app plays a few seconds wav song in a loop through <code>MediaPlayer.setLooping(true)</code>, and I want an indicator (a simple 3dp width view) that moves on the screen showing the progress, starting over at the left when the song restarts in the loop.</p>
<p>One way of doing this is through a <code>HandlerTask</code> like this:</p>
<pre><code>mHandlerTask = new Runnable() {
@Override
public void run() {
    if (mms != null &amp;&amp; mms.isPlaying()) {
        playprogress.setTranslationX(playprogresswidth * mms.getCurrentPosition() / duration);
    }
    mHandler.postDelayed(this, 500);
}
</code></pre>
<p>This works, but the movement is not continuous, with jumps every 500ms. Of course I can choose 50, or 5, or 1, instead 500, but then that should be quite heavy and a battery drainer.</p>
<p>So I implemented a <code>ValueAnimator</code>, like this:</p>
<pre><code>ValueAnimator animation = ObjectAnimator.ofFloat(playprogress, &quot;translationX&quot;, playprogresswidth);
animation.setRepeatCount(ValueAnimator.INFINITE);
animation.setRepeatMode(ValueAnimator.RESTART);
animation.setDuration(duration);
animation.setInterpolator(new LinearInterpolator());
animation.start();
</code></pre>
<p>This works, except for the fact that the <code>MediaPlayer</code> and the <code>animation</code> are not perfectly synced, and go out of sync more and more as the loop restarts. And this actually makes sense: the <code>MediaPlayer</code> needs some extra time for the restart.</p>
<p>So how I can sync both? I could not find any listener in <code>MediaPlayer</code> to trigger a single animation for each loop. I tried with an <code>animation.addListener(new Animator.AnimatorListener() {...})</code> to try to fiddle in the duration without much luck. This is the best I got so far, with a non-repeat animation (<code>mms</code> is the <code>MediaPlayer</code>):</p>
<pre><code>ValueAnimator animation = ObjectAnimator.ofFloat(playprogress, &quot;translationX&quot;, playprogresswidth);
animation.setDuration(duration+150);
animation.setInterpolator(new LinearInterpolator());
animation.addListener(new Animator.AnimatorListener() {
    @Override
    public void onAnimationStart(Animator animation) {}
    @Override
    public void onAnimationEnd(Animator animation) {
        if (mms != null &amp;&amp; mms.isPlaying()) {
            animation.setDuration(duration - mms.getCurrentPosition() + 150);
            animation.start();
        }
    }
    @Override
    public void onAnimationCancel(Animator animation) {}
    @Override
    public void onAnimationRepeat(Animator animation) {}
});
animation.start();
</code></pre>
<p>The problem with this approach is that 150: it should be device independent.</p>
<p><strong>EDIT</strong></p>
<p>I found a much better solution, although probably not the best one yet:</p>
<hr />
<pre><code>playprogress.setTranslationX(0);
ValueAnimator animation = ObjectAnimator.ofFloat(playprogress, &quot;translationX&quot;, playprogresswidth);
animation.setInterpolator(new LinearInterpolator());
animation.setDuration(duration);
animation.addListener(new AnimatorListenerAdapter() {
    @Override
    public void onAnimationEnd(Animator animation) {
        if (mms != null &amp;&amp; mms.isPlaying()) {
            animation.setStartDelay(duration-mms.getCurrentPosition());
            animation.start();
        }
    }
});
animation.start();
</code></pre>",android|loops|synchronization|repeat|animator,1483390,Luis A. Florit,no
Android mediaplayer endless buffering,"<p>I'm developing online streaming player on Android. I found that mediaplayer wont ever stop buffering! It reads 100% of buffer and keeps doing 'something', because stream can only be read only once and there nothing left to buffer...
I see that </p>

<pre><code>public void onBufferingUpdate(MediaPlayer player, int percent)
</code></pre>

<p>is called endlessly with percent = 100. It drains battery over one night.  Am I doing something wrong or there is some reasonable explanation on this? It seems that buffering can not be canceled, the only way to stop it is to reset mediaplayer itself. I need some way to stop this endless 'buffering'!</p>

<p>This how I init mediaplayer</p>

<pre><code>mMediaPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);
mMediaPlayer.setDataSource(streamUrl);
mMediaPlayer.setOnBufferingUpdateListener(this);
mMediaPlayer.setOnInfoListener(this);
mMediaPlayer.setOnPreparedListener(this);
mMediaPlayer.setOnErrorListener(this);
mMediaPlayer.prepareAsync();
</code></pre>

<p>Log messages I see:</p>

<pre><code>10-30 08:45:21.169: D/MediaPlayer(13217): Message: MEDIA_BUFFERING_UPDATE(3), ext1=93, ext2=0x0
10-30 08:45:22.169: D/MediaPlayer(13217): Message: MEDIA_BUFFERING_UPDATE(3), ext1=100, ext2=0x0
10-30 08:45:23.169: D/MediaPlayer(13217): Message: MEDIA_BUFFERING_UPDATE(3), ext1=100, ext2=0x0
10-30 08:45:24.172: D/MediaPlayer(13217): Message: MEDIA_BUFFERING_UPDATE(3), ext1=100, ext2=0x0
10-30 08:45:25.172: D/MediaPlayer(13217): Message: MEDIA_BUFFERING_UPDATE(3), ext1=100, ext2=0x0
...
</code></pre>",java|android|android-mediaplayer,2935082,Arvydas,yes
Heavy CPU analysis while running foreground service,"<p>So, I've a <code>Service</code> that is important for applications logic and thus needs to be alive all the time. 
First thing is first, I created it as a <code>foreground service</code>.</p>

<p>Whenever user starts to run, <code>Service</code> starts to do a lot of heavy things. It uses <code>FusedLocationAPI</code> different type of sensors and do a lot of different calculations. At this point phone starts to heat up (CPU usage is high). When running stops, heating stops and CPU drops lower. </p>

<p>This makes me think that the main problem is whenever these sensors are used and calculations are made, but there's a lot of possibilities that could cause this and I wanted to understand, how can I deeply analyze batter usage in this case? I read that <code>Battery Historian</code> should be way to go, but the information there is complicated and do not give me much information. How can I use this data to understand which class/runnable/code part is held responsible for the CPU usage? Maybe there's better ways to solve this? Thanks in advance.</p>

<p>Detailed analysis on what's happening using CPU profiler (after suggestion).</p>

<hr>

<p><a href=""https://i.stack.imgur.com/chV4N.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/chV4N.png"" alt=""enter image description here""></a></p>

<ol>
<li>Image. Application is opened and few different screens are switch to and from. Nothing special. Phone does not heat up and from CPU analysis everything also looks pretty okay.</li>
</ol>

<hr>

<p><a href=""https://i.stack.imgur.com/t42Gb.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/t42Gb.png"" alt=""enter image description here""></a></p>

<p>2.User starts to run and enter heavy state. The yellow (light green) rectangle shows previously mentioned ""important service"" that bring important role to application. Called functions does not use too much time of CPU considering the % of whole running trip - which makes me think, I've to look somewhere else..</p>

<hr>

<p><a href=""https://i.stack.imgur.com/pH43o.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/pH43o.png"" alt=""enter image description here""></a></p>

<ol>
<li>What I saw is that CPU increases heavily whenever I lock the phone (while service is running. From CPU <code>Bottom Up</code> analysis I cannot understand what is causing the problem (orange rectangle) - looks like a bunch of Android stuff is happening, but it does not give me any clue.</li>
</ol>

<p>From CPU profiler I do understand that I have a serious problem considering CPU usage, but right now I do not understand what is causing it (which piece of code/class/function). I know for the fact that whenever my important service is created (on app start) I use <code>PARTIAL_WAKE_LOCK</code> to not allow CPU go to sleep and also make service to be alive at all times. As I understand I need to find different solution for this, because CPU drains too much of battery. </p>

<p>How could I found this using only profiler? I now this fact only for code and profiler stack does not tell me much about this (maybe Im not looking at the right place?)</p>",android|battery|foreground-service,8358447,MaaAn13,no
PARTIAL_WAKE_LOCK kills my mediaplayer,"<p>I implemented a wakelock to avoid stopping my MediaPlayer (playing local files only) when screen goes off. Since I don't want to drain battery, I tried a PARTIAL_WAKE_LOCK. But it has no effect: screen off kills my player. FULL_WAKE_LOCK works fine, but screen stays on, as expected, draining the battery...</p>

<p>What am I doing wrong?</p>

<p>Thanks!
L.</p>",android|media-player|android-wake-lock,1483390,Luis A. Florit,yes
Optimise service for battery consumption,"<p>I am developing an Android Service basically I set an alarm every 3 minutes the Service starts,performs it's tasks then stops and restarts again after 3 minutes. The problem is the service is consuming to much battery life draining the power from the device.</p>

<p>The task needs to be executed every 3 minutes. </p>

<p>Is there a solution for making it drain less power ? It's better to keep it on all the time then starting and stoping it ?</p>",android|optimization|android-service,478687,opc0de,yes
Fused Location Provider unexpected behavior,"<p>this is how I register my app to receive location updates:</p>

<pre><code>mLocationRequest = LocationRequest.create();
mLocationRequest.setInterval(Consts.ONE_MINUTE * 10);
mLocationRequest.setPriority(LocationRequest.PRIORITY_BALANCED_POWER_ACCURACY);
mLocationRequest.setFastestInterval(Consts.ONE_MINUTE);

Builder builder = new GoogleApiClient.Builder(context);
builder.addApi(ActivityRecognition.API);

mGoogleApiClient = builder.addConnectionCallbacks(this)
            .addOnConnectionFailedListener(this)
            .build();

mGoogleApiClient.connect();

....
....

@Override
public void onConnected(Bundle connectionHint) {
   LocationServices.FusedLocationApi.requestLocationUpdates(mGoogleApiClient, mLocationRequest, locationUpdatespendingInent);
}
</code></pre>

<p>my pending intent been invoked in background almost in the exact requested intervals...</p>

<p>so far so good.</p>

<p><strong>the problem:</strong>   When WIFI is disabled/ not connected to any network, or when there is no 3G/4G network data enabled - the fused location provider not providing new location updates!!</p>

<p>my Location access settings are turned on, and GPS satellites and WI-FI &amp; mobile network location is checked.</p>

<p><strong>the even bigger problem:</strong> sometimes in that case, I do receive location updates callbacks via the pending intent, but with the last location it knew (even if it was an hour ago, and I'm long long gone away miles from that place)</p>

<p>according to the documentation of <code>PRIORITY_BALANCED_POWER_ACCURACY</code> :</p>

<blockquote>
  <p>Used with setPriority(int) to request ""block"" level accuracy.
  Block level accuracy is considered to be about 100 meter accuracy. Using a coarse accuracy such as this often consumes less power.</p>
</blockquote>

<p>I'm expecting that the fused location provider will open the GPS when it have no other choice, or at least won't provide a new location updates if he don't have any.</p>

<p><strong>another unpredictable and disturbing issue:</strong></p>

<p>I changed <code>PRIORITY_BALANCED_POWER_ACCURACY</code> to <code>PRIORITY_HIGH_ACCURACY</code> in order to see how it behaves (for 24 hours). all the intervals stayed the same (10 minutes interval between updates). accurate location indeed received even in phones with no network/sim card,  but - the battery drained out fast!  when I looked on the battery history, I was surprised to see that <strong>GPS radio was on full transmission mode all the time!!!!</strong>    and I saw also in my log that loction was received every minute, even that I requested location each ten minutes (I don't have any other installed apps that opens GPS to receive locations..) </p>

<p>I noticed this behavior on several devices (such as Moto X 2013, HTC One X, Nexus 5) , all with latest Google Play Services (version 6.1.11) , and android KITKAT 4.4.4</p>

<p>my application depends a lot on the user current location, and periodically receives location updates in the specified interval as long as the user logged in,  so I don't want to use the <code>PRIORITY_HIGH_ACCURACY</code> mode, to prevent battery drain..</p>

<p><strong>my questions:</strong></p>

<ul>
<li><p>is the fused location provider suppose to use GPS at all if it set to receive updates with <code>PRIORITY_BALANCED_POWER_ACCURACY</code> and don't have any WI-FI or cell towers info ?</p></li>
<li><p>if it does, then what am I doing wrong?</p></li>
<li><p>why I'm getting this misleading location updates that are not correct? (as I explained in the the ""even bigger problem"" section..</p></li>
<li><p>why GPS radio is opened all the time instead of been opened for the 10 minutes interval when I used the <code>PRIORITY_HIGH_ACCURACY</code> parameter? (I don't have other installed apps that triggers location updates faster..)</p></li>
</ul>",android|gps|google-play-services|android-location|location-services,1039461,Tal Kanel,yes
Pusher versus PubNub for iOS,"<p>I am looking for pros and cons of Pusher versus PubNub specifically for iOS clients. In terms of resource utilization (battery drain, speed, etc) and delivery reliability. It appears that PubNub has an official iOS library but the Pusher library is created by a third party and not officially maintained? What has your experience been using these libraries?</p>",ios|objective-c|push-notification|pusher|pubnub,920855,Joel,no
If I know the drain rate can we calculate the remainin time for battery?,"<p>I know the draining rate.
I want to know after how many hours or minutes it will be totally drained</p>",python|data-science|battery,9947248,A Das,no
Crashlytics performs network request for settings every time it been initialized,"<p>I'm initializing Crashlytics every time my procees starts from the <code>Application.OnCreate()</code> method using the following code:</p>

<blockquote>
<pre><code>  Fabric.with(new Fabric.Builder(MainApplication.getAppContext()).debuggable(BuildConfig.DEBUG)
                                                                   .logger(BuildConfig.LOGS_ENABLED ? new DefaultLogger(Log.VERBOSE) : new SilentLogger())
                                                                   .kits(new Crashlytics.Builder().build())
                                                                   .build());
</code></pre>
</blockquote>

<p>I noticed in the logs and netowrk traffic monitor tools that every time I'm doing this initialization - the following happen:</p>

<pre><code>D/Fabric: Requesting settings from https://settings.crashlytics.com/spi/v2/platforms/android/apps/..
</code></pre>

<p>then</p>

<pre><code>D/Fabric: Loaded settings: {""settings_version"":2,""cache_duration"":7200,..., .....,""expires_at"":1524658871212..}
</code></pre>

<p>it looks like the cache duration is 7200 (Milliseconds?)  which explains why every time it download from scratch.</p>

<p>this is a problem for me, because I would like to avoid any network requests that opens 3G/WIFI radio when not really needed. my process wakes up a lot, and I would like to not drain the battery.</p>

<p>I would expect it will be possible to modify the cache duration somehow, but I did not found any way in the Fabric console or programatic to do that.</p>

<p>I'm using Crashlytics version 2.6</p>

<p>My questions are:</p>

<ul>
<li>I'm I missing here something?</li>
<li>Is it possible to modify somehow the cache duration of the settings or prevent every initialization from load the settings from scratch?</li>
</ul>",android|crashlytics|google-fabric|crashlytics-android,1039461,Tal Kanel,yes
How to create a background service to populate a list in android?,"<p>I have an Activity created in my Application which has a RecyclerView that is populated <strong><em>once</em></strong> <strong>since the activity is started</strong>.</p>

<p>How I can create a background service that starts on the Activity creation and runs on the background and checks through a web process, <strong>every</strong> <strong><em>x</em> seconds/milliseconds</strong> for any changes and repopulate the list in each case accordingly, without drain too much battery?</p>

<p>Every opinion is accepted.</p>",android|android-intent|web|service|android-recyclerview,5303491,gkanellis,no
stop service after execution,"<p>Hi I am writing program which fetches users current lattitude and longitude every 5 minutes using Alarmmanager and store the value in shared preferences.I want to run this search backgroun so iam using service.I want to stop the service after fetching the lattitude and longitude to avoid battery drain.This is my code</p>

<p>CurrentLocation.java</p>

<pre><code>import com.google.android.gms.maps.model.LatLng;

import android.app.Service;
import android.content.Context;
import android.content.Intent;
import android.content.ServiceConnection;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.os.IBinder;
import android.preference.PreferenceManager;
import android.util.Log;
import android.widget.Toast;


public class CurrentLocation extends Service implements LocationListener {

    private Context mcontext;
    SharedPreferences shprefs;


    @Override
    public void onCreate() {
        // TODO Auto-generated method stub
        super.onCreate();
        this.mcontext=this;
        getlocation();

    }
    private void getlocation() {
        // TODO Auto-generated method stub
        Log.i(""evvterer"", ""mnbj"");
        LocationManager locationManager = (LocationManager) mcontext.getSystemService(Context.LOCATION_SERVICE);
        locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, this);
    }
    @Override
    public IBinder onBind(Intent intent) {
        // TODO Auto-generated method stub

        return null;
    }
    @Override
    public void onLocationChanged(Location location) {
        // TODO Auto-generated method stub
        shprefs=PreferenceManager.getDefaultSharedPreferences(CurrentLocation.this);


        double latitude=location.getLatitude();
        Editor edit=shprefs.edit();
        edit.putString(""Ltd"", """"+latitude);
        edit.commit();

        double longitude=location.getLongitude();
        Editor edits=shprefs.edit();
        edits.putString(""Lngtd"", """"+longitude);
        edits.commit();
        LatLng loca=new LatLng(latitude,longitude);

    }
    @Override
    public void onProviderDisabled(String provider) {
        // TODO Auto-generated method stub

    }
    @Override
    public void onProviderEnabled(String provider) {
        // TODO Auto-generated method stub

    }
    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
        // TODO Auto-generated method stub

    }   
}
</code></pre>

<p>please help me
Thanks in advance</p>",android|service|locationlistener,2083175,user2083175,yes
GCM wakelock permission,"<p>After i saw the video from google about performance patterns - <a href=""https://www.youtube.com/watch?v=orlRuEwlDoM"" rel=""nofollow"">video</a>, i decided to implement Google Cloud Messaging.
But while i was implementing GCM for Android, i saw that GCM is using some permissions, and one of them is  ""wakelock"".
But like we know, this permission is ""equals"" to battery drain.</p>

<p>So my question is, how we can manage this issue? Lib GCM do this for us?? Is better to use pull notifications than pull?</p>

<p>Thanks</p>",android|google-cloud-messaging,1851366,user1851366,yes
SpriteKit library BUG: battery drain (Energy Impact is High / Very High) [WORKAROUND],"<p>I understand that stackoverflow is rather a question-answer informational resource, but I also believe its core idea is solution sharing in the first place. And, as I found a tricky bug in Apple's SpriteKit library, and a workaround for that bug, I share the solution with you. </p>

<p>Also, I filed a bug report to Apple via <a href=""https://bugreport.apple.com/"" rel=""nofollow noreferrer"">https://bugreport.apple.com/</a>, but the 1-trillion company seem not to care much - it's been almost two weeks since the report, and the bug is still open, and not a single comment / update was given from the Apple crew.</p>

<h2>TLDR;</h2>

<p>SpriteKit goes into enormous energy consumption if your game supports landscape mode only, and the order of UISupportedInterfaceOrientations landscape values in your Info.plist file is 'wrong' (!). If UIInterfaceOrientationLandscapeRight goes first and UIInterfaceOrientationLandscapeLeft goes second - you are in trouble.</p>

<p>The workaround is:</p>

<ol>
<li><p>Select your Info.plist in the project navigator -> Open As -> Source Code. Find the key: UISupportedInterfaceOrientations</p></li>
<li><p>Make sure the order of values is the following:</p></li>
</ol>

<p>(LandscapeLeft goes FIRST)</p>

<pre><code>&lt;string&gt;UIInterfaceOrientationLandscapeLeft&lt;/string&gt;
&lt;string&gt;UIInterfaceOrientationLandscapeRight&lt;/string&gt;
</code></pre>

<p>That's it.</p>

<h2>BUG REPRODUCE STEPS</h2>

<p>(for those only who are curious and have some extra free time)</p>

<ol>
<li><p>Launch XCode, create a brand new project of type 'Game'</p>

<ul>
<li>language: Swift</li>
<li>game technology: SpriteKit</li>
<li>uncheck Integrate GamePlayKit</li>
<li>uncheck Include Unit Tests</li>
<li>uncheck Include UI Tests</li>
</ul></li>
<li><p>In target general settings</p>

<ul>
<li>uncheck Device Orientation: Portrait</li>
<li>check Requires full screen</li>
</ul></li>
<li><p>Remove files: GameScene.sks, Actions.sks (Move to trash)</p></li>
<li><p>Replace the content of GameScene.swift with the following </p></li>
</ol>

<p>code:</p>

<pre><code>import SpriteKit

class GameScene: SKScene {

    fileprivate let nodeSizeUnit: CGFloat = 50

    override func didMove(to view: SKView) {
        let layer = getLayer()
        let nodeWithBody = getItemWithBody()

        layer.addChild(nodeWithBody)
        addChild(layer)     
    }

    fileprivate func getLayer() -&gt; SKNode {
        let layerSize = CGSize(width: nodeSizeUnit * 3, height: nodeSizeUnit * 3)
        let layer = SKSpriteNode(texture: nil, color: UIColor.blue, size: layerSize)
        layer.position = CGPoint(x: size.width / 2, y: size.height / 2)

        return layer
    }

    fileprivate func getItemWithBody() -&gt; SKNode {
        let bodySize = CGSize(width: nodeSizeUnit, height: nodeSizeUnit)
        let body = SKPhysicsBody(rectangleOf: bodySize)

        body.isDynamic = false
        body.affectedByGravity = false
        body.categoryBitMask = 0
        body.collisionBitMask = 0
        body.contactTestBitMask = 0

        let item = SKSpriteNode(texture: nil,
                                color: SKColor.gray,
                                size: CGSize(width: nodeSizeUnit * 2, height: nodeSizeUnit * 2))
        item.physicsBody = body

        return item
    }
}
</code></pre>

<ol start=""5"">
<li>Replace the content of GameViewController with the following</li>
</ol>

<p>code:</p>

<pre><code>import SpriteKit

class GameViewController: UIViewController {

    override func viewDidLoad() {
        super.viewDidLoad()

        if let view = self.view as! SKView? {
            let scene = GameScene()
            scene.size = UIScreen.main.nativeBounds.size
            scene.scaleMode = .aspectFill
            view.presentScene(scene)

            view.ignoresSiblingOrder = true

            view.showsPhysics = true
            view.showsFPS = true
            view.showsNodeCount = true
            view.showsDrawCount = true
        }
    }
}
</code></pre>

<ol start=""6"">
<li>Connect a physical device available, run the build on that device. Make sure to set build's Deployment Target according to you device. </li>
</ol>

<p><b>UPD: Make sure the device iOS is -below- 12.0, otherwise you'll get high energy impact regardless of UISupportedInterfaceOrientations parameters order. Looks like SpriteKit has even another, iOS-version-related, energy consumption bug.</b></p>

<ol start=""7"">
<li><p>Go to the Debug Navigator (Cmd + 7), switch to the Energy Impact section. The average Energy Impact is low. Fine at this point.</p></li>
<li><p>Stop the build, go to target settings. uncheck Device Orientation: Landscape Left. Aaaand check it again. Yes, you read it right: first uncheck, then check. Now, you are doomed.</p></li>
<li><p>Run the build, go to the Debug Navigator (Cmd + 7), switch to the Energy Imact section. Now, it grows frorm 'Low' to 'High' in a blink of an eye, and ends up 'Very High'. How cool is that?</p></li>
<li><p>Stop the build. Select your Info.plist in the project navigator -> Open As -> Source Code. Find the key: UISupportedInterfaceOrientations. You'll see the following:</p></li>
</ol>

<p>(LandscapeLeft goes SECOND):</p>

<pre><code>&lt;array&gt;
    &lt;string&gt;UIInterfaceOrientationLandscapeRight&lt;/string&gt;
    &lt;string&gt;UIInterfaceOrientationLandscapeLeft&lt;/string&gt;    
&lt;/array&gt;
</code></pre>

<p>change it to:</p>

<pre><code>&lt;array&gt;
    &lt;string&gt;UIInterfaceOrientationLandscapeLeft&lt;/string&gt;    
    &lt;string&gt;UIInterfaceOrientationLandscapeRight&lt;/string&gt;
&lt;/array&gt;
</code></pre>

<p>(LandscapeLeft goes FIRST)</p>

<ol start=""11"">
<li>Run the build, go to the Debug Navigator (Cmd + 7), switch to the Energy Impact section. The average Energy Impact is low. Yay.</li>
</ol>

<p>You can play the UISupportedInterfaceOrientations key yourself, changing the order of params and watching the energy impact change accordingly.</p>",ios|sprite-kit,8212346,Yaroslav Yaremenko,no
How I get a background location every n seconds?,"<p>Is there any way to listen background location every n seconds? I need to get the location every 5 minutes to not drain the device battery.</p>

<p>PS I have a pro account.</p>",codenameone,2416072,user2416072,no
Android application that works in background 24/7 and drains less as possible battery,"<p>I want to create android app that while i am in my wifi area it will use the wifi soon as ""MyWifi"" is not in reach should change and start data connection through 3g/4g...so my question is how to make the application to run 24/7 and drain less as possible battery, also if anyone can givme something about wifi and data connection what are the system calls, or refer me to any tutorials od examples that think that i will find them handy&lt;
Thanks</p>",android|android-wifi,1223791,Tony,yes
Battery drain when using CoreLocation Significant Location Monitoring & CoreBluetooth,"<p>We've released an application which runs in the background and uses <code>CoreBluetooth</code> &amp; <code>CoreLocation</code> to automatically save your parking location.</p>

<p>At a high level our app just looks for a <code>CoreBluetooth</code> disconnect event and turns on GPS until we get an location fix (accuracy &lt;=10m) or 3 minutes max time (this could occur when you park in an underground parking lot with no GPS coverage). We then use Significant Location Monitoring to automatically re-launch our application in event of the system terminating our app.</p>

<p>During our development we never saw a battery drain issue ourselves, however 75% of our users say that they see a significant battery drain. 10% of our backers responded to the poll so it's a difficult to determine how representative the breakdown is, but it's a large percentage of our users. <a href=""http://www.findmycarsmarter.com/forum/viewtopic.php?f=4&amp;t=30"">http://www.findmycarsmarter.com/forum/viewtopic.php?f=4&amp;t=30</a></p>

<p>We then released an update that allowed users to disable Significant Location Monitoring and 60% say that by disabling Significant Location Monitoring the drain goes away. <a href=""http://www.findmycarsmarter.com/forum/viewtopic.php?f=4&amp;t=42"">http://www.findmycarsmarter.com/forum/viewtopic.php?f=4&amp;t=42</a></p>

<p>Initially we could not duplicate the drain issue ourselves, but we found that when we installed a simple app that just turned on Significant Location Monitoring in conjunction with Find My Car Smarter, we intermittently saw the drain reproduce. In the drain state the phone does not enter hibernate. This is indicated by the usage time in (Settings->Usage->Time since last full charge) continuing to increment even though the phone had been put to sleep and the display is off. Something prevents the system from entering hibernate. The battery drains about 15% per hour in this stage. This drain shows up intermittently and seems to clear itself out after an hour or two and come again randomly. We have not found a way to reliability reproduce the drain.</p>

<p>We believe the issue is caused by multiple clients calling into CoreLocation. We asked a few users who experienced the issue to wipe their phone and only install our Find My Car Smarter app. Alone with just this app installed, the drain did not exhibit. We have had other reports that when our app is used with Google Latitude or Facebook, etc is when they see the drain occur. Or if they go and kill other applications the drain goes away. We've seen the drain persist through a power cycle, with no apps launched. This implies that it has to be a system level service that prevents the OS from sleeping.</p>

<p>Even though we think the issue is caused by some race condition of multiple clients calling into CoreLocation, we never saw the issue reproduce with apps that only used CoreLocation. We even created 4 or 5 different apps that would simultaneously access CoreLocation and we didn't  see the drain occur. We did however see the issue when we had an app with CoreLocation and a second app with CoreLocation + CoreBluetooth. There are probably very few apps that use the CoreLocation + CoreBluetooth combination, so potentially that's why more developers haven't hit this issue. Although we're at a loss to explain how CoreLocation &amp; CoreBluetooth interact to cause this drain and how the second app with CoreLocation comes into the equation. Since the drain was intermittent it's possible that it's just a fluke that the issue only happened when we were testing with CoreLocation + CoreBluetooth.</p>

<p>On a wiped 5.0.1 iPhone 4S with only these two apps CTM1 &amp; FMC installed we were able to intermittently get into the drain state. Interestingly, the drain issue seemed to occur much less frequently on a wiped device then our normal device. Unfortunately we only saw the drain state a few times and without being able to reliably reproduce the drain we don't have a good control state to work from.</p>

<p>We've filed a bug report with Apple and opened up a Technical Support Incident, but maybe the Stackover community can also provide some insight. We've seen this issue both in 5.0.1 &amp; in 5.1 Beta 3.</p>

<p>CTM1
<a href=""http://www.findmycarsmarter.com/files/CTM1.zip"">http://www.findmycarsmarter.com/files/CTM1.zip</a></p>

<pre><code>On Going into the Background
    [locationManager stopUpdatingLocation];
    [locationManager stopUpdatingHeading];
    [locationManager startMonitoringSignificantLocationChanges];

On Re-entering Foreground
    [locationManager stopMonitoringSignificantLocationChanges];
    [locationManager startUpdatingLocation];
    [locationManager startUpdatingHeading];
On didUpdateToLocation
    //do nothing
On didUpdateHeading
    //do nothing
</code></pre>

<p>FMC
<a href=""http://www.findmycarsmarter.com/files/FMC.zip"">http://www.findmycarsmarter.com/files/FMC.zip</a></p>

<pre><code>On Going into the Background
    [btleManager stopScan];
    [locationManager stopUpdatingLocation];
    [locationManager stopUpdatingHeading];
    [locationManager startMonitoringSignificantLocationChanges];

On Re-entering Foreground
    [locationManager stopMonitoringSignificantLocationChanges];
    [locationManager startUpdatingLocation];
    [locationManager startUpdatingHeading];        
    [btleManager scanForPeripheralsWithServices:nil options:nil];
On didUpdateToLocation
    //do nothing
On didUpdateHeading
    //do nothing
On centralManagerDidUpdateState
    [btleManager scanForPeripheralsWithServices:nil options:nil];
On didDiscoverPeripheral
    [btleManager connectPeripheral:device options:nil];
On didConnectPeripheral
    //update log
On didDisconnectPeripheral
    //initiate reconnect
    [btleManager connectPeripheral:device options:nil];
</code></pre>

<p>If you see any coding mistakes that might account for the drain please let us know.</p>

<p>One other question we did have, if we're using both GPS &amp; Significant Location Monitoring, is there a reason to call <code>stopMonitoringSignificantLocationChanges</code>? Looking at the Regions sample code they call <code>stopMonitoringSignificantLocationChanges</code> &amp; <code>startLocationUpdate</code> on entering foreground and <code>stopLocationUpdate</code> &amp; <code>startMonitoringSignificantLocationChanges</code> on entering background, but I'm wondering if this is necessary/recommended/required?</p>

<p>Update:</p>

<p>We've confirmed with Apple Developer Technical Support that for applications using both GPS &amp; Significant Location Monitoring that our sequence of turning off Significant Location Monitoring before enabling GPS update is correct.</p>

<p>We've also confirmed that the drain issue can still be seen in the GM 5.1 &amp; with a re-compiled Find My Car Smarter application against the 5.1 Frameworks. </p>

<p>Update:</p>

<p>It looks like the issue is triggered when our app is launched from the background in response to a Significant Location Monitoring event. We actually don't handle this scenario properly in our sample code but we do in our actual app.</p>

<p>In the sample code, on a background re-launch we'll turn on location update and since there is not a applicationDidEnterBackground call, the GPS will be left on.</p>

<p>In our app we check to see if we were launched from the background by looking for the UIApplicationLaunchOptionsLocationKey flag, if so we start Significant Location Monitoring, otherwise we were launched in the foreground and we start Updating Location.</p>

<p>Apple got back to us and stated that usage of Significant Location Monitoring does not require the location set in UIBackgroundModes array in the Info.plist. We removed this entry and it appears that the battery drain state is no longer hit. We still have bluetooth-central in the UIBackgroundModes list. At the moment we're unclear as to why this helps. We're going to be running some more experiments to help us understand this better. If anyone has any suggestions please let us know.</p>",ios|core-location|cllocationmanager|power-management|core-bluetooth,1041186,fmc,yes
How is screen rotation achieved in terms of battery life?,"<p>Hi I am working on an Android app which should detect user movements with accelerometer and according to it run some further actions. I have a service which listens to sensormanager updates but, there is a problem, the accelerometer drains the battery pretty fast:-\ 
Please is it possible to save the battery for example with lower sampling rate of the sensor? 
How does it the operating system with screen rotation? There must be sensor running all the time, isn't it true? 
Thank you for your help, I hope you will understand my question. In case of not, I can post some further info.. </p>

<p>Thanks </p>",android|accelerometer,419449,simekadam,yes
Measure power consumption related to particular app,"<p>As a part of application tests, I need to somehow measure how much my app is draining the battery. </p>

<p>In Android there is a chart in the Battery Setting where I can see the percentage consumption, as well as CPU time or wake time, but problems arise while my app is using accelerometer continuously while running.</p>

<p>The acceleremoter also has the strongest element of standby usage, so I would like to estimate its particular usage, somehow.</p>

<p>Does acceleremoter battery-usage belong to Android System, or Android OS, or neither of them?</p>

<p>How can acceleremoter battery-usage be determined accurately?</p>

<p>Note: I have been thinking about measuring actual consumption using a multi-meter and electrodes attached between the battery and the device's power contacts, but I am scared about breaking my phone.</p>",android|accelerometer|power-management,419449,simekadam,yes
Using UDP versus TCP for Wi-Fi comm - battery drain?,"<p>I have several questions, but SO's practice is not to ask multiple at once, so i'll put the same intro and number them in logical order.</p>

<p>I'm writing a business app that communicates with a .NET Win-service.  Target audience are staff, working in a building with Wi-Fi coverage.  The app is used for announcement of certain events that eventually will require receiver's acceptance or rejection (so transmission must be bi-directional).</p>

<p>I have implemented device registration over TCP, followed by a switch to a UDP data channel.
Architecturally, there is a startup Application class (necessary to configure some global settings), which in turn opens the LogIn activity, which opens the Main activity upon successful registration.  As it starts, Main launches a foreground service (CommSvc), which starts the UDP-comm thread.</p>

<p>I'm developing in VisualStudio 2017 15.5.4, Xamarin 4.8.0.757, Xamarin.Android SDK - 8.1.3.0.<br>
My test devices are 2 phones LG Nexus 4 (Android 4.3, API 18), BLU Vivo 5 Mini (6.0, 23),<br>
and a Samsung SM-T377V (6.0.1, 23) tablet, which i'm thinking about upgrading to 7.0.</p>

<hr>

<p><strong>Q1</strong>. It has been estimated by our in-house network engineers that utilizing TCP will result in mobile radio draining the battery faster (vs. UDP).  <em>Is that so indeed?</em></p>

<p>TCP gives guaranteed ordered delivery of the byte-stream (provided the device stays in range). UDP packets may get lost, thus requiring some kind of ACK-and-retransmit-on-failure protocol.</p>

<p>Due to Wi-Fi nature of the channel there can never be a guarantee that a sent packet reached the target device (e.g. it went out of range), therefore <em>an ACK-and-retransmit protocol becomes necessary no matter what, am i right</em>?  (There are liability aspects)</p>",tcp|udp|wifi|android-wifi|battery,803920,Astrogator,no
iOS: Background location app using too much battery,"<p>I have an app that gets location updates in the background every 2 minutes and 25 meters traveled.  My problem is that while the location tracking is working perfectly, it is seriously draining my battery.  Battery usage over a 24 hour period was 30% compared to my next closest app at 14%.  Is there some trick to decreasing the battery usage of my app while maintaining my accuracy and time period of location updates?</p>

<p>Could it be draining the battery because of the frequency of calls to didUpdateLocations:? Or could it be that I am communicating with a web service in the background for each location update?  I'm really at a loss as to how to improve the battery usage, any help is much appreciated!</p>

<p>Below is my code in AppDelegate for getting location and sending updates to the server:</p>

<pre><code>- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
     self.locationManager = [CLLocationManager new];
    [self.locationManager setDelegate:self];
    if ([self.locationManager respondsToSelector:@selector(requestAlwaysAuthorization)]) {
        [self.locationManager requestAlwaysAuthorization];
    }
    [self.locationManager startUpdatingLocation];
    [self.locationManager startMonitoringSignificantLocationChanges];

    [self initializeRegionMonitoring];
}

-(void) initializeRegionMonitoring {
    self.locationManager = [[CLLocationManager alloc] init];
    self.locationManager.delegate = self;

    // notify changes when the device has moved x meters
    self.locationManager.distanceFilter = 25; // or set to 20 meters
    self.locationManager.desiredAccuracy = kCLLocationAccuracyNearestTenMeters;
    [self.locationManager startUpdatingLocation];
    [self.locationManager startMonitoringSignificantLocationChanges];
}

- (void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations {

    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSDate *lastDate = [defaults objectForKey:@""lastSavedDate""];

    if ([[NSDate date] timeIntervalSinceDate:lastDate] &lt; 120) {
        NSLog(@""LAST SAVE TIME LESS THAN 2 MINUTES"");
        return;
    }

    [self saveLocation];    

    //tell the centralManager that you want to deferred this updatedLocation
    if (isBackgroundMode &amp;&amp; !_deferringUpdates)
    {
        NSLog(@""THIS IS GETTING CALLED EVERY TIME"");
        _deferringUpdates = YES;
        [self.locationManager allowDeferredLocationUpdatesUntilTraveled:CLLocationDistanceMax timeout:120];
    }
}

- (void) locationManager:(CLLocationManager *)manager didFinishDeferredUpdatesWithError:(NSError *)error {

    _deferringUpdates = NO;
}

-(void) saveLocation {
    // This code saves location data to a web service
}

- (void)applicationWillResignActive:(UIApplication *)application {
    isBackgroundMode = YES;

    [self.locationManager stopUpdatingLocation];
    [self.locationManager setDesiredAccuracy:kCLLocationAccuracyNearestTenMeters];
    [self.locationManager setDistanceFilter:25];
    self.locationManager.pausesLocationUpdatesAutomatically = NO;
    self.locationManager.activityType = CLActivityTypeAutomotiveNavigation;
    [self.locationManager startUpdatingLocation];
}


-(BOOL)application:(UIApplication *)application willFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    [[UIApplication sharedApplication] setMinimumBackgroundFetchInterval:UIApplicationBackgroundFetchIntervalMinimum];
    return true;
}

-(void)application:(UIApplication *)application performFetchWithCompletionHandler:(void (^)(UIBackgroundFetchResult))completionHandler {

    [self saveLocation];

   completionHandler(UIBackgroundFetchResultNewData);
    NSLog(@""Fetch completed"");
}
</code></pre>",ios|objective-c|geolocation|cllocationmanager|cllocation,3543861,MSU_Bulldog,yes
Nearby Connections always in discover mode,"<p>I'm working on a feature in my app where I want users to be able to share content with each other offline using the android nearby connections API. I want to have a similar UX flow to how photos can be sent using nearby share in google photos. In the google photos app the sending user decides to share but receiving users don't have to do anything to enter a &quot;discovery mode&quot; (there's no button they need to press to start discovery it seems like the phone is always discovering). If I were to have my app always be in discover mode for users would that cause too much of a drain on the battery/processor? Or is there a way with nearby that I can have my app detect when another device is advertising and then automatically enter discover mode?</p>
<p>Edit: On the API page for Nearby Messages it mentions that battery life is an issue, but the Nearby Connections page doesn't seem to mention it so I'm curious if it is still a concern with this newer api.</p>",android|kotlin,4889821,TKDefender,no
Android: Custom Clock widget Service work-around?,"<p>I was interested in developing a clock widget for the homescreen and upon reading <a href=""http://android-developers.blogspot.com/2009/04/introducing-home-screen-widgets-and.html"" rel=""nofollow noreferrer"">Home Screen Widgets tutorial</a>, I wondered if there is a pre-existing <code>Service</code> I could reference for updating the current time rather than re-inventing the wheel?</p>
<p>I download the <em>Retro Clock</em> application on my android phone and noticed that when I click it, it pops up the Alarm Clock settings, but with the default Google <em>Analog Clock</em> widget, upon click does nothing.</p>
<p>Is that because the <em>Retro Clock</em> widget implements the Alarm Clock service? If so, how can I go about referencing that service? Or do I have this all wrong and misunderstood?</p>
<p>Any help is appreciated.</p>
<h3>EDIT:</h3>
<p>I believe implementing the service to update the clock would drain the battery life tremendously, any ideas on a work around or help shed some light on any performance issues with using <code>Service</code>?</p>",android|widget|code-reuse,166712,Anthony Forloney,no
How to get the real time of driving throw google map,"<p>I'm developing a delivery android app, i let the user to input 2 points then i draw the polygon after hitting a request to <code>https://maps.googleapis.com/maps/api/directions/</code> this seems fine and it produces json like this part  </p>

<pre><code>""steps"" : [
                  {
                     ""distance"" : {
                        ""text"" : ""1 m"",
                        ""value"" : 0
                     },
                     ""duration"" : {
                        ""text"" : ""1 min"",
                        ""value"" : 0
                     },
                     ""end_location"" : {
                        ""lat"" : 30.2032168,
                        ""lng"" : 35.4687987
                     },
                     ""html_instructions"" : ""Head on \u003cb\u003eKings Hwy.\u003c/b\u003e/\u003cb\u003eRoute 35\u003c/b\u003e"",
                     ""polyline"" : {
                        ""points"" : ""cajwD_onwE""
                     },
                     ""start_location"" : {
                        ""lat"" : 30.2032168,
                        ""lng"" : 35.4687987
                     },
                     ""travel_mode"" : ""DRIVING""
                  }
               ],
               ""traffic_speed_entry"" : [],
               ""via_waypoint"" : []
            }
         ],
</code></pre>

<p>well, it seems all good so far, my problem is how to get the real time? i mean when the driver starts driving i need to update my estimation time based on car speed,
it's hard to make an httprequest every 5 seconds, because the json file will need a lot of calculation as you see json file is just 5% of the whole json response regardless to the internet speed,they all need a huge time and it will drain the battery, is there a way to pull the time direct for the original google map ?</p>",android|google-maps,6689208,Habooltak Ana,yes
"Persistent cached processes in android, howto?","<p>I'm developping an app for a company who wish to use android phones as persistent user location info. I've created a LocationListener, and requestLocationUpdates, generating a cached process, which saves the data to a file. BUT, it's usual for the system to kill those processes to make up space for other proceses, and I want to negate that.</p>

<p>In words, I want for those cache processes to me persistent, and resist to kill commands (or stop the kill commands from the system). Already tried activities to no avail (kept crashing the app)</p>

<p>Right now the system is somethin like this:</p>

<pre><code>LocationListener listener = new LocationListener(){
    onLocationChanged(){useData;/*congestion avoidance function*/}    

    onStatusChanged()
    {
    if(offline){requestLocationUpdate(/*with new time, to avoid congestion*/)}

    }
}
</code></pre>

<p><strong>It's a very rough draft, hope you can get along with it. inbetween there are some functions to avoid battery drain and memory congestion</strong></p>

<p>The process works fine, and it is persistent, sometimes. But some other times phone usage kills that process, and I want to avoid that.</p>

<p>I'm relatively new to android programming, but have experience in other systems.</p>

<p>Thanks in advance</p>",android|performance|caching|android-intent,3062482,fusion--,yes
Override default Oreo Foreground Notification,"<p>As I correctly recall, with Android Oreo the system got more restrictive in terms of battery consumption, e.g., showing the user which app is currently running in the background draining the battery life.</p>

<p>This also shows in my app (scanning for BLE devices in the background, even if the app is not running in the foreground), stating </p>

<blockquote>
  <p>AppName is running in the background. Tap for Details on battery and
  data usage</p>
</blockquote>

<p>My question is, <em>whether</em> and <em>how</em> I would be able to exchange this text with a more user facing notification like</p>

<blockquote>
  <p>AppName is running in the background for reason XYZ</p>
</blockquote>

<p>Even so with a notification with a specific icon, etc.</p>

<p>I already tried this by</p>

<ol>
<li><p>Creating a custom notification channel in the application.</p></li>
<li><p>Starting the services with <code>startForegroundService</code> on Oreo devices.</p></li>
<li><p>From within the <code>onCreate</code> method of the service, I call</p>

<pre><code>startForeground(1, NotificationCompat.Builder(applicationContext, ""my_channel_id"")
            .setSmallIcon(R.drawable.some_icon)
            .setContentTitle(""Title"")
            .setContentText(""AppName is running in the background for reason XYZ"")
            .build())
</code></pre></li>
</ol>

<p>But all what happens is the same system-generated notification saying ""AppName is running in the background"".</p>

<p>Is it even possible to change this?</p>

<p>Thank you for sour suggestions in advance :)</p>",android|android-notifications|android-8.0-oreo,3600860,DeBe,no
JavaScript animation hanging up,"<p>I have an animation build with setInterval. </p>

<p><div class=""snippet"" data-lang=""js"" data-hide=""true"" data-console=""true"" data-babel=""false"">
<div class=""snippet-code snippet-currently-hidden"">
<pre class=""snippet-code-js lang-js prettyprint-override""><code>function changeBatteryIcon(status, i) {
  switch (status) {
    case 1:
      i.className = ""fa fa-battery-half red""
      return ++status
    case 2:
      i.className = ""fa fa-battery-3 orange""
      return ++status
    case 3:
      i.className = ""fa fa-battery lightgreen""
      return 1
  } 
}

function animateHeaderBatteries() {
  const i = 
        document.getElementById(""header-batteries"").querySelector('i')
  let status = 1
  setInterval(function() {
   status = changeBatteryIcon(status, i)
  }, 300)
  
  
}

animateHeaderBatteries()

const chargeBtn = document.getElementById('charge')
const drainBtn = document.getElementById('drain')
let ammount = 1
let not = document.getElementById('battery-not')

function charge(battery_charge) {
  if (ammount == 1) {
  const intervalHandler = 
        setInterval(function() {
           ++ammount
          const style = `width:${ammount}%;`
          battery_charge.style = style
         
          changeStyle(ammount)
          
          if (ammount == 100) {
            clearInterval(intervalHandler)
            not.style = 'background-color:lightgreen'
          }
        }, 50)
  }
}

function drain(battery_charge) {
  if (ammount == 100) {
    const intervalHandler =
          setInterval( function() {
            --ammount
            const style = `width:${ammount}%`
            battery_charge.style = style
            
            changeStyle(ammount)
            
            if (ammount &lt; 100) {
              not.style = 'background-color:white'
            }
            
            if (ammount == 1) {
              clearInterval(intervalHandler)
            }
}, 50)
  }
}

const battery_charge = document.getElementById('battery-charge')
function changeStyle (ammount) {
          if (ammount &gt; 25)
            battery_charge.style['background-color'] = 'orange'
          if (ammount &gt; 50)
            battery_charge.style['background-color'] = 'yellow'
          if (ammount &gt; 75) 
            battery_charge.style['background-color'] = 'lightgreen'
}


chargeBtn.onclick = function () {
  charge(battery_charge)
}

drainBtn.onclick = function () {
  drain(battery_charge)
}</code></pre>
<pre class=""snippet-code-css lang-css prettyprint-override""><code>body {
  font-family:arial;
}

.red {
  color:red;
}

.orange {
  color:orange;
}

.lightgreen {
  color:lightgreen;
}

header {
  flex-direction:column;
  display:flex;
  align-items:center;
  justify-content:center;
  background-color:#252525;
  color:yellow;
}


#header-batteries {
  padding-top:20px;
}

header h1 {
  margin-top:0;
}

article {
  display:flex;
  flex-direction: column;
  justify-content:center;
  align-items:center;

}

#battery-container {
  width:50%;
    margin-top:20px;
  margin-bottom:20px;
  display:flex;
  align-items:center;
}
#battery {
  border:2px solid #252525;
  height:75px;
  width:90%;
  display:flex;
  align-items:center;
  

}

#battery-not {
  height:25px;
  border:2px solid black;
  border-left:0;
  width:2%;
}
#battery-charge {
  height:100%;
  width:1%;
  background-color:red;
  display:flex;
 
}
#bolt {
  position:absolute;
  left:45%;
  font-size:50px;
  color:grey;
  
}



#controls {
  width:50%;
  display:flex;
  justify-content:flex-end;
  
}
#controls button {
 height:40px;
 flex-basis:40%;
 background-color:#f2f200;
 border:0;
 font-size:16px;
 font-weight:bold;
 font-family:Helvetica;
 margin-left:10px;
}

footer {
  display:flex;
  align-items:center;
  justify-content:center;
  margin-top:50px;
}</code></pre>
<pre class=""snippet-code-html lang-html prettyprint-override""><code>&lt;html lang=""pt-BR""&gt;
  &lt;meta charset=""UTF-8""&gt;
&lt;/html&gt;
&lt;body&gt;
  &lt;div id=""container""&gt;
    &lt;header&gt;
      &lt;div id=""header-batteries""&gt;
        &lt;i class=""fa fa-battery""&gt;&lt;/i&gt;
      &lt;/div&gt;
      &lt;h1&gt;Battery&lt;/h1&gt;
    &lt;/header&gt;
    &lt;article&gt;
      &lt;div id=""battery-container""&gt;
      &lt;div id=""battery""&gt;
        
           &lt;i class=""fa fa-bolt"" id=""bolt""&gt;&lt;/i&gt;
        &lt;div id=""battery-charge""&gt;
       
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div id=""battery-not""&gt;
      &lt;/div&gt;
      &lt;/div&gt;
      
      &lt;div id=""controls""&gt;
        &lt;button id=""charge""&gt;
          CHARGE
        &lt;/button&gt;
        &lt;button id=""drain""&gt;
          DRAIN
        &lt;/button&gt;
      &lt;/div&gt;
    &lt;/article&gt;
    &lt;footer&gt;
      &lt;span&gt;Made with &lt;i class=""fa fa-heart red"" &gt;&lt;/i&gt; by Alex Alonso&lt;/span&gt;
    &lt;/footer&gt;
  &lt;/div&gt;
&lt;/body&gt;</code></pre>
</div>
</div>
</p>

<p>It should run smoothly, changing the css and thus animating the battery charge. But what happens is that it hangs up a little bit in the beginning, but only at the first cycle of animation. After that all animations run smoothly.</p>

<pre><code>const intervalHandler = 
        setInterval(function() {
           ++ammount
          console.log(ammount)
          const style = `width:${ammount}%;`
          battery_charge.style = style

          changeStyle(ammount)

          if (ammount == 100) {
            clearInterval(intervalHandler)
            not.style = 'background-color:lightgreen'
          }
        }, 50)
</code></pre>

<p>I want to know why it behaves like this</p>",javascript|css|animation,3775416,Alex Alonso,yes
how to get address with GPS location in android?,"<p>in my code i got the latitude and longitude values exactly but i can't get the address of my location .... it just shows only NULL values for the address fields ... i gave all required permissions in my manifest file but still i didnt get address ..  please correct my code and help me to get address values..
here my code</p>

<p>void getMyCurrentLocation()throws NullPointerException {</p>

<pre><code>    LocationManager locManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    LocationListener locListener = new MyLocationListener();


     try{gps_enabled=locManager.isProviderEnabled(LocationManager.GPS_PROVIDER);}catch(Exception ex){}
       try{network_enabled=locManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER);}catch(Exception ex){}

        //don't start listeners if no provider is enabled
        //if(!gps_enabled &amp;&amp; !network_enabled)
            //return false;

        if(gps_enabled){
            locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, locListener);

        }


        if(gps_enabled){
            location=locManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);


        }


        if(network_enabled &amp;&amp; location==null){
            locManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, locListener);

        }


        if(network_enabled &amp;&amp; location==null)    {
            location=locManager.getLastKnownLocation(LocationManager.NETWORK_PROVIDER); 

        }

    if (location != null) {

       MyLat = location.getLatitude();
        MyLong = location.getLongitude();


    } else {
        Location loc= getLastKnownLocation(this);
        if (loc != null) {

            MyLat = loc.getLatitude();
            MyLong = loc.getLongitude();


        }
    }
    locManager.removeUpdates(locListener); // removes the periodic updates from location listener to //avoid battery drainage. If you want to get location at the periodic intervals call this method using //pending intent.

    try
    {
</code></pre>

<p>// Getting address from found locations.
        Geocoder geocoder;</p>

<pre><code>    List&lt;Address&gt; addresses;
    geocoder = new Geocoder(this, Locale.getDefault());
     addresses = geocoder.getFromLocation(MyLat, MyLong, 1);

    StateName= addresses.get(0).getAdminArea();
    CityName = addresses.get(0).getLocality();
    CountryName = addresses.get(0).getCountryName();
    // you can get more details other than this . like country code, state code, etc.


    //System.out.println("" StateName "" + StateName);
   // System.out.println("" CityName "" + CityName);
  //  System.out.println("" CountryName "" + CountryName);
    }
    catch (Exception e)
    {
        Toast.makeText(getApplicationContext(), ""error""+e,Toast.LENGTH_LONG).show(); 
        e.printStackTrace();
    }

    textView2.setText(""""+MyLat);
    textView3.setText(""""+MyLong);
    textView1.setText("" StateName "" + StateName +"" CityName "" + CityName +"" CountryName "" + CountryName);
}
</code></pre>",android|gps|location|geocoding,3152493,user3152493,no
Requesting iPhone location whilst in background?,"<p>Simple question ... I have an application that records a users location at 30second intervals (using an NSTimer) it works perfectly until the application goes ""inactive"" and the NStimer stops. As a consequence I am looking for options to maintain my location interval (30secs) whilst still being able to record fairly accurate location data (within 100m accuracy).</p>

<ul>
<li><p><strong>Option_001, Brute Force:</strong> Let CLLocationManager, startUpdatingLocation run all the time using UIBackgroundModes = ""location"". Not recommended, drains battery. Regularity upon request, Accuracy approx. 10-65m. Might just be the only realistic option.</p></li>
<li><p><strong>Option_002, SLC:</strong> I could use Significant Location Change but the frequency of location updates is pretty poor (not to mention accuracy). This is particularly true if the application is running in a rural or wilderness area with limited numbers of cell towers. Regularity unknown, Accuracy approx. 500m</p></li>
<li><p><strong>Option_003, Hybrid:</strong> I could use Significant Location Change (SLC) in the background as an indicator of ""significant"" movement and then request an GPS location based on kCLLocationAccuracyBest. This would work but the SLC events are not going to arrive at anywhere near 30second intervals (particularly when walking). Regularity unknown, Accuracy approx. 10-50m.</p></li>
<li><p><strong>Option_004, Something else?</strong> any ideas would be much appreciated.</p></li>
</ul>

<hr>

<p><strong>NOTE:</strong> <em>I thought I had this working because when you press [LOCK] on an iPhone (connected via USB) applicationWillResignActive is called but NSTimers do not stop. If you try the same with the iPhone un-connected (i.e. as the phone would be in normal use) the NSTimers stop almost immediately after applicationWillResignActive is called.</em> </p>",iphone|objective-c|cocoa-touch,164216,fuzzygoat,no
how to use tfs source control on an Apple Mac,"<p>Hi I made the mistake of experimenting with an Apple Mac just before the lockdown and now im stuck with it. Now I am trying to work on a tfs project in os as both bootcamp and parallels drivers drain the battery too fast.</p>

<p>As TFS is not supported in visual studio for Mac I have been trying to get it to work in visual studio code. I have installed the extension, but can't get tee clc working (I think its no longer supported)</p>

<p>It appears that tee clc is not compatible with the latest version of oracle.</p>

<p>I have tried installing oracle 10 and folowing this fix <a href=""https://expicon.se/2017/10/13/tee-clc-not-working-on-mac/#comment-9"" rel=""nofollow noreferrer"">here</a> but I get an error java.lang.module.FindException: Module java.xml.bind not found</p>

<p>can anybody point me in the right direction. I feel like im missing something as this should not be so hard.</p>

<p>Is TEE clc the right tool to be using. If not how should this be done now?</p>

<p>Thanks</p>",macos|visual-studio-code|tfs,1784280,Paul,yes
How to determine package name of app which throws exception in logcat?,"<p>Recently I encountered a problem on my phone. I look into logcat almost every day and few days ago I've noticed that logcat is flooded with one exception. Exactly this one:</p>

<pre><code>2019-05-26 11:23:19.034 14375-14441/? W/Bundle: Key android.icon expected Parcelable but value was a java.lang.Integer.  The default value &lt;null&gt; was returned.
2019-05-26 11:23:19.034 14375-14441/? W/Bundle: Attempt to cast generated internal exception:
    java.lang.ClassCastException: java.lang.Integer cannot be cast to android.os.Parcelable
        at android.os.Bundle.getParcelable(Bundle.java:946)
        at android.app.Notification.fixDuplicateExtra(Notification.java:2840)
        at android.app.Notification.fixDuplicateExtras(Notification.java:2830)
        at android.app.Notification.readFromParcelImpl(Notification.java:2178)
        at android.app.Notification.&lt;init&gt;(Notification.java:2106)
        at android.app.Notification$1.createFromParcel(Notification.java:2716)
        at android.app.Notification$1.createFromParcel(Notification.java:2713)
        at android.os.Parcel.readParcelable(Parcel.java:2790)
        at android.view.accessibility.AccessibilityEvent.readAccessibilityRecordFromParcel(AccessibilityEvent.java:1232)
        at android.view.accessibility.AccessibilityEvent.initFromParcel(AccessibilityEvent.java:1182)
        at android.view.accessibility.AccessibilityEvent$1.createFromParcel(AccessibilityEvent.java:1426)
        at android.view.accessibility.AccessibilityEvent$1.createFromParcel(AccessibilityEvent.java:1423)
        at android.accessibilityservice.IAccessibilityServiceClient$Stub.onTransact(IAccessibilityServiceClient.java:68)
        at android.os.Binder.execTransact(Binder.java:739)
</code></pre>

<p>I also noticed that my battery started to drain much faster probably because of that. Actually Google Play Services are quite high on the battery info list when I look on 1 week history </p>

<p>How can I determine which app is writing this exception? Is it actually possible? Maybe you have other ideas how to solve this problem?</p>",android|logcat,1750213,Zygi,yes
My service notification makes a battery drain,"<p>i have a notification that display the battery level. The notification is in a service because even if the app is closed the service still run and it can display the percentage of battery.. I've notice the battery level go down faster when the notification is active.. Is there a way to resolve this problem? </p>

<p>Edit:
onCreate of service</p>

<pre><code>@Override
    public void onCreate(){
        super.onCreate();
        mNotificationManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
        new IntentFilter(Intent.ACTION_BATTERY_CHANGED);    
    }
</code></pre>

<p>and in the manifest i wrote this too <code>ACTION_BATTERY_CHANGED</code> </p>",android|service|android-notifications|batterylevel,2508402,David_D,yes
Android App Is Causing Battery Drain,"<p>I have two issues with this, my very first android app. The first is that I noticed after I installed the app the battery started draining about twice as fast as before. I read an article on this that stated sometimes programmers make an error which causes this. This being my first app, the probability is pretty high that this is the case.</p>

<p>The second issue is that I can save my variables when the app is turned off, but when the phone is turned off the data is lost. </p>

<p>As for the code, it's mostly bits and pieces from stuff I've found online and tried to incorporate. It's a simple calculator with three variables. Ideally, I'd like to store <code>b</code> and <code>c</code>, but allow the user to overwrite them. Variable <code>a</code> will change with each use, so no need to store that.</p>

<p>Here's my Main:</p>

<pre><code>package com.kwagz.calc;

import android.app.Activity;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.os.Bundle;
import android.preference.PreferenceManager;
import android.view.View;
import android.widget.EditText;
import android.widget.TextView;

public class MainActivity extends Activity {

String g, e;
String b; //changed(sorry)
String c; //changed
SharedPreferences sh_Pref;
Editor toEdit;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    loadSavedPreferences();

}

public void calculateClickHandler(View view) {

 if (view.getId() == R.id.button1) {

     EditText a = (EditText)findViewById(R.id.a);
 EditText b = (EditText)findViewById(R.id.b);
 EditText c = (EditText)findViewById(R.id.c);
 TextView output = (TextView)findViewById(R.id.textView9);

 double gp = Double.parseDouble(a.getText().toString());
     int ab = Integer.parseInt(b.getText().toString());
     int ac = Integer.parseInt(c.getText().toString());        
     double t = ((gp / ab) * ac);

 output.setText(String.format(""%.2f"", t));
 }

 }

public void sharedPreferences() {
    SharedPreferences saved_values =//there's no linebreak here in my code
 PreferenceManager.getDefaultSharedPreferences(getApplicationContext());
    SharedPreferences.Editor editor=saved_values.edit();
         editor.putString(""b"", b);
         editor.putString(""c"", c);
         editor.commit();   

}

private void loadSavedPreferences() {
    SharedPreferences saved_values =//there's no linebreak here in my code
 PreferenceManager.getDefaultSharedPreferences(getApplicationContext());

    b = saved_values.getString(""b"", g);
}


}
</code></pre>",android|eclipse,3453128,Kwag_Myers,no
optimizing chat box in php and jQuery,"<p>I have a chat box using jQuery and php.</p>

<pre><code>setInterval(
    function(){

        if($('#session_container').children().length &gt; 0){
            if(localStorage['group_id']){
                var group_id = localStorage['group_id'];
                var session_id = localStorage['session_id'];
                var gsid = 'GSID' + group_id + session_id;
                $('#chatbox').load('php/chatbox.php', {'group_id' : group_id, 'session_id' : session_id}, 
                    function(){
                        $('#chatbox').find('tr:even').addClass('alt');
                        if($('#chatbox').children().length == 0){
                            localStorage.clear();
                            window.location.replace('chatro_main.php');
                        }
                    }
                );
            }else{

            }
        }
    }, 1000);
</code></pre>

<p>As you can see from the code above, the script runs every one second which I think is very aggressive and I think it's also wasting power(my laptop's battery seems to be draining faster when I was running this). Is there a better way of doing this. Something like not reloading the content while the user is on another tab on the browser window. Or something like updating only the content if another user sent a message? 
If you know of another technology that could do this in a more optimal way, you could also mention it.</p>",php|jquery,472034,Wern Ancheta,yes
Best practice for persistent mobile connections on Android?,"<p>I'm considering using a persistent connection to a ""cloud service"" from an Android app. This would  run all the time in a background service (or something like that). </p>

<p>I'm thinking of using web sockets or XMPP to keep the connection, basically looking for a light weight connection that won't drain battery. I <strong>want to be able to push notifications in real time</strong> to this connection, so periodic polling is not desired. <em>I am aware of C2DM and other commercial solutions, but am looking to roll my own</em>. This is why a web socket (or other light weight connection) is what I'm investigating. So if I go this route, what are some best practices I should be aware of? </p>

<p>I'm thinking of stuff like:</p>

<ol>
<li>how to prevent the battery from draining, </li>
<li>How to handle IP address changes, etc?</li>
</ol>",android|xmpp|websocket|real-time,402098,Paul Fryer,yes
Location in background and simulator,"<p>I need to make the application which use exact coordinates every 1 secound.
<strong>I know about battery drain - this app will work only on power</strong> (wires in car).
But I need to use not significand, but high accuracy coordinates very often (and in background, because use navigation program at this time).</p>

<p>I try a lot of examples from some articles about corelocation in background.
I make delegate of CLLocationManagerDelegate
Make function locationManager:didUpdateToLocation:fromLocation:
<strong>Write backgroungmode:location in .plist</strong> 
in my log I see coordinates.
But when I click on home button - everithing stops.
I get coordinates in background mode one time in 5min.
Is it a problem with app or feature of simulator?</p>

<p>I compile and start some examples from github etc - everything the same</p>

<p>I don't have yet iPhone - because to buy or not to buy depends of ""can I write this app"".
In android it's really easy - I make location listener and Service - and get coordinates every secound.</p>

<p>Update:
I use this example:
<a href=""http://mobile.tutsplus.com/tutorials/iphone/ios-multitasking-background-location/"" rel=""nofollow"">http://mobile.tutsplus.com/tutorials/iphone/ios-multitasking-background-location/</a></p>

<pre><code>2013-01-05 11:26:41.162 BackgroundLocationTrackingExample[3402:f803]  Latitude: 37.331504 Longitude: -122.030716
2013-01-05 11:26:42.166 BackgroundLocationTrackingExample[3402:f803]  Latitude: 37.331464 Longitude: -122.030721
2013-01-05 11:26:43.148 BackgroundLocationTrackingExample[3402:f803]  Latitude: 37.331426 Longitude: -122.030728
2013-01-05 11:26:44.161 BackgroundLocationTrackingExample[3402:f803]  Latitude: 37.331388 Longitude: -122.030728
2013-01-05 11:26:45.172 BackgroundLocationTrackingExample[3402:f803]  Latitude: 37.331351 Longitude: -122.030735
</code></pre>

<p>Press Home button</p>

<pre><code>2013-01-05 11:30:35.147 BackgroundLocationTrackingExample[3402:f803]  Latitude: 37.330071 Longitude: -122.021223
2013-01-05 11:35:35.176 BackgroundLocationTrackingExample[3402:f803]  Latitude: 37.324633 Longitude: -122.024034
2013-01-05 11:40:36.153 BackgroundLocationTrackingExample[3402:f803]  Latitude: 37.330647 Longitude: -122.030024
etc
</code></pre>",ios|sdk|background|ios-simulator|core-location,1821221,klvd,yes
Does OpenGL ES drain more battery than standard 2D graphics?,"<p>I'm contemplating writing an app which does a lot of moving 2D graphics. I'm not very familiar with the standard android 2D graphics API, and I'm a lot more comfortable with OpenGL so I'm naturally considering using OpenGL instead.</p>

<p>My consideration right now is this, if I make sure to reduce my frame rate and not do any continuous updates unless I need to animate stuff, is there a significant difference in power consumption/battery life with using OpenGL ES compared to standard graphics?</p>

<p>Note that I'm not making a game, and I will not need continuous updates except when animating UI elements.</p>",android|opengl-es|battery,46991,falstro,no
Android Running Service indefinitely recommended?,"<p>My application has a service that collects data through bluetooth and stores in a file locally. However the code for turning on the bluetooth and pairing is in the activity.</p>

<p>Am planning to bring the pairing part logic into the service as well, but i do not want to kill the service ever after exiting the application. The next time when my mobile comes within the bluetooth range, since it is already paired it will start collecting data.</p>

<p>Is it recommended to make the service run at the background indefinitely? 
Does this will really drain up the battery? Any suggestions?</p>",android|service|bluetooth|bluetooth-lowenergy|android-bluetooth,925097,Vivek C A,no
iPhone app rejected due to battery usage and heat,"<p>My app got rejected for the following:</p>

<pre><code>13.2 - Apps that rapidly drain the device's battery or generate excessive heat will be rejected
</code></pre>

<p>I have two guesses as to why it may have been rejected:</p>

<ol>
<li>My app is essentially a LED Candle app which uses a proprietary candle flicker algorithm. So it turns on/off the LED very quickly resembling a candle. Usage of the LED is obviously going to drain the battery faster than most apps would. So wouldn't the multitude of ""LED Flashlight"" Apps on the market. </li>
<li><p>I have code which does recursive loops and looping code like this could be killing the battery? </p>

<p><code>NSTimer.scheduledTimerWithTimeInterval(timeTillFlicker, target: self, selector: ""candleFlickerLoop"", userInfo: nil, repeats: false)</code></p>

<p>Does creating loops like this with a <code>timeTillFlicker</code> around <code>0.0065</code> Seconds burn the battery down? Is there a better way to do this?</p></li>
</ol>

<p>So of those two things, do you think either is the cause of this rejection by apple? </p>

<p>Does anyone have any advice on working through feedback like this? </p>

<p>Any advice would be greatly appreciated. I'm feeling pretty discouraged from this review process. </p>

<p>UPDATE: After getting rejected numerous times for numerous different reasons that were all kind of BS, I eventually received a phone call from Apple to tell me the real reason they are rejecting my app indefinitely. It is because I have created an app which uses the camera flashlight and they are no longer accepting any app which uses this as it's primary function. Their reasoning is that they already offer a 1st party flashlight application and don't want any others, even though my app really is not the same thing. I truly believe it is because there is a massive memory leak every time you turn on/off the back flashlight. In my tests I was able to identify that every time you turn on/off the light, it consumes memory and does not clean up after itself until eventually the app or phone crashes. I ended up giving up on this app due to basically being told ""It will never be accepted regardless of what you change.""</p>",ios|appstore-approval,4760118,Corey,yes
Continuously Running Socket.io Service in Android,"<p>I am developing a chat client using Socket.io as a means of communicating with the server. As such, using GCM is not exactly an option.</p>

<p>I want be able to receive chats at any time (even if the application is closed); essentially the socket needs to be listening at all times. I understand that a service can be started when the phone boots and kept running. However, this seems to be a rather bad idea on a mobile device, draining battery and the like.</p>

<p>Researching, it seems that GCM is the most common implementation for this sort of issue. Unfortunately, I cannot replace Socket.io at the moment. I was wondering how I would go about implementing this chat design - having a socket listening in the background.</p>",java|android|sockets|socket.io|chat,5704973,DaPasta,yes
Android Wear: BleLEScan is draining my battery,"<p>I am developing an app which needs data from the wear.</p>

<p>One of the type of data is BLE.</p>

<p>I am using BleLeScan:</p>

<pre><code>BluetoothManager bluetoothManager =
                (BluetoothManager) getSystemService(Context.BLUETOOTH_SERVICE);
        mBluetoothAdapter = bluetoothManager.getAdapter();
    if (Build.VERSION.SDK_INT &gt;= 21) {
                mLEScanner = mBluetoothAdapter.getBluetoothLeScanner();
                settings = new ScanSettings.Builder()
                        .build();
                filters = new ArrayList&lt;ScanFilter&gt;();
            }

mLEScanner.startScan(filters, settings, mScanCallback);
</code></pre>

<p>BLELeScan is draining my wear's battery. I know this because i tested with BLE scan and without it. The difference is huge, without BLE scan battery consumption per hour is about 3%, whereas with BLE scan it is >16%.</p>

<p>How can I optimize battery consumtion for BLELeScan? I need to run the scan continuously.</p>",android|service|bluetooth-lowenergy|wear-os|battery,4135902,Ritu Raj,no
How and where is better to execute a periodic code on Android,"<p>Hi everyone (i'm a newbie in android and kotlin),
What i need to do is send periodically (every 10 sec) some information, of may application, on a remote server whit a POST request independently if the application is in foreground or background.
Now i found some interesting source like this: <a href=""https://guides.codepath.com/android/Repeatinag-Periodic-Tasks#alarmmanager"" rel=""nofollow noreferrer"">https://guides.codepath.com/android/Repeatinag-Periodic-Tasks#alarmmanager</a>.</p>
<p>But i have some perplexity:</p>
<ul>
<li>how would you structure this task?</li>
<li>is a bad idea to start aThreadPool on an application class?</li>
<li>is better to use a Thread or    service?</li>
</ul>
<p>Thanks everyone in advance!</p>
<p><strong>More Info:</strong></p>
<p>The information in question are logs, so every 10 sec the app send it's logs(if present) to a logstash -&gt; Elasticsearch.</p>
<p>I know that 10 sec is a lot, and it will drain the battery of the device, but i'm not the one in charge of this decision and i can't change it.</p>",android|kotlin|android-service|android-thread|android-log,15151545,SoncioZ,no
Check for location using broadcast receiver,"<p>Whenever I check location settings, I can see the low usage by google maps etc. My question is can I declare a broadcast receiver such that it continuously receives location updates? As in can I check if the users location is equal to a specific location? Or will this process drain battery like anything? Is there a Broadcast Receiver Intent-Filter for location changed?
Please do help.</p>

<p>Thank you.</p>",java|android|location|broadcastreceiver|intentfilter,5211223,KISHORE_ZE,no
iOS Battery drain and overhead,"<p>)</p>
<p>I'm working on 2 apps (let's say Uber like for drivers and clients) that heavily depends on real time sync.
To give you an overview, theses apps uses ;
sockets to get realtime data
bluetooth to connect to various hardwares
location in realtime to dispatch rides
standard REST API
Firebase for chats</p>
<p>The customer noticed that the driver app is draining the battery while the passenger app is not.
Indeed, the energy consumption is very high</p>
<p><a href=""https://i.stack.imgur.com/nQxHq.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/nQxHq.png"" alt=""enter image description here"" /></a></p>
<p>That is only by launching the app and doing nothing. As compared, the passenger app has a high energy impact at launch, and then goes back to the green area.</p>
<p>Of course I tried to investigate and ran various Instruments. There are no leaks (that's a good news so far).
Obviously, I thought that it could come from the continuous location update, the sockets and the bluetooth. I denied access to location and bluetooth and deactivate the socket. Here are the results :</p>
<p><a href=""https://i.stack.imgur.com/afYVO.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/afYVO.png"" alt=""enter image description here"" /></a></p>
<p>Obviously it's better, but still really high for no reason.
I noticed that there was a request that is made periodically that triggers overhead each time (it's although visible in the previous image). So I ran network check.</p>
<p><a href=""https://i.stack.imgur.com/oLizo.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/oLizo.png"" alt=""enter image description here"" /></a></p>
<p>As you can see there are no requests made by my application besides when the app is launched.
I cannot find what is that damn request. I tried to completely shut down Firebase Analytics too, same results. I tried to use SocketRocket instead of Starscream, I get a slightly better result, but still in the red zone. I just can't figure out what's causing this overhead and which process periodically sends a network activity.</p>
<p>Any help would be much appreciated. Thanks.</p>",swift|sockets|core-location|core-bluetooth,637438,Khal,no
Long Lived Persistent TCP Connection on the Android,"<p>I've read some articles on the web and some questions on StackOverFlow, but no one seems to have a definite answer over a) If google uses Long Lived TCP connections for Gmail, Mail etc, and b) If using it in a custom app will drain battery life , and if so roughly how much?</p>",android|tcp|persistent,117691,Faisal Abid,no
Google Analytics v4 on Android. Dispatch Frequency,"<p>Here is my XML configuration file.</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;
&lt;resources xmlns:tools=""http://schemas.android.com/tools"" tools:ignore=""TypographyDashes""&gt;

    &lt;string name=""ga_trackingId""&gt;UA-XXXXXXXX-YY&lt;/string&gt;
    &lt;bool name=""ga_autoActivityTracking""&gt;true&lt;/bool&gt;
    &lt;bool name=""ga_reportUncaughtExceptions""&gt;true&lt;/bool&gt;

    &lt;screenName name=""com.gui.Activity1""&gt;Activity1&lt;/screenName&gt;
    &lt;screenName name=""com.gui.Activity2""&gt;Activity2&lt;/screenName&gt;
    &lt;screenName name=""com.gui.Activity3""&gt;Activity3&lt;/screenName&gt;

&lt;/resources&gt;
</code></pre>

<p>Here is an initialization of a <code>GoogleAnalytics</code> instance in a helper class.</p>

<pre><code>private GoogleAnalyticsHelper() {
    mGoogleAnalytics = GoogleAnalytics.getInstance(KMSApplication.sAppContext);
    mTracker = mGoogleAnalytics.newTracker(R.xml.tracker_global_config);
}
</code></pre>

<p><a href=""https://developer.android.com/reference/com/google/android/gms/analytics/GoogleAnalytics.html"" rel=""nofollow"">The documentation says</a> the default dispatch period is 30 minutes; however, I can see reports in my GA console both in the Real-Time Overview page and in the Events Overview page in a few minutes. Why?</p>

<p>I'm worried about battery drain which may be caused by frequent dispatches.</p>",android|google-analytics,1065835,Maksim Dmitriev,yes
ValueAnimator doesn't work as expected when battery saver is enabled(>= API 21),"<p>ValueAnimator doesn't seem to repeat or play animators that are repeated infinitely when the battery saver is enabled in Android lollipop or higher. </p>

<pre><code>    animator = ValueAnimator.ofInt(0,timePeriods.length-1);
    animator.setInterpolator(new LinearInterpolator());
    animator.setEvaluator(new TypeEvaluator() {
        @Override
        public Object evaluate(float v, Object o, Object t1) {
            int time = 0 ;
            int timeElapsed = (int)(v*totalTime) ;
            for (int i = 0; i &lt; timePeriods.length; i++) {
                time = time + timePeriods[i];
                if(time&gt;=timeElapsed) return i ;
            }
            return 0 ;
        }
    });
    animator.setDuration(totalTime);
    animator.setRepeatCount(repeatCount);
    animator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() {
        int currentValue = -1 ;
        @Override
        public void onAnimationUpdate(ValueAnimator valueAnimator) {
            int value = (Integer) valueAnimator.getAnimatedValue();
            if(value!=currentValue){
                Log.d(TAG,""Value Changed: ""+currentValue+"" ""+value);
                currentValue = value ;
            }
        }
    });
</code></pre>

<p>When the battery saver is enabled the animator plays the animation only once and doesn't repeat after that... Is there any setting|Flag within the application or activity to run animators even in low battery mode as the above animator is a simple integer valueanimator and doesn't drain the battery any further.</p>",android|animation|android-5.0-lollipop|android-6.0-marshmallow,3350779,Revanth Gopi,no
Android background thread continually listening to an UDP port,"<p>I really appreciate that you take a couple of minutes to read my problem, thanks in advance!  </p>

<p>I am building a non-public app for some specific users and here is my problem:</p>

<hr>

<p>I have a service for background workloads in which I started a user thread that continually listens to an UDP port. It works fine when the device screen is turned on but lost all UDP packets when screen turned off.  </p>

<p>Following is what I wrote in the thread:</p>

<pre><code>// Android os v7.1.2, wifi 
DatagramSocket s;
DatagramPacket p;  // already initialized 
while (true) {
    try {
        if (s == null || !s.isBound()) {
            s = new DatagramSocket(60000);
            s.setSoTimeout(0);
        } else {
            s.receive(p);  
            ... 
        }
    } catch(Exception e) {
        ...
    }
}
</code></pre>

<p>I guess it's a power-management-related problem on Android devices. I have tried place <strong>PowerManager.WakeLock.aquire()</strong> and <strong>release()</strong> before and after the while loop but that does take effect.  </p>

<p>To be clear, this app is built for specific clients and does not care about how much battery it will drain(probably the only running app on device in most times lol).   </p>

<p>Any idea what should I do? Should I choose <strong>IntentService</strong> or something like that to achieve this ""infinite"" UPD port listening work? I have spent a whole weekend seeking solutions in Android docs, but non of the examples said I could do a instantaneously triggered UDP socket listening[sad face]. </p>

<p>For more information, I logged all three socket connection threads started in my service and find out that the one thread which uses tcp socket to send sth to server and wait for sth sent back works quite fine... </p>",java|android,9938918,qeva zessica,no
How to test the battery drain and frame rendering in iOS applications similar to pCloudy for Android?,"<p>We have a popular tool called as pCloudy for testing the Android battery drain for Android applications as shown below :</p>
<p><a href=""https://www.pcloudy.com/android-app-testing-for-battery-drain/"" rel=""nofollow noreferrer"">https://www.pcloudy.com/android-app-testing-for-battery-drain/</a></p>
<p>Since pCloudy doesnt have support for iOS applications for checking the Battery Drain and Frame rate. Please help me with another alternatives which support testing Battery Drain and Frame rate for the iOS applications.</p>",android|ios|objective-c|swift|xcode,3301811,Developer,yes
Persistent background worker in Android Flutter App that fetch Web API every 30 seconds,"<p>I'm developing Android only app on Flutter. My app needs to call some Web APIs in the background every 30 seconds. The background worker should keep running even if the user or Android OS closes my app's main activity.</p>
<p>I know that doing something in the background too frequently will drain the battery very quickly and it is considered bad practice. But still, I need to do it every 30 seconds.</p>
<p>The target platform of my app is Android 7.0 or higher.</p>
<p>Any ideas how can I implement this in Flutter?</p>",android|flutter|dart|backgroundworker|intervals,3247384,Tiber Septim,no
iOS: How to use location tracking during predefined time period while saving battery life?,"<p>iOS: How to use location tracking during predefined time period while saving battery life?</p>

<p>I need to activate location tracking during predefined time periods (does not matter if app in background or foreground) and need to be sure that battery life is not impacted too much?</p>

<p>PS:
  Please not that running location in background with tracking significant changes does not suits because it gives you location after 10 min and only when you passed reasonable amount of distance ... so during driving 40 km I got location only 3 times that will not allow me to catch user movement near some point. If running location more often ...that drains battery upto 40 percent per 6 hours...</p>",ios|core-location|battery-saver,2521971,Rufat Abdullayev,no
TimeSeries prediction / optimization problem for a solar powered water pump,"<p>I would like to solve an ""optimization problem"" by using new and fancy machine learning methods (also to learn more about them) and I haven't found yet which methods / models will help me to solve my specific problem. May be you have some inspiration or hints :-)</p>

<p><strong>Constraints:</strong></p>

<p>A water pump is connected to a battery which is powered by a solar panel.
The water pump speed can be set from 0 (stop) to 1023 (running at full speed).
The battery can be charged up to 13.4 V and it is empty at 11.7 V.
I can measure the battery voltage and current and set the pump speed by using an ESP8266.</p>

<p><strong>Goal:</strong></p>

<p>From e.g. 8 am until 10 pm, the pump speed should always be as high as possible.</p>

<p><strong>Problem:</strong></p>

<p>The problem is that the battery capacity is limited and the sun is not always shining (for the solar panel). So on a sunny day, the pump can run at e.g. speed 500 from 8am - 10pm but if it is cloudy the speed should be slower to consume less power. If it is cloudy in the morning it should run at slow speed in the morning and if it gets sunny in the afternoon it can run a little bit faster and so on.</p>

<p><strong>Solution / TL;DR:</strong></p>

<p>I have the following inputs to train e.g. a Long short-term memory (LSTM) artificial recurrent neural network (RNN):</p>

<ul>
<li>timestamp (will measure the values every 60sec)</li>
<li>battery voltage [11.7-13.4]</li>
<li>pump speed (will drain the battery) [0-1023]</li>
<li>luminance (will charge the battery) [0 (dark) - 1023 (bright)]</li>
</ul>

<p>Now I thought of using a genetic algorithm to calculate the ""optimal pump speed plan"" for the day at 8 am:</p>

<p>e.g. 08:00 -> 300, 08:01 -> 300, ... , 10:00 -> 400, ..., 15:00 -> 900, ..., 22:00 -> 0</p>

<p>As I don't know if such a plan (with random pump speed values) would actually work I would like to predict the battery voltage by using the RNN as it has learned on the data history, that high luminance will charge the battery and high pump speed will drain the battery faster.</p>

<p>So I have the pump speed for the next 24h and a weather forecast for the luminance and now the RNN should predict the battery voltage. <strong>How can this be achieved?</strong> Is a LSTM the right tool?</p>

<p>Then I can check the battery voltage if it always stays > 11.7V (the fitness function), if not, I can update the plan accordingly (crossover / mutation) until the genetic algorithm found a good plan.</p>

<p>I can also redo the whole calculation and adapt the plan every 60min.</p>

<p>What do you think?</p>

<p>Here is the already measured data for ~2 (sunny) days. Pump is turned on (1023) for 10 minutes every hour. When the battery is full > 13.4V the voltage starts ""flickering"" by the solar charger controller; I guess this would confuse the RNN and I could apply: if value > 13.4 ? 13.4 : value.</p>

<p><a href=""https://i.stack.imgur.com/lkR96.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/lkR96.png"" alt=""data example""></a></p>

<p>Thanks
Ben</p>",python|keras|lstm|recurrent-neural-network|genetic-algorithm,3264951,Ben,yes
Do tasks when device wakes up,"<p>I'm have a widget that is being updated from a service. When the user then turn off the screen, the service stops and won't start to update the widget again when the user wake up the device. So on to my question, is there some way to ""restart"" the service when the user wake up the device? I know I can keep the service keep going when the screen is locked, but I think it would drain to much battery then... I have google'd alot but haven't found anything...</p>

<p>Thanks in advance!</p>

<p>EDIT: Okey, this is strange! Now somehow it does that automatically, so it's working now! Thanks anyway!</p>

<p>EDIT 2: Or, now I don't really think it's the screen lock that stops the service, cause it just sometimes stops randomly without crashdialog when I use the phone... Anyone know how I should do to fix that?</p>",android|screen,1329077,GuiceU,yes
Choosing BLE broadcast interval,"<p>My IOT device has two functionalities.
1. It provides load/weight data when the weight is applied
2. It is also used for tracking the location of an item to which it is attached.</p>

<p>My battery capacity is 150mAH. What is the best broadcast interval I should use?  If I use longer broadcast interval like 2 seconds, it will mean weight has to be applied for a longer period to get the weight data which is inconvenient for the user. However, too frequent broadcast can cause drain on the battery when it is used for tracking. 
Please advise.</p>",bluetooth-lowenergy,8418954,BLE,no
Implementing SensorEventListener in a BroadcastReceiver... is it possible?,"<p>Why can't I have a class extending BroadcastReceiver and implementing SensorEventListener? This class receives alarm intents set in my application.</p>

<p>I have a class instance variable that is set inside the implemented onSensorChanged method. In the onReceive method I register the listener, have a while loop that runs until the class instance variable is set. After the loop I unregister the listener. But the variable is never set and the loop keeps running.</p>

<p>According to the answer here I should never register a listener inside a broadcast receiver:</p>

<p><a href=""https://stackoverflow.com/questions/6883664/broadcastreceiver-with-a-listener-drains-battery-when-not-in-use"">BroadcastReceiver with a Listener drains battery when not in use</a> </p>

<p>In AlarmManager docs there are all these warnings about the device sleeping but in my case it never sleeps.</p>",android|broadcastreceiver|alarmmanager|android-sensors,1445030,jsstp24n5,yes
How to send large message data size (>10 KB) using Push notification to Android,"<p>I have an android app which request for a particular list of data every 10 secs. The size of the response is greater than 10 kb. But I have a battery drainage issue with this kind of architecture. So I thought it would be wiser to implement Push notification service which would be fired from the server each time an action is triggered.</p>

<p>While conducting a feasibility check, I found that the size for a GCM message is limited to 4KB.</p>

<p>How can I fulfill my requirements by using push notification? or is there any other option which I can look into?  </p>",android|asp.net|push-notification|google-cloud-messaging,2168527,Sathya,yes
ios - how to keep app running in background only if the location manager is runnig,"<p>I'm using location background mode, but that makes the app runs forever. what I wanna do is when the location manager is active (user pressed start saving my location) and the app enter the back ground mode the app must stay running (achieved). But, if the user didn't pressed the button to start saving the location or he pressed the button ""stop saving my locations"" then the app can be killed or suspended when it is in the background. 
Now the app is running on the background even if it has no work to do. and it drains battery.</p>",ios|background|cllocationmanager,1891218,Firas KADHUM,yes
"Hand rays getting stuck if you go out of the app to shell and going back if the application has ""Run in background"" unchecked","<p>Describe the bug
Hand rays getting stuck if you go out of the app to shell and going back if the application has ""Run in background"" unchecked. Old hand rays get stuck and new hand rays pop up. So you can see 3 or more hand rays at the same time. Also seems grabbing stops working, not always but sometimes. But if far interaction pointers are visible, they always get stuck upon going to shell.</p>

<p>This ticked is reopening of <a href=""https://github.com/microsoft/MixedRealityToolkit-Unity/issues/4196"" rel=""nofollow noreferrer"">https://github.com/microsoft/MixedRealityToolkit-Unity/issues/4196</a> since the problem was discovered why our app behaves differently than MRTK example app. The difference was Run in Background being unchecked in ours and checked in MRTK.</p>

<p>We would prefer for our app to not have to Run in Background, to not drain battery. But if this is required it should be documented somewhere.</p>

<p>To reproduce
Reproducible with standard MRTK example build. Before building uncheck ""Run in Background"" in ""Resolution and Presentation"" part of the ""Player Settings"". Then on device in application if you hit the home button with hand rays visible and then go to shell via Home Button on Start menu. Wait couple of seconds (~10s). And open the app the previous hand rays are visible and new ones come up.</p>

<p>Expected behavior
Only new hand rays are visible</p>",mrtk,10935621,Yoyozilla,yes
How to cancel auto reconnect mechanism in Paho Android Client when internet is not available?,"<p>We are using PahoAndroidClient and it works just fine. However we want to cancel auto reconnect mechanism for example after 10 failure tries when network connectivity is not available.</p>

<p>In this case, we want to close or disconnect the current MqttAndroidClient instance and later when user have access to the internet, we connect it again (we don't want to leave Mqtt service running, reconnecting and draining battery).</p>

<p>Now by invoking disconnect method on an instance of MqttAndroidClient which is still alive and trying to reconnect, nothing will happen (still trying to reconnect). In addition, if the next time when user have access to the internet, we create a new object and connect it to the server, the previous instance also can connect and it causes a duplicate connection issue on the server while two simultaneous client are connecting with a common clientId.</p>",android|mqtt|paho,3384459,Ryan,no
Drive API files.list returning nextPageToken with empty item results,"<p>In the last week or so we got a report of a user missing files in the file list in our app. We we're a bit confused at first because they said they only had a couple files that matched our query string, but with a bit of work we were able to reproduce their issue by adding a large number of files to our Google Drive. Previously we had been assuming people would have less than 100 files and hadn't been doing paging to avoid multiple files.list requests.</p>

<p>After switching to use paging, we noticed that on one of our test accounts was sending hundreds and hundreds of files.list requests and most of the responses did not contain any files but did contain a nextPageToken. I'll update as soon as I can get a screenshot - but the client was sending enough requests to heat the computer up and drain battery fairly quickly.</p>

<p>We also found that based on what the query is even though it matches the same files it can have a drastic effect of the number of requests needed to retrieve our full file list. For example, switching '=' to 'contains' in the query param significantly reduces the number of requests made, but we don't see any guarantee that this is a reasonable and generalizeable solution.</p>

<p>Is this the intended behavior? Is there anything we can do to reduce the number of requests that we are sending?</p>

<p>We're using the following code to retrieve files created by our app that is causing the issue.</p>

<pre><code>runLoad: function(pageToken)
{
    gapi.client.drive.files.list(
    {
        'maxResults': 999,
        'pageToken': pageToken,
        'q': ""trashed=false and mimeType='"" + mime + ""'""
    }).execute(function (results)
    {
        this.filePageRequests++;

        if (results.error || !results.nextPageToken || this.filePageRequests &gt;= MAX_FILE_PAGE_REQUESTS)
        {
            this.isLoading(false);
        }
        else
        {
            this.runLoad(results.nextPageToken);
        }
    }.bind(this));
}
</code></pre>",google-drive-api,2575382,Grant Watters,no
How do I get data from an api and then send a push notification to my device if something changed (with firebase)?,"<p>I'm creating an android app in Java which is supposed to check third party APIs for any changes in the cryptocurrency balance and if there are any, then it should send a push notification to my app.</p>
<p>Originally I was thinking about doing this with an AlarmManager but the drawback is that it drains the battery to much. I've heard about Firebase and I would like to use it in my project, but I didn't find any source or documentation on how I could continually get the API data.</p>
<p>I would be really grateful if someone could point me in the right direction or give me an example (I don't know how to actually get the data with firebase, but I saw a lot of documentation on push notifications and I know how to compare the data).</p>",java|android|firebase|api,13861744,The Nerd,yes
How can I refresh MediaStore on Android?,"<p>This started out as a general user question on Android forums. However it's become, by necessity, a  programming question. Here's my problem. </p>

<p>Android has a service - MediaScanner - which runs in the background any time (I believe) the SD card is un-mounted and re-mounted. This service collects data on all the media files on the card, and provides a SQLite DB which can be queried by music applications. Most music applications use this service as it saves on battery-drain associated with scanning the SD card. </p>

<p>Since I started using android, I've consistently had a problem whereby M3U playlists synchronised to the device remain in this SQLite DB even after being deleted from the SD Card. It's gotten to the point where I now have a collection of about 40 playlists showing up in any music app I use, despite there only being around 10 m3u files on the card. The remaining playlists do not play, and are empty. I can remove them manually by deleting them from the music app, but I'm sick of doing this. There has to be a better way to remove these ghost playlists. </p>

<p>There are two apps on the Android Market - SDRescan and Music Scanner, which supposedly do exactly this but neither of them work. </p>

<p>I set about writing my own app to refresh or delete the MediaStore database and start from scratch, but I'm not getting very far. I've got an android app which runs the following code :</p>

<pre><code>sendBroadcast(new Intent(Intent.ACTION_MEDIA_MOUNTED, 
        Uri.parse(""file://"" + Environment.getExternalStorageDirectory()))); 
</code></pre>

<p>I've found a few examples of this code online as a way to scan the SD Card but I'm not having any luck with it whatsoever. Any tips? </p>

<p>FULL CODE:</p>

<pre><code>package com.roryok.MediaRescan;

import android.app.Activity;
import android.content.Intent;
import android.content.IntentFilter;
import android.net.Uri;
import android.os.Bundle;
import android.os.Environment;

public class MediaRescan extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        sendBroadcast(new Intent(Intent.ACTION_MEDIA_MOUNTED, 
                Uri.parse(""file://"" + Environment.getExternalStorageDirectory()))); 
        setContentView(R.layout.main);
    }

    //Rescan the sdcard after copy the file
    private void rescanSdcard() throws Exception{     
      Intent scanIntent = new Intent(Intent.ACTION_MEDIA_MOUNTED, 
                Uri.parse(""file://"" + Environment.getExternalStorageDirectory()));   
      IntentFilter intentFilter = new IntentFilter(Intent.ACTION_MEDIA_SCANNER_STARTED);
      intentFilter.addDataScheme(""file"");     
      sendBroadcast(new Intent(Intent.ACTION_MEDIA_MOUNTED, 
                Uri.parse(""file://"" + Environment.getExternalStorageDirectory())));    
    }
}
</code></pre>",android|mediastore,352867,roryok,yes
how to handle the data downloading in background dispatch queue from server if battery drains?,"<p>I am downloading the data at background from server in an offline app, where the data will be downloaded when the app launches for the first time .Later the app will be used as offline app.</p>

<p>I need to place the condition to check whether the data couldn't be downloaded due to low battery, Network issues etc.</p>

<p>Where Can I handle these in app life cycle?</p>",ios|objective-c|download|offline-browsing,4169569,soumya,yes
Notify user when the battery temperature exceeds a limit,"<p>I am developing an App which gets a maximum temperature from the user. It keeps on monitoring the current temperature of the battery. And once the temperature goes above the maximum temperature got from user, it should notify user. </p>

<p>I designed layouts, wrote logic to store the temperature from the user and i know i can monitor the temperature using EXTRA_TEMPERATURE. However, this app should run in the background. Since I have to monitor the temperature always,logically the service should always run. </p>

<p>On reading forums i understand this will drain battery a lot and mostly can have services running when the screen is on. But, i would like to know if the service can be had in Background without draining battery. Or is there any other way to achieve this?</p>

<p>My app is similar to this : <a href=""https://stackoverflow.com/questions/12075084/creating-a-temperature-sensing-android-app-that-runs-in-the-background-after-act"">Creating a temperature-sensing Android app that runs in the background after activation</a></p>",android|service|notifications|battery,2087494,senthilrameshjv,yes
Proper iOS Background Location Updates,"<p>Location updates using apples CLLocationManager have been working fine while my application is running.  I decided to implement the MonitorSignificantLocationChanges method described in the apple documentation.</p>

<p>Here is my applicationDidEnterBackground method:</p>

<pre><code>- (void)applicationDidEnterBackground:(UIApplication *)application {

// Switch to significant location change events monitoring
[self.viewController.locationController.locationManager stopUpdatingLocation];
[self.viewController.locationController.locationManager startMonitoringSignificantLocationChanges];
</code></pre>

<p>The problem that I am having is that no matter whether I startMonitoringSignificantLocationChanges or not, my application still reports to iOS that it is utilizing location updates even when the application has been removed from the multitasking bar.  Just installing the app without ever running it is enough to make iOS display the location icon in the top right of the screen and the phone starts to drain the battery.  I cannot figure out how to properly stop location updates when the home button is pressed and how to properly start the significant change monitoring service.</p>

<p>Please let me know if I can provide any additional helpful details.</p>",iphone|ios|gps|core-location|multitasking,427854,wasabi,yes
Significant location change for geofencing,"<p>I need to deliver specific messages to the user based on its proximity to a specific location and on some other rules (like if there are any specific messages for that area). For example User gets in car and gets to work. The moment he arrives at work he then gets a message of some sort IF there's a message to be delivered. Here's what I was thinking (no code yet just trying to design the flow while I work at other parts of my app)</p>

<ol>
<li><p>Listen to significant location change and each time that happens send the user's geolocation to the server to see if there's any message to be delivered near that location. No go. That would drain the battery too much due to overusing the radio.</p></li>
<li><p>Save the message regions daily, and at each significant location change do a test on the local stored data. If anything matches THEN contact server. Sounds better in theory.</p></li>
</ol>

<p>Questions:</p>

<ol>
<li>Can number 2 work?</li>
<li>What is the fidelity of the significant location change? I would like NOT to lose a message in a specific area by not getting notified of a location change.</li>
<li>Is significant location change REALLY based on cell tower change? (i read on a number of occasion that'it is not)</li>
<li>Would region monitoring be more suited to this task? Anybody using it? What is the battery drain on it and does it have better or on par fidelity to significant location change?</li>
<li>if app is terminated will significant location change really wake up my app? kinda depending on it.</li>
<li>any suggestion on how to approach this in a way I haven't talked about here?</li>
</ol>

<p>A million thanks to anybody who takes the time to clear some of this stuff up.</p>

<p>EDIT : extra question
7. Region monitoring, having a large number of regions added has any impact on the system? Say having 2 regions vs 100 regions?</p>",ios|geolocation|gps|geofencing,845313,pocorschi,yes
How to keep alive without using GCM and Wakelock,"<p>So i have an application that i am working on. This apps requires to keep alive so that can send keep-alive message to server.</p>

<p>If i do not use wake-lock or wifi-lock app cannot send ping message after around 20 mins or so. </p>

<p><code>WifiManager.WifiLock
Allows an application to keep the Wi-Fi radio awake. Normally the Wi-Fi radio may turn off when the user has not used the device in a while. Acquiring a WifiLock will keep the radio on until the lock is released. Multiple applications may hold WifiLocks, and the radio will only be allowed to turn off when no WifiLocks are held in any application.</code></p>

<p>Because if i use wake-lock the battery will drain so fast.</p>

<p>And i don't want to use GCM either because its not guaranteed.</p>

<p>Could you give me a suggestion !</p>",android|android-service|google-cloud-messaging|android-networking,1420945,hoangnh,yes
Android AlarmManager heavy battery drainer?,"<p>i just started working on android about 4 months back.
i created a project that uses AlarmManager, the flow is like this:
AlarmManager->service->wifi not available->AlarmManager continues->service.. and so on.
this alarm may be scheduled for days, hopefully if the device is not rebooted.
I required help in the Battery drainage part of the project. How may i know the rate at which my AlarmManager Project is draining the battery. I fear that if it draining a lot of battery, my app wont be useful.</p>",android|alarmmanager|battery|android-wifi|android-alarms,793784,blogbydev,yes
How to find most repeated word in a Column in MySQL?,"<p>I have a table of comments by users like:</p>

<pre><code>id  Comments
1   The battery drains off very soon 
2   Screen Quality is very good
3   Even I have the same battery problem
4   Battery can be imporved
5   Screen goes blank sometimes...
6   Over all build is nice
</code></pre>

<p>So in the above case, I want to find the most talked about feature of a phone. So that result I can display as 50% people speaking about Battery, 30% about Screen and 20% Others.</p>

<p>How can achieve this? Also how to exclude preposition, conjunctions etc. from the result set.</p>",mysql,1168819,azzaxp,yes
iOS how to detect if power cable is plugged,"<p>I am making a GPS app and the accuracy changes based on if power is available (ie vehicle charger)</p>

<p>Is there a way to run something in the background that constantly checks to see if a device is receiving power?</p>

<p>I know how to check if power is connected. But the issue is IF the user is at home and connected. He unplugs the device to go out on a run. Then decides to hang out. My app checks the battery state on launch. How can I check it again and again. I don't want to drain his battery because he was using my app!</p>

<p>We plan on only supporting iOS 5 and higher (no need for backward compatibility with iOS 4 and 3)</p>

<p>Thanks</p>",ios5|notifications|push-notification|nsnotificationcenter,317785,Cocoa Dev,yes
How to keep gps at full power while device sleeps,"<p>My app needs to record (as precisely as possible) the user's location and movement over time. If I let the device sleep, the GPS accuracy seems to be automatically reduced. I can stop it from sleeping but obviously that is a further drain on the battery. I would like to allow the display to sleep, but maintain the max accuracy for the locationmanager. I have Location updates ticked in the Background Modes section. My code looks like this ...</p>

<pre><code>    locationManager.delegate = self
    locationManager.desiredAccuracy = kCLLocationAccuracyBestForNavigation
    locationManager.distanceFilter = 1
    locationManager.activityType = .Fitness
    locationManager.requestAlwaysAuthorization()
    locationManager.pausesLocationUpdatesAutomatically = false
    locationManager.startUpdatingLocation()

        UIApplication.sharedApplication().idleTimerDisabled = true
</code></pre>

<p>I would really like to remove that last line, but all the testing I have done on a 4s suggests that as soon as the device sleeps it loses accuracy.</p>",iphone|swift|gps|cllocationmanager|sleep,5478114,Melchester,yes
What's the most battery-efficient approach of using LocationClient to periodically get updates?,"<p>I am thinking about having two separate alarms to gather a user's location data every hour, one that goes off every 59 minutes to ""connect"" the client and a second to actually get the location and then subsequently disconnect the client. </p>

<p>In terms of battery life, is there anything else I should consider doing if getting the user's location will be the primary drain of the app? Or, is there a different approach to having two alarms? I originally only had a single alarm, but performing a (!mLocationClient.isConnected) then connect check does not give the client enough time to connect. </p>

<p>Thanks for your insight. </p>

<p>The two alarms would go off something like this: </p>

<pre><code>private int PERIODIC_UPDATE = 60000*60;  //gets location and disconnects every hour
private int PERIODIC_RECONNECTION_UPDATE = 60000*59;  //connects 1 minute before getLocation call

    Timer toReconnect = new Timer();
    toReconnect.schedule(new TimerTask() {

        @Override
        public void run() {
            mLocationClient.connect();
        }
    }, 5000, PERIODIC_RECONNECTION_UPDATE);

    Timer theTimer = new Timer(); 
    theTimer.schedule(new TimerTask(){
        @Override
        public void run() {
            try {
                if(!mLocationClient.isConnected()) {
                    mLocationClient.connect();
                    //This will not have much affect because cannot so quickly, will remove. 
                }

                Location theLocation = mLocationClient.getLastLocation();
                if(theLocation!=null) {
                    checkPostLocation(theLocation); 

                    mLocationClient.disconnect();
                }
            } catch (Exception e) {
                e.printStackTrace();
            }   
        }}, 5000, PERIODIC_UPDATE);
</code></pre>",android|timer|geolocation|google-play-services,2423246,NumenorForLife,no
Saving power with location services by detecting user movement using sensors,"<p>I'm working on an app that tracks the user's whereabouts. In order to save battery, I want to implement an idle zone that makes the location manager pull less frequently (or even stop) on the GPS location. Once the user starts moving again (detected by either accelerometer and/or significant movement), the location service will pull on the default interval.</p>

<p>One approach is to define the idle zone as the <code>minDistance</code> parameter in <code>LocationManager::requestLocationUpdates</code>, but other users around here <a href=""https://stackoverflow.com/a/8947373/1924825"">suggests that it does not have any impact on the battery drain</a>, and the <a href=""https://developer.android.com/reference/android/location/LocationManager.html#requestLocationUpdates(long,%20float,%20android.location.Criteria,%20android.app.PendingIntent)"" rel=""noreferrer"">documentation</a> states that it is difficult for the location manager to save battery using this criteria:</p>

<blockquote>
  <p>However it is more difficult for location providers to save power
  using the minDistance parameter, so minTime should be the primary tool
  to conserving battery life.</p>
</blockquote>

<p>Google also suggests using the <a href=""https://source.android.com/devices/sensors/sensor-types.html#significant_motion"" rel=""noreferrer"">significant motion sensor</a> for detecting when the user location changes:</p>

<blockquote>
  <p>At the high level, the significant motion detector is used to reduce
  the power consumption of location determination. When the localization
  algorithms detect that the device is static, they can switch to a low
  power mode, where they rely on significant motion to wake the device
  up when the user is changing location.</p>
</blockquote>

<p>Does this mean the location manager uses the significant motion sensor if it is present by default, or do I need to activate or implement something to make the location service use it? </p>

<p>And what about the accelerometers? A large part of my question lies in whether using the accelerometer to detect when the user starts moving would save any power, as using the accelerometer would be another sensor that would require power and callback handling. Some accelerometer sensors <a href=""https://source.android.com/devices/sensors/sensor-types.html#composite_sensor_type_summary"" rel=""noreferrer"">are listed as low-powered</a> by Google, while some are not (including the significant movement sensor).</p>

<p>Would it be possible to save any battery power by putting the GPS to sleep and then use sensors to detect user movement which would wake up the GPS again?</p>",android|gps|geolocation|location|battery-saver,1924825,Martin,no
css svg animations use up too much server resources,"<p>Does animation like below drain server resources? </p>

<p>I have many animations of similar(not only in rect but in different shapes too), some have more than 20 <code>nth-child</code> up to 8s, I am working on a localhost and it exhausts battery. My laptop is hot while it is on and there is system prompt of the page using up too much resources. </p>

<p>I wonder if it is cause by the animations? if yes, How can I achieve the same result without draining the server resources? </p>

<p><div class=""snippet"" data-lang=""js"" data-hide=""false"" data-console=""true"" data-babel=""false"">
<div class=""snippet-code"">
<pre class=""snippet-code-css lang-css prettyprint-override""><code>#svg rect {
  --animation-delay: 0.1s;
  animation: ani 1.8s linear infinite var(--animation-delay);
}


#svg rect:hover {
  animation:none;

} 


#svg rect:nth-child(2) { --animation-delay: 0.2s; }
#svg rect:nth-child(3) { --animation-delay: 0.3s; }
#svg rect:nth-child(4) { --animation-delay: 0.4s; }
#svg rect:nth-child(5) { --animation-delay: 0.5s; }



@keyframes ani {
  0% {
    fill: #0057B8;
  }

  20% {
    fill: #F11E4A;
  }

  40% {
    fill: #F8A527;
  }

  60% {
    fill: #266D7F;
  }

  80% {
    fill: #82A;
  }

  100% {
    fill: #0057B8;
  }
}</code></pre>
<pre class=""snippet-code-html lang-html prettyprint-override""><code>&lt;svg id=""svg"" width=""401"" height=""275"" viewBox=""0 0 401 275"" fill=""none"" xmlns=""http://www.w3.org/2000/svg""&gt;
&lt;rect width=""401"" height=""275"" fill=""white""/&gt;
&lt;rect x=""50"" y=""91"" width=""57"" height=""57"" fill=""#C4C4C4""/&gt;
&lt;rect x=""118"" y=""91"" width=""57"" height=""57"" fill=""#C4C4C4""/&gt;
&lt;rect x=""186"" y=""91"" width=""57"" height=""57"" fill=""#C4C4C4""/&gt;
&lt;rect x=""254"" y=""91"" width=""57"" height=""57"" fill=""#C4C4C4""/&gt;
&lt;/svg&gt;</code></pre>
</div>
</div>
</p>",html|css|svg|css-animations|svg-animate,11814543,Organic Heart,no
Android problems with fused location provider,"<p>I develop an application which needs to be location aware. I tried to use the new google api client but i have some problems.</p>

<p>1.When i ask for location I ask for PRIORITY_HIGH_ACCURACY but i want the user to have the choise to save his battery by using only the mobile networks. When I check Battery saving mode (or disable GPS on old devices) everything works fine. But when I tested the app on a phone with lollipop, even if I close all location providers, the battery is killed. (I also noticed that and by the time the battery is drained, no location update received). </p>

<p>2.I tested to some devices and tried to get location with mobile networks. That worked fine when the device was close to a wifi (but not connected). But in a specific device (sony xperia M2) it is needed to connect to wifi to update location. Is there anything i can do? Is problem of the device or the version of google play services?</p>

<p>My code is here. I fire periodically a pending intent to run the service to be sure that location listener is still listening (i had some problems in the past where location listener disconnected)</p>

<pre><code>public class UpdateLocService extends Service implements GoogleApiClient.ConnectionCallbacks, LocationListener {

public static final String SENDER_ID = ""66801"";
public static final String devIdToServer = ""send dev id to server"";

private static LocationListener listener = null;

//private LocationClient locationClient;
private GoogleApiClient mGoogleApiClient;

private static Location lastLocation = null;;
private LocationRequest mLocationRequest;

@Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    return null;
}

@Override
@Deprecated
public void onStart(Intent intent, int startId) {
    Log.d(""UpdateLocService"", ""dienem service "");
    locApi();
}

private void locApi() {
    if(mGoogleApiClient != null &amp;&amp; (mGoogleApiClient.isConnected() || mGoogleApiClient.isConnecting())){
        dLog.d(""loc.txt"",""tryed to connect but already connected or trying now"");
        dLog.d(""flow.txt"",""tryed to connect but already connected or trying now"");
    }else{
        dLog.d(""loc.txt"",""new connection attempt"");
        mGoogleApiClient = new GoogleApiClient.Builder(this)
                .addApi(LocationServices.API)
                .addConnectionCallbacks(this)
                        //.addOnConnectionFailedListener(this)
                .build();
        mGoogleApiClient.connect();
    }
}

@Override
public void onConnected(Bundle bundle) {
    mLocationRequest = LocationRequest.create();
    mLocationRequest.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);
    mLocationRequest.setInterval(1000 * 60);

    LocationServices.FusedLocationApi.requestLocationUpdates(mGoogleApiClient, mLocationRequest, this);
}

@Override
public void onConnectionSuspended(int i) {

}

public static Location getLocation(){
    return lastLocation;
}

@Override
public void onLocationChanged(Location location) {
    dLog.d(""loc.txt"",location.toString());
    lastLocation = location;
}
</code></pre>

<p>}</p>",android|location|battery,3864483,user3864483,yes
How to determine iPhone is being used/unlocked,"<p>I am facing one of the requirements where I need to detect if the user is using the iPhone or not. Even if my app is in background then also. So far I've found the following way outs, but none of them points to the unlocking mechanism: </p>

<ol>
<li><p><strong><code>applicationProtectedDataWillBecomeUnavailable</code></strong>: This will tell if the user has locked/unlocked the device but will work only If a passcode is set.</p></li>
<li><p><strong>Darwin lock/unlock notifications</strong>: Not accepted on AppStore.</p></li>
<li><p><strong>Proximity Sensor (<code>UIDeviceProximityStateDidChangeNotification</code>)</strong>: This will only happen if the user is calling.</p></li>
<li><p><code>[[UIScreen mainScreen] brightness]</code>: Can be queried during <code>applicationDidEnterBackground</code> state to check whether phone was locked or home button was pressed. If brightness is greater than 0, it indicates home button was pressed or there was a transition to some other app, when it is 0, it means locked.</p></li>
<li><p>Using motion sensors: Given the battery drainage, a fairly incorrect approach to check what's the roll of the device or acceleration in a certain coordinate system</p></li>
<li><p><code>UIDeviceOrientationDidChangeNotification</code>: only works when app is in foreground.</p></li>
<li><p>What's the technology behind apple's ""pick up to wake"" implementation: I have seen that iPhone6s brightens the screen when you pick it up. They must be using a more efficient way than accelerometer?</p></li>
</ol>

<p>I don't see any other good approaches. Did I miss something?</p>",ios|objective-c|iphone|darwin,1364053,nr5,yes
Sensor Background Service wakelock,"<p>I am working on an app that runs a background services which reads accelerometer (and also sometimes, gyroscope) data in the background continuously. I use partial wake lock but there's battery drain. Is there any way I can reduce or minimize the battery drain? I've seen services like Skype and Whatsapp run in the background and consume very little battery, how do they achieve low battery usage?</p>",android|sensors|battery|wakelock|android-wake-lock,3573421,user3573421,yes
notify the date change,"<p>I am new to the blackberry development. My requirement is like I want to execute specific task on 8 a.m. every day. For this I tried Timer class to schedule task on 8 am. But the problem is  if I change my device time, the timer stops working from that moment. So I moved to RealtimeClockListener but user had bad experience with the battery drain problem.</p>

<p>I am just trying to work out with the efficient solution but no luck I am totally strucked here. </p>

<p>Can anybody please help me in this regard. I want to implement a task which will execute on 8 am everyday..</p>

<p>Please help me....</p>

<p>Thanking you in advance..</p>",blackberry,824206,Amol Benare,yes
iPhone 4 profile power consumption (with instruments),"<p>I have an app that I added <strong>a lot of animation</strong> to. The app also used ""iPhone sleep preventer"" to play silent audio. Since then, I noticed that <strong>the battery consumption increased by up to 4 times!</strong> I'd like to find a method to profile the power consumption (I think I saw an option in Instruments) to find and eliminate the offending method(s). </p>

<p>Where would I start looking for information like this? Currently I have the phone left on the desk for ~3 hours to record power drain over time. Is there a better method to predict when the app will run out of power if running my app continuously?</p>

<p>An extra side question: are the % of battery left displayed in the status bar linear or is there some non-linearity towards the end of the battery life?</p>

<p>Edit: <strong>I found a ""power"" preset in xcode>product>profile>CPU>Energy diagnostics.</strong> It doesn't seem to work perfectly, as the power consumption level is always 0/20. But it does tell me how much of the CPU time is spent on <strong>app foreground, graphics and music!</strong></p>

<p>Now I dont know how the CPU power is managed, is running the CPU at 75% more power consuming than lets say 30%? Intuitively it feels like it should...</p>

<p>Thank you!</p>",iphone|ios|profiling|instruments,967484,Alex Stone,yes
Scheduling recurring task in Android,"<p>I'm designing an app that has a recurring task of sending presence to a dedicated server as long as the app is in foreground.</p>

<p>In my searches across the web I saw a few different approaches and wanted to know what is the best way of doing this.</p>

<p><strong>What is the best way to schedule a server call?</strong></p>

<p>The options I saw were:</p>

<ol>
<li><p><a href=""http://developer.android.com/reference/java/util/Timer.html"" rel=""noreferrer"">Timer </a>.</p></li>
<li><p><a href=""http://developer.android.com/reference/java/util/concurrent/ScheduledThreadPoolExecutor.html"" rel=""noreferrer"">ScheduledThreadPoolExecutor</a>.</p></li>
<li><p><a href=""http://developer.android.com/reference/android/app/Service.html"" rel=""noreferrer"">Service</a>.</p></li>
<li><p>BroadcastReciever with <a href=""http://developer.android.com/reference/android/app/AlarmManager.html"" rel=""noreferrer"">AlarmManager</a>.</p></li>
</ol>

<p>What's your opinion?</p>

<p><strong>EDIT:</strong>  <br/>The reason I need this is for a chat based app that sends all the user actions to a remote server. <br/>i.e. user is typing a message, user is reading a message, user is online, user is offline etc.</p>

<p>This means that once every interval, I need to send the server what I'm doing, since I open a chat room with other people, they need to know what I'm doing.</p>

<p>Similar to the whatsapp message feedback mechanism:
<img src=""https://i.stack.imgur.com/xU5Ki.png"" alt=""message looks delivered""></p>

<p><strong>EDIT #2:</strong>  <br/>
Recurring tasks should now be scheduled almost always via the <code>JobScheduler</code> API (or <a href=""https://github.com/firebase/firebase-jobdispatcher-android"" rel=""noreferrer""><code>FirebaseJobDispatcher</code></a> for lower APIs) in order to prevent battery draining issues as can be read in the <a href=""https://developer.android.com/topic/performance/vitals/wakeup.html"" rel=""noreferrer"">vitals section</a> of the Android training</p>

<p><strong>EDIT #3:</strong>  <br/>
FirebaseJobDispatcher has been deprecated and replaced by <a href=""https://developer.android.com/topic/libraries/architecture/workmanager"" rel=""noreferrer"">Workmanager</a>, which also incorporates features of JobScheduler. </p>",android|scheduled-tasks,1056359,thepoosh,no
iPhone 4 augmented reality with iOS5 which sensors to use?,"<p>I'm thinking of creating an augmented reality game using gps, camera and iPhone sensors. The main objective of the game is to be able to walk around billboards placed according to their gps coordinates. The player must be able to walk around the augmented reality billboard, which may be within 30-50 feet of the user. The game is played outdoors</p>

<p>I'm trying to understand what are the optimal sensors that I need to use to calculate the position and orientation in space.</p>

<p>Is it accelerometer +gyroscope within some
Reference frame, along with a core location from gps? Or is doing so redundant?</p>

<p>Alternatively, it would be nice to know if I can even hope to achieve enough accuracy to be able to walk around points</p>

<p>Update: I found this app: QuickDistance, which uses known eye level height to estimate distance to an object at the user's feet. Something tells me that the same concept can be used to more precisely find the local position of the user to improve GPS accuracy by finding the distance to known points. I'm not sure if there are any open source pedometer/distance calculators that use accelerometer, I'd love to know the kind of accuracy that can be obtained from those. </p>

<p>If All I can expect is a 56 feet accuracy outdoors, this means that my billboards would have to be huge. </p>

<p>PS. I Also noticed an incredible battery drain while using metaio SDK for AR, I'm not sure if what I'm describing is even feasible from the battery life point of view - running accelerometer, gyroscope, magnetometer and receiving constant GPS updates may kill the battery very fast. This is another reason why I want to understand how to keep track of the location with minimum number of sensors involved. </p>",iphone|objective-c|ios,967484,Alex Stone,yes
How is Android GenieWidget updated?,"<p>The Android GenieWidget (also known as News &amp; Weather Widget) updates very often (every few seconds). Now the time interval for updating a widget can currently not be shorter than half an hour. It is possible to create a service or use AlarmManager that updates it more often, but this is discouraged because of the drain of system resources. </p>

<p>I am considering making a similar application. My question is, how is it (probably) done in GenieWidget? Is it some clever trick, or does it just update more frequently (and is therefore battery drainer)? That would be weird since it is Google application and one expects some quality there.</p>",android|widget,999198,comodoro,yes
Storybook webpack repeatedly rebuilding (hot reloading over and over?),"<p>I am using Storybook for a NextJS project and when I run it, it keeps rebuilding over and over and never stops. My CPU goes crazy and it drains my battery. After the build finishes, it immediately starts rebuilding. It's like it is hot reloading over and over.</p>
<pre><code>webpack building...
webpack built preview 4f726ddcef7523fb95db in 20394ms
webpack building...
webpack built preview 4f726ddcef7523fb95db in 8835ms
webpack building...
webpack built preview 4f726ddcef7523fb95db in 8763ms
webpack building...
webpack built preview 4f726ddcef7523fb95db in 7692ms
webpack building...
webpack built preview 4f726ddcef7523fb95db in 10166ms
webpack building...
webpack built preview 4f726ddcef7523fb95db in 8239ms
webpack building...
webpack built preview 4f726ddcef7523fb95db in 8956ms
webpack building...
webpack built preview 4f726ddcef7523fb95db in 7353ms
webpack building...
</code></pre>
<p>My <code>main.js</code></p>
<pre><code>const path = require('path');

module.exports = {
  stories: ['../**/*.stories.mdx', '../**/*.stories.@(js|jsx|ts|tsx)'],
  addons: ['@storybook/addon-links', '@storybook/addon-essentials'],
  presets: [path.resolve(__dirname, './next-preset.js')],
};
</code></pre>
<p>My <code>next-preset.js</code></p>
<pre><code>const path = require('path');

module.exports = {
  webpackFinal: async (baseConfig, options) =&gt; {
    // Modify or replace config. Mutating the original reference object can cause unexpected bugs.
    const { module = {} } = baseConfig;

    const newConfig = {
      ...baseConfig,
      module: {
        ...module,
        rules: [...(module.rules || [])],
      },
    };

    // Absolute imports
    newConfig.resolve.modules.push(path.resolve(__dirname, '../'));

    // TypeScript with Next.js
    newConfig.module.rules.push({
      test: /\.(ts|tsx)$/,
      include: [path.resolve(__dirname, '../')],
      use: [
        {
          loader: 'babel-loader',
          options: {
            presets: ['next/babel'],
            plugins: ['react-docgen'],
          },
        },
      ],
    });
    newConfig.resolve.extensions.push('.ts', '.tsx');

    // Less
    // Remove original less loader
    newConfig.module.rules = baseConfig.module.rules.filter(
      (f) =&gt; f.test.toString() !== '/\\.less$/'
    );
    newConfig.module.rules.push({
      test: /\.less$/,
      include: [
        // Include antd to rebuild
        /[\\/]node_modules[\\/].*antd/,
        path.resolve(__dirname, '../'),
      ],
      use: [
        'style-loader',
        'css-loader',
        {
          loader: 'less-loader',
          options: {
            javascriptEnabled: true,
          },
        },
      ],
    });

    //
    // CSS Modules
    // Many thanks to https://github.com/storybookjs/storybook/issues/6055#issuecomment-521046352
    //

    // First we prevent webpack from using Storybook CSS rules to process CSS modules
    newConfig.module.rules.find(
      (rule) =&gt; rule.test.toString() === '/\\.css$/'
    ).exclude = /\.module\.css$/;

    // Then we tell webpack what to do with CSS modules
    newConfig.module.rules.push({
      test: /\.module\.css$/,
      include: [path.resolve(__dirname, '../')],
      use: [
        'style-loader',
        {
          loader: 'css-loader',
          options: {
            importLoaders: 1,
            modules: true,
          },
        },
      ],
    });

    newConfig.resolve.alias['/images'] = path.resolve(
      __dirname,
      '../public/images'
    );

    return newConfig;
  },
};
</code></pre>
<p>My <code>preview.js</code></p>
<pre><code>import React from 'react';
import { RouterContext } from 'next/dist/next-server/lib/router-context';
import * as NextImage from 'next/image';

require('../src/assets/styles/antd.less');

export const parameters = {
  actions: { argTypesRegex: '^on[A-Z].*' },
};

export const decorators = [
  (Story) =&gt; (
    &lt;RouterContext.Provider
      value={{
        push: () =&gt; Promise.resolve(),
        replace: () =&gt; Promise.resolve(),
        prefetch: () =&gt; Promise.resolve(),
      }}
    &gt;
      &lt;Story /&gt;
    &lt;/RouterContext.Provider&gt;
  ),
];

Object.defineProperty(NextImage, 'default', {
  configurable: true,
  value: (props) =&gt; {
    const height = props.height;
    const width = props.width;
    const quotient = height / width;
    const paddingTop = isNaN(quotient) ? '100%' : `${quotient * 100}%`;
    let wrapperStyle;
    let sizerStyle;
    let sizerSvg;
    let toBase64;
    let imgStyle = {
      position: 'absolute',
      top: 0,
      left: 0,
      bottom: 0,
      right: 0,
      boxSizing: 'border-box',
      padding: 0,
      border: 'none',
      margin: 'auto',
      display: 'block',
      width: 0,
      height: 0,
      minWidth: '100%',
      maxWidth: '100%',
      minHeight: '100%',
      maxHeight: '100%',
      objectFit: props.objectFit ? props.objectFit : undefined,
      objectPosition: props.objectPosition ? props.objectPosition : undefined,
    };

    if (
      width !== undefined &amp;&amp;
      height !== undefined &amp;&amp;
      props.layout !== 'fill'
    ) {
      if (props.layout === 'responsive') {
        wrapperStyle = {
          display: 'block',
          overflow: 'hidden',
          position: 'relative',
          boxSizing: 'border-box',
          margin: 0,
        };
        sizerStyle = {
          display: 'block',
          boxSizing: 'border-box',
          paddingTop,
        };
      } else if (props.layout === 'intrinsic' || props.layout === undefined) {
        wrapperStyle = {
          display: 'inline-block',
          maxWidth: '100%',
          overflow: 'hidden',
          position: 'relative',
          boxSizing: 'border-box',
          margin: 0,
        };
        sizerStyle = {
          boxSizing: 'border-box',
          display: 'block',
          maxWidth: '100%',
        };
        sizerSvg = `&lt;svg width=&quot;${width}&quot; height=&quot;${height}&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; version=&quot;1.1&quot;/&gt;`;
        toBase64 = Buffer.from(sizerSvg).toString('base64');
      } else if (props.layout === 'fixed') {
        wrapperStyle = {
          overflow: 'hidden',
          boxSizing: 'border-box',
          display: 'inline-block',
          position: 'relative',
          width,
          height,
        };
      }
    } else if (
      width === undefined &amp;&amp;
      height === undefined &amp;&amp;
      props.layout === 'fill'
    ) {
      wrapperStyle = {
        display: 'block',
        overflow: 'hidden',
        position: 'absolute',
        top: 0,
        left: 0,
        bottom: 0,
        right: 0,
        boxSizing: 'border-box',
        margin: 0,
      };
    } else {
      throw new Error(
        `Image with src &quot;${props.src}&quot; must use &quot;width&quot; and &quot;height&quot; properties or &quot;layout='fill'&quot; property.`
      );
    }

    return (
      &lt;div style={wrapperStyle}&gt;
        {sizerStyle ? (
          &lt;div style={sizerStyle}&gt;
            {sizerSvg ? (
              &lt;img
                style={{ maxWidth: '100%', display: 'block' }}
                alt={props.alt}
                aria-hidden={true}
                role='presentation'
                src={`data:image/svg+xml;base64,${toBase64}`}
              /&gt;
            ) : null}
          &lt;/div&gt;
        ) : null}
        &lt;img {...props} decoding='async' style={imgStyle} /&gt;
      &lt;/div&gt;
    );
  },
});
</code></pre>
<p>I have no idea what to do here. Any help would be greatly appreciated!</p>",javascript|reactjs|webpack|next.js|storybook,3842480,gdvander,yes
How to debug the background behaviour of an application?,"<p>I get this behavior for my app in Settings->Battery:</p>

<pre><code>CPU Total : 9m30s
CPU foreground : 23s
Keep awake : 0s
Wi-Fi running : 4s
...
Computed power used : 60mAh
</code></pre>

<p>I see the battery draining and the phone heating up. So clearly my app is doing something there. But what?</p>

<p>My general question is how to debug (best practice, tools) what my application is really doing?</p>

<p>Regarding this specific case, I will add that the app uses the AlarmManager:</p>

<pre><code>AlarmManager alarmManager = (AlarmManager)context.getSystemService(Context.ALARM_SERVICE);
alarmManager.setInexactRepeating(AlarmManager.ELAPSED_REALTIME, 0, ONE_HOUR_MS, pendingIntent);
</code></pre>

<p>I have tried to fire up traceview on a debug version of the app, but the thread waken up by the AlarmManager is quickly finished and no other thread that belongs to the app process is doing any work.</p>",android|debugging|background|alarmmanager|battery,1855855,Adi B,yes
"Battery drain rate,for server calls in regular intervals","<p>Hi iam currently working on a hotel notifier android application.Which gives the users a listview of hotels around them.It updates this list and notifies them whenever a new hotel is around them.The app should notify the user in the status bar with the name of the hotels when the user reaches near to these hotels.
Please tell me how can i implement this technique.
Can I use something like checking whether the users current location is near to the location of the hotels whose details are stored in a table called ""hotels"" within certain intervals(say every 5 minutes it checks whether any new hotel is around user's location if found it would notify the user in the status bar.
But does this process drain out a lot of battery....?
If yes ,then some one could please suggest me some other method.
any help would be apprciable</p>",android|performance|push-notification,3781907,user3781907,no
Run service every 30 minutes without using wakelocks,"<blockquote>
  <p><strong>tl;dr:</strong> my app doesn't update my <code>SharedPreferences</code> with the last value from the server because sometimes the phone is sleeping.</p>
</blockquote>

<h1>Explanation:</h1>

<p>I'm new in this android world, and I've been working on my first ""real"" application but I'm having a few issues right know...</p>

<h2>Here's how I need my application to work:</h2>

<blockquote>
  <ul>
  <li>Check every 30 minutes for new data (data is pulled from a json file on my server)</li>
  <li>If the data is different from the stored on the phone, then store the new data and send a notification to the user. (I'm using <strong><code>SharedPreferences</code></strong> for the ""storage"")</li>
  </ul>
</blockquote>

<h2>Here's what I used to try to achieve that:</h2>

<blockquote>
  <ul>
  <li><p><code>MainActivity.java</code> / <strong>Activity</strong> (my main activity, duh')</p></li>
  <li><p><code>cargarJson.java</code> / <strong>AsyncTask</strong> (a class that pulls json data and returns a jsonobject). Cargar = Load (in spanish)</p></li>
  <li><p><code>DolarService.java</code> / <strong>IntentService</strong> (The service creates a loadJson object and execute it, then sends the notification).</p></li>
  <li><p><code>AlarmReceiver.java</code> / <strong>BroadcastReceiver</strong> (It's a receiver that has an <code>AlarmManager</code> that executes my <strong><em><code>DolarService</code></em></strong> every 30 minutes and runs everytime the phone boot up and when the user runs the app for the first time).</p></li>
  </ul>
</blockquote>

<p>I kind of managed to do it, but the problem is that I don't want to use wakelocks because it drains the battery really fast.</p>

<p>My <code>AlarmManager</code> doesn't use wakelocks so when it sends the notification every 30 minutes it contains the last value stored in the SharedPreferences when the phone was ""awake"" and not the new data from the server.</p>

<p><strong>Here's my source:</strong>
<a href=""https://gist.github.com/anonymous/d5cccf5ba331f041630e"" rel=""nofollow"">https://gist.github.com/anonymous/d5cccf5ba331f041630e</a></p>

<p><strong>My question:</strong> how do I keep my up-to-date data in my <code>SharedPreferences</code> (updating it every 30 minutes) without using wakelocks. Also, is something wrong with my approach to do this app ?</p>

<p><em>Thank you in advance and sorry for my poor english, I tried my best to explain my situation!</em></p>",java|android|json,922155,kustomrtr,no
android sensor event slows down when device screen is off for a while,"<p>I'm trying to collect accelerometer values at 50ms period and do something with collected values at every 1 minute. So i used alarm manager with 1 minute pending intent with RTC_WAKEUP flag and set sensor event to 50ms. It first seemed that sensor event was called well with exact time period and collected 1150~1210 accelerometer values at every one minute passed even when my device screen is off, but when i unplugged my device from computer and turn screen power off, it started to become slower, at the end it collected only 60~100 samples at every 1 minute.
So i currently acquire Wakelock whole time and replaced alarm manager with timer to do timer taske at every 1 minute. But i'm worried of drain of my battery.</p>

<p>So what i wanna ask you are below""</p>

<p>1) Is device awake when device is plugged to computer or recharger?</p>

<p>2) What method would be better for battery life? Using alarm maganer to acquire wakelock every 2 second to stay device awake and do something when it reaches 1 minute? Or using current method of acquiring Wakelock for whole time to make device alive and use timer to do something every 1 minute?</p>",android|alarmmanager|android-sensors|android-wake-lock,4217483,강신욱,no
Synchronizing message processing between multiple servers and threads,"<p>Sorry for the long read. Technical info: Windows environment, MSMQ, .NET Framework</p>
<p>I have many mobile devices sending data to my server about events that happened on that device. Events are sent to my servers (multiple receiving servers, one DB) in the order they happened and on the server are sent to a centralized message queue.
I have multiple servers each running a multi-threaded windows service that each thread pulls each time a message from the queue, processes it and saves it to the DB.</p>
<p>Usually the mobile devices are online and as events happen once every few minutes everything is saved in order to the DB as the servers have enough time to process the message before the next one from the same device arrives. but sometimes a device could be offline for a while and when it comes back online, it sends a few messages rapidly to the server (the simplest example is that the queue will now have messages #1 and #2 at the same time for this device - in the queue they are in order). Then two servers each pull a message from the queue and because of server load or thread speed message #2 could be saved to the DB before #1 is saved.</p>
<p>I tried solving this by implementing some kind of locking on the mobile device side so that it will acquire a “lock” from the server before sending message #1, then the lock is released after the server processes message #1 or the lock is released after a long timeout (if the message got lost somewhere) and then the device can acquire a lock to send message #2. It works but since the device is unaware of the processing time that it will take for #1 to be saved, it either has to poll the server a lot (which is ineffective and will drain the battery) or it tries to acquire a lock every 1-2 minutes which makes sending logged messages from the device really slow (the server could process it in 2 seconds so the device is just sitting idle for too long not sending the next message). More over, this requires the device to be online for longer as it sends messages to the server one by one.</p>
<p>I want to explore another option which is allowing the device to send all its data without acquiring a lock, thus releasing the mobile device online requirement as fast as possible. Incoming messages will be put into a message queue and then I need some solution on how to process them in a multi-server, multi-threaded environment, making sure messages are processed in the order they arrived per mobile device and as fast as possible.
I thought about a single dispatcher thread reading from the incoming message queue and splitting the messages up into multiple queues - one for each server I have. The split will be based on the device that sent the message, so messages from the same device will be sent to the same queue (they still remain in order).
Then on each server have one thread read from the server specific incoming queue and put the incoming messages in internal queues - one for each thread processing messages - messages from the same mobile device will be in the same internal queue. Then have the multiple threads read each from its own queue.</p>
<p>Any thoughts on a better design?</p>
<p>Thanks</p>",.net|multithreading,512612,Dani Avni,yes
Battery drain issues with Android GPS recording service,"<p>My service records the location of the user and sends it to Firebase every X minutes.  I have tried changing X from 1 minute to 5 minutes, however the change in battery drain was less than 1 percent.  In both cases it works out at about 5% used by the app every 3 hours.</p>

<p>I am trying to understand how increasing the GPS interval by 500% had little or no impact on the battery life.  Not only is the GPS firing 1/5 of the time, but there is also 1/5 of the data being sent/received to Firebase. </p>

<p>When the watching location is turned off, battery drain is 0.</p>

<p>Any ideas as to what is causing the drain?  Also, what kind of battery drain should I be looking at for getting a GPS location every 5 mins and sending about 50 bytes of data with it?</p>",android|gps|firebase|battery,3757721,Marty.H,yes
"In Android, is there a way to reduce battery drain while using GPS?","<p>In our app, we are taking latitude and longitude every 5 seconds from the GPS to improve the location accuracy. In our app, we have to draw a line as per the user's movement. But we are facing the battery drain problem. Is there any way to reduce battery drain? Every time the location service shows that our app uses high battery. Please suggest some working solution.</p>",android|gps|batterymanager,5397170,Anand Shunmugadurai,yes
Android what is the best way to auto-connect to ble device,"<p>I'm currently trying to make an Android app that will have some interaction with a BLE device. That device doesn't have the Ibeacon protocol. </p>

<p>What I want to do is auto connect to that device every time it is in range even (and almost 99% of the time) when the app is not in foreground. The only thing I know is that it is a BLE device, I have access to it name and address (00:1E:C0:29:BD:F8). </p>

<p>It is crucial tha the app connect to it every time it come in range. Even if the phone is lock it must connect no matter what (except if the phone is shut down XD). But as soon as the phone has booted and that bluetooth is activated, I must be sure that my app will be able to connect to tha device if it come in range.</p>

<p>I wanted to know what is the best way to do so. </p>

<p>The only way I can think of is to start a service as sticky, that will scan every 15 seconds (or something similar) for the device it already has registered to auto-connect. </p>

<p>The downfall of that method I guess is that it will surely drain the battery, I'm not sure about that but doing a scan for 3 to 4 second every 15 second must use up a lot of battery.</p>

<p>What do you guys think of that ?
Does anybody know a better solution I could use ?</p>

<p>Thank in advance for the help.</p>",android|service|bluetooth|bluetooth-lowenergy,2177335,Incognito,yes
Getting GPS location Consumes battery,"<p>I am working on a android project where i have to get the current location of the user for every 2 minutes and the code we are using is </p>

<pre><code>try {
                DpGPSEnabled = DpLocationManager.isProviderEnabled(LocationManager.GPS_PROVIDER);
                DpNetworkEnabled = DpLocationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER);
                if (DpIsGpsProvider &amp;&amp; DpGPSEnabled) {
                    DpLocationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER,DpMIN_TIME_BW_UPDATES,DpMIN_DISTANCE_CHANGE_FOR_UPDATES,DpLocationListener);
                } else if (!DpGPSEnabled) {
                    DpLocationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER,DpMIN_TIME_BW_UPDATES,DpMIN_DISTANCE_CHANGE_FOR_UPDATES,DpLocationListener);
                    DpGenUtil.setLocationPostion(DpLocationManager.getLastKnownLocation(LocationManager.NETWORK_PROVIDER));
                }
                if (DpGPSEnabled &amp;&amp; DpNetworkEnabled) {
                    DgProvider = ""GPS+Network"";
                } else if (DpNetworkEnabled) {
                    DgProvider = ""Network"";
                } else if (DpGPSEnabled) {
                    DgProvider = ""GPS"";
                } else {
                    DgProvider = ""Not Selected"";
                }

            } catch (Exception ex) {

            }
</code></pre>

<p>where DpMIN_TIME_BW_UPDATES =1000*60*2; 2 minutes
and DpMIN_DISTANCE_CHANGE_FOR_UPDATES = 200; in meters </p>

<p>the problem is we are able to get the locations properly , but battery started to drain faster , is there any other method we can get the location and it will not consume much battery also.</p>",android|gps|battery,3278190,sunilkarkala,yes
"How to fix ""Android Studio recent project list goes empty and want to retrieve back""","<p>Because of the battery drain. My laptop is suddenly shutdown and as I have restarted and start Android studio I cannot see any recent project list on the start screen. Android studio start screen looks as I have started android studio for the first time. I have almost more than 150+ project list in the recent project. (List of 4+ years of the android project) </p>

<p>Can someone help me to retrieve this list?</p>

<p>I have already checked ""recentProjects.xml"" file from this location ""\Users\Username.AndroidStudio3.4\config\options\"" but I have found ""recentProjects.xml"" file with the empty list.</p>",android|android-studio|intellij-idea,1151312,a4ankur,yes
Does the bluetooth socket in any way influence the WiFi socket?,"<p>I have a bluetooth logic that tries to connect to BT hardware nonstop. One <code>socket.connect()</code> takes about 3 seconds and once it returns unsuccessful, a new one is started.</p>

<p>While it is trying to connect on many devices no WiFi connection can be established. Once the BT connection stands, WiFi works as usual. It doesnt matter what app wants wifi, it just wont get it for as long as my app is machine-gunning the socket.connects() (just one at a time, but nearly zero delay between them)</p>

<p>I believe that somewhere i read something about a shared ""socket"" or something in the hardware. I would like to know if that is true.</p>

<p>Can i attempt to connect a bt socket (in a nonstop fashion) AND have WiFi operating at the same time ?</p>

<p><strong>Edit, regarding battery life:</strong></p>

<p>24h running this routine is barely noticeable where as simply having wifi activited for 24h really drains the battery... so would having a 24h bt connection, but if its wanted then thats what it costs. It's up to the user.</p>",android|bluetooth,1092271,NikkyD,yes
Is it possible for a website to heat up a android Device and cause faster battery draining?,"<p>I am developing a website which is a Single Page Application (built on AngularJS).</p>

<p>However, my client complains that using the website is causing user devices to heat up and drains the battery faster.</p>

<p>Technologies used for the development.</p>

<p>For back-end 
- PHP / Codeigniter</p>

<p>For front-end
 - Angular JS</p>

<p>I have a lot of codes written in native Javascript too.</p>

<p>Is it possible for a website to cause these issues? If yes, how can I solve this?</p>",javascript|angularjs|performance,4460325,Junaid Qureshi,yes
Is it a good approach to update the view in a scheduled timer or is it better to use OpenGL,"<p>I want some views bounce back at the edge of the screen. Therefore i already implemented a viewcontroller and some subviews for the bouncing. Its already known, when the view reaches the edge, all the Framecomparsion methods and exit angle methods are already known. But what is the best way for updating the views position. In the future, the rectangles should also bounce, when they reach eachother.</p>

<p>I tried to use +[UIView animation..] methods and it pretty much worked but the viewlayer position calculation was pretty hard to handle because its a timing calculation, when a view reaches the edge of the screen.</p>

<p>Than I tried to update the screen with a scheduled timer just like this:
[NSTimer scheduledTimerWithTimeInterval:1/30 target:self selector:@selector(render) userInfo:nil repeats:YES]; //30 fps if possible b
But i just don't know if its a good approach for this, because I think, the battery gets drained too much, right?</p>

<p>Didn't get to learn OpenGL so far, but i might be pretty close, am i right?</p>

<p>What do you think, is the best way to solve this problem? If OpenGl is the best approach, is there a good tutorial you could suggest (i know, there are many, goolge is my friend, but i'd like to know from you).</p>",ios|animation|uiview|opengl-es,682166,NicTesla,no
Problem with Calendar.get(Calendar.HOUR),"<p>I am trying to display in a TextView when my application last updated (e.g., ""Last updated at 12:13). I am trying to use a Calendar instance and I thought I understood it correctly but I seem to be having trouble. I know to get an instance I use the method Calendar.getInstance(). And then to get the hour and minute I was using Calendar.get(Calendar.HOUR) and Calendar.get(Calendar.MINUTE). My minute field returns correctly but Calendar.HOUR is returning the hour on a 24 hour clock and I want a 12 hour clock. I thought HOUR_OF_DAY was 24 hour clock. Where am I going wrong?</p>

<p>Here is the code I'm using:</p>

<pre><code>Calendar rightNow = Calendar.getInstance();
mTv.setText(""Refreshed! Last updated "" + 
           rightNow.get(Calendar.HOUR) + "":"" + 
           rightNow.get(Calendar.MINUTE) + ""."");
</code></pre>

<p>mTv is my TextView that I'm updating. Thanks for any help.</p>

<p>Also, it would be ideal if I could say ""Last updated 5 minutes ago."" instead of ""Last updated at 12:13pm"". But I'm not sure the best way to have this update each minute without draining resources or the battery...?</p>",android|calendar|android-calendar,838209,Jon Rubins,no
Android requestWait of usb serial is not blocking for FT232R device,"<p>I am currently using:
Device Name: FT232R device.
Device Serial Number: A104WOUG.
Device Description: FT232R USB UART.
Device ID: 04036001.
Device Location: 41d1.</p>

<p>for an Android device configured with OTG-USBS. Everything works fine.
Recently, I observed that when the cable is long connected with the Android device,
it drains the battery of Android.</p>

<p>After an investigation, I found that the blocking function
requestWait() in  android.hardware.usb.UsbDeviceConnection
is not blocking (I have tested with other brand, i.e. Prolific, it is blocking function).</p>

<p>I would like to know which parameters should I need to set in order to let the function requestWait a blocking function.</p>

<p>Thanks.</p>",android|usbserial|usb-otg,8645954,Jacky Lam,no
Reliability of the Activity Lifecycle (onPause to onDestory),"<p>After years of trusting the lifecycle, i did a little digging.
Now i am not amused.</p>

<p>I know and read a lot about that <code>onStop</code> is not guaranteed to be called etc.</p>

<p>I created a simple App with 2 Activites and a custom Application class. I put a Log.d() in every callback that i could find and played around on a Galaxy S2 with 4.1 on it.
Activity A launches on start and in its <code>onResume</code> it starts Activity B. Activity B has a Button that creates a Nullpointer but otherwise it is doing nothing.</p>

<p>Now the things that worry/confuse me:</p>

<ul>
<li><p>if i create a nullpointer on buttonclick, the app crashes and NO callback happens in neither activity</p></li>
<li><p>if i hit the powerbutton and turn off the screen, the activity will be restarted if the display mode (portrait or landscape) of the activity doesnt match the native orientation of the device. I do know that and how i could override it but IF it destroys and restarts my activity it calls <code>onPause</code> and <code>isFinishing()</code> returns false but the activity is being finished and restarted.</p></li>
<li><p>if above does not happen, only <code>onPause</code> is being called even though the app is no longer visible</p></li>
<li><p>starting another activity calls <code>onPause</code> in A, then creates B to <code>onResume</code> and then calls <code>onStop</code> of A. Now i am tracking my activites in the .App class and if i unregister A in <code>onPause</code> and register B in <code>onResume</code>, there will be a split millisecond where no activity is registered. If i wanted to shut down some service when no activity is there, it would happen all the time. But if i unregister it in <code>onStop</code> (so they would overlap) it would never be unregistered when the user hits the powerbutton and the service (or thread or whatever) keeps running and draining battery power.</p></li>
</ul>

<p>I am working with android for quite some time now and i am trying to achieve a rather complex or lets say bulletproof design. But its almost impossible to keep track of what is happening to my activities. </p>

<ul>
<li><p>powerdown has to be detected via Intent.ACTION_SCREEN_OFF but that happens when its already off. The only thing before that would be onPause.</p></li>
<li><p>homebutton... some combination of onUserInteraction and pause/stop</p></li>
</ul>

<p>Its really hard to simply determine when my APP (not just one activity) is no longer being used and put in the background and when its just transitioning between activites or when its being shut down by the system. Because the .App class has NO callback for termination as <code>onTerminate()</code> is only used in emulator, so the docs say.</p>

<p>Maybe im just not seeing the forest through the trees...
help would be appreciated!</p>",android|lifecycle,1092271,NikkyD,yes
Why isn't the .plist pointing to my .ipa completing?,"<p>I know about other 3rd parties but I'm trying to do Ad Hoc OTA using Dropbox. 
99% of the material available is out of date, for iOS4 and pre-dates Xcode 5</p>

<p>After sifting it all this works for me up to a point: I get to download on another device from Dropbox but only partially. But the process continually re-starts halfway through and never completes.</p>

<pre><code>// an email link to ..
// a regular html file on my website using the following:
&lt;a href=""https://www.dropbox.com/s/(my_DB_link)/ipa.html""&gt;Tap Here&lt;/a&gt;

// the .html file above points to another file on DropBox's servers,
// which is another .html file pointing to the .plist manifest
&lt;a href=""itms-services://?action=download-manifest&amp;url=https://dl.dropboxusercontent.com/s/(my_plist_link)/myApp.plist""&gt;Your Beta, Sir&lt;/a&gt;

// line 14 in the .plist points back to my website
&lt;string&gt;http://www.example.com.au/apps/myApp.ipa&lt;/string&gt;
</code></pre>

<p>I'm using the .plist generated by Xcode, all the places below suggest editing their example, but none worked to get get me thus far
I tried just linking from an email to my .plist pointing to my.ipa in dropbox. Nope. Not in a million years.</p>

<p>Has anyone done it successfully from scratch since October 2013 ?</p>

<p>that's my question, but some background notes:
the reason for the fancy dance is that I learned that iOS7 expects the .ipa to be served up under HTTPS: I didn't feel like spending a week learning network coding. So I'm using Dropbox to fool itms-services for a trusted certificate.</p>

<p>yes the device is on my provisioning file,and its a distribution profile, not a development profile</p>

<p>one with the latest date
<a href=""http://digitalpublishing.tumblr.com/post/29479304378/installing-your-developer-app-over-the-air-without"" rel=""nofollow noreferrer"">http://digitalpublishing.tumblr.com/post/29479304378/installing-your-developer-app-over-the-air-without</a></p>

<p>2hrs with this link didnt produce a solution, but worth it for other things that can go wrong 
<a href=""https://stackoverflow.com/questions/4695180/wireless-iphone-app-distribution-problem-with-itms-services-protocol"">wireless iphone app distribution - problem with itms-services protocol</a></p>

<p>For newcomers here's some links where not to waste your time on the subject, there's other sites but smack of content-theivery.
( they drained my laptop battery nearly twice, I want some value for my hours ). </p>

<p><a href=""http://shinydevelopment.com/blog/over-the-air-ios-provisioning-and-distribution/"" rel=""nofollow noreferrer"">http://shinydevelopment.com/blog/over-the-air-ios-provisioning-and-distribution/</a></p>

<p><a href=""http://iosdevelopertips.com/xcode/distribute-ad-hoc-applications-over-the-air-ota.html"" rel=""nofollow noreferrer"">http://iosdevelopertips.com/xcode/distribute-ad-hoc-applications-over-the-air-ota.html</a></p>

<p><a href=""http://aaronparecki.com/articles/2011/01/21/1/how-to-distribute-your-ios-apps-over-the-air"" rel=""nofollow noreferrer"">http://aaronparecki.com/articles/2011/01/21/1/how-to-distribute-your-ios-apps-over-the-air</a></p>

<p><a href=""http://dr-palaniraja.blogspot.com.au/2011/06/distribute-your-iphoneipad-adhoc-builds.html"" rel=""nofollow noreferrer"">http://dr-palaniraja.blogspot.com.au/2011/06/distribute-your-iphoneipad-adhoc-builds.html</a></p>

<p><a href=""http://www.techaheadcorp.com/blog/iphone/wireless-ad-hoc-distribution.php"" rel=""nofollow noreferrer"">http://www.techaheadcorp.com/blog/iphone/wireless-ad-hoc-distribution.php</a></p>

<p><a href=""http://www.buzztouch.com/forum/thread.php?tid=C170BC9A655DAC18CF67787&amp;currentPage=1"" rel=""nofollow noreferrer"">http://www.buzztouch.com/forum/thread.php?tid=C170BC9A655DAC18CF67787&amp;currentPage=1</a></p>

<p><a href=""http://3qilabs.com/how-to-ad-hoc-distribute-your-ios-app-via-a-website-and-ota/"" rel=""nofollow noreferrer"">http://3qilabs.com/how-to-ad-hoc-distribute-your-ios-app-via-a-website-and-ota/</a></p>",ios|dropbox|ota,1542458,aremvee,no
"iOS GPS Battery drain, how to make it less drain?","<p>My service needs gps. I actually implemented a service, which turns the gps on, checks if the location is valid, and then goes to sleep for some time. (Starting with 5 seconds, and if no movement is detected, it can sleep up to a minute)
After that, I start the gps again, and get a new location.</p>

<p>But the battery drain is still high! Ive used locMgr.distanceFilter = 10.0f and desiredAccurady = NearestTenMeters.</p>

<p>How do I minimize battery drain more?</p>",ios,828450,Mariusz B.,yes
Does anyone have a working example of a GATT HID Keyboard Server using BLUEZ?,"<p>I'm using my Raspbery PI4-b with Raspian Lite distro to write a virtual keyboard using BLUEZ to create a GATT HID (HOGP) Service.</p>
<p>I've taken the GATT sample code for a heart rate monitor service provided by BLUEZ and modified it to add Services and Characteristics to try and make my GATT HID Keyboard Server.</p>
<p>I did the best I could to get my server working but can't quite figure it out. So was wondering if anyone has a working example of this type service I could work from?</p>
<p>I have my server connecting ok to Windows 10 and my Android phone as a ble keyboard peripheral, but neither client will start the report characteristic notify function so i can start sending reports containing key press data.</p>
<p>THANKS!!! In advance for any help.</p>
<p>The code I created from the BLUEZ heart monitor sample:</p>
<pre><code>#!/usr/bin/env python3
# SPDX-License-Identifier: LGPL-2.1-or-later

import time
import dbus, dbus.exceptions
import dbus.mainloop.glib
import dbus.service

import array
try:
  from gi.repository import GObject
except ImportError:
  import gobject as GObject
import sys

from random import randint

mainloop = None
hidService = None

BLUEZ_SERVICE_NAME = 'org.bluez'
GATT_MANAGER_IFACE = 'org.bluez.GattManager1'
DBUS_OM_IFACE =      'org.freedesktop.DBus.ObjectManager'
DBUS_PROP_IFACE =    'org.freedesktop.DBus.Properties'

GATT_SERVICE_IFACE = 'org.bluez.GattService1'
GATT_CHRC_IFACE =    'org.bluez.GattCharacteristic1'
GATT_DESC_IFACE =    'org.bluez.GattDescriptor1'

class InvalidArgsException(dbus.exceptions.DBusException):
    _dbus_error_name = 'org.freedesktop.DBus.Error.InvalidArgs'

class NotSupportedException(dbus.exceptions.DBusException):
    _dbus_error_name = 'org.bluez.Error.NotSupported'

class NotPermittedException(dbus.exceptions.DBusException):
    _dbus_error_name = 'org.bluez.Error.NotPermitted'

class InvalidValueLengthException(dbus.exceptions.DBusException):
    _dbus_error_name = 'org.bluez.Error.InvalidValueLength'

class FailedException(dbus.exceptions.DBusException):
    _dbus_error_name = 'org.bluez.Error.Failed'


class Application(dbus.service.Object):
    &quot;&quot;&quot;
    org.bluez.GattApplication1 interface implementation
    &quot;&quot;&quot;
    def __init__(self, bus):
 
        self.path = '/'
        self.services = []
        dbus.service.Object.__init__(self, bus, self.path)
        
        self.add_service(HIDService(bus, 0))
        self.add_service(DeviceInfoService(bus, 1))
        self.add_service(BatteryService(bus, 2))
        #self.add_service(TestService(bus, 3))

    def get_path(self):
        return dbus.ObjectPath(self.path)

    def add_service(self, service):
        self.services.append(service)

    @dbus.service.method(DBUS_OM_IFACE, out_signature='a{oa{sa{sv}}}')
    def GetManagedObjects(self):
        response = {}
        print('GetManagedObjects')

        for service in self.services:
            response[service.get_path()] = service.get_properties()
            chrcs = service.get_characteristics()
            for chrc in chrcs:
                response[chrc.get_path()] = chrc.get_properties()
                descs = chrc.get_descriptors()
                for desc in descs:
                    response[desc.get_path()] = desc.get_properties()

        return response


class Service(dbus.service.Object):
    &quot;&quot;&quot;
    org.bluez.GattService1 interface implementation
    &quot;&quot;&quot;
    PATH_BASE = '/org/bluez/example/service'

    def __init__(self, bus, index, uuid, primary):
        self.path = self.PATH_BASE + str(index)
        self.bus = bus
        self.uuid = uuid
        self.primary = primary
        self.characteristics = []
        dbus.service.Object.__init__(self, bus, self.path)

    def get_properties(self):
        return {
                GATT_SERVICE_IFACE: {
                        'UUID': self.uuid,
                        'Primary': self.primary,
                        'Characteristics': dbus.Array(
                                self.get_characteristic_paths(),
                                signature='o')
                }
        }

    def get_path(self):
        return dbus.ObjectPath(self.path)

    def add_characteristic(self, characteristic):
        self.characteristics.append(characteristic)

    def get_characteristic_paths(self):
        result = []
        for chrc in self.characteristics:
            result.append(chrc.get_path())
        return result

    def get_characteristics(self):
        return self.characteristics

    @dbus.service.method(DBUS_PROP_IFACE,
                         in_signature='s',
                         out_signature='a{sv}')
    def GetAll(self, interface):
        if interface != GATT_SERVICE_IFACE:
            raise InvalidArgsException()

        return self.get_properties()[GATT_SERVICE_IFACE]


class Characteristic(dbus.service.Object):
    &quot;&quot;&quot;
    org.bluez.GattCharacteristic1 interface implementation
    &quot;&quot;&quot;
    def __init__(self, bus, index, uuid, flags, service):
        self.path = service.path + '/char' + str(index)
        self.bus = bus
        self.uuid = uuid
        self.service = service
        self.flags = flags
        self.descriptors = []
        dbus.service.Object.__init__(self, bus, self.path)

    def get_properties(self):
        return {
                GATT_CHRC_IFACE: {
                        'Service': self.service.get_path(),
                        'UUID': self.uuid,
                        'Flags': self.flags,
                        'Descriptors': dbus.Array(
                                self.get_descriptor_paths(),
                                signature='o')
                }
        }

    def get_path(self):
        return dbus.ObjectPath(self.path)

    def add_descriptor(self, descriptor):
        self.descriptors.append(descriptor)

    def get_descriptor_paths(self):
        result = []
        for desc in self.descriptors:
            result.append(desc.get_path())
        return result

    def get_descriptors(self):
        return self.descriptors

    @dbus.service.method(DBUS_PROP_IFACE,
                         in_signature='s',
                         out_signature='a{sv}')
    def GetAll(self, interface):
        if interface != GATT_CHRC_IFACE:
            raise InvalidArgsException()

        return self.get_properties()[GATT_CHRC_IFACE]

    @dbus.service.method(GATT_CHRC_IFACE,
                        in_signature='a{sv}',
                        out_signature='ay')
    def ReadValue(self, options):
        print('Default ReadValue called, returning error')
        raise NotSupportedException()

    @dbus.service.method(GATT_CHRC_IFACE, in_signature='aya{sv}')
    def WriteValue(self, value, options):
        print('Default WriteValue called, returning error')
        raise NotSupportedException()

    @dbus.service.method(GATT_CHRC_IFACE)
    def StartNotify(self):
        print('Default StartNotify called, returning error')
        raise NotSupportedException()

    @dbus.service.method(GATT_CHRC_IFACE)
    def StopNotify(self):
        print('Default StopNotify called, returning error')
        raise NotSupportedException()

    @dbus.service.signal(DBUS_PROP_IFACE,
                         signature='sa{sv}as')
    def PropertiesChanged(self, interface, changed, invalidated):
        pass


class Descriptor(dbus.service.Object):
    &quot;&quot;&quot;
    org.bluez.GattDescriptor1 interface implementation
    &quot;&quot;&quot;
    def __init__(self, bus, index, uuid, flags, characteristic):
        self.path = characteristic.path + '/desc' + str(index)
        self.bus = bus
        self.uuid = uuid
        self.flags = flags
        self.chrc = characteristic
        dbus.service.Object.__init__(self, bus, self.path)

    def get_properties(self):
        return {
                GATT_DESC_IFACE: {
                        'Characteristic': self.chrc.get_path(),
                        'UUID': self.uuid,
                        'Flags': self.flags,
                }
        }

    def get_path(self):
        return dbus.ObjectPath(self.path)

    @dbus.service.method(DBUS_PROP_IFACE,
                         in_signature='s',
                         out_signature='a{sv}')
    def GetAll(self, interface):
        if interface != GATT_DESC_IFACE:
            raise InvalidArgsException()

        return self.get_properties()[GATT_DESC_IFACE]

    @dbus.service.method(GATT_DESC_IFACE,
                        in_signature='a{sv}',
                        out_signature='ay')
    def ReadValue(self, options):
        print ('Default ReadValue called, returning error')
        raise NotSupportedException()

    @dbus.service.method(GATT_DESC_IFACE, in_signature='aya{sv}')
    def WriteValue(self, value, options):
        print('Default WriteValue called, returning error')
        raise NotSupportedException()

class BatteryService(Service):
    &quot;&quot;&quot;
    Fake Battery service that emulates a draining battery.

    &quot;&quot;&quot;
    SERVICE_UUID = '180f'

    def __init__(self, bus, index):
        Service.__init__(self, bus, index, self.SERVICE_UUID, True)
        self.add_characteristic(BatteryLevelCharacteristic(bus, 0, self))


class BatteryLevelCharacteristic(Characteristic):
    &quot;&quot;&quot;
    Fake Battery Level characteristic. The battery level is drained by 2 points
    every 5 seconds.

    &quot;&quot;&quot;
    BATTERY_LVL_UUID = '2a19'

    def __init__(self, bus, index, service):
        Characteristic.__init__(
                self, bus, index,
                self.BATTERY_LVL_UUID,
                ['read', 'notify'],
                service)
        self.notifying = False
        self.battery_lvl = 100
        self.timer = GObject.timeout_add(30000, self.drain_battery)

    def notify_battery_level(self):
        if not self.notifying:
            return
        self.PropertiesChanged(
                GATT_CHRC_IFACE,
                { 'Value': [dbus.Byte(self.battery_lvl)] }, [])

    def drain_battery(self):
        if not self.notifying:
            return True
        if self.battery_lvl &gt; 0:
            self.battery_lvl -= 2
            if self.battery_lvl &lt; 5:
                #self.battery_lvl = 0
                GObject.source_remove(self.timer)
                
        print('Battery Level drained: ' + repr(self.battery_lvl))
        self.notify_battery_level()
        return True

    def ReadValue(self, options):
        print('Battery Level read: ' + repr(self.battery_lvl))
        return [dbus.Byte(self.battery_lvl)]

    def StartNotify(self):
        if self.notifying:
            print('Already notifying, nothing to do')
            return

        self.notifying = True
        self.notify_battery_level()

    def StopNotify(self):
        if not self.notifying:
            print('Not notifying, nothing to do')
            return

        self.notifying = False


#sourceId=&quot;org.bluetooth.service.device_information&quot; type=&quot;primary&quot; uuid=&quot;180A&quot;
class DeviceInfoService(Service):

    SERVICE_UUID = '180A'

    def __init__(self, bus, index):
        Service.__init__(self, bus, index, self.SERVICE_UUID, True)
        self.add_characteristic(VendorCharacteristic(bus, 0, self))
        self.add_characteristic(ProductCharacteristic(bus, 1, self))
        self.add_characteristic(VersionCharacteristic(bus, 2, self))

#name=&quot;Manufacturer Name String&quot; sourceId=&quot;org.bluetooth.characteristic.manufacturer_name_string&quot; uuid=&quot;2A29&quot;
class VendorCharacteristic(Characteristic):

    CHARACTERISTIC_UUID = '2A29'

    def __init__(self, bus, index, service):
        Characteristic.__init__(
                self, bus, index,
                self.CHARACTERISTIC_UUID,
                [&quot;read&quot;],
                service)
        
        self.value = dbus.Array('HodgeCode'.encode(), signature=dbus.Signature('y'))
        print(f'***VendorCharacteristic value***: {self.value}')

    def ReadValue(self, options):
        print(f'Read VendorCharacteristic: {self.value}')
        return self.value

#sourceId=&quot;org.bluetooth.characteristic.model_number_string&quot; uuid=&quot;2A24&quot;
class ProductCharacteristic(Characteristic):

    CHARACTERISTIC_UUID = '2A24'

    def __init__(self, bus, index, service):
        Characteristic.__init__(
                self, bus, index,
                self.CHARACTERISTIC_UUID,
                [&quot;read&quot;],
                service)
        
        self.value = dbus.Array('smartRemotes'.encode(), signature=dbus.Signature('y'))
        print(f'***ProductCharacteristic value***: {self.value}')

    def ReadValue(self, options):
        print(f'Read ProductCharacteristic: {self.value}')
        return self.value

#sourceId=&quot;org.bluetooth.characteristic.software_revision_string&quot; uuid=&quot;2A28&quot;
class VersionCharacteristic(Characteristic):

    CHARACTERISTIC_UUID = '2A28'

    def __init__(self, bus, index, service):
        Characteristic.__init__(
                self, bus, index,
                self.CHARACTERISTIC_UUID,
                [&quot;read&quot;],
                service)
        
        self.value = dbus.Array('version 1.0.0'.encode(), signature=dbus.Signature('y'))
        print(f'***VersionCharacteristic value***: {self.value}')

    def ReadValue(self, options):
        print(f'Read VersionCharacteristic: {self.value}')
        return self.value

#name=&quot;Human Interface Device&quot; sourceId=&quot;org.bluetooth.service.human_interface_device&quot; type=&quot;primary&quot; uuid=&quot;1812&quot;
class HIDService(Service):
    SERVICE_UUID = '1812'
   
    def __init__(self, bus, index, application):
        Service.__init__(self, bus, index, self.SERVICE_UUID, True)
        
        self.parent = application
        self.protocolMode = ProtocolModeCharacteristic(bus, 0, self)
        self.hidInfo = HIDInfoCharacteristic(bus, 1, self)
        self.controlPoint = ControlPointCharacteristic(bus, 2, self)
        self.report = ReportCharacteristic(bus, 3, self)
        self.reportMap = ReportMapCharacteristic(bus, 4, self)
        
        self.add_characteristic(self.protocolMode)
        self.add_characteristic(self.hidInfo)
        self.add_characteristic(self.controlPoint)
        self.add_characteristic(self.report)
        self.add_characteristic(self.reportMap)
    
        self.protocolMode.ReadValue({})
        
#name=&quot;Protocol Mode&quot; sourceId=&quot;org.bluetooth.characteristic.protocol_mode&quot; uuid=&quot;2A4E&quot;
class ProtocolModeCharacteristic(Characteristic):

    CHARACTERISTIC_UUID = '2A4E'

    def __init__(self, bus, index, service):
        
        Characteristic.__init__(
                self, bus, index,
                self.CHARACTERISTIC_UUID,
                [&quot;read&quot;, &quot;write-without-response&quot;],
                service)
        
        #self.value = dbus.Array([1], signature=dbus.Signature('y'))
        self.parent = service
        self.value = dbus.Array(bytearray.fromhex('01'), signature=dbus.Signature('y'))
        print(f'***ProtocolMode value***: {self.value}')
        print('********', service.parent)

    def ReadValue(self, options):
        print(f'Read ProtocolMode: {self.value}')
        return self.value

    def WriteValue(self, value, options):
        print(f'Write ProtocolMode {value}')
        self.value = value

#sourceId=&quot;org.bluetooth.characteristic.hid_control_point&quot; uuid=&quot;2A4C&quot;
class ControlPointCharacteristic(Characteristic):

    CHARACTERISTIC_UUID = '2A4C'

    def __init__(self, bus, index, service):
        Characteristic.__init__(
                self, bus, index,
                self.CHARACTERISTIC_UUID,
                [&quot;write-without-response&quot;],
                service)
        
        self.value = dbus.Array(bytearray.fromhex('00'), signature=dbus.Signature('y'))
        print(f'***ControlPoint value***: {self.value}')

    def WriteValue(self, value, options):
        print(f'Write ControlPoint {value}')
        self.value = value


#id=&quot;hid_information&quot; name=&quot;HID Information&quot; sourceId=&quot;org.bluetooth.characteristic.hid_information&quot; uuid=&quot;2A4A&quot;
class HIDInfoCharacteristic(Characteristic):

    CHARACTERISTIC_UUID = '2A4A'

    def __init__(self, bus, index, service):
        Characteristic.__init__(
                self, bus, index,
                self.CHARACTERISTIC_UUID,
                ['read'],
                service)
                
        self.value = dbus.Array(bytearray.fromhex('01110002'), signature=dbus.Signature('y'))
        print(f'***HIDInformation value***: {self.value}')

    def ReadValue(self, options):
        print(f'Read HIDInformation: {self.value}')
        return self.value


#sourceId=&quot;org.bluetooth.characteristic.report_map&quot; uuid=&quot;2A4B&quot;
class ReportMapCharacteristic(Characteristic):

    CHARACTERISTIC_UUID = '2A4B'

    def __init__(self, bus, index, service):
        Characteristic.__init__(
                self, bus, index,
                self.CHARACTERISTIC_UUID,
                ['read'],
                service)
                
        self.parent = service
        #self.value = dbus.Array(bytearray.fromhex('05010906a101850175019508050719e029e715002501810295017508810395057501050819012905910295017503910395067508150026ff000507190029ff8100c0050C0901A101850275109501150126ff0719012Aff078100C005010906a101850375019508050719e029e715002501810295017508150026ff000507190029ff8100c0'), signature=dbus.Signature('y'))
        self.value = dbus.Array(bytearray.fromhex('05010906a101050719e029e71500250175019508810295017508810195067508150025650507190029658100c0'), signature=dbus.Signature('y'))
        print(f'***ReportMap value***: {self.value}')

    def ReadValue(self, options):
        print(f'Read ReportMap: {self.value}')
        return self.value


#id=&quot;report&quot; name=&quot;Report&quot; sourceId=&quot;org.bluetooth.characteristic.report&quot; uuid=&quot;2A4D&quot;        
class ReportCharacteristic(Characteristic):

    CHARACTERISTIC_UUID = '2A4D'

    def __init__(self, bus, index, service):
        Characteristic.__init__(
                self, bus, index,
                self.CHARACTERISTIC_UUID,
                ['read', 'notify'],
                service)
                
        #self.add_descriptor(ClientConfigurationDescriptor(bus, 0, self))
        self.add_descriptor(ReportReferenceDescriptor(bus, 1, self))
        
        #[ 0xA1, reportNum, 0, 0, 0, 0, 0, 0, 0, 0 ]
        #self.value = dbus.Array(bytearray.fromhex('00000000000000000000'), signature=dbus.Signature('y'))
        self.value = dbus.Array(bytearray.fromhex('0000000000000000'), signature=dbus.Signature('y'))
        print(f'***Report value***: {self.value}')
                
        self.notifying = False
        #self.battery_lvl = 100
        #GObject.timeout_add(5000, self.drain_battery)

    def send(self, value='Hey'):
        print(f'***send*** {value}');
        self.payload = dbus.Array(bytearray.fromhex('a100004800000000'))       
        self.PropertiesChanged(GATT_CHRC_IFACE, { 'Value': self.payload }, [])
                
        print(f'***sent***');
        

    def ReadValue(self, options):
        print(f'Read Report: {self.value}')
        return self.value

    def WriteValue(self, value, options):
        print(f'Write Report {self.value}')
        self.value = value

    def StartNotify(self):
        print(f'Start Notify')
        if self.notifying:
            print('Already notifying, nothing to do')
            return

        self.notifying = True
        self.notify_battery_level()

    def StopNotify(self):
        print(f'Stop Notify')
        if not self.notifying:
            print('Not notifying, nothing to do')
            return

        self.notifying = False
        
#name=&quot;Client Characteristic Configuration&quot; sourceId=&quot;org.bluetooth.descriptor.gatt.client_characteristic_configuration&quot; uuid=&quot;2902&quot;
class ClientConfigurationDescriptor(Descriptor):

    DESCRIPTOR_UUID = '2902'

    def __init__(self, bus, index, characteristic):
        Descriptor.__init__(
                self, bus, index,
                self.DESCRIPTOR_UUID,
                ['read', 'write'],
                characteristic)
                
        self.value = dbus.Array(bytearray.fromhex('0100'), signature=dbus.Signature('y'))
        print(f'***ClientConfiguration***: {self.value}')

    def ReadValue(self, options):
        print(f'Read ClientConfiguration: {self.value}')
        return self.value

    def WriteValue(self, value, options):
        print(f'Write ClientConfiguration {self.value}')
        self.value = value

#type=&quot;org.bluetooth.descriptor.report_reference&quot; uuid=&quot;2908&quot;
class ReportReferenceDescriptor(Descriptor):

    DESCRIPTOR_UUID = '2908'

    def __init__(self, bus, index, characteristic):
        Descriptor.__init__(
                self, bus, index,
                self.DESCRIPTOR_UUID,
                ['read'],
                characteristic)
                
        self.value = dbus.Array(bytearray.fromhex('0001'), signature=dbus.Signature('y'))
        print(f'***ReportReference***: {self.value}')

    def ReadValue(self, options):
        print(f'Read ReportReference: {self.value}')
        return self.value
 
#############################
# my sandbox
#############################
class TestService(Service):
    &quot;&quot;&quot;
    Dummy test service that provides characteristics and descriptors that
    exercise various API functionality.
    &quot;&quot;&quot;

    SERVICE_UUID = '12345678-1234-5678-1234-56789abcdef0'

    def __init__(self, bus, index):
        Service.__init__(self, bus, index, self.SERVICE_UUID, True)
        self.add_characteristic(TestCharacteristic(bus, 0, self))


class TestCharacteristic(Characteristic):
    &quot;&quot;&quot;
    Dummy test characteristic. Allows writing arbitrary bytes to its value, and
    contains &quot;extended properties&quot;, as well as a test descriptor.
    &quot;&quot;&quot;

    CHARACTERISTIC_UUID = '12345678-1234-5678-1234-56789abcdef1'

    def __init__(self, bus, index, service):
        Characteristic.__init__(
                self, bus, index,
                self.CHARACTERISTIC_UUID,
                ['read', 'write'],
                service)
                
        self.add_descriptor(TestDescriptor(bus, 0, self))
        #self.value = []
        self.value = dbus.Array(bytearray.fromhex('05010906a101850175019508050719e029e715002501810295017508810395057501050819012905910295017503910395067508150026ff000507190029ff8100c0050C0901A101850275109501150126ff0719012Aff078100C005010906a101850375019508050719e029e715002501810295017508150026ff000507190029ff8100c0'), signature=dbus.Signature('y'))

    def ReadValue(self, options):
        print('TestCharacteristic Read: ' + repr(self.value))
        return self.value

    def WriteValue(self, value, options):
        print('TestCharacteristic Write: ' + repr(value))
        self.value = value


class TestDescriptor(Descriptor):
    &quot;&quot;&quot;
    Dummy test descriptor. Returns a static value.
    &quot;&quot;&quot;

    DESCRIPTOR_UUID = '12345678-1234-5678-1234-56789abcdef2'

    def __init__(self, bus, index, characteristic):
        Descriptor.__init__(
                self, bus, index,
                self.DESCRIPTOR_UUID,
                ['read', 'write'],
                characteristic)
                
        self.value = dbus.Array('Test'.encode(), signature=dbus.Signature('y'))
        print(f'***TestDescriptor***: {self.value}')


    def ReadValue(self, options):
        print('TestDescriptor Read')
        
        return self.value

    def WriteValue(self, value, options):
        print(f'TestDescriptor Write: {value}')
        self.value = value

def register_app_cb():
    print('GATT application registered')


def register_app_error_cb(error):
    print('Failed to register application: ' + str(error))
    mainloop.quit()


def find_adapter(bus):
    remote_om = dbus.Interface(bus.get_object(BLUEZ_SERVICE_NAME, '/'),
                               DBUS_OM_IFACE)
    objects = remote_om.GetManagedObjects()

    for o, props in objects.items():
        if GATT_MANAGER_IFACE in props.keys():
            return o

    return None

def main():
    global mainloop

    dbus.mainloop.glib.DBusGMainLoop(set_as_default=True)

    bus = dbus.SystemBus()

    adapter = find_adapter(bus)
    if not adapter:
        print('GattManager1 interface not found')
        return

    service_manager = dbus.Interface(
            bus.get_object(BLUEZ_SERVICE_NAME, adapter),
            GATT_MANAGER_IFACE)

    app = Application(bus)

    mainloop = GObject.MainLoop()

    print('Registering GATT application...')

    service_manager.RegisterApplication(app.get_path(), {},
                                    reply_handler=register_app_cb,
                                    error_handler=register_app_error_cb)

    mainloop.run()

if __name__ == '__main__':
    main()
</code></pre>",keyboard|hid|bluez|gatt,6182423,HeadHodge,yes
onSensorChanged stops being called after 3 minutes of Locked screen,"<p>I am trying to develop a simple app which will record the user's activity (accelerometer values) on a <strong>txt or csv</strong> file.</p>

<p>My app consists of 2 java classes <strong>MainActivity</strong> and <strong>MyService</strong>. The MainActivity includes two buttons to start and stop the service and the required permissions. However, the onSensorChanged normally logs for the first 3 minutes after locking the phone (turning off the screen) and then stops logging. As soon as I open the screen the logd starts working again. Same behavior for the records in txt file. I found out that the app seems to be working excellent if I override the battery optimizations. However, I need the phone to also be working in doze mode to save some battery drain. Has anyone else had a similar issue?</p>

<p>Here is my Foreground Service:</p>

<pre><code>public class MyService extends Service implements SensorEventListener {

    public static final String CHANNEL_ID = ""ForegroundServiceChannel"";
    private static final String TAG = ""MyService"";

    private Messenger messageHandler;


    private SensorManager mSensorManager;
    private Sensor mAccelerometer;
    private Context mContext;
    private PowerManager.WakeLock wakeLock = null;

    //private HandlerThread mSensorThread;
    //private Handler mHandler;

    @SuppressLint(""MissingPermission"")
    @Override
    public void onCreate() {
        super.onCreate();
        Log.v(""shake service startup"", ""registering for shake"");
        mContext = getApplicationContext();

        //mHandler = new Handler(mSensorThread.getLooper());

        mSensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
        mAccelerometer = mSensorManager
                .getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
        mSensorManager.registerListener(this, mAccelerometer,
                SensorManager.SENSOR_DELAY_NORMAL);


        PowerManager manager = (PowerManager) getSystemService(Context.POWER_SERVICE);
        wakeLock = manager.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, ""Wakelock :: TAG"");

        // Register our receiver for the ACTION_SCREEN_OFF action. This will make our receiver
        // code be called whenever the phone enters standby mode.
        //IntentFilter filter = new IntentFilter(Intent.ACTION_SCREEN_OFF);
        //registerReceiver(mReceiver, filter);
    }


    /*
    // BroadcastReceiver for handling ACTION_SCREEN_OFF.
    public BroadcastReceiver mReceiver = new BroadcastReceiver() {

        @Override
        public void onReceive(Context context, Intent intent) {
            // Check action just to be on the safe side.
            if (intent.getAction().equals(Intent.ACTION_SCREEN_OFF)) {
                Log.v(""shake mediator screen off"",""trying re-registration"");
                // Unregisters the listener and registers it again.
                mSensorManager.unregisterListener(MyService.this);
                mSensorManager.registerListener(MyService.this, mAccelerometer,
                        SensorManager.SENSOR_DELAY_NORMAL, mHandler);
            }
        }
    };
    */

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        String input = intent.getStringExtra(""inputExtra"");
        createNotificationChannel();
        Intent notificationIntent = new Intent(this, MainActivity.class);
        PendingIntent pendingIntent = PendingIntent.getActivity(this,
                0, notificationIntent, 0);

        Notification notification = new NotificationCompat.Builder(this, CHANNEL_ID)
                .setContentTitle(""Foreground Service"")
                .setContentText(input)
                .setSmallIcon(R.drawable.ic_launcher)
                .setContentIntent(pendingIntent)
                .build();

        startForeground(1, notification);

        return START_STICKY;

        //stopSelf();

        //return START_NOT_STICKY;
    }

    private void createNotificationChannel() {
        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {
            NotificationChannel serviceChannel = new NotificationChannel(
                    CHANNEL_ID,
                    ""Foreground Service Channel"",
                    NotificationManager.IMPORTANCE_DEFAULT
            );

            NotificationManager manager = getSystemService(NotificationManager.class);
            manager.createNotificationChannel(serviceChannel);
        }
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        if(mSensorManager != null){
            //noinspection MissingPermission
            mSensorManager.unregisterListener(MyService.this);
        }
        //unregisterReceiver(mReceiver);
        try{
            wakeLock.release();//always release before acquiring for safety just in case
        }
        catch(Exception e){
            //probably already released
            Log.e(TAG, e.getMessage());
        }

    }

    @Nullable
    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }



    @Override
    public void onSensorChanged(SensorEvent event) {
        Log.d(TAG, ""onSensorChanged: "" + event.timestamp + "" "" + event.values[0] + "" "" + event.values[1] + "" "" + event.values[2]);
        recordAccelValues(String.valueOf(event.timestamp),  event.values[0] + "" "" + event.values[1] + "" "" + event.values[2]);
    }

    @Override
    public void onAccuracyChanged(Sensor sensor, int accuracy) {

    }

    private void recordAccelValues(String time, String accel_values) {
        String record = time + "" "" + accel_values  + ""\n"";

        String state = Environment.getExternalStorageState();
        if (Environment.MEDIA_MOUNTED.equals(state)) {
            if (Build.VERSION.SDK_INT &gt;= 23) {
                File sdcard = Environment.getExternalStorageDirectory();
                File dir = new File(sdcard.getAbsolutePath() + ""/text/"");
                if(!dir.exists()) {
                    dir.mkdir();
                }
                File file = new File(dir, ""dailyRecordsAccel.dat"");
                FileOutputStream os = null;
                try {
                    os = new FileOutputStream(file, true);
                    os.write(record.getBytes());
                    os.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }

            }
        }

    }


}
</code></pre>

<p>As you can see in the code I tried several recommendations from other questions I found, like wakelock and Intent.ACTION_SCREEN_OFF but they didn't seem to work.
<a href=""https://stackoverflow.com/questions/2143102/accelerometer-stops-delivering-samples-when-the-screen-is-off-on-droid-nexus-one"">Accelerometer stops delivering samples when the screen is off on Droid/Nexus One even with a WakeLock</a></p>",java|android|android-studio|accelerometer,12262726,aristyan,no
"How to keep Android awake when screen off, like scrcpy","<p>Sometimes I run a server app on my Android device (OnePlus 6 rooted with Android 10) but it appears that most apps only run when the screen is on which is a much worse battery drainer than background services.
I know that scrcpy which is an adb powered app which allows the control the device from a computer over USB or Wifi and the 'virtual screen' (i.e. display in the scrcpy app on the computer) is on but the physical screen is off. And this app does not use root, so it should be possible.
How do they do that ?</p>",android|background-process|display,18577523,user513667,yes
how to use accelerometer at a very low sampling rate in a background service? (to conserve batteries),"<p>I am developing an app that I would like to have constantly monitor accelerometer sensor data, even when the screen is off, but I would also like my battery to last longer than 5 hours :/  The most obvious thing of course is to set the sampling rate very low.  I have tried to register the accelerometer with both SENSOR_DELAY_NORMAL and with a microsecond value of 1000000 (once per second) using </p>

<pre><code>senSensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
senAccelerometer = senSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
senSensorManager.registerListener(this, senAccelerometer, SensorManager.SENSOR_DELAY_NORMAL);
</code></pre>

<p>but the Android OS quickly (after I jiggle the phone for a couple seconds) decides to override these suggested sampling rates and starts sending my app non-stop accelerometer sensor events at about 100/second, even when I turn the screen off.  Needless to say, this is not good for the battery life.</p>

<p>What I have tried for now is a bit of a hack, and I'm wondering if 1. there is a better, Android appoved way to do it, and 2. if what I've done is going to not actually work the way that I want it to.  My current solution is to immediate unregister the accelerometer after the first reading (from within the listener callback), record the time of unregistering and then to have a separate timer loop that re-registers the accelerometer listener after a half-second has passed.  This <em>seems</em> to work, but I don't know if it's going to cause problems on some devices, or maybe the registerListener function itself drains batteries on some devices?  Any advice from anybody else who has made a non-battery-draining always-on background accelerometer listener would be greatly appreciated.  Thanks.</p>

<p><strong>EDIT 9/7/2016:</strong>
The hack that I described above does seem to work and does seem to save significantly on battery, as long as I slow down the sampling speed to about 0.5 or 1.0 seconds.  If I have any more experience, good or bad, with this technique I'll let you all know.  (If it matters, I'm testing this on a Note 4, Android 5.1.1)  (also added a bit more explanatory code up above)</p>",android|android-sensors,2923200,mtopinka,yes
Check the server for new updates using Jsoup every hour,"<p>I'm working on university application and I'm using Jsoup Library <a href=""http://jsoup.org/"" rel=""nofollow"">Java HTML Parser</a> to get the news article from the university website , but I want to check every hour if there any new article added to push notification to the user</p>

<p>and my approach is to save the title of latest article in shared preferences and make my app every hour in background to get the last article  and compare it with  the last one and push notification if they are different </p>

<p><strong>My Question</strong> : How to make my app do that in the background every hour?</p>

<p><strong>another thing</strong> is that a good approach? because doing that every hour will drain the battery user, is there another way to check for news better than this? 
by the way: I don't have any permission on the university website to use GCM or something else. </p>",android|android-asynctask|notifications|push-notification|jsoup,3504332,user3504332,no
Android - Battery impact for simple background thread that periodically wakes up,"<p>I'm trying to implement a timeout mechanism for a user's login session in my app 
ie. If user has not interacted with my app for say 10 mins then when he uses the app next (regardless of whether the app was previously in the background or currently in the foreground) he should be taken to the login screen.</p>

<p>My current implementation uses:
<br>- a singleton instance of a Java Thread (call it 'TimeoutThread') from my 'BaseActivity' (all my activities except the LoginActivity extend BaseActivity)
<br>- so the singleton 'TimeoutThread' will be started only the first time any post-login activity starts up.
<br>- 'TimeoutThread' will simply keep track of the 'lastUserInteractionTimeStamp' inside a while() loop with a Thread.wait()...
so it wakes up every 2 secs, checks if the (currentTime-lastUserInteractionTimeStamp) is greater than say 10 mins and if yes then it'll trigger some callback if callback object is not null (the callback is made null whenever the app goes into background, etc)</p>

<p>This method works fine right now. </p>

<p>My concern is that since this thread wakes up every few secs (Thread.wait() inside a while(true) loop) even when the app goes into the background (eg. user presses Home button), it will cause a battery drain. </p>

<p>I've been unable to find a good link to explain the effects of keeping such a thread. 
I did find links for power optimization, scheduling recurring tasks etc (pasted below) but couldn't directly find my answer there. 
<br><a href=""https://developer.android.com/training/monitoring-device-state/index.html"" rel=""nofollow noreferrer"">https://developer.android.com/training/monitoring-device-state/index.html</a>
<br><a href=""https://stackoverflow.com/questions/14376470/scheduling-recurring-task-in-android"">Scheduling recurring task in Android</a></p>

<p>Can anyone critique this approach / suggest a better one ? </p>",android|multithreading|android-activity|background,2306340,dangling_refrenz,no
Measure battery drain for a specific App or package name using ADB Commands,"<p>Measure battery drain using ADB commands for a specific package name. </p>

<p>Battery stats for the package name since the last charge to the android device. To measure performance of the device or to automate the non-functional testing for your application in the android devices</p>",android|performance|adb|batterymanager,4813904,Siva,no
Azure IoT hub is taking more than 2 sec to push messages to mqtt device,"<p>We have a number of devices <em>(around 50-60 devices)</em> connecting via MQTT to IoTHub. To save battery,  our devices wake up once every <strong>5 min</strong>, stay awake for <strong>1 sec</strong> to get any messages and if there is nothing they goes back to sleep. This was working fine until about 2 weeks ago when this stopped working. </p>

<p>After trying a few things, we found that if we <strong>increase our Stay-Awake time to 3</strong> sec, then when devices connect, the IoTHub pushes the messages to the devices. On average the IoT hub is taking about <strong>2.5 sec</strong> to push messages once the devices connect. This will drain our battery very quick and we cannot use this as a solution. It seems to be too long to wait for messages to be dispatched considering that the devices are in the same region as the IoTHub. </p>

<p>We have also noticed that sometimes connection timeout needed to be increased to nearly <strong>10 sec</strong> to get a successful connection, which seems to be far too long. </p>

<p>On our IoT devices, we are using MQTT protocol and due to limited hardware resources we could not use the Azure IoT sdk </p>

<p>So the questions here are: </p>

<p><strong>Is it normal for the IoTHub to take 2-3 seconds to push mqtt messages once the device connect?</strong></p>

<p><strong>And is it normal to take up to 10 seconds to establish a connection with IoTHub?</strong> </p>

<p><strong>Update 1 - 5th May 2017 10:11 AM</strong></p>

<p>I have raised this question with Microsoft via MSDN, here is the link to the question: <a href=""https://social.msdn.microsoft.com/Forums/en-US/9d24c261-2280-4515-8e89-8097625307ee/azure-iothub-is-taking-more-than-23-seconds-to-dispatch-messages-via-mqtt-to-the-devices-when?forum=azureiothub"" rel=""noreferrer"">https://social.msdn.microsoft.com/Forums/en-US/9d24c261-2280-4515-8e89-8097625307ee/azure-iothub-is-taking-more-than-23-seconds-to-dispatch-messages-via-mqtt-to-the-devices-when?forum=azureiothub</a></p>

<p>We are using the Azure sdk on our cloud services. However on the IoT devices we could not use the sdk due to hardware limitation, so we are just using MQTT protocol to connect, subscribe, process messages, then disconnect. 
We are located in Australia (Melbourne SE) and we have multiple deployments that we are testing against, some are here in AU and some in East US, all deployments are giving us similar extended wait time to connect and to dispatch / push messages to the IoT devices </p>",azure|mqtt|azure-iot-hub,1570662,Has AlTaiar,yes
Disabling Physical Keyboard in Android Tablet,"<p>Ok so i bought Chinese tablet and chinese Keyboard which drains my tab battery v.fast, so
i am thinking to create an app to enable and disable physical keyboard, can any one help me for how i can target physical keyboard in codings, or is there any other possible way.</p>

<p>EDIT: by Disable i mean no interaction in any sense with physical keyboard, or say disable usb port, what you'll suggest</p>

<p>I also have ROM toolbox, which also allows me to play with some of the build properties so if u can help me in this way than i will be very thankful b/c it will save me alot time.</p>

<p>Android: 4.0.3
keyboards connects with usb cable.</p>

<p>anyway Thanks in Advance</p>",android|keyboard,1415295,Arsalan Saleem,yes
High CPU and energy use by iOS Vision framework face tracking,"<p>I am prototyping an app which would use the iOS Vision framework to continuously crop tightly around the user's face through the front camera. I've found a great tutorial from the official Apple documentation: <a href=""https://developer.apple.com/documentation/vision/tracking_the_user_s_face_in_real_time"" rel=""nofollow noreferrer"">https://developer.apple.com/documentation/vision/tracking_the_user_s_face_in_real_time</a></p>
<p>My plan is to adapt this to crop the video instead of drawing a bounding box, and then build the rest of my app around that.</p>
<p>However, I've noticed that this example app uses a high amount of energy and CPU. The app will not be viable if this is unavoidable, as it will quickly drain the user's battery.</p>
<p>Is the Vision framework intended just to be used in short bursts? Is it worth diving into trying to optimize it?</p>",ios|swift|computer-vision,1204766,Jehan,yes
Control application execution under any condition in WP8,"<p>I'm trying to build a basic tracking app for Windows Phone 8. However I can't figure out which model to use. The app shall log the location in a definable interval (e.g. 5 sec or even 2 hours).</p>

<p>If I develop the app as an foreground application the tracking will stop if the user opens another program, the screen locks (you can configure the app to continue running under the lock screen), or you reveice a phone call. Overall the risk of the app not being executed is to high.</p>

<p>There are also background tasks that are scheduled by the OS, and are only allowed to run a few seconds or minutes depending on the current state of the phone. Is there some workaround to schedule the background task execution as defined by the user? E.g. the Email client can be set to fetch emails every 15 minutes, therefore there must be some way.</p>

<p>The thrid option would be using the push notification service. This however seems stupid as some third party Microsoft server has to be involved and other limitations may apply. And more importantly, the app must run to receive the notification.</p>

<p>What is best practise on this? I don't care about battery drain as long as the app works as wanted. Similar solutions must exists for tiles that shall be updated more frequently (30 minutes or even more seems awfully long)? Am I missing something?</p>

<p>A basic app that can call it's own <code>sleep</code> would be great, but if it get's killed after a few seconds, that won't do it. Or does <code>sleep</code> time not count?</p>",c#|xaml|windows-phone-8|windows-phone,643742,Franz Kafka,no
How to control the GPS event after the app killed from the task management bar?,"<p>Please see following url..</p>

<p><a href=""http://googlemobile.blogspot.com/2010/12/introducing-google-latitude-app-for.html?m=1"" rel=""nofollow"">http://googlemobile.blogspot.com/2010/12/introducing-google-latitude-app-for.html?m=1</a></p>

<p>I don't know how it's doing this, but this app will continue to use the GPS even after it's killed from the task management bar. </p>

<p>The only way to stop it from using the GPS is to rerun the app and disable background updating. That or disallow Latitude from the Location Services settings.  </p>

<p>It doesn't seem to drain the battery like other GPS apps though, so my guess is it's using triangulation. That or it's not polling that frequently.</p>

<p>How can I do that?</p>

<p>Please help me..</p>",iphone|gps|notifications,772363,Excalibur,yes
"What is the difference between broadcast receiver, AIDL, and Messenger?","<p>Can someone please distinguish between the scenarios where one should use a broadcast receiver, an AIDL (Android Interface Definition Language), and a messenger? I was told that using a broadcast receiver is battery draining so I should not make use of it. AIDL and messengers are used for IPC (inter process communication) but I could use the AIDL way to pass data from service to an activity within the same process.</p>

<p>So in that scenario, should I prefer an AIDL or a broadcast receiver?</p>",android|service|broadcastreceiver|aidl,4518585,JavaN00b,no
What is happening in Android when i run Thread.sleep in background service,"<p>What is happening in Android if I have IntentService defined as following:</p>

<pre><code>public class BackgroundService  extends IntentService {
    public BackgroundService() {
        super(""BackgroundService"");
    }

    @Override
    protected void onHandleIntent(Intent workIntent) {
        run();
    }
    private void run() {
        try {
            while(true)
            {
                //Some expensive Internet &amp; SQL querying stuff
                Thread.sleep(1000 * 60 * 60);
            }
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
</code></pre>

<p>How bad will it drain the battery?
I aim for rather fundamental answer (What will happen if I set the sleep to 1 day)?</p>",android|multithreading,1128259,Vojtech B,yes
"Will the Intent ""android.intent.action.ACTION_SHUTDOWN"" be broadcast if device is switched off due to 0 battery level?",<p>I have an application which listens to this broadcast so as to save some data when device is about to shut down. It works fine when I manually shut down the device. I am curious to know what would be the behavior if device shuts down because all battery was drained and battery level becomes 0? Would the event be broadcast and system would do a proper shutdown OR system would not be able to shutdown properly?</p>,android|android-intent,1174483,ShivangSeth,yes
Notifications not working with ios8 - Pushwoosh + phonegap,"<p>4 apps in apple store and android market created with pushwoosh + phonegap build. Notifications works good on all devices except for new ios8. why? is sometheing changed? I used these 2 files:
Pushnotification.js</p>

<pre><code>(function(cordova) {

    function PushNotification() {}

    // Call this to register for push notifications and retreive a deviceToken
    PushNotification.prototype.registerDevice = function(config, success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""registerDevice"", config ? [config] : []);
    };

    // Call this to set tags for the device
    PushNotification.prototype.setTags = function(config, success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""setTags"", config ? [config] : []);
    };

    // Call this to send geo location for the device
    PushNotification.prototype.sendLocation = function(config, success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""sendLocation"", config ? [config] : []);
    };

    PushNotification.prototype.onDeviceReady = function() {
        cordova.exec(null, null, ""PushNotification"", ""onDeviceReady"", []);
    };

    // Call this to get tags for the device
    PushNotification.prototype.getTags = function(success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""getTags"", []);
    };

    //Android Only----
    PushNotification.prototype.unregisterDevice = function(success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""unregisterDevice"", []);
    };

    //config params: {msg:""message"", seconds:30, userData:""optional""}
    PushNotification.prototype.createLocalNotification = function(config, success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""createLocalNotification"", config ? [config] : []);
    };

    PushNotification.prototype.clearLocalNotification = function() {
        cordova.exec(null, null, ""PushNotification"", ""clearLocalNotification"", []);
    };

    //advanced background task to track device position and not drain the battery
    PushNotification.prototype.startGeoPushes = function(success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""startGeoPushes"", []);
    };

    PushNotification.prototype.stopGeoPushes = function(success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""stopGeoPushes"", []);
    };

    //sets multi notification mode on
    PushNotification.prototype.setMultiNotificationMode = function(success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""setMultiNotificationMode"", []);
    };

    //sets single notification mode
    PushNotification.prototype.setSingleNotificationMode = function(success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""setSingleNotificationMode"", []);
    };

    //type: 0 default, 1 no sound, 2 always
    PushNotification.prototype.setSoundType = function(type, success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""setSoundType"", [type]);
    };  

    //type: 0 default, 1 no vibration, 2 always
    PushNotification.prototype.setVibrateType = function(type, success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""setVibrateType"", [type]);
    };  

    PushNotification.prototype.setLightScreenOnNotification = function(on, success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""setLightScreenOnNotification"", [on]);
    };

    //set to enable led blinking when notification arrives and display is off
    PushNotification.prototype.setEnableLED = function(on, success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""setEnableLED"", [on]);
    };

    //{goal:'name', count:3} (count is optional)
    PushNotification.prototype.sendGoalAchieved = function(config, success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""sendGoalAchieved"", config ? [config] : []);
    };

    //Android End----

    //iOS only----
    PushNotification.prototype.startLocationTracking = function(backgroundMode, success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""startLocationTracking"", backgroundMode ? [{mode : backgroundMode}] : []);
    };

    PushNotification.prototype.stopLocationTracking = function(success, fail) {
        cordova.exec(success, fail, ""PushNotification"", ""stopLocationTracking"", []);
    };

    // Call this to get a detailed status of remoteNotifications
    PushNotification.prototype.getRemoteNotificationStatus = function(callback) {
        cordova.exec(callback, callback, ""PushNotification"", ""getRemoteNotificationStatus"", []);
    };

    // Call this to set the application icon badge
    PushNotification.prototype.setApplicationIconBadgeNumber = function(badgeNumber, callback) {
        cordova.exec(callback, callback, ""PushNotification"", ""setApplicationIconBadgeNumber"", [{badge: badgeNumber}]);
    };

    // Call this to clear all notifications from the notification center
    PushNotification.prototype.cancelAllLocalNotifications = function(callback) {
        cordova.exec(callback, callback, ""PushNotification"", ""cancelAllLocalNotifications"", []);
    };
    //iOS End----

    // Event spawned when a notification is received while the application is active
    PushNotification.prototype.notificationCallback = function(notification) {
        var ev = document.createEvent('HTMLEvents');
        ev.notification = notification;
        ev.initEvent('push-notification', true, true, arguments);
        document.dispatchEvent(ev);
    };

    cordova.addConstructor(function() {
        if(!window.plugins) window.plugins = {};
        window.plugins.pushNotification = new PushNotification();
    });

})(window.cordova || window.Cordova || window.PhoneGap);
</code></pre>

<p>And app.js</p>

<pre><code>    function registerPushwooshIOS() {
        var pushNotification = window.plugins.pushNotification;

    //push notifications handler
    document.addEventListener('push-notification', function(event) {
                var notification = event.notification;
                //navigator.notification.alert(notification.aps.alert);

                //to view full push payload
                //navigator.notification.alert(JSON.stringify(notification));

                //reset badges on icon
                pushNotification.setApplicationIconBadgeNumber(0);
              });

    pushNotification.registerDevice({alert:true, badge:true, sound:true, pw_appid:""69620-5C1D0"", appname:""Maxistore""},
                                    function(status) {
                                        var deviceToken = status['deviceToken'];
                                        console.warn('registerDevice: ' + deviceToken);
                                        onPushwooshiOSInitialized(deviceToken);
                                    },
                                    function(status) {
                                        console.warn('failed to register : ' + JSON.stringify(status));
                                        navigator.notification.alert(JSON.stringify(['failed to register ', status]));
                                    });

    //reset badges on start
    pushNotification.setApplicationIconBadgeNumber(0);
}

function onPushwooshiOSInitialized(pushToken)
{
    var pushNotification = window.plugins.pushNotification;
    //retrieve the tags for the device
    pushNotification.getTags(function(tags) {
                                console.warn('tags for the device: ' + JSON.stringify(tags));
                             },
                             function(error) {
                                console.warn('get tags error: ' + JSON.stringify(error));
                             });

    //start geo tracking. PWTrackSignificantLocationChanges - Uses GPS in foreground, Cell Triangulation in background. 
    pushNotification.startLocationTracking('PWTrackSignificantLocationChanges',
                                    function() {
                                           console.warn('Location Tracking Started');
                                    });
}

function registerPushwooshAndroid() {

    var pushNotification = window.plugins.pushNotification;

    //push notifications handler
    document.addEventListener('push-notification', function(event) {
                var title = event.notification.title;
                var userData = event.notification.userdata;

                //dump custom data to the console if it exists
                if(typeof(userData) != ""undefined"") {
                    console.warn('user data: ' + JSON.stringify(userData));
                }

                //and show alert
                //navigator.notification.alert(title);

                //stopping geopushes
                pushNotification.stopGeoPushes();
              });

    //projectid: ""GOOGLE_PROJECT_ID"", appid : ""PUSHWOOSH_APP_ID""
    pushNotification.registerDevice({ projectid: ""863823034249"", appid : ""69620-5C1D0"" },
                                    function(token) {
                                        alert(token);
                                        //callback when pushwoosh is ready
                                        onPushwooshAndroidInitialized(token);
                                    },
                                    function(status) {
                                        alert(""failed to register: "" +  status);
                                        console.warn(JSON.stringify(['failed to register ', status]));
                                    });
 }

function onPushwooshAndroidInitialized(pushToken)
{
    //output the token to the console
    console.warn('push token: ' + pushToken);

    var pushNotification = window.plugins.pushNotification;

    pushNotification.getTags(function(tags) {
                            console.warn('tags for the device: ' + JSON.stringify(tags));
                         },
                         function(error) {
                            console.warn('get tags error: ' + JSON.stringify(error));
                         });


    //set multi notificaiton mode
    //pushNotification.setMultiNotificationMode();
    //pushNotification.setEnableLED(true);

    //set single notification mode
    //pushNotification.setSingleNotificationMode();

    //disable sound and vibration
    //pushNotification.setSoundType(1);
    //pushNotification.setVibrateType(1);

    pushNotification.setLightScreenOnNotification(false);

    //goal with count
    //pushNotification.sendGoalAchieved({goal:'purchase', count:3});

    //goal with no count
    //pushNotification.sendGoalAchieved({goal:'registration'});

    //setting list tags
    //pushNotification.setTags({""MyTag"":[""hello"", ""world""]});

    //settings tags
    pushNotification.setTags({deviceName:""hello"", deviceId:10},
                                    function(status) {
                                        console.warn('setTags success');
                                    },
                                    function(status) {
                                        console.warn('setTags failed');
                                    });

    function geolocationSuccess(position) {
        pushNotification.sendLocation({lat:position.coords.latitude, lon:position.coords.longitude},
                                 function(status) {
                                      console.warn('sendLocation success');
                                 },
                                 function(status) {
                                      console.warn('sendLocation failed');
                                 });
    };

    // onError Callback receives a PositionError object
    //
    function geolocationError(error) {
        alert('code: '    + error.code    + '\n' +
              'message: ' + error.message + '\n');
    }

    function getCurrentPosition() {
        navigator.geolocation.getCurrentPosition(geolocationSuccess, geolocationError);
    }

    //greedy method to get user position every 3 second. works well for demo.
//  setInterval(getCurrentPosition, 3000);

    //this method just gives the position once
//  navigator.geolocation.getCurrentPosition(geolocationSuccess, geolocationError);

    //this method should track the user position as per Phonegap docs.
//  navigator.geolocation.watchPosition(geolocationSuccess, geolocationError, { maximumAge: 3000, enableHighAccuracy: true });

    //Pushwoosh Android specific method that cares for the battery
    pushNotification.startGeoPushes();
}

 function initPushwoosh() {
    var pushNotification = window.plugins.pushNotification;
    if(device.platform == ""Android"")
    {
        registerPushwooshAndroid();
        pushNotification.onDeviceReady();
    }

    if(device.platform == ""iPhone"" || device.platform == ""iOS"")
    {
        registerPushwooshIOS();
        pushNotification.onDeviceReady();
    }
}
</code></pre>",ios|cordova|phonegap-build|pushwoosh,1726972,user1726972,no
is impact of acquiring cpu wake lock increases by no of applications holding it in android?,"<p>I used <a href=""https://play.google.com/store/apps/details?id=com.uzumapps.wakelockdetector&amp;hl=en&amp;rdid=com.uzumapps.wakelockdetector"" rel=""nofollow noreferrer"">this application from play store</a> to identify the applications holding CPU locks and turned out almost entire suite of google apps along with a few third party application have acquired CPU wake locks.</p>

<p>I am amazed that even google was using it extensively while it discouraged holding it as it drains battery. Kind of defeats the purpose of wake triggers if cpu never goes to sleep.</p>

<p>So I was wondering whether the no of applications holding the cpu wake lock affects the performance if most of them are just network application waiting for a server response.</p>

<p>because if it doesn't then the recommended practise of not to acquire it would mean nothing in practical devices as some application would likely be holding the wake lock, and when its google apps themselves you won't wanna avoid it anyway.</p>",android|wakelock|android-wake-lock,1062760,Allahjane,no
Battery Drainage Issue with the Android application,"<p>I have an issue with the battery drainage related to my application. My application is running as a background service and is required to get the location updates every 20 seconds. Additionally, it also uses Wifi Direct. </p>

<p>I am unable to fix the battery drainage issue. Any help will be appreciated.</p>",android-studio|battery,11320488,xeniazee,yes
Android based SMS server and WakeLock?,"<p>I building a Android based SMS Server.</p>

<p>It shall request server (each x seconds) for new SMSes to send (in an infinite loop).
The Android device will be always plugged-in via USB to the server.</p>

<p>The fetching of the new messages is running as a service and I need it to run 24/7.
Since battery draining is not an issue here, how should I use the WakeLock?</p>

<p>As I read some articles about the partial lock it seems to be sufficient.</p>

<p>But yet I did not find any clues when should I call the wakeLock.acquire(); and wakeLock.release();</p>

<p>I do not suppose that it could work like that:</p>

<pre><code>while(true){
    wakeLock.acquire();
    //Do stuff
    wakeLock.release();
    Thread.sleep(10000);
}
</code></pre>

<p>Considering the idea... Any inputs would be greatly apperciated. For example does it make sense to scheduler a daily restart of the phone so it will not get stucked? etc...</p>",android|wakelock,1128259,Vojtech B,yes
using additional tty sessions battery life draining?,"<p>When I'm working on my laptop I prefer to work in the arch linux console (without Xwindow).
I do this to preserve battery life, since I don't need graphics for my work, it's not a problem.</p>

<p>However sometimes I need to use X to edit a picture for example, but I'd rather not start X in tty1 where I'm working in the console.</p>

<p>So my question is: If I log into tty2 with the same user and start X from there, will my battery life be drained faster rather than if I would start X in tty1 and leave tty2 alone?</p>

<p>If possible I would like an explanation about how this works, also if my question isn't clear I'll try to give a better example.</p>

<p>Thank you in advance.</p>",linux|x11|gnu|archlinux|tty,967965,Attic,no
Standard Location Service battery drain on iOS,"<p>I noticed that if I have an application using Significant Location Change it does take approximately 30% of my battery over 24H. I thought that SLC was not supposed to drain the battery. </p>

<p>Is this behaviour normal? We made our tests scientifically on an iPhone 6 with iOS 8.3 and 8.4. We also tried on an iPhone 5c (iOS 8.3 and 8.4). </p>",ios|iphone|location|core-location|cllocationmanager,112976,poiuytrez,yes
Which type of connections allow for the server to send data to a client without the client having to ask first?,"<p>I'm sure many of you have come across this realization very early in your programming career.</p>

<p>Suppose there's a connection between a server and a client. The purpose of the client is to act when an alteration has been made to a variable on the server.</p>

<p><strong><em>The standard model</em></strong> requires the client to repeatedly check for the value of the variable and act when the value has changed.</p>

<p><strong>Server</strong></p>

<pre><code>string variable = ""nothing"";
</code></pre>

<p><strong>Client</strong></p>

<pre><code>every 1 second {

    string variable = fetchData(Server, ""variable"");

    if (variable == ""something"") {

        performAction();
    }
}
</code></pre>

<p>The problem is hundreds of thousands of cycles are wasted if the variable changes only once per day, and if the client is a mobile device it would drain it's battery and cripple it's performance.</p>

<p><strong><em>An alternative way</em></strong> would be for the client to listen indefinitely to the server and the server send the variable when it has changed.</p>

<p><strong>Server</strong></p>

<pre><code>every 1 second {

    if (variable == ""something"") {

        sendData(Client, variable);

        variable = ""nothing"";
    }
}
</code></pre>

<p><strong>Client</strong></p>

<pre><code>didReceiveData(variable) {

    performAction(variable);
}
</code></pre>

<p>This way the cycles on the client are reduced to just the n times the variable changes. I'm looking for the highest level of efficiency in client-side (for a single alteration per day a single cycle per day) and the least delay possible (almost instantaneously) between the alteration and the action. Also, in the next step of development I would like to make each client a server and this means <strong>push notifications</strong> can't scale.</p>

<p><strong>I would assume Peer-2-Peer but can it be made to work for the example above? Are there any other methods or connection types?</strong></p>

<p><em>Excuse my arbitrary programming language.</em></p>",android|windows|macos|p2p,3737190,Vulkan,yes
How would I update battery charging status every second,"<p>I am developing a mobile app  which keeps the screen  ON when launched and all of you know that this kind of app drains the battery. So I wanted to keep the screen ON only when the device is plugged in. I found this code on stackoverflow (thanks to all of you).</p>

<pre><code>  IntentFilter ifilter = new IntentFilter(Intent.ACTION_BATTERY_CHANGED);
  Context context = this;
  Intent batteryStatus = context.registerReceiver(null, ifilter);
  int status = batteryStatus.getIntExtra(BatteryManager.EXTRA_STATUS, -1);
  boolean isCharging = status == BatteryManager.BATTERY_STATUS_CHARGING || status == BatteryManager.BATTERY_STATUS_FULL;
  int chargePlug = batteryStatus.getIntExtra(BatteryManager.EXTRA_PLUGGED, -1);
  boolean usbCharge = chargePlug == BatteryManager.BATTERY_PLUGGED_USB;
  boolean acCharge = chargePlug == BatteryManager.BATTERY_PLUGGED_AC;
  if (isCharging) {
    if (usbCharge) {
      tv1.setText(""USB plugged in"");
    } else {
      if (acCharge) {
        tv1.setText(""AC plugged in"");
      }
    }
  } else {
    tv1.setText(""Connect your charger"");
  }
}
</code></pre>

<p>I put this code in oncreate. But the problem is that it shows status only once(when app is launched). So I put a timer task to repeat checking like this</p>

<pre><code>t = new TimerTask() {
    @Override 
    public void run() {
        runOnUiThread(new Runnable() {
              @Override 
              public void run() {
                  IntentFilter ifilter = new IntentFilter(Intent.ACTION_BATTERY_CHANGED);
                  Context context = this;
                  Intent batteryStatus = context.registerReceiver(null, ifilter);
                  int status = batteryStatus.getIntExtra(BatteryManager.EXTRA_STATUS, -1);
                  boolean isCharging = status == BatteryManager.BATTERY_STATUS_CHARGING || status == BatteryManager.BATTERY_STATUS_FULL;
                  int chargePlug = batteryStatus.getIntExtra(BatteryManager.EXTRA_PLUGGED, -1);
                  boolean usbCharge = chargePlug == BatteryManager.BATTERY_PLUGGED_USB;
                  boolean acCharge = chargePlug == BatteryManager.BATTERY_PLUGGED_AC;
                  if (isCharging) {
                    if (usbCharge) {
                      tv1.setText(""USB plugged in"");
                    } else {
                      if (acCharge) {
                        tv1.setText(""AC plugged in"");
                      }
                    }
</code></pre>

<p>But this doesn't work and gives the error </p>

<blockquote>
  <p>Type missmatch : Cannot convert from new Runnable(){} to Context   </p>
</blockquote>

<p>I am a newbie so please see if you could help me with some modification or even a new code. Thanks in advance.
Important note: I work on Sketchware which lets you only to put codes in MainActivity.xml or MainActivity.java other features like manifest.xml is not editable. Please keep this in mind while answering.</p>",java|xml|timer|threadpool,10911463,Wakeel Ahmad,no
Sending message to a Handler on a dead thread when getting a location within Service,"<p>I've developed Android Wear watch face, which gets location within a <strong>Service</strong> on handheld side. I use AsyncTask code which I've got from here.
This error drains about 50% battery of the phone. And I don't know why. Please help.
Error:</p>

<pre><code>W/MessageQueue: Handler (android.location.LocationManager$ListenerTransport$1) {93795ca} sending message to a Handler on a dead thread
                                                                 java.lang.IllegalStateException: Handler (android.location.LocationManager$ListenerTransport$1) {93795ca} sending message to a Handler on a dead thread
                                                                     at android.os.MessageQueue.enqueueMessage(MessageQueue.java:543)
                                                                     at android.os.Handler.enqueueMessage(Handler.java:631)
                                                                     at android.os.Handler.sendMessageAtTime(Handler.java:600)
                                                                     at android.os.Handler.sendMessageDelayed(Handler.java:570)
                                                                     at android.os.Handler.sendMessage(Handler.java:507)
                                                                     at android.location.LocationManager$ListenerTransport.onLocationChanged(LocationManager.java:248)
                                                                     at android.location.ILocationListener$Stub.onTransact(ILocationListener.java:58)
                                                                     at android.os.Binder.execTransact(Binder.java:453)
</code></pre>

<p>My Service:</p>

<pre><code>public class WeatherService extends WearableListenerService {

private void startTask() {

        Log.d(TAG, ""Start Weather AsyncTask"");
        mGoogleApiClient = new GoogleApiClient.Builder(this).addApi(Wearable.API).build();

        mLocationManager = (LocationManager) this.getSystemService(Context.LOCATION_SERVICE);

        // getting GPS status
        isGPSEnabled = mLocationManager
                .isProviderEnabled(LocationManager.GPS_PROVIDER);

        // getting network status
        isNetworkEnabled = mLocationManager
                .isProviderEnabled(LocationManager.NETWORK_PROVIDER);
        if (!isGPSEnabled &amp;&amp; !isNetworkEnabled) {
            Log.d(TAG, ""no network provider is enabled"");
            // no network provider is enabled

        } else {
            this.canGetLocation = true;
            Log.d(TAG, ""canGetLocation"" + isGPSEnabled + isNetworkEnabled);
            if (isNetworkEnabled) {
                mLocationManager.requestLocationUpdates(
                        LocationManager.NETWORK_PROVIDER,
                        0,
                        0, new LocationListener() {
                            @Override
                            public void onLocationChanged(Location location) {
                                Log.d(TAG, ""onLocationChanged: "" + location);
                                //mLocation = location;
                                mLocationNetwork = location;
                                Task task = new Task();
                                task.execute();
                                Log.v(TAG, ""isNetworkEnabled onLocationChanged: "" + mLocationNetwork);
                                if (mLocationManager != null) {
                                    mLocationManager.removeUpdates(this);
                                }
                            }

                            @Override
                            public void onStatusChanged(String provider, int status, Bundle extras) {
                                Log.d(TAG, ""onLocationChanged: "" + location);
                                if (mLocationManager != null) {
                                    mLocationManager.removeUpdates(this);
                                }
                                //mLocation = location;
                                mLocationNetwork = location;

                            }

                            @Override
                            public void onProviderEnabled(String provider) {
                                if (mLocationManager != null) {
                                    mLocationManager.removeUpdates(this);
                                }

                            }

                            @Override
                            public void onProviderDisabled(String provider) {
                                if (mLocationManager != null) {
                                    mLocationManager.removeUpdates(this);
                                }
                            }

                        });
                Log.d(""Network"", ""Network Enabled"");
                if (mLocationManager != null) {
                    location = mLocationManager
                            .getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
                    if (location != null) {
                        latitude = location.getLatitude();
                        longitude = location.getLongitude();
                        Log.d(TAG, ""Network Enabled: lat and long: "" + latitude + longitude);
                        Task task = new Task();
                        task.execute();
                        Log.v(TAG, ""isNetworkEnabled mLocationManager != null: "" + location + latitude + longitude);


                    }
                }
            }
            // if GPS Enabled get lat/long using GPS Services
            if (isGPSEnabled) {
                if (location == null) {
                    mLocationManager.requestLocationUpdates(
                            LocationManager.GPS_PROVIDER,
                            0,
                            0, new LocationListener(){
                                @Override
                                public void onLocationChanged( Location location )
                                {
                                    Log.d( TAG, ""onLocationChanged: "" + location );

                                    //mLocation = location;
                                    mLocationNetwork = location;
                                    Task task = new Task();
                                    task.execute();
                                    Log.v(TAG, ""isGPSEnabled onLocationChanged: "" + mLocationNetwork);
                                    if (mLocationManager != null) {
                                        mLocationManager.removeUpdates(this);
                                    }
                                }

                                @Override
                                public void onStatusChanged( String provider, int status, Bundle extras )
                                {
                                    Log.d( TAG, ""onLocationChanged: "" + location );
                                    //mLocation = location;
                                    mLocationNetwork = location;
                                    if (mLocationManager != null) {
                                        mLocationManager.removeUpdates(this);
                                    }
                                }

                                @Override
                                public void onProviderEnabled( String provider )
                                {
                                    if (mLocationManager != null) {
                                        mLocationManager.removeUpdates(this);
                                    }
                                }

                                @Override
                                public void onProviderDisabled( String provider )
                                {
                                    if (mLocationManager != null) {
                                        mLocationManager.removeUpdates(this);
                                    }
                                }
                            });
                    Log.d(""GPS"", ""GPS Enabled"");
                    if (mLocationManager != null) {
                        location = mLocationManager
                                .getLastKnownLocation(LocationManager.GPS_PROVIDER);
                        if (location != null) {
                            latitude = location.getLatitude();
                            longitude = location.getLongitude();
                            Log.d(TAG, ""GPS Enabled: lat and long: "" + latitude + longitude);
                            Task task = new Task();
                            task.execute();
                            Log.v(TAG, ""isGPSEnabled mLocationManager != null: "" + location + latitude + longitude);
                        }
                    }
                }
            }
        }

    }
</code></pre>

<p>And here is the ASyncTask:</p>

<pre><code>private class Task extends AsyncTask
    {
        private String resp;
        @Inject
        IWeatherApi api;

        @Override
        protected Object doInBackground( Object[] params )
        {
            if (this.isCancelled()) {
                return null;
            }
            try
            {
                Log.d( TAG, ""Task Running"" );
                RoboGuice.getInjector( WeatherService.this.getApplicationContext() ).injectMembers( this );

                if ( !mGoogleApiClient.isConnected() )
                { mGoogleApiClient.connect();

                }

                final DataMap config = new DataMap();

                WeatherInfo infoNetwork = api.getCurrentWeatherInfo(latitude, longitude);

                config.putInt( KEY_WEATHER_TEMPERATURE, infoNetwork.getTemperature() );
                config.putString( KEY_WEATHER_CONDITION, infoNetwork.getCondition() );
                config.putLong( KEY_WEATHER_SUNSET, infoNetwork.getSunset() );
                config.putLong( KEY_WEATHER_SUNRISE, infoNetwork.getSunrise() );
                config.putInt( KEY_WEATHER_WIND_SPEED, infoNetwork.getSpeed() );
                config.putInt( KEY_WEATHER_WIND_DEGREE, infoNetwork.getDeg() );
                config.putInt( KEY_WEATHER_TEMP_MIN, infoNetwork.getTempMin() );
                config.putInt( KEY_WEATHER_TEMP_MAX, infoNetwork.getTempMax() );
                config.putInt( KEY_WEATHER_HUMIDITY, infoNetwork.getHumidity() );
                config.putInt( KEY_WEATHER_PRESSURE, infoNetwork.getPressure() );

                    Wearable.MessageApi.sendMessage(mGoogleApiClient, mPeerId, PATH_WEATHER_INFO, config.toByteArray())
                            .setResultCallback(
                                    new ResultCallback&lt;MessageApi.SendMessageResult&gt;() {
                                        @Override
                                        public void onResult(MessageApi.SendMessageResult sendMessageResult) {
                                            Log.d(TAG, ""SendUpdateMessage: "" + sendMessageResult.getStatus());
                                            Log.v(TAG, KEY_WEATHER_CONDITION);
                                            Log.v(TAG, ""AsyncTask config in onResult: "" + config.toString());
                                            Log.v(TAG, ""mGoogleApiClient, mPeerId, PATH_WEATHER_INFO, config.toByteArray()"" + mGoogleApiClient + "" "" + mPeerId + "" "" + PATH_WEATHER_INFO + "" "" + config);
                                        }
                                    }
                            );

            }catch (IllegalStateException e) {
                e.printStackTrace();
                resp = e.getMessage();
            }
            catch ( Exception e )
            {
                Log.d( TAG, ""Task Fail: "" + e );
            }
            return null;
        }
    }
</code></pre>

<p>Please help, I'm a new developer and trying to solve this problem and for now without any result.</p>",android|android-asynctask|wear-os,6497368,Jack,no
Pairing to a Bluetooth Low Energy device in Android,"<p>Is it possible to automatically connect to Bluetooth Low Energy (BLE) devices?</p>

<p>The <a href=""https://developer.android.com/guide/topics/connectivity/bluetooth-le.html"">Android documentation</a> indicates that the [<code>BluetoothDevice.connectGatt()</code>](<a href=""https://developer.android.com/reference/android/bluetooth/BluetoothDevice.html#connectGatt(android.content.Context"">https://developer.android.com/reference/android/bluetooth/BluetoothDevice.html#connectGatt(android.content.Context</a>, boolean, android.bluetooth.BluetoothGattCallback)) has a autoConnect parameter:</p>

<blockquote>
  <p>boolean indicating whether to automatically connect to the BLE device
  as soon as it becomes available</p>
</blockquote>

<p>However, to call this, you need a <code>BluetoothDevice</code> first. AFAIK the only way to get this is by scanning available devices. Setting up a scan every time to connect to a device doesn't seem like a desirable way. Also, I tried using <a href=""https://play.google.com/store/apps/details?id=no.nordicsemi.android.mcp&amp;hl=en"">nRF Control Master Panel</a> to connect to my peripheral using the <code>autoConnect = true</code>, but this does not connect to the device. Connecting without the <code>autoConnect</code> however does make it connect, and I've managed to read and write data from and to my peripheral this way with success.</p>

<p>The general way in Bluetooth to have two devices paired. However, searching for my BLE device and using <a href=""https://developer.android.com/reference/android/bluetooth/BluetoothDevice.html#createBond()""><code>BluetoothDevice.createBond()</code></a> does not seem to work. In my <code>ACTION_BOND_STATE_CHANGED</code>-callback, the <code>EXTRA_BOND_STATE</code> and <code>EXTRA_PREVIOUS_BOND_STATE</code> just go from <code>BOND_BONDING</code> to <code>BOND_NONE</code> and back. I don't read out an error or anything - so maybe I'm missing something here. Here's the callback:</p>

<pre><code>private final BroadcastReceiver mGattUpdateReceiver = new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) {
        final String action = intent.getAction();
        if (BluetoothDevice.ACTION_BOND_STATE_CHANGED.equals(action)) {

            final int state = intent.getIntExtra(BluetoothDevice.EXTRA_BOND_STATE, BluetoothDevice.ERROR);
            final int prevState = intent.getIntExtra(BluetoothDevice.EXTRA_PREVIOUS_BOND_STATE, BluetoothDevice.ERROR);

            Log.e(TAG, ""prevState "" + prevState + "", state "" + state);
        }
    }
};
</code></pre>

<p>So this type of bonding does not seem to work.</p>

<p>My question is: am I doing something wrong for pairing or the autoConnect? Or is how I currently have it working the only correct way? It seems like a real pain (and battery-drain) to have to scan for devices every time, see if the device is there, if so read data and check back tomorrow, otherwise check back in an hour or so. The point of Bluetooth is that it should pair directly whenever it is near, isn't it?</p>",android|bluetooth|bluetooth-lowenergy,1319187,jdepypere,no
"Google Map not Displayed , Cannot get my LatLong","<p>I need help. I have already set up Google Console in the right way, the right API and the right package name and SHA-1 for restricting usage in Android apps and I can see the green checkmark. In other words it worked before, but now the map in Google Map gone, just showing logo, my button and still can detect my LatLong.</p>
<p>My other problem is my Google Map can't show LatLong, my location button, and can't use mark if I turn off GPS. I need to turn ON the GPS outside of the activity. Even I make refresh button but still I need to turn on GPS outside of activity (like before get inside the map activity).</p>
<p>Here is my MapActivity:</p>
<pre><code>public class MapActivity extends AppCompatActivity implements OnMapReadyCallback {
  
    private GoogleMap mMap;
    private FloatingActionButton fabDone, fabRefresh;
    private Location currentLocation;
    private boolean gps_enabled = false;
    private boolean network_enabled = false;
    private Double MyLat, MyLong;
    private String kode;
    FusedLocationProviderClient fusedLocationProviderClient;
    private static final int REQUEST_CODE = 101;
    Marker incidentMarker;
    Geocoder geo;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_map);

        AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO);

        Intent intent = getIntent();
        kode = intent.getStringExtra(&quot;kode&quot;);

        
        ActionBar actionBar = getSupportActionBar();
        actionBar.setTitle(&quot;Map&quot;);

        fabDone     = findViewById(R.id.fab_done);
        fabRefresh  = findViewById(R.id.fab_refresh);
        
        fusedLocationProviderClient = LocationServices.getFusedLocationProviderClient(this);
        geo = new Geocoder(getApplicationContext(), Locale.getDefault());

        turnGPSOn();
        fetchLocation();

        fabRefresh.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                Intent intent = getIntent();
                finish();
                startActivity(intent);
            }
        });

    }


    @Override
    public void onMapReady(@NonNull GoogleMap googleMap) {
        mMap = googleMap;
        LocationManager locManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        LocationListener locListener = new MyLocationListener();

        try {
            gps_enabled = locManager.isProviderEnabled(LocationManager.GPS_PROVIDER);
        } catch (Exception ex) {
        }
        try {
            network_enabled = locManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER);
        } catch (Exception ex) {
        }

        if (ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED &amp;&amp; ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) {
            // TODO: Consider calling
            //    ActivityCompat#requestPermissions
            // here to request the missing permissions, and then overriding
            //   public void onRequestPermissionsResult(int requestCode, String[] permissions,
            //                                          int[] grantResults)
            // to handle the case where the user grants the permission. See the documentation
            // for ActivityCompat#requestPermissions for more details.


            return;
        }

        if (gps_enabled) {
            locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, locListener);
            currentLocation = locManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);

        }

        if(network_enabled &amp;&amp; currentLocation==null){
            locManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, locListener);
            currentLocation = locManager.getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
        }

        if (currentLocation != null) {

            MyLat = currentLocation.getLatitude();
            MyLong = currentLocation.getLongitude();
            mMap.setMyLocationEnabled(true);
            LatLng latLng = new LatLng(MyLat, MyLong);
            mMap.animateCamera(CameraUpdateFactory.newLatLng(latLng));
            mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(latLng, 12.0f));

        } else {
            Location loc= getLastKnownLocation(this);
            if (loc != null) {

                MyLat = loc.getLatitude();
                MyLong = loc.getLongitude();
                mMap.setMyLocationEnabled(true);
                LatLng latLng = new LatLng(MyLat, MyLong);
                mMap.animateCamera(CameraUpdateFactory.newLatLng(latLng));
                mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(latLng, 12.0f));
            }
        }

       
        locManager.removeUpdates(locListener);

        try {
            mMap.setOnMapLongClickListener(new GoogleMap.OnMapLongClickListener() {

                @Override
                public void onMapLongClick(LatLng latLng) {
                    if (incidentMarker != null)
                        incidentMarker.remove();
                    MarkerOptions options = new MarkerOptions().position(latLng).title(&quot;Incident Location&quot;);
                    try {
                        Address address = geo.getFromLocation(latLng.latitude, latLng.longitude, 2).get(0);
                        String addressLine = address.getAddressLine(0); // If any additional                       

                        String snippets = addressLine;
                        Log.d(&quot;MAP&quot;, snippets);
                        options.snippet(snippets);
                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                    incidentMarker = mMap.addMarker(options);
                    incidentMarker.showInfoWindow();
                }
            });


            fabDone.setOnClickListener(new View.OnClickListener() {
                @Override
                public void onClick(View view) {
                   
                    if (incidentMarker == null) {
                        Toast.makeText(getApplicationContext(), &quot;Points the incident location using Long Click!&quot;, Toast.LENGTH_SHORT).show();
                        return;
                    } else {

                        if (kode.equals(&quot;1&quot;)) {

                            Intent intent = new Intent(MapActivity.this, AddReportActivity.class);
                            intent.putExtra(&quot;address&quot;, incidentMarker.getSnippet());
                            intent.putExtra(&quot;latitude&quot;, incidentMarker.getPosition().latitude);
                            intent.putExtra(&quot;longitude&quot;, incidentMarker.getPosition().longitude);

                            startActivity(intent);
                            finish();//finishing activity

                        } else if (kode.equals(&quot;2&quot;)) {
                            Intent intent = new Intent(MapActivity.this, EditReportActivity.class);
                            intent.putExtra(&quot;address&quot;, incidentMarker.getSnippet());
                            intent.putExtra(&quot;latitude&quot;, incidentMarker.getPosition().latitude);
                            intent.putExtra(&quot;longitude&quot;, incidentMarker.getPosition().longitude);

                            startActivity(intent);
                            finish();//finishing activity
                        }

                    }
                }
            });
        } catch (Exception e){e.printStackTrace();}

        if (gps_enabled &amp;&amp; network_enabled &amp;&amp; currentLocation!=null){
            MyLat = currentLocation.getLatitude();
            MyLong = currentLocation.getLongitude();
            mMap.setMyLocationEnabled(true);
            LatLng latLng = new LatLng(MyLat, MyLong);
            mMap.animateCamera(CameraUpdateFactory.newLatLng(latLng));
            mMap.animateCamera(CameraUpdateFactory.newLatLngZoom(latLng, 12.0f));
        } else if (gps_enabled &amp;&amp; network_enabled &amp;&amp; currentLocation==null){
            Toast.makeText(this, &quot;Location can't be found.&quot;, Toast.LENGTH_LONG).show();
        } else {
            Toast.makeText(this, &quot;Please turn ON the GPS.&quot;, Toast.LENGTH_SHORT).show();
        }


    }


    private void fetchLocation() {
        if (ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED &amp;&amp; ActivityCompat.checkSelfPermission(this, Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) {
            ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.ACCESS_FINE_LOCATION}, REQUEST_CODE);
            return;
        }
        Task&lt;Location&gt; task = fusedLocationProviderClient.getLastLocation();
        task.addOnSuccessListener(new OnSuccessListener&lt;Location&gt;() {
            @Override
            public void onSuccess(Location location) {
                if (location != null) {
                    currentLocation = location;
                    Toast.makeText(getApplicationContext(), currentLocation.getLatitude() + &quot;&quot; + currentLocation.getLongitude(), Toast.LENGTH_SHORT).show();
                    SupportMapFragment supportMapFragment = (SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.fama_map);
                    assert supportMapFragment != null;
                    supportMapFragment.getMapAsync(MapActivity.this);
                }
            }
        });
    }

    @Override
    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {
        super.onRequestPermissionsResult(requestCode, permissions, grantResults);
        switch (requestCode) {
            case REQUEST_CODE:
                if (grantResults.length &gt; 0 &amp;&amp; grantResults[0] == PackageManager.PERMISSION_GRANTED) {
                    fetchLocation();
                }
                break;
        }
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.map_options, menu);
        return true;
    }

    public class MyLocationListener implements LocationListener {
        public void onLocationChanged(Location location) {
            if (location != null) {
            }
        }

        public void onProviderDisabled(String provider) {
            // TODO Auto-generated method stub
        }

        public void onProviderEnabled(String provider) {
            // TODO Auto-generated method stub
        }

        public void onStatusChanged(String provider, int status, Bundle extras) {
            // TODO Auto-generated method stub
        }
    }

    public static Location getLastKnownLocation(Context context) {
        Location location = null;
        @SuppressLint(&quot;WrongConstant&quot;) LocationManager locationmanager = (LocationManager)context.getSystemService(&quot;location&quot;);
        List list = locationmanager.getAllProviders();
        boolean i = false;
        Iterator iterator = list.iterator();
        do
        {
            //System.out.println(&quot;---------------------------------------------------------------------&quot;);
            if(!iterator.hasNext())
                break;
            String s = (String)iterator.next();
            
            if(i != false &amp;&amp; !locationmanager.isProviderEnabled(s))
                continue;
            
            @SuppressLint(&quot;MissingPermission&quot;) Location location1 = locationmanager.getLastKnownLocation(s);
            if(location1 == null)
                continue;
            if(location != null)
            {
                
                float f = location.getAccuracy();
                float f1 = location1.getAccuracy();
                if(f &gt;= f1)
                {
                    long l = location1.getTime();
                    long l1 = location.getTime();
                    if(l - l1 &lt;= 600000L)
                        continue;
                }
            }
            location = location1;
            
            i = locationmanager.isProviderEnabled(s);
            // System.out.println(&quot;---------------------------------------------------------------------&quot;);
        } while(true);
        return location;
    }

    public void turnGPSOn(){
        try
        {

            String provider = Settings.Secure.getString(getContentResolver(), Settings.Secure.LOCATION_PROVIDERS_ALLOWED);


            if(!provider.contains(&quot;gps&quot;)){ //if gps is disabled
                final Intent poke = new Intent();
                poke.setClassName(&quot;com.android.settings&quot;, &quot;com.android.settings.widget.SettingsAppWidgetProvider&quot;);
                poke.addCategory(Intent.CATEGORY_ALTERNATIVE);
                poke.setData(Uri.parse(&quot;3&quot;));
                sendBroadcast(poke);
            }
        }
        catch (Exception e) {

        }
    }
    // Method to turn off the GPS
    public void turnGPSOff(){
        String provider = Settings.Secure.getString(getContentResolver(), Settings.Secure.LOCATION_PROVIDERS_ALLOWED);

        if(provider.contains(&quot;gps&quot;)){ //if gps is enabled
            final Intent poke = new Intent();
            poke.setClassName(&quot;com.android.settings&quot;, &quot;com.android.settings.widget.SettingsAppWidgetProvider&quot;);
            poke.addCategory(Intent.CATEGORY_ALTERNATIVE);
            poke.setData(Uri.parse(&quot;3&quot;));
            sendBroadcast(poke);
        }
    }

    // turning off the GPS if its in on state. to avoid the battery drain.
    @Override
    protected void onDestroy() {
        // TODO Auto-generated method stub
        super.onDestroy();
        turnGPSOff();
    }
}
</code></pre>",android|android-studio|google-maps|latitude-longitude|android-gps,13009876,Dioo B,yes
iOS reading data from server regularly,"<p>I need to create a iOS app where the app has to continuously check for the updates from the server(may be every 30 secs). But only when the app is running on the foreground.<br>
I know this will drain the battery, but this will run on a environment where there's no internet. So we can't use push notifications.<br></p>

<p>Only option I can think of is sending a request to the server every 30 secs or so and get the updates. What is the best way to do this? Using NSTimer and NSURLConnection or any other better approaches?<br></p>

<p>Also if I use a timer, when the app goes to the background will it pause and will it start running as it comes to the foreground again? Is there a chance that app get killed while its on background?</p>

<p>Thanks</p>",ios|ios6|ios7|ipad-2,1692096,Madhu,yes
how to minimize battery drain in a heavy service,"<p>I would like create a service to do something when some ""hot situation"" occurs, and by ""hot situation"" I mean the following:</p>

<ul>
<li>the GPS/cell coordinates are in a known zone</li>
<li>a known Bluetooth device is detected</li>
<li>a known Wi-Fi network is detected</li>
<li>weather info has changed</li>
<li>considerable change in acceleration of device detected: eg. from walking to travel by car.</li>
</ul>

<p>As one can see, these tasks are ""heavy"" and will be run frequently – say, 15 minutes, but sometimes even more – when I have to detect the acceleration of the device.</p>

<p>The question I have is this: will this service drain the battery heavily?  </p>

<p>If so, what recommendations do you have to minimize battery drain from the tasks described above?</p>",android|power-management,243782,Pentium10,no
FPS is ~60 even when there is no interaction on the table view,"<p>I've tab bar based app, on each tab we've a table view, i'm facing problem with my app draining battery. </p>

<p>So when checking the FPS of each screen, all screens FPS drop to zero when there are no interactions, but on home feed alone after fetching second page info the FPS is constantly showing ~60 even when there is no change in rendering is needed. </p>

<p>Shouldn't the FPS drop when there is no necessity for no rendering update on screen?</p>",ios|iphone|rendering|frame-rate|battery,796094,HariHaraSudhan,yes
Play audio from app in background like alarm,"<p>I'm creating an Alarm-like app that needs to play a long audio file (about 15 minutes) when a time comes even if the app is in the background and the phone is locked. As Apple says, local notifications sounds length are limited to 30 seconds.
I have thought about these options:
- Create a new local notification every 30 seconds with a 30-seconds audio each time, and remove the previous notifications. Cons: Will the audio sound in silent-mode? And also showing a notification every 30 seconds could be annoying...
- Create a calendar event and use a EKAlarm (I don't even know if this could do the trick)
- Execute a background silent audio to keep the app awake so I'll be able to play audio whenever I want. Cons: battery drain?</p>

<p>Any other ideas?</p>",ios|iphone|audio|uilocalnotification|alarm,2167559,Pablo Blanco,no
iPhone Battery Drain,"<p>I am facing iPhone Battery Drain problem. In my app, I am using the accelerometer to count the steps. I am subscribing to the location manager in order to keep accelerometer active in background (so that it keeps logging steps). Of course I am using a large distance filter so the localization should not cause such a big battery drain.</p>

<p>Location manager setting:</p>

<pre><code>locationManager.desiredAccuracy = kCLLocationAccuracyThreeKilometers;
locationManager.distanceFilter=3000;
</code></pre>

<p>//Even I had used startMonitoringSignificantLocationChanges also.</p>

<pre><code>[locationManager startMonitoringSignificantLocationChanges];
</code></pre>

<p>Unfortunately, after around 5 hours my battery is empty. In comparison with the app ""Moves""(<a href=""https://itunes.apple.com/in/app/moves/id509204969?mt=8"" rel=""nofollow"">https://itunes.apple.com/in/app/moves/id509204969?mt=8</a> ) their application is consuming very litle battery yet they still track ALL the activity while the app is in the background. I am amazed how they handle battery problem. When they are also using accelerometer &amp; location manager. I am very thankful for any guidance offered in this respect on how they achieve this.</p>

<p><strong>Thanks!</strong></p>",ios|iphone|background|battery,2181175,Karamjeet Singh,no
How do you manage battery health of your development devices when is always plugged in?,"<p>I know this question is not programming related, so for this I made community wiki. Developers are the best guys to answer the question.</p>

<p>I am addressed to those that do development on devices that runs on batteries, like phones, gadgets etc. Probably you are constantly develop for them, and therefor they are always plugged in and charged at 100%. We develop mainly for smartphones and we have devices that were always above 90% charged in the last month or so.</p>

<p>If a battery is always charged, it degrades it life cycle, so what steps you do to ensure decent battery drain to maximize the life of the batteries.</p>",iphone|android|windows-mobile|mobile|battery,243782,Pentium10,yes
How to determine signal strength when GSM returns '99'?,"<p>We have an in-house Android app which is a migration of a pre-existing JME application. There was an issue where users in the field were complaining that the app drained the device battery when it tried to send data when the signal strength was low (this is common behaviour in mobile devices and not our immediate problem)</p>

<p>The data needs to be sent promptly but not immediately, so we placed a check on the signal strength before sending the data. This check used the <code>PhoneStateListener</code> and the <code>onSignalStrengthsChanged(SignalStrength signalStrength)</code> callback as recommended by many similar SO questions and articles elsewhere.</p>

<p>This works fine on my own phone (running on Telstra Australia) and <a href=""http://developer.android.com/reference/android/telephony/SignalStrength.html"" rel=""nofollow noreferrer"">SignalStrength</a>.getGsmSignalStrength() returns a value from <code>0-31</code> as expected. On a phone running on another network (Optus Australia) however, it reports GSM is true but returns 99 (ie an error code) when determining the signal strength. I believe this is still correct behaviour since <a href=""http://en.wikipedia.org/wiki/GSM"" rel=""nofollow noreferrer"">GSM</a> is the 2G data and it is the 3G <a href=""http://en.wikipedia.org/wiki/UMTS"" rel=""nofollow noreferrer"">UMTS</a>/<a href=""http://en.wikipedia.org/wiki/HSPA"" rel=""nofollow noreferrer"">HSPA</a> that should be checked. <a href=""http://en.wikipedia.org/wiki/UMTS"" rel=""nofollow noreferrer"">UMTS</a>/<a href=""http://en.wikipedia.org/wiki/HSPA"" rel=""nofollow noreferrer"">HSPA</a> is the network reported by the <code>Elixir</code> app on the phone, as expected. We have also had unconfirmed reports that my network (Telstra Australia) reports insufficient GSM strength to send data from the application, but is able to browse the internet and perform other data activities without issue. This leads me to believe that the GSM strength is the wrong thing to check anyway.</p>

<p>I am in the process of running tests on other Android phones on the same network (still trying to access some devices) but it is definitely the case that we are able to browse the internet and send (HTTP) data from our application, it just fails if we check the signal strength and always receive '99'.  On Optus, SignalStrength.toString() always returns <code>99 -1 -1 -1 -1 -1 -1 gsm 3</code> after several days of testing against multiple towers.</p>

<p>The closest (unanswered) SO thread is this one: <a href=""https://stackoverflow.com/questions/4361760/getting-signal-strength-rscp-and-ec-io-from-a-phone-served-by-a-hspa-network"">Getting Signal Strength RSCP and Ec/Io from a phone served by a HSPA network</a></p>

<p><strong>In summary:</strong></p>

<ul>
<li>Telstra connection reports GSM is true and returns a usable signal strength</li>
<li>Optus connection reports GSM true but always reports '99'</li>
<li>GSM is possibly the wrong thing to check anyway, we need to try to obtain the '<em>actual data transmission network strength</em>'</li>
</ul>",android|gsm,530513,David O'Meara,no
Suggestions for replacing a Microsoft Natural Wireless Laser Mouse 6000,"<p>My partner uses a Microsoft Natural Wireless Laser Mouse 6000 (well actually, one that came with the keyboard and mouse combo...) and it's beginning to get weird on us (it drains batteries really fast, both good alkalines and rechargables). We'd replace it with another, but Microsoft seem to have discontinued the product.</p>

<p>Can anyone recommend a similar styled 'ergonomic' mouse? Ideally rechargeable, or with long battery life.</p>

<p>I use a Logitech Performance Mouse M950, which she finds isn't tilted enough and set off her wrists, and the 3M joystick mice go too far and set of her elbows and shoulders.</p>

<p>Here's the support page for it: <a href=""http://www.microsoft.com/hardware/en-us/d/natural-wireless-laser-mouse-6000"" rel=""nofollow"">http://www.microsoft.com/hardware/en-us/d/natural-wireless-laser-mouse-6000</a></p>",mouse|ergonomics,1773807,Aethylred,yes
Android sensor listening when app in background,"<p>Is it possible to track motion sensor events on Android continuously, even if the app is not in foreground?</p>

<p>If yes - what's the drain on battery?</p>

<p>A client asked if it would be possible to write an app that would initiate an action if the person ""falls"" - which basically means continuously listening to the motion sensor for rapid movement.</p>",android-sensors,2197236,Publicus,yes
Is it possible to keep Tizen application alive non stop,"<p>recently I’ve started developing for Tizen OS. My application is created only for wearable and only for specific device which is Samsung Gear Sport (Tizen 3.0 on board). Main purpose of this application is to gather complete sensor data over a long period of time. I’m interested in heart rate, and movement sensors in general (gyroscope and accelerometer). Then, this data will be send to cloud server and analysed. Currently I’m considering a WEB application because so far I have found no evidence that WEB API is missing something that exists in native API.</p>

<p>But there is one limitation in Tizen OS that so far I am unable to overcome. My application is put to sleep after a while (10 minutes or so). It is crucial that this app should work in the background for a long time (up to 10 hours). To achieve this, I’ve tried following approaches:</p>

<ul>
<li><strong>Normal Tizen app with background-category:</strong> data given by this approach is still too fragmented, for example I got 15 minutes holes where no data was recorded at all. Sometimes there were holes even longer than 30 minutes.</li>
<li><strong>Tizen alarms API:</strong> alarms did the job in case of keeping the app alive, but with every alarm, app was brought to the front and this is not an acceptable solution. There is an option to silently wake up the app (using app control), but it does not have any callback, so all alarms would have to be scheduled upfront.</li>
<li><strong>CPU_AWAKE flag</strong> made the system show “this app is using too much energy” popup, and when not answered within 10 minutes or so, system would kill my app nonetheless.</li>
<li><strong>Web Workers</strong> - this one is only for the sake of argument, web workers are put to sleep along with the application</li>
<li><strong>Data recording:</strong> I was hoping for something similar to Apple Health Kit, but instead I got something that is not working for HRM at all. Somehow it works for <code>PRESSURE</code> sensor. Tizen allows to start recording for <code>HRM</code> but nothing is recorded after - <code>NotFoundError: Failed to read recorded data</code>. Any other sensor  gives <code>TypeMismatchError</code>.</li>
<li><strong>Web Service app</strong> - this one requires partner-level certification with Samsung, also it’s affected by the background limitations, <a href=""https://developer.tizen.org/ko/development/guides/native-application/application-management/applications/service-application?langredirect=1"" rel=""noreferrer"">as the documentation mentions.</a> </li>
<li><strong>Watch Face</strong> approach with “keep always on” flag set to true in device settings. This solution was the best I’ve tried. Watch face app wakes up every minute to change the time and it also receives sensor data. Unfortunately after more testing it turned out that there were couple holes in the data recorded.</li>
</ul>

<p>About the battery: none of the above was draining the battery to a point where it became unacceptable. So first I’d like to find a solution that will give me all the sensor data I need, as frequently as possible from at least 10 hours, with no holes in it. And after that, if it turns out that this solution is draining too much battery, I will think about how to optimize it.</p>

<p>And now the question: <strong>is it possible to keep my application alive for 10+ hours non stop?</strong></p>",tizen|tizen-web-app|tizen-wearable-sdk|tizen-studio,2440598,tymbark,no
Keeping iOS app in sync with server,"<p>We are designing a system that based on particular events on the server creates geofences for particular device. It is expected that the client (device) will be in sync with the server data, question is how?</p>

<p>Initial (most optimal) idea was to send a silent push to the device to notify it about new data, and trigger data pull. Knowing that this solution will work for Android OS devices, we though the problem can be solved in similar fashion on iOS. Unfortunately, my iOS dev told me that silent push are not reliable on iOS, and presented following discussion: <a href=""https://stackoverflow.com/questions/26959472/silent-push-notifications-only-delivered-if-device-is-charging-and-or-app-is-for"">Silent push notifications only delivered if device is charging and/or app is foreground</a>.</p>

<p>Therefore, my question is how to keep the (geofence) data on the iOS devices in sync with server side?</p>

<ul>
<li>We can pull, say every say 5 minutes, this solution is extremely inefficient, for most of the devices new geofences are changed rarely if at all, but our ‘power users’ need to have geofences updated very often.</li>
<li>We could push with some kind of silent push mechanism, but it has to be reliable.</li>
<li>Maybe some kind of persistent connection (tcp or better udp) but that seems like battery draining solution. Besides not reliable, the server would have to keep track of changing IPs which is not even possible on many cellular networks.</li>
<li>WebSocket. Also battery draining solution, that is not intended for background sync. Overkill for devices that really have the data updated rarely (like once a month).</li>
<li>Some commercial solution (PubNub or Pusher), but we would definitely prefer in house solution.</li>
</ul>

<p>Are there any other solutions that are used in such cases? Maybe our approach with silent push is not right, but there is other build in Apple solution for such use case?</p>",ios|iphone|apple-push-notifications|data-synchronization,820339,Paul B.,no
Android - Code design of notification feature,"<p>I am working on an Android social app. It contains notification feature such as <code>when A send a friend request to B, B should later get a notification icon shows 1 friend request on App bar</code> (not a toast).</p>

<p>In order to know if the user has a friend request or not, the app will need to periodically send HTTP request to my backend API query for any notification. This should be performed in background. <br>I am not sure what is a good way of implement such a feature. Should I use a Android Service? or should I spin a thread by myself? How to design and implement this to make sure it won't drain the data and battery? If I want to add a toast feature later, how should I design the whole client side notification system to make sure its easy to add the toast functionality?</p>

<p>Code pointers or suggestions will be greatly helpful. Thank you!</p>",java|android|notifications|push-notification|toast,872344,Allan Jiang,yes
Keep app running under lockscreen in Windows Phone 8.1,"<p>It seems that</p>

<pre><code>PhoneApplicationService.Current.ApplicationIdleDetectionMode = IdleDetectionMode.Disabled;
</code></pre>

<p>is no longer available in Windows Phone 8.1 (non-Silverlight). Is there a way to get app running under lock screen like playing audio but for our own purpose like performing time consuming image, video processing in the background?</p>

<p>From official documentation such as <a href=""https://msdn.microsoft.com/en-us/library/windows/apps/xaml/dn642090.aspx"" rel=""nofollow"">https://msdn.microsoft.com/en-us/library/windows/apps/xaml/dn642090.aspx</a>, I sort of guess that from 8.1 running stuffs under lock screen is privilege of Microsoft's stock apps and that developers are limited to whatever they are supplying. For e.g. third party apps can only playing audio via MediaPlayer API and download/upload files via Background transfer in background. I could guess the intention is to rein rogue apps and conserve battery; but this forces genuine apps and users to keep the screen on and this drains battery even more.</p>",c++|windows-phone-8.1,668344,An Hoa,no
What events can wake up a sleeping Android device?,"<p>I am writing a Android client app which keeps receiving push notifications from a server using HTTP long-polling(Comet).</p>

<p>I don't want to always keep WakeLock since it will drain battery, but I need to make sure the device can receive notification even when it is in sleep mode. </p>

<p>And I found this question:</p>

<p><a href=""https://stackoverflow.com/questions/5007721/android-sleep-stages-levels-on-an-android-device"">Android: Sleep stages/levels on an Android device?</a></p>

<p>where ""CommonsWare"" mentioned that an incoming packet on a non-Wifi socket will wake up the device.</p>

<p>So my solution looks like this:</p>

<pre><code>    Client ------------------------- Server
              ---- Request-----&gt;
    release WakeLock                 (Allow device to sleep)





              &lt;----Notification--    (Hopes it can wake up the device)
    require WakeLock
    process the notification  
              ---- Request-----&gt;
    release WakeLock          
    ....
</code></pre>

<p>But there is a little time window between receiving the notification and requiring the wakelock, so my question is, how long will the device keep this awake state? Is it possible for the device to back to sleep during this time window?</p>",android|sockets|wakelock|android-wake-lock,690435,bhh,no
How can I map multiple attributes of a website within multiple sections as scrapy items?,"<p>I'm quite new to python and scrapy.  This is a sample code for the problem I am encountering with my gathering of data set from products within amazon.</p>

<pre><code>from scrapy.selector import HtmlXPathSelector
from amazoncrawler.items import AmazoncrawlerItem
import scrapy

class startcrawler(scrapy.Spider):
     name = ""amazone""
     allowed_domains = [""www.amazon.co.uk""]

  start_urls = [
    ""http://www.amazon.co.uk/product-reviews/B005KP74BI"",
  ]

  def parse(self, response):
    hxs = HtmlXPathSelector(response)
    item = AmazoncrawlerItem()
    reviewText = hxs.xpath('//table[@id=""productReviews""]/*/*/*/*/div/div' and '//div[@class=""reviewText""]/text()').extract()
    ratings = hxs.xpath('//table[@id=""productReviews""]/*/*/*/*/div/div' and '//span[contains(@class, ""s_star"")]/span/text()').extract()

    for text in reviewText:
      item['comment'] = text
      yield item
    for rating in ratings:
      item['rating'] = rating
      yield item
</code></pre>

<p>The response as csv file:</p>

<pre><code>comment,rating
And they do last quite some time too.,
""Not a lot to say about a pair of 9v batteries, but I've not had any problems with Duracell for this purpose."",
Whilst there are quite a few rechargeable 9v ones around you are better off with these as the rechargeable types are not suggested for use in devices such as this.,
Nearly didnt buy these based on two bad reviews - glad I ignored them. Its the Genuine thing with 4 batteries in the pack sold by amazon themselves.,
""They say you only get what you pay for and I am a firm believer of that and certainly in this case it is without doubt, the price of these batteries however in the high street is quite extortionate, hence this is very good value from Amazon. These batteries outlast normal batteries by at least  5-7 times as I have proved to myself several times as I use batteries for my business to power test meters and I can confirm that if you put a run of the mill relatively cheap battery in some of my meters you will be lucky to get 3 days to a week out of them, that is depending on the use of the meter."",
""I still use cheap batteries but only for the likes of wall clocks and the like that do not have a high power drain and they last a reasonable length of time, sometimes up to 2 years. A classic example of how long a cheap battery last is for example my Gillette Fusion ProGlide powered razor, a cheap battery last about a week, but a Duracell lasts at least 5-6 weeks, as I say you only get what you pay for, highly rated batteries and at this price you cannot loose."",
great value for money and its why my wee town is loosing money as their selling one for the same price.,
Great Value for Duracell  batteries. I need new ones for our 4 smoke alarms in our house. We normal go for cheap ones from pound shops but they don't last more then a week. When I came across these on Amazon at this price I brought them straight away. They came as describe no problems with them all in our smoke alarms and all tested and work that's what I brought them for to do and they do the job. Ignore the negative comments previous to stop you buying. There is no problems with these batteries,
""Put these into my smoke alarms, worked fine for 18 months before the alarms started the usual chirping at 3am to let you know the battery was dying. They were replaced, but the old ones still had enough power to run one of our baby's toys more a few more months."",
Good price and good shelf life too.,
""Bought 2 packs of these batteries in March 2014 to use in PIR sensors for a wireless alarm. Batteries in the sensors generally needed to be changed annually. These batteries lasted barely 5 months, very disappointing."",
""Arrived smartly Thanks and as stated fresh cells 2016 expiry, good for my smoke and CO2 alarms, postman had to ring bell as square box shape did not fit through letter box."",
""I purchased these because I needed one for a smoke alarm - but I knew it wouldn't be long before I needed others because all my alarms were purchased at the same time. Sure enough 5 weeks later I had to change another one. When the alarm instantly gave the """"low battery"""" beeps I took it out and tested it - it was well down in the """"weak"""" section. Was this a factory fault? or do employees swap their flat batteries for a new one in the box? There is no seal on the box to alert anyone to such a fiddle."",
""They're batteries. They fit well the bastard smoke detectors when they start bleeping bleeping away. They still won't shut up with the new batteries, but that's the bastard smoke detector's fault, and not the battery, which works fine."",
""Whoever thought of compulsory smoke detectors, and of their general """"safety"""" features, would also benefit from having a batchload of these batteries inserted in him."",
""Whoever thought of compulsory smoke detectors, and of their general """"safety"""" features, would also benefit from having a batchload of these batteries inserted in him."",4.7 out of 5 stars
""Whoever thought of compulsory smoke detectors, and of their general """"safety"""" features, would also benefit from having a batchload of these batteries inserted in him."",4.0 out of 5 stars
""Whoever thought of compulsory smoke detectors, and of their general """"safety"""" features, would also benefit from having a batchload of these batteries inserted in him."",1.0 out of 5 stars
""Whoever thought of compulsory smoke detectors, and of their general """"safety"""" features, would also benefit from having a batchload of these batteries inserted in him."",4.0 out of 5 stars
""Whoever thought of compulsory smoke detectors, and of their general """"safety"""" features, would also benefit from having a batchload of these batteries inserted in him."",5.0 out of 5 stars
""Whoever thought of compulsory smoke detectors, and of their general """"safety"""" features, would also benefit from having a batchload of these batteries inserted in him."",5.0 out of 5 stars
""Whoever thought of compulsory smoke detectors, and of their general """"safety"""" features, would also benefit from having a batchload of these batteries inserted in him."",5.0 out of 5 stars
""Whoever thought of compulsory smoke detectors, and of their general """"safety"""" features, would also benefit from having a batchload of these batteries inserted in him."",5.0 out of 5 stars
""Whoever thought of compulsory smoke detectors, and of their general """"safety"""" features, would also benefit from having a batchload of these batteries inserted in him."",5.0 out of 5 stars
""Whoever thought of compulsory smoke detectors, and of their general """"safety"""" features, would also benefit from having a batchload of these batteries inserted in him."",1.0 out of 5 stars
""Whoever thought of compulsory smoke detectors, and of their general """"safety"""" features, would also benefit from having a batchload of these batteries inserted in him."",5.0 out of 5 stars
""Whoever thought of compulsory smoke detectors, and of their general """"safety"""" features, would also benefit from having a batchload of these batteries inserted in him."",1.0 out of 5 stars
""Whoever thought of compulsory smoke detectors, and of their general """"safety"""" features, would also benefit from having a batchload of these batteries inserted in him."",5.0 out of 5 stars
</code></pre>

<p>My first issue is that the crawler is extracting 3 review rating outside of the table id 'productReview' as the first 3 review rating but this is consistent when i scrape other products. I could just ignore it but it would be nice to know how i could resolve this.</p>

<p>Second, what i'd like is for the whole paragraph to merge into one and the corresponding rating separated by delimiter. </p>

<pre><code>comment,rating
""And they do last quite some time too.
Not a lot to say about a pair of 9v batteries, but I've not had any problems with Duracell for this purpose.
Whilst there are quite a few rechargeable 9v ones around you are better off with these as the rechargeable types are not suggested for use in devices such as this."",4.0 out of 5 stars
</code></pre>",python|xpath|web-scraping|scrapy|scrapy-spider,4646109,felix,yes
Android SocketIO still works in background,"<p>I am creating an Android application with <a href=""http://socket.io/blog/native-socket-io-and-android/#"" rel=""nofollow"">Socket IO</a></p>

<p>But I checked from log, the socket is not disconnected when app go to background, I don't need to use socket when app is in background. So, is it correct? Does it drain battery much when socket still works in background?
If I want to force disconnect socket in background, how can I do it?</p>

<p>Thanks for reading this</p>",android|sockets|socket.io,2284724,Hellothi11,yes
Android: How to use Gottox/socket.io-java-client library with right way?,"<p>I have a service. I create a <code>Thread</code> for using <code>socket.io-java-client</code> library on separate thread in this Service.</p>

<p>I keep thread with following way:</p>

<pre><code>@Override
public void run() {
    while (canLiveThread) {
    //  keep thread
    }
}
</code></pre>

<p>And this way fully wrong yes? To fix this solution I need find answer to following questions:</p>

<p><strong>1.</strong> Are need to me create separately thread to use socket.io-java-client library in Service? Or I can use this library without thread, simply implement socket.io-java-client library in Service?</p>

<p><strong>2.</strong> If need create thread to use this library, then how to manage thread with right way to not draining battery in background Service?</p>

<p>If anybody have any Solution, please answer to this question ...</p>

<p>Thanks in Advance!</p>",android|multithreading|sockets|gottox|socket.io-java-client,1942750,SBotirov,yes
Can we show lockscreen media controls without playing a media on the phone?,"<p>I'm trying to develop an app which shows lockscreen media controls (<code>MPRemoteCommandCenter</code> and <code>MPNowPlayingInfoCenter</code>).
The tricky part is that I'm not playing a media on the phone but on a remote server (like <strong>Google cast</strong>).</p>

<p>I managed to do it by playing a silent audio file on the phone which shows the lockscreen controls but it doesn't feel like a good solution (unnecessary battery drain).</p>

<p>Is it possible to show these controls without playing anything on the phone ?</p>

<p><a href=""https://i.stack.imgur.com/CmL3a.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/CmL3a.jpg"" alt=""enter image description here""></a></p>",ios|cocoa|mpnowplayinginfocenter|mpremotecommandcenter,312654,Salah,yes
Refactor to fix architectural error,"<p>In a sort-of-working application I see this monstrous code:</p>

<pre><code>class SomeUglyClass extends Thread {
    ArrayList&lt;SomeData&gt; someDataStructure = new ArrayList&lt;SomeData&gt;();
    Handler mHandler = new Handler() {
        // a lot
        // writing to someDataStructure
    }
    public void run() {
        int some_count, ...;
        while(true) {
            // a lot
            // r/w access to someDataStructure

            try {
                Thread.sleep(1, 0);
            } catch (Exception e) {
                break;
            }               
        }
    } // end of run(), total 500 lines of code
} // end of SomeUglyClass, total 4K lines of code
</code></pre>

<p>Maybe you already see the problems with this code. If not, here they are:</p>

<ol>
<li><p><code>mHandler</code> is attached to the UI thread (because it is created by the thread that loads the class, which is the main thread)</p></li>
<li><p>there's no looper (which is fact is <strong><em>the bug</em></strong>)</p></li>
<li><p>the thread wastes CPU time and drains the battery</p></li>
<li><p><code>someDataStructure</code> is not thread-safe, but synchronizing elementary access operations will not help; synchronizing large blocks of code in a endless loop will likely block the guarded resource and make it unavailable for other threads; finally, it is not only <code>someDataStructure</code>, the whole class is based on the assumption that only one thread can run its code.</p></li>
<li><p>I cannot just add the looper, because the endless loop in <code>run()</code> has to be run, while <code>Looper.loop();</code> also is an infinite loop. One thread cannot run two infinite loops.</p></li>
</ol>

<p>Despite this epic architectural fail, the code is really doing something, it cannot be re-written at once, it is 4K lines of code, and often I can only guess what the code really does.</p>

<p>I need to refactor it. It should be a sequence of small steps preserving the functionality.</p>

<p><strong><em>How do I refactor this terrific code?</em></strong></p>",android|multithreading|android-looper,755804,18446744073709551615,yes
How to stop a thread completely in Java?,"<p>I know this question was asked so many times before.
I don't want to add a flag in the <code>Run()</code> method. because the method still runs and drains battery.
How can I stop the Thread completely?!</p>

<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_layout);

    AudioDispatcher dispatcher = AudioDispatcherFactory.fromDefaultMicrophone(22050,1024,0);
    dispatcher.addAudioProcessor(new PitchProcessor(PitchEstimationAlgorithm.AMDF, 22050, 1024, new PitchDetectionHandler() {

        @Override
        public void handlePitch(PitchDetectionResult pitchDetectionResult,
                AudioEvent audioEvent) {
            final float pitchInHz = pitchDetectionResult.getPitch();
            runOnUiThread(new Runnable() {
                 @Override
                 public void run() {

                    Log.i("""" + pitchInHz);

                }
            });

        }
    }));

    Thread thread = new Thread(dispatcher,""Audio Dispatcher"");
    thread.start();

}
</code></pre>",java|android|multithreading,3994414,Mandrake,yes
Extracting Meaning from a Sentence Using NLP,"<p>Basically I am trying to take answer of question why from sentence.</p>
<p>Example Sentence: I uninstalled the app because it really drains my battery.</p>
<p>Example Output: Why user uninstalled the app? -&gt; Because it drains her/his battery.</p>
<p>My researches didn't lead me to a place where I can work on. What should I do/use to achieve this. Anyone can show me a path?</p>",nlp,14427164,Erkys,yes
Continuos location tracking in web application,"<p>I have been researching the ability to make a sportstracker (continous GPS tracking) as a web-app/PWA, but this still seems impossible.</p>
<p>I have made one that somehow works, by using the Wake Lock API which works on Android, not iOS, but it still seem flaky and does turn off the screen ocasionally and javascript and tracking stop.</p>
<p>A web worker does not allow GPS tracking as far as I can tell.</p>
<p>I am totally fine with user consent and icons, bells and whistles that tells the user that tracking is going on. And battery drain should not be a bigger issue than it is on native apps for this use case.</p>
<p>Is there any way around this in 2022?</p>",web-applications|geolocation|gps,1483087,Jesper R. Hansen,yes
Is it ok to use setAlarmClock to bypass Doze mode?,"<p>I'm developing an app that requires the user's movements to be tracked continuously - using a foreground service. The app should work even when it's in background and screen is off. </p>

<p>I don't really need to track it in real time, so, to avoid draining battery, my first solution was a scheduled thread that would fire every 1 minute, fire a location listener, get a location and then turn it off.</p>

<p>This works well. But of course I eventually found out that after Doze mode kicks in, it would defer that task to many minutes - sometimes hours - ahead. Which kind of kills the purpose of my app.</p>

<p>After some research and trials I found that I could use the <code>AlarmManager</code> for that by calling <code>setExactAndAllowWhileIdle</code>, which does a better job but still suffers from the same issue.</p>

<p>Then I found that <code>setAlarmClock</code> circumvents Doze mode consistently (at least on my test device: a Pixel 3a). One thing that it does differently, though, is that it adds a ""clock"" icon to the status bar indicating that there's an alarm set up.</p>

<p>Now, I can see why Doze mode exists (abuse) and why <code>setAlarmClock</code> works around it (we need alarm apps to be reliable). And for that reason, I'm not sure if I should proceed with using it and if it's even something that could get my app blacklisted or if it's a bad practice overall - using alarms to retrieve location definitely looks wrong, but documentation on the matter is pretty incomplete at the moment.</p>

<p>I can say this method drains VERY little battery - as little as 1% for 24h usage. And it's probably the best solution for my use case.</p>

<p>So, is it ok to keep using this method? Any chances this could backfire somehow?</p>",android|location|android-doze,1007693,arvere,no
GPS icon is still blinking after locationManager.removeUpdates() and by setting locationManager to null,"<p>I am developing the Location Tracking application. But i am stopping getting the location update by doing 2 things...</p>

<ol>
<li>locationManager.removeUpdates(this);  and</li>
<li>setting locationManager reference to null.</li>
</ol>

<p>This will stop getting location co-ordinates as i want...</p>

<p>But the problem is the gps icon is still blinking.. which will draining the device's battery.</p>

<p>So please help me in stopping this GPS fixes...  </p>",android|geolocation|locationmanager,1078003,NullPointerException,yes
Simulating low battery for iPhones,"<p>I am working on a mobile game, which appearantly crashes when the Low Battery alert is displayed. It works fine on low memory, incoming calls and other messages.</p>

<p>Its a pain to test and debug this, since I can find no terminal or iPhone simulator way of simulating this situation, so I have to charge my phone up a little bit, launch the app, wait for it to drain its power, and start all over again.</p>

<p>Does anyone know of a way to produce this error in a realistic way? Hopefully something that isn't too stressful on my iPhone battery.</p>",iphone|objective-c|ios-simulator|simulation|power-management,598857,Nils Munch,yes
How to recognize when the user has spent a certain amount of time in an app?,"<p>I want to give the user the possibility to set a time limit for apps he has installed on his smartphone. Similiar to the <a href=""https://play.google.com/store/apps/details?id=com.google.android.apps.wellbeing"" rel=""nofollow noreferrer"">Digital Wellbeing</a> application from Google. When the time limit is reached, he should be notified in some way.</p>
<p>To get the time spent in apps installed on the smartphone I use the <a href=""https://developer.android.com/reference/android/app/usage/UsageStatsManager"" rel=""nofollow noreferrer"">UsageStatsManager</a>. So I have a method like this one:</p>
<pre><code>fun getTimeSpentInApp(packageName: String): Long {
   ... 
}
</code></pre>
<p>I can call this method while the user has my app open. However, when the user closes my app, I can no longer query whether the user has already exceeded their daily limit (because my app is closed now).</p>
<p>During my research I found multiple options on how I could solve the problem, but all of them had drawbacks.</p>
<ol>
<li><a href=""https://developer.android.com/topic/libraries/architecture/workmanager"" rel=""nofollow noreferrer"">WorkManager</a>: The minimum time interval between two periodic task is 15 minutes (<a href=""https://developer.android.com/reference/androidx/work/PeriodicWorkRequest#MIN_PERIODIC_INTERVAL_MILLIS"" rel=""nofollow noreferrer"">see here</a>) which is too long. If the user has set a time limit of one minute but the app usage time is only checked every 15 minutes, in the worst case he will be notified after  he used the app for 16 minutes.</li>
<li><a href=""https://developer.android.com/guide/components/foreground-services"" rel=""nofollow noreferrer"">ForegroundService</a>: Requires to always display a notification and it seems battery-draining to call the method every minute (this interval would be required)</li>
<li><a href=""https://erev0s.com/blog/run-android-service-background-reliably-every-n-seconds/"" rel=""nofollow noreferrer"">AlarmManager</a>: battery-draining to call the method every minute (this interval would be required)</li>
</ol>
<p><strong>Is there a good way to recognize when the user has spent x minutes in an application (while he is using the other application)?</strong></p>",android|android-service|android-alarms|android-workmanager|usagestatsmanager,4267725,Antict,no
Issue with Android Service in SDK >= 26,"<p>I'm creating an application which send notifications to the user even when app is killed from the process or in background. Actually in the Android versions with SDK >= 26 I'm using foreground services.
For showing notifications, I have a service (DatasNotification) which starts an asyncTask (HttpRequest) for making an http request and the asynctask at the end of the conditions starts a new service that show the notification.
When my app goes in background, I have a system notification that said: my application is draining battery.
During my analysis I understood that this system notification is generated by DatasNotification service.</p>

<p>This is my DatasNotification code:</p>

<pre><code>@Override
public void onCreate() {
    super.onCreate();
    Fabric.with(this, new Crashlytics());
    if (android.os.Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {
        startForeground(1, new Notification());
    }
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    new HttpRequest(getApplicationContext(), 0).execute();
    return START_STICKY;
}
</code></pre>

<p>Is there any solution for running a background service in sdk >= 26?</p>",android|service|notifications,12074671,Patrik Penta,yes
"Android game, battery usage is very high","<p>I am programming simple game. Draw/Update go throw realtime model, so CPU is always high loaded. Thread looks so:</p>

<pre><code>
    @Override
    public void run() {
        while (true) {   
            if (!mRun) {
                try {
                    Thread.sleep(100);
                } catch (InterruptedException e) {};
            } else {
                Canvas c = null;
                try {
                    c = mSurfaceHolder.lockCanvas(null);
                    synchronized (mSurfaceHolder) {
                        ..update game objects..
                        if (canvas != null) {
                        ..draw to canvas...
                        }
                    }
                } finally {
                    if (c != null) {
                        mSurfaceHolder.unlockCanvasAndPost(c);
                    }
                }
            }                
        }
    }
</code></pre>

<p>Problem is that working so application eats battery. On my Galaxy S2 it drains faster than charges in the same moment being on PC USB.</p>

<p>What am I doing wrong, or it's OK for games?</p>",android|battery|2d-games,148387,Vadim,yes
Bluetooth notifications for devices in range (Windows Mobile 6.5),"<p>I have searched extensively and cannot find a way of doing this.  Is it not possible?</p>

<p>I wanted to get a notification when a bluetooth device (another WM device in this case) comes within range of my Windows Mobile 6.5 device.</p>

<p>I played with the RequestBluetoothNotifications and it worked fine but there are only the following options for notifications:</p>

<p>BTE_CLASS_CONNECTIONS (1)</p>

<p>BTE_CLASS_PAIRING (2)</p>

<p>BTE_CLASS_DEVICE (4)</p>

<p>BTE_CLASS_STACK (8)</p>

<p>There isn't an option for devices in range.</p>

<p>It looks like my only option would be to have a background thread scanning for devices in range?  This approach is really not ideal because the interval would have to be really short to be effective (every min?) and it would drain the device's battery.</p>",windows-mobile|bluetooth,1356393,Mob Dev 2012,yes
What kind of code could make a Blackberry consume a lot of battery power?,"<p>I'm not a Blackberry programmer at all, but I've been asked to investigate what might possibly be making one of our Blackberry applications cause the device to overheat and completely drain the battery in less than one hour.</p>

<p>As far as we can determine, this only happens to the program on one kind of device (the Bold 9700), so we're not at all certain that it's actually caused by our program.  The application does periodically poll one or more servers/services, and we're aware that this has a negative effect on battery life.  However, this particular problem is much more extreme than normal with a polling process going on.</p>

<p>Can anyone point me to any good links or resources, assuming this is a not-uncommon problem with Blackberry apps?</p>",blackberry,14606,MusiGenesis,yes
Mobile app showing other users' exact location,"<p>If I were to attempt to create a mobile application (cordova/webapi/sql server app) that allows the user to see the exact location of other users, I'm guessing that I would have to gather the exact location of the user when the app is launched and store that in a user sessions table. I could then use something like signalr to poll that table and send updates to the app. Does this sound reasonable? Is there an easier way? Is there a flaw in my thinking?</p>

<p>This assumes that the user would allow the app to gather their location.   </p>

<p><strong>EDIT</strong>
In an effort to narrow down the focus of the question, there are essentially a few questions I have:</p>

<ol>
<li>Is there a way using cordova to ""track"" a user's location at timed intervals, like say every 5 minutes?</li>
<li>Does doing this cause a significant drain on the device's battery?</li>
</ol>

<p>Is something like this feasible? Hopefully, this narrows it down a little. </p>",cordova|gps,316738,Matt M,no
Database access and battery friendly apps,"<p>I'd like to save statistics about the usage of the ad networks in my app. Basically I want to maintain the count of the number of times an ad network is requested, makes an impression, or fails in the request each day.</p>

<p>My initial idea is have an SQLite database with the following columns</p>

<pre><code>[ day , networkId, requests, impressions, fails] 
</code></pre>

<p>But I'm considering the following performance/battery drain possible issue:</p>

<p>Since I use 3 ad network (1 main and 2 as backfill) the worst case is:</p>

<ul>
<li>Network A requested</li>
<li>Network A fails</li>
<li>Network B requested</li>
<li>Network B fails</li>
<li>Network C requested</li>
<li>Network C success.</li>
</ul>

<p>All within ~4 seconds. If each one of this points make an access to the database for updating the corresponding row, the overhead is significantly? Should I implement some kind of cache in memory and bulk insert the values (seizing also the pair of [request+success] or [request+fail] making a single update?) or can I use directly the database</p>",java|android|sqlite,853836,Addev,no
"Issue with GPS icon while using ""Location Significant Change"" and user perception","<p>I developed an application that uses ""Location Significant Change"" feature. I notice that after users download my app, they quickly tend to uninstall it because they see the white GPS icon on their iPhone, and they think it will drain their phone battery.</p>

<p>I wonder if there is any workaround or suggestion, I wonder also if Apple is going to do anything about the GPS icon when using ""Location Significant Change"" feature, either on iOS 6 or next versions.</p>

<p>on comparison Android have a feature where you could setup Alarm manager to wake up application on certain time intervals. This will solve the problem, is there something similar on iOS (or iOS 6 maybe).</p>

<p>Thanks.    </p>",iphone|ios|ios6,836026,user836026,no
how to port a desktop groovy app to cloud/android,"<p>I have an application already developed and in production. It's developed in groovy, as a desktop application with its own UI, and its purpose is to screen-scrape a website to extract some information every minute, and show alerts to the user when it need to.</p>

<p>Now I am trying to move this application to android, so it will be available all the time the phone is up (the more alerts the user gets during the day the better). Before starting I would like to gather opinions from people with experience (haven't touched android yet):</p>

<p>I see the following ways to set the app in android:</p>

<ol>
<li><p>just port the whole application to android/java and have it running in the background all the time, doing more or less what the app now does. To take into account.</p>

<ul>
<li><p>I assume running groovy on android is out of the question. I think I saw once some reference to a project to port it to android but it was so slow it was useless. So it must be android/java</p></li>
<li><p>Getting the html pages every minute (or less if i decrease) and doing all the parsing etc is doable or drains to much battery? What about memory, pages to parse could be not so small is there any limit on android?</p></li>
</ul></li>
<li><p>Set up a server side living in some hosting doing the screen-scraping every minute and only sending alerts to the background running android app, that would be much lighter than the previous one.</p>

<ul>
<li><p>I assume there is some built-in push functionality in android apps can listen to?</p></li>
<li><p>What server side hosting/service would be recommended (and for what reason, cost, perf, easy of use...).  </p></li>
</ul></li>
</ol>

<p>My guess would be 2, using GAE due to the affinity with android and maybe I could even use gaelyk to reause part of my groovy code...</p>

<p>I am targeting android 2.2.1 and up. The number of users is very small and easy to deal with so updating the android app is not a problem.</p>

<p>thanks</p>",android|google-app-engine|groovy|amazon-ec2|gaelyk,101762,Persimmonium,no
Battery getting drain on iOS 8.1.2 ( Specially when keep receiving APNS only),"<p>I am currently facing one issue about battery drain. My application is just seating in background. it is also not available in list of background app refresh. But when I visit Usage section it show ""Background activity"" 
Ref :</p>

<p><img src=""https://i.stack.imgur.com/QEGJq.png"" alt=""enter image description here""></p>

<p>can I get information what this background activity means here. also when application is not receiving APNS battery drain is around 10%. but when APNS is received this is 34% battery usage. is there anything apart from background refresh which can cause battery drain. there is no any location update service running for my app.</p>",ios|objective-c|battery-saver,355082,Sagar...,no
How to On and off GPS Programmatically after each 10 minutes?,"<p>I am using Gps and fetching location and sending to server after each 10 minutes but do to Gps ,battery draining.So for this i want that after each 10 minutes Gps should on and fetch location and after this Gps should off itself.</p>",android|gps|location,2101858,user2101858,yes
AMOLED display does not save power with full black display. Why is it so?,"<p>I created an that shows black screen and installed it on Moto X (with AMOLED display). Put the phone in aeroplane mode. Then ran Trepn profiler app to measure power consumed. The total battery drain was 53.36 for 10 minutes. Then repeated the same experiment with the same app showing white screen. Battery drain was 58.05 for 10 minutes. The difference is very small and I wonder does AMOLED really save power consumed on showing black.</p>

<p>EDIT: I don't want to switch the screen off. It can be done. I want to switch individual pixel off (when black color is shown) in an AMOLED display. Thereby reducing power consumption.</p>

<p>Note:
1. The app acquires a wake lock to keep the screen on.
2. The app does not have anything in it. It is just a black screen or white screen.</p>",android|battery|display,1305873,prasannatsm,yes
Gps status listener stops functioning once you call de-register a location listener,"<p><code>onGpsStatusChanged</code> of <code>GpsStatus.Listener</code> stops getting called once you call <code>removeUpdates</code> on a <code>LocationManager</code> instance. I originally had <a href=""https://stackoverflow.com/questions/18497340/ongpsstatuschanged-not-firing-for-gpsstatus-listener"">this</a> problem which I fixed. I'm trying to switch between gps based location tracking and network based location tracking. I've already looked into <a href=""https://stackoverflow.com/questions/5505429/switching-between-network-and-gps-provider"">this</a> and <a href=""https://stackoverflow.com/questions/7019474/switching-between-gps-and-network-provider"">this</a>. Most of the places they talk about requesting location updates from both providers simultaneously. I'm afraid this method would drain <strong>battery</strong> bigtime. </p>

<p>Hence I did something as follows. I had two <code>LocationListener</code>s: <code>gpsListener</code> and <code>ntListener</code>:</p>

<pre><code>Listener mGPSListener = new GpsStatus.Listener() {

    @Override
    public void onGpsStatusChanged(final int event) {

        switch (event) {
            case GpsStatus.GPS_EVENT_STARTED:
                locMgr.removeUpdates(ntListener);
                locMgr.requestLocationUpdates(LocationManager.GPS_PROVIDER, 120000, 50, gpsListener);
                break;

            case GpsStatus.GPS_EVENT_STOPPED:
                locMgr.removeUpdates(gpsListener);
                locMgr.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 120000, 50, ntListener);
                break;
        }


    }


};
</code></pre>

<p>Now once, <code>locMgr.removeUpdates</code> is hit, <code>onGpsStatusChanged</code> stops getting called. I tried several things such as adding <code>addGpsStatusListener</code>  after calling <code>removeUpdates</code> trying different gps status listeners, etc. No success yet. Am I doing something wrong? </p>",android|gps|android-location,1349159,ranjjose,no
Node JS createWriteStream memory leak,"<p>I have a node js procedure that, after reading say 10K rows from a database table, writes the rows to a CSV file. The rows are successfully written to the CSV file, but afterwards the node js memory usage has increased substantially and never goes back down. I suspect I have a (large) memory leak in the following code but can't find it.</p>

<p>To write this code I took guidance from <a href=""https://stackoverflow.com/questions/18932488/how-can-i-use-the-drain-event-with-createwritestream-method-in-node-js"">How to use drain event of stream.Writable in Node.js</a> . The code is executing the ""drain"" clause, &amp; there are not error messages, but the memory leak problem remains. </p>

<p>Any ideas on the cause of the memory leak?</p>

<pre><code>exports.csv_export_ar = function(req, res)
{
  global.mysqlPool.getConnection(function(err,connection) {
  if(err)
      console.log( ""Erge:Export:AR:Error:getConnection failed:%s"", err );
  else {
      var call_proc = ""call export_recent_core_events_ar("" + connection.escape(req.params.coreguid) + "");"";

      connection.query( call_proc, function(err,the_data) {
          if(err) {
                console.error(""Erge:CsvExport:AR:Error:Calling export_recent_core_events_ar:%s"", err ); 
          }
          else {                  
                  var filename = '/tmp/export_ar_' + the_coreguid + '.csv';
                  var ws = fs.createWriteStream(filename);

                  ws.on('finish', function () {
                      console.log('Erge:Export:File has been written');
                    });

                  // Add this to ensure that the out.txt's file descriptor is closed in case of error.
                  ws.on('error', function(err) {
                    console.log('Erge:Export:Error:%s', err);
                    ws.end();
                  });

                  ws.write( 
                          'datetime,a0,a1,a2,a3,a4,a5,a6,a7,' +
                          'pin_state,mode_state,prov_battery,prov solar,prov grid,' + 
                          'use battery,use hwc,use other,' +
                          'battery charge,prov solar model,prov grid model,use grid model \r\n' );

                  var i = 0;
                  exportLines();

                  function exportLines() {
                    var ok = true;
                    do {
                      var the_row = the_data[0][i];
                      var the_line =
                          the_row.created_on  + ',' + 
                          the_row.a0 + ',' + the_row.a1 + ',' + the_row.a2 + ',' + the_row.a3 + ',' + 
                          the_row.a4 + ',' + the_row.a5 + ',' + the_row.a6 + ',' + the_row.a7 + ',' + 
                          the_row.pin_state + ',' + the_row.mode_state + ',' +  
                          the_row.wProvBatteryRaw + ',' + the_row.wProvSolarRaw + ',' + the_row.wProvGridRaw + ',' + 
                          the_row.wUseBatteryRaw + ',' + the_row.wUseHwcRaw + ',' + the_row.wUseOtherRaw + ',' +
                          the_row.battery_charge + ',' +
                          the_row.wProvSolarModel + ',' + the_row.wProvGridModel + ',' + the_row.wUseGridModel + 
                          ' \r\n';
                      ok = ws.write(the_line);
                      i++;
                    } while (i &lt; the_data[0].length &amp;&amp; ok);

                    if (i &lt; the_data[0].length) {
                        // had to stop early!
                        // write some more once it drains. 
                        // If we don't wait for the drain event then the memory usage was increased
                        ws.once('drain', exportLines);
                    }
                    else
                    {
                        ws.end();           
                        ws = null;
                    }
                  }
              }
          }

          connection.release( );
      });
     }
   });
 };
</code></pre>",javascript|node.js|csv|memory-leaks,5348337,Philip Quirke,yes
Google maps new version battery drain in offline mode,"<p>Since > 9 version of google maps services battery start draining hard in offline(or airplane) mode.</p>

<p>Gsm logs: </p>

<pre><code>02-16 03:16:00.172 5795-13092/? W/ctxmgr: [AclManager]No 2 for (accnt=account#-1792900917#, com.google.android.gms(10007):UserLocationProducer, vrsn=10298000, 0, 3pPkg = null ,  3pMdlId = null). Was: 2 for 1, account#-1792900917#
02-16 03:16:00.184 5795-13092/? W/ctxmgr: [AclManager]No 2 for (accnt=account#-1253298855#, com.google.android.gms(10007):UserLocationProducer, vrsn=10298000, 0, 3pPkg = null ,  3pMdlId = null). Was: 2 for 1, account#-1253298855#
02-16 03:20:32.082 5795-25747/? W/ctxmgr: [AclManager]No 2 for (accnt=account#-1792900917#, com.google.android.gms(10007):UserLocationProducer, vrsn=10290000, 0, 3pPkg = null ,  3pMdlId = null). Was: 2 for 1, account#-179290000#
02-16 03:20:32.084 5795-25747/? W/ctxmgr: [AclManager]No 2 for (accnt=account#-1253298855#, com.google.android.gms(10007):UserLocationProducer, vrsn=10290000, 0, 3pPkg = null ,  3pMdlId = null). Was: 2 for 1, account#-1253298855#
02-16 03:27:56.240 5795-25125/? W/ctxmgr: [AclManager]No 2 for (accnt=account#-1792900917#, com.google.android.gms(10007):UserLocationProducer, vrsn=10290000, 0, 3pPkg = null ,  3pMdlId = null). Was: 2 for 1, account#-1792900917#
02-16 03:27:56.247 5795-25125/? W/ctxmgr: [AclManager]No 2 for (accnt=account#-1253298855#, com.google.android.gms(10007):UserLocationProducer, vrsn=10290000, 0, 3pPkg = null ,  3pMdlId = null). Was: 2 for 1, account#-1253298855#
</code></pre>

<p>Is it possible to suspend gsm services while there is no connection?</p>

<p>What is the class - AclManager?</p>

<p>Thanks</p>",java|android|performance|google-maps,4929268,Mishel,yes
Is there any difference between battery drain in iOS7 and iOS6 for location manager?,"<pre><code>@implementation MTCLocationManager
@synthesize manager;
@synthesize lastLocation;
@synthesize timer;
@synthesize wsUserName;
@synthesize xmlParser;
@synthesize webData;
@synthesize soapResults;
@synthesize wsUserPassword;
@synthesize glbData;
@synthesize vAktarDelegate;

NSDate *firstDate;
NSUserDefaults *defaults;
bool isUploadingDataNow;
NSString *strUserName;
NSString *strPassword;
NSString *strUrl;
CLLocation *lastLocation;
int saveUserApplicationStatusCalled;


bool sendOnly1Record = false;
-(id)init{

    self = [super init];

    if (self) {

        CLLocationManager *locationManager = [[CLLocationManager alloc] init];
        locationManager.delegate = self;

        [self setLocationManager:locationManager withDistanceFilter:100.0f];
        lastLocation = [[CLLocation alloc]init];
        firstDate =[NSDate date];
        glbData = [[NSMutableString alloc] init];
        defaults = [NSUserDefaults standardUserDefaults];
        strUserName= [defaults stringForKey:@""username""];
        strPassword= [defaults stringForKey:@""password""];
        strUrl = [defaults stringForKey:@""url""];
        isUploadingDataNow = false;
        saveUserApplicationStatusCalled = 0;

    }

    return self;
}

-(void) setSendOnly1Record:(BOOL) s{
    sendOnly1Record = s;

}
-(void)enteredBackground:(id)sender{
    [self.manager startMonitoringSignificantLocationChanges];
}

-(void)startUpdate{
   [self.manager startUpdatingLocation];
}
-(void) stopLocationListener
{
    [self.manager stopMonitoringSignificantLocationChanges];
}

-(void)post1Record:(CLLocation *)newLocation STATUS:(int) iStat{
    NSLog(@""\n\nPOST1RECORD"");
    NSString *latitude = [[NSString alloc] init];
    NSString *longitude = [[NSString alloc] init];
    latitude = [NSString stringWithFormat:@""%f"", [newLocation coordinate].latitude];
    longitude = [NSString stringWithFormat:@""%f"", [newLocation coordinate].longitude];
    NSDate *currdate = [NSDate date];
    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc]init];
    [dateFormatter setDateFormat:@""yyyy-MM-dd HH:mm:ss""];
    NSString *dateString = [[NSString alloc] init];
    dateString = [dateFormatter stringFromDate:currdate];


    NSString* batString = @"""";
    @try {
        [[UIDevice currentDevice] setBatteryMonitoringEnabled:YES];
        float batteryLevel = [[UIDevice currentDevice] batteryLevel];
        NSLog(@""battery level %f"",batteryLevel);
        batteryLevel *= 100;
        int batLevel = (int) batteryLevel;
        batString= [NSString stringWithFormat:@""%i"", abs(batLevel)];
    }
    @catch (NSException *exception) {

    }
    @finally {

    }
    NSMutableString *strTemp = [[NSMutableString alloc] init];
    NSString* strStat = [NSString stringWithFormat:@""%i"", iStat];
    [strTemp appendString:dateString];
    [strTemp appendString:@""|""];
    [strTemp appendString:latitude];
    [strTemp appendString:@""|""];
    [strTemp appendString:longitude];
    [strTemp appendString:@""|""];
    [strTemp appendString:batString];
    [strTemp appendString:@""|""];
    [strTemp appendString:strStat];
    [strTemp appendString:@""|""];

    [self postMULTILocation:strTemp];

}

- (void)locationManager:(CLLocationManager *)theLocationManager didUpdateToLocation:(CLLocation *)newLocation
       fromLocation:(CLLocation *)oldLocation{
    lastLocation = newLocation;
    if(sendOnly1Record) {
        sendOnly1Record = false;
        saveUserApplicationStatusCalled =1;
        [self post1Record:newLocation STATUS:0];
    }
    else if (!isUploadingDataNow) {


        NSString *latitude = [[NSString alloc] init];
        NSString *longitude = [[NSString alloc] init];
        latitude = [NSString stringWithFormat:@""%f"", [newLocation coordinate].latitude];
        longitude = [NSString stringWithFormat:@""%f"", [newLocation coordinate].longitude];
        NSDate *currdate = [NSDate date];
        int intervall = (int) [currdate timeIntervalSinceDate: firstDate] / 60;
        NSLog(@""time interval %d"",intervall);
        NSDateFormatter *dateFormatter = [[NSDateFormatter alloc]init];
        [dateFormatter setDateFormat:@""yyyy-MM-dd HH:mm:ss""];
        NSString *dateString = [[NSString alloc] init];
        dateString = [dateFormatter stringFromDate:currdate];

        if(intervall &gt; 10) {
            //update location
            isUploadingDataNow = true;
            [self postMULTILocation:glbData];

            firstDate = [NSDate date];
        }else{


            NSString* batString = @"""";
            @try {
                [[UIDevice currentDevice] setBatteryMonitoringEnabled:YES];
                float batteryLevel = [[UIDevice currentDevice] batteryLevel];
                //NSLog(@""battery level %f"",batteryLevel);
                batteryLevel *= 100;
                int batLevel = (int) batteryLevel;
                batString= [NSString stringWithFormat:@""%i"", abs(batLevel)];
            }
            @catch (NSException *exception) {

            }
            @finally {

            }

            NSString* strSaveUserApplicationStatusCalled = [NSString stringWithFormat:@""%i"", saveUserApplicationStatusCalled];
            [glbData appendString:dateString];
            [glbData appendString:@""|""];
            [glbData appendString:latitude];
            [glbData appendString:@""|""];
            [glbData appendString:longitude];
            [glbData appendString:@""|""];
            [glbData appendString:batString];
            [glbData appendString:@""|""];
            [glbData appendString:strSaveUserApplicationStatusCalled];
            [glbData appendString:@""|""];


        }
        if (!saveUserApplicationStatusCalled) {
            saveUserApplicationStatusCalled=1;
        }
        [defaults setObject:glbData forKey:@""glbData""];
        [defaults synchronize];
    }
}





-(void)postMULTILocation:(NSString *) strData{

    strUserName= [defaults stringForKey:@""username""];
    strPassword= [defaults stringForKey:@""password""];
    strUrl = [defaults stringForKey:@""url""];

    ///parameters

    AFHTTPRequestOperation *operation =[[AFHTTPRequestOperation alloc] initWithRequest:theRequest];
    [operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject){

        //NSLog(@""%@"",[operation responseString]);
        NSLog(@""RESPONSE:\n%@"",[operation responseString]);

        NSData* data = [[operation responseString] dataUsingEncoding:NSUTF8StringEncoding];
        data = [data subdataWithRange:NSMakeRange(0, [data length] - 1)];

        NSXMLParser *nsXmlParser = [[NSXMLParser alloc] initWithData:data];

        // create and init our delegate
        MultiPostParser *parser = [[MultiPostParser alloc] initXMLParser];


        [nsXmlParser setDelegate:parser];

        // parsing...
        BOOL success = [nsXmlParser parse];


        if([parser responseStr] != nil &amp;&amp; [parser responseStr].length&gt;0){

            [self resetDefaults ];
            glbData = [[NSMutableString alloc] init];
            [self.vAktarDelegate didSend:true];


        }else{
            [self.vAktarDelegate didSend:false];
        }

        isUploadingDataNow = false;
    }failure:^(AFHTTPRequestOperation *operation, NSError *error) {
        isUploadingDataNow = false;
        [self.vAktarDelegate didSend:false];
        NSLog(@""failed %@"",error.localizedDescription);
    }];
    [operation start];
}

- (void)resetDefaults {

    [defaults removeObjectForKey:@""glbData""];
    [defaults synchronize];
}


- (void)setLocationManager:(CLLocationManager*)locationManager withDistanceFilter:(CLLocationDistance)distanceFilter {

    self.manager.delegate = nil;
    self.manager = locationManager;
    self.manager.pausesLocationUpdatesAutomatically = NO;
    self.manager.delegate = self;
    self.manager.distanceFilter = distanceFilter;
    [self.manager setDesiredAccuracy:kCLLocationAccuracyNearestTenMeters];
}
- (void)locationManager:(CLLocationManager *)manager
       didFailWithError:(NSError *)error{

}
</code></pre>

<p>@end</p>",objective-c|ios6|ios7|cllocationmanager,1093975,Winston,no
Any App to monitor what sensors or CPU drain the battery life?,"<p>I have a Android application which i use almost all the sensors and some heavy computation algorithms. It drains out the battery in 4,5 hrs. But i need to find out which sensors or CPU users the battery? And application or any mechanism to know this?</p>",android|google-play,393639,dinesh707,no
Is there a way to pause sagas when the react-native app goes to background?,"<p>Currently we check the store if the app is active:</p>

<pre><code>function* cycleChatBadge() {

    let task;

    while (true) {
        const state = yield select(),
        isAppActive = isAppActiveSelector(state);

        if (!isAppActive) {
            yield call(delay, 8000)
            yield put({type: ""CHAT_BADGE""});
            return;
        }

        const { input } = yield take('CHAT_BADGE');

        if (task) {
            yield cancel(task)
        }

        task = yield fork(getChatBadge)
    }
}
</code></pre>

<p>However, we wonder how optimised this approach is power-wise and whether checking the store every 5 seconds drains the battery. So we thought of pausing the root saga when the app goes to background. Is it possible?</p>",react-native|redux|redux-saga,172815,Guy,no
Why my application shows in battery after exit android application?,"<p><strong>Screens</strong></p>

<hr>

<p><img src=""https://i.stack.imgur.com/6jylA.jpg"" alt=""Battery Drains""></p>

<p><strong>Problems</strong></p>

<hr>

<p><strong>1) It drains lots of battery.</strong></p>

<p><strong>2) After Exit application it display in battery status.</strong></p>",android|exit|battery,1516870,Darshak,yes
Battery drain via Google Play Services persists after location services are used in Android,"<p>I'm using <code>location</code> &amp; <code>activity recognition</code> features of android. Used for realtime location tracking. Currently using the latest <code>ConnectionLess</code> APIs. I have encountered the following problem:</p>

<p>After starting the location, activity services, once in a while, the battery starts to get drained. The behavior is pretty strange as the entire drain is showed under <code>Google Play Services</code>. The drain persists even if the app is stopped, killed, etc. To my surprise, the drain persisted even when the app was uninstalled and it took a couple of full battery re-charges to come out of the situation. </p>

<p>I'm more or less sure that the drain is triggered by my app as multiple devices have recorded the issue and these devices are from different manufacturers and across multiple android OS versions. In ADB shell, I find <code>com.google.android.gms</code> taking up 126% CPU permanently as seen below:</p>

<p><a href=""https://i.stack.imgur.com/bCgo9.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/bCgo9.png"" alt=""""></a></p>

<p>Next, I listed all the threads under that process. Result attached below:</p>

<p><a href=""https://i.stack.imgur.com/ssw4H.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/ssw4H.png"" alt=""enter image description here""></a></p>

<p>As seen there's one thread, <code>CastSocketMulti</code> running. All other threads are sleeping.Didn't get much on <code>castSocketMulti</code> other than some basic information like it is related to casting in android, etc. We aren't using anything related to casting in our app. </p>

<p>After, killing the process, the drain stops. 
Note: I found same question <a href=""https://stackoverflow.com/questions/34052609/android-app-google-play-services-battery-drain"">here</a>, however unanswered. </p>

<p>Edit: Every time the battery drain happens, as above, <code>com.google.android.gms</code>is listed as the number one process taking 100%+ CPU and the <code>castSocketMulti</code>, the only thread of that process in <code>R</code> status </p>

<p>Update: I have opened an issue <a href=""https://issuetracker.google.com/issues/70411185"" rel=""nofollow noreferrer"">here</a>. 
Pls leave a star so that it may go high on priority</p>",android|google-play-services|battery,1349159,ranjjose,yes
Socket.IO With Service Draining Battery Dramatically (Android),"<p>Good day.</p>

<p>I have a question considering the most best practise for battery managment.</p>

<p>Beforehand please do not suggest nor <strong>GCM</strong> neither <strong>Firebase</strong> as i am not interested in them and i will tell the reason after.</p>

<p>So here is the scenario.</p>

<p>I have  a social network deployed of my own.</p>

<p>I hardly believe that <strong>Viber</strong>,<strong>WhatsApp</strong> or <strong>Telegram</strong> is using any of Google Services like <strong>GCM</strong> or <strong>Firebase</strong> and plus i have used both of them and i am dramatically dissatisfied about the delays of them and about the pricing i am receiving so the best option for me was to keep all of the notifications under the hood of the Socket.IO.</p>

<p>So each step now: </p>

<p>• I have created an always-running service which is running on no matter what.</p>

<p>• The service has Socket.IO lib attached to it and the service keeps persistent connection to the server via Socket.IO.</p>

<p>• The service handles all of the Socket.IO logic which are the next :  The full application notifications - Group Notifications, Friend Request, Message Notifications and all of them, all counts around of 10 types of notifications which can be inside my application.</p>

<p>• Everything was perfect unless i saw that my Samsung S7 Edge complaining about the usage of my application. I though it was one of the Samsung typicall complains but when i saw the battery usage i was shocked... My app used <strong>MORE BATTERY THAN THE ANDROID OS</strong> which was a big hit to me.</p>

<p>I will shortly show you the code of my service : </p>

<p>i am intializing the socket like this.</p>

<pre><code>@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    initSocketFully();
    return START_STICKY;
}

  private void initSocketFully() {
    sharedHelper = new SharedHelper(this);
    currentUserId = sharedHelper.getUserId();
    destroySocket();
    try {
        mSocket = IO.socket(SOCKET_URL);
    } catch (URISyntaxException e) {
        e.printStackTrace();
    }
    initSocket();

}

 private void initSocket() {
    mSocket.on(EVENT_CONNECT, onSocketConnected);
    mSocket.on(EVENT_CONNECT_ERROR, onSocketConnectionError);
    mSocket.on(EVENT_DISCONNECT, onSocketDisconnected);
    mSocket.on(EVENT_NEW_MESSAGE, onNewMessageReceived);
    mSocket.on(EVENT_STOPPED_TYPING, onUserStoppedTyping);
    mSocket.on(EVENT_TYPING, onUserTyping);
    mSocket.on(EVENT_MESSAGE_SENT, onMessageSent);
    mSocket.on(EVENT_CONNECT_TIMEOUT, onSocketTimeOut);
    mSocket.on(EVENT_ONLINE_STATUS, onOnlineStatusReceived);
    mSocket.on(EVENT_ON_GAME_CREATED, onMafiaGameCreated);
    mSocket.on(EVENT_ON_COMMENT_ADDED, onCommentAdded);
    mSocket.on(EVENT_ON_FRIEND_REQUEST_ACCEPTED, onFriendRequestAccepted);
    mSocket.on(EVENT_ON_FRIEND_REQUEST_DECLINED, onFriendRequestDeclined);
    mSocket.on(EVENT_ON_POST_LIKED, onPostLiked);
    mSocket.on(EVENT_ON_POST_MADE, onPostMade);
    mSocket.on(EVENT_ON_FRIEND_REQUESTED, onFriendRequested);

    mSocket.connect();
}
</code></pre>

<p>Destroying it on the callback of sevice's <code>onDestroy</code> like so : </p>

<pre><code> private void destroySocket() {
    if (mSocket != null) {
        mSocket.disconnect();
        mSocket.off(EVENT_CONNECT, onSocketConnected);
        mSocket.off(EVENT_ON_FRIEND_REQUEST_ACCEPTED, onFriendRequestAccepted);
        mSocket.off(EVENT_CONNECT_ERROR, onSocketConnectionError);
        mSocket.off(EVENT_ON_FRIEND_REQUEST_DECLINED, onFriendRequestDeclined);
        mSocket.off(EVENT_DISCONNECT, onSocketDisconnected);
        mSocket.off(EVENT_NEW_MESSAGE, onNewMessageReceived);
        mSocket.off(EVENT_STOPPED_TYPING, onUserStoppedTyping);
        mSocket.off(EVENT_ON_GAME_CREATED, onMafiaGameCreated);
        mSocket.off(EVENT_TYPING, onUserTyping);
        mSocket.off(EVENT_MESSAGE_SENT, onMessageSent);
        mSocket.off(EVENT_CONNECT_TIMEOUT, onSocketTimeOut);
        mSocket.off(EVENT_ONLINE_STATUS, onOnlineStatusReceived);
        mSocket.off(EVENT_ON_COMMENT_ADDED, onCommentAdded);
        mSocket.off(EVENT_ON_POST_LIKED, onPostLiked);
        mSocket.off(EVENT_ON_POST_MADE, onPostMade);
        mSocket.off(EVENT_ON_FRIEND_REQUESTED, onFriendRequested);
    }
}
</code></pre>

<p>Important notice that i am starting this service every 10 minutes over and over which is the guarantee that if system kills the service process, yet it will be again started and no delays for the user will be.</p>

<p>My question is the next : </p>

<p>How to optimize all of these logic not to drain the battery of phone more then <strong>Android OS</strong> as it is ridicilous to drain the user's device battery in that way, but i believe there must be some good practise where i MUST NOT use firebase nor GCM and i MUST NOT close the Socket and open it very late and let user feel huge delays as it will distract user from my application...</p>

<p>So any ideas or a code improvement?</p>",android|sockets|socket.io|battery|batterymanager,7497670,Volo Apps,no
prompt the user to activate gps in a background service?,"<p>The main activity is destroyed the first time the app is installed and after that I've got a background service that runs whenever there is available internet. </p>

<p>The background service detects location (amongst other things) and since the app is supposed to remain on the phone for months (it only works when there is internet and not all the time or else that'd drain the battery even further) well since it runs for a long time, the user can disable gps and forget to turn it back on before he is connected to internet the next time which can cause the app to crash when the google API client requests location so for now, the background app automatically opens the settings interface when it detects that gps is off in order to remind the user to turn it on but this solution isn't that good since the interface appears out of nowhere and the user can get confused. </p>

<p>So I want to make a prompt/alert dialogue that tells the user ""the app [appName] requires gsp please turn it on"" with ""yes"" and ""no"" choices and when the user clicks ""yes"" then the settings interface is shown. Is this doable ? Again, I'm not looking for a solution with an activity as I already know how to do this (no transparent activity either just using the service)</p>

<p><strong>Here's how I'm doing things so far:</strong></p>

<pre><code>//This part of the code is right before getting the current location
    if (!isLocationEnabled(this)) {

              Intent myIntent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
              myIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
              startActivity(myIntent);

        }

    public static boolean isLocationEnabled(Context context) {
        int locationMode = 0;
        String locationProviders;

        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) {
            try {
                locationMode = Settings.Secure.getInt(context.getContentResolver(), Settings.Secure.LOCATION_MODE);

            } catch (Settings.SettingNotFoundException e) {
                e.printStackTrace();
                return false;
            }

            return locationMode != Settings.Secure.LOCATION_MODE_OFF;

        } else {
            locationProviders = Settings.Secure.getString(context.getContentResolver(), Settings.Secure.LOCATION_PROVIDERS_ALLOWED);
            return !TextUtils.isEmpty(locationProviders);
        }


    }
</code></pre>",android|geolocation|gps|android-alertdialog|android-permissions,7610349,student93,no
Best Practice to report user location continusly and Google Latitude,"<p>I need to make application that report user location to back end server. I had 2 choices:</p>

<ul>
<li>significant-change: I tried this, but accuracy is lower than what I'm looking for.</li>
<li>Background Location update: accuracy is OK, but it's drain battery and it's not recommended by Apple, only for few  application.</li>
</ul>

<p>I wonder if there is a method that gives good accuracy but without draining battery. for example, I notice Google Latitude app have good accuracy but it have no noticeable effect on battery.</p>

<p>any idea?</p>",iphone|ios,836026,user836026,yes
Acquiring an Android WakeLock in NativeScript App,"<p>I've almost finished a NativeScript app that integrates timers as part of the UI. (I repeat, a NativeScript app. NativeScript is kind of like React Native. It's written in JavaScript, not Java.) The user will create a timer that runs for up to ~100 minutes but could run for as little as 1 second, with the expectation that an alarm is guaranteed to go off at the end of this process, whether or not they've been using their phone. When I run this application on my phone, after the phone's screen has been locked for a while (I'm not sure exactly how long it takes, but probably 10-30 minutes), alarms don't go off and the app relaunches to the home page. I ideally want the state of the app to be completely preserved and the processing that goes on in my Angular component to continue while the screen is off. Yes, I know this is a drain on battery life.</p>

<p>Right now, the code I'm using to enforce a partial wake lock in Android looks something like this:</p>

<pre><code>acquireWakeLock() {
    //enforce a new partial wake lock
    const PowerManager = android.os.PowerManager;
    let powerManager = &lt;PowerManager&gt;application.android.context.getSystemService(android.content.Context.POWER_SERVICE);
    this.wakelock = &lt;PowerManager.WakeLock&gt;powerManager.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, ""RoutineTimer"");
    this.wakelock.acquire();
    console.log(""Acquired new wake lock"");
}
</code></pre>

<p>(Forgive the verbose references, but I'm putting them here to distinguish between ""android"" and ""application.android"".)</p>

<p>This doesn't have the desired effect at all. It's being called from an Angular component but is housed in an Angular service.</p>

<p>Does anyone know what's up with this or have other recommendations? I'd prefer not to use a full (screen) wake lock, though I know there's a plugin for that. I'd also prefer not to send in any kind of broadcast from a server for financial reasons.</p>",android|nativescript|nativescript-angular,8315348,Andrew Puglionesi,no
Is it possible to ignore one type of push notification in iOS,"<p>The problem is that I want to make ios client responsible for taking care of displaying/not displaying push notification relating on some kind type in push dictionary.</p>

<p>I would present some kind of modal view where user can choose what notifications he want to see.</p>

<p>And the question is it possible to ignore that chosen type when app is turned off or in background?</p>

<p>I know it's bad solution due to unnecessary unwanted pushes to be send and drain battery and it surely should be managed on the server side, but for now I need very fast solution that would be replaced in the future or even there could be double side check.</p>",ios|iphone|push-notification,546013,yershuachu,no
Parsing Beacon Information in didEnterRegion Method of Altbeacon Library,"<p>I would like to use the didEnterRegion method in association with the RegionBootstrap or MonitorNotifier in my application. Currently I'm using the RegionBootstrap but perhaps the MonitorNotifier is better for my application. </p>

<p>In particular I'm adding an iBeacon parser to the beaconmanager and then setting ""Id1"" of a region to look for the UUID portion of my iBeacon and setting ""Id2"" and ""Id3"" to Null. Though they are set to Null in the Region, I would like to be able to parse the information from those locations upon entering the didEnterRegion method. I'm using ""Id2"" (Major) and ""Id3"" (Minor) to provide random identification parameters of the beacons. </p>

<p>This information along with a portion of the data from the UUID would then be sent in a notification to the phone user. When testing, I'm entering the didEnterRegion method but the data that is provided is only that which matches the set region of ""Id1"". If someone could provide any insight at all, it would be greatly appreciated! </p>

<p>I would also like to receive the didEnterRegion method for the same iBeacon every 10 seconds, but with testing it appeared that once that particular iBeacon was seen once, didEnterRegion wouldn't get a subsequent call again. Any way to clear that the iBeacon was captured so that subsequent captures could happen? </p>

<p>I'm trying to keep the battery usage as low as possible and when using the scanRecord data from a onNonBeaconLEScan to parse the information, I'm noticing significant battery drain even when setting the foreground and background time ""BetweenScanPeriod"" to something really large. I really only need to see that the iBeacon entered the region and pull the information, then 10 seconds later do it again. </p>

<p><strong>Intended application flow</strong> - </p>

<ul>
<li>User enters region of beacon with matching UUID (ID1)</li>
<li>Beacon information from ID2 and ID3 are parsed and sent along with ID1 to user via notification</li>
<li>10 seconds later user receives another notification with same data</li>
<li>repeat until person leaves region or iBeacon stops transmitting</li>
</ul>",altbeacon,9676686,Dustin,yes
get sensor data every 1/10th second,"<p>I am trying to log Android sensor data (Accelerometer, Gyro), every 1/10th of a second. Using the Android supplied values (AI, GAME, NORMAL), or user defined values (eg 100000 microseconds) makes absolutely no difference, onSensorChanged is firing every 1/100th of a second. This is bad for both battery life, and the size of logging files ( 60 million events every day to log).</p>

<p>I can make it work using a simple loop, and simply throwing away 9/10 values, but that means you are still registering every event, just not writing it to file, which does not seem ideal.</p>

<p>My next idea was to use a Runnable every 1/10th of a second, that resulted in only getting one of the sensors, not both.</p>

<p>My next Idea was to have a runnable for each sensor, and register and deregister each of them in the runnable:</p>

<pre><code>public void registerAccel(){
    Log.d(TAG, ""registerAccel: on"");
    sensorManager.registerListener(this, mAccelerometer, SensorManager.SENSOR_DELAY_NORMAL);

}

public void unregisterAccel(){
    Log.d(TAG, ""unregisterAccel: off"");
    sensorManager.unregisterListener(this, mAccelerometer);
}



private final Runnable processAccel = new Runnable() {
    @Override
    public void run() {
        Log.d(TAG, ""run: AccelStart"");

        registerAccel();

        mHandler.postDelayed(this, interval);

        unregisterAccel();

    }
};
</code></pre>

<p>This produced no sensor readings, but i noticed even though the runable was running every 1/10th of a second, the whole Runnable was finishing in 1/1000th of a second, which i though might be too fast to register the sensor. So I added a sleep: </p>

<pre><code>private final Runnable processAccel = new Runnable() {
    @Override
    public void run() {
        Log.d(TAG, ""run: AccelStart"");

        registerAccel();

        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        mHandler.postDelayed(this, interval);

        unregisterAccel();

    }
};
</code></pre>

<p>This now keeps the Runnable open for 1/10th of a second, but I am still not receiving any data from the sensors? Basically onSensorChanged is not called while the runnable is running, but if i remove the:</p>

<pre><code>unregisterAccel();
</code></pre>

<p>from the Runnable, it goes back to receiving data every 1/100th of a second.</p>

<p>I am hitting a wall here, I can't think of any other way to get a reading every 10th of a second.</p>

<p>Note this is an app that will run in the background 24/7, so I am trying to do everything I can to minimize the battery drain, and I was really hopeful this would work, as registering then unregistering the sensors seems like the best option, but I guess it may just take longer than 1/10 of a second to do so?</p>

<p>If someone could find a problem with my code, that would be awesome!</p>

<p>EDIT:
OK on further testing, I think I must be misunderstanding something. I tried extending the thread.sleep out to 10 seconds, and still get no OnSensorChanged events, even though the sensor is still registered. This confuses me, as the only thread that should be sleeping is the runnable, the sensor is registered, and OnSensorChanged is not part of the Runnable, so I am unsure why nothing is registering?</p>",android|sensors|runnable|android-sensors,2851268,Geordie Wicks,yes
Location status bar icon displayed when listening for StatusChanged on Geolocator,"<p>I'm building an app for Windows 10 Mobile, and I'd like it to know when the location authorization status changes so it can enable/disable location features. I've run into this issue where users always see the icon indicating that an app is accessing their location in the phone's status bar. It seems that simply adding a listener for StatusChanged (and not for PositionChanged) is enough to cause this icon to appear, which doesn't make sense because the app isn't requesting any location information yet.</p>

<p>I would like to be able to detect authorization status changes even without having gotten the user's location, but this is making users think the app is tracking their location (violating their privacy and draining their battery) even when it isn't.</p>

<p>Is there anything I can do to prevent this icon from appearing when I'm not actually listening for location updates?</p>

<p>Here's some (ugly) code that demonstrates this:</p>

<pre><code>MainPage::MainPage()
{
    InitializeComponent();

    Geolocator::RequestAccessAsync();

    static Geolocator ^g;
    g = ref new Geolocator();
    g-&gt;StatusChanged += ref new Windows::Foundation::TypedEventHandler&lt;Windows::Devices::Geolocation::Geolocator ^, Windows::Devices::Geolocation::StatusChangedEventArgs ^&gt;(this, &amp;LocationIndicatorTest::MainPage::OnStatusChanged);
}


void LocationIndicatorTest::MainPage::OnStatusChanged(Windows::Devices::Geolocation::Geolocator ^sender, Windows::Devices::Geolocation::StatusChangedEventArgs ^args)
{
    OutputDebugStringW(L""Status changed\n"");
}
</code></pre>",windows|windows-10|uwp|windows-10-mobile,5117090,Joe Doe,no
STM32 how to recover from lock up,"<p>I am trying to communicate with an SMBus battery. That has 2 sections so I am using 2 I2C modules. After the first I2C module makes a successful communication second module gets stuck. And it gets stuck in Busy. In that case I thought I need to reset that I2C module. However, I could not do it. </p>

<p>I tried following ways:</p>

<p>1) By using HAL library deiniting and then initing the module again:</p>

<pre><code>HAL_I2C_DeInit(&amp;hi2c1);
HAL_I2C_Init(&amp;hi2c1);
</code></pre>

<p>2) Adding Swrst lines to first method:</p>

<pre><code>//Set Swrst bit
        I2C2-&gt;CR1 |= I2C_CR1_SWRST;
//Clear Swrst bit
    I2C2-&gt;CR1 &amp;= ~(I2C_CR1_SWRST);
    HAL_I2C_DeInit(&amp;hi2c1);
    HAL_I2C_Init(&amp;hi2c1);
</code></pre>

<p>3)</p>

<pre><code> __HAL_RCC_I2C1_CLK_ENABLE();
 __HAL_RCC_I2C1_FORCE_RESET();
 __HAL_RCC_I2C1_RELEASE_RESET();
</code></pre>

<p>4) Using the errata document and this line of codes:</p>

<pre><code>void I2C_Errate_Workaround(int module){

    if(module==1){
        //Disable The I2C's
        I2C1 -&gt; CR1 &amp;= ~(I2C_CR1_PE);
        //Pins are general purpose output open-drain
        GPIOB-&gt;CRL |= 0b01&lt;&lt;24; //I2C1 SCL Open Drain
        GPIOB-&gt;CRL |= 0b01&lt;&lt;28; //I2C1 SDA Open Drain
        //Make SCL/SDA High
        GPIOB-&gt; ODR |= GPIO_ODR_ODR6;
        GPIOB -&gt; ODR |= GPIO_ODR_ODR7;
        //Check whether pins are high
        if((GPIOB-&gt;IDR &amp; GPIO_PIN_6) == GPIO_PIN_RESET || (GPIOB -&gt;IDR &amp; GPIO_PIN_7) == GPIO_PIN_RESET)
        {
            for(;;){}
        }
        //SDA Low Level
        GPIOB-&gt;ODR &amp;= ~(GPIO_ODR_ODR7);
        // Check if SDA pins are really low
        if((GPIOB-&gt;IDR &amp; GPIO_PIN_7)== GPIO_PIN_SET){
            for(;;){}
        }
        // SCL Pin to Low
        GPIOB -&gt; ODR &amp;= ~(GPIO_ODR_ODR6);
        // Check whether SCL pins are cleared
        if((GPIOB-&gt;IDR &amp; GPIO_PIN_6)== GPIO_PIN_SET){
            for(;;){}
        }
        //Configure SCL to High
        GPIOB-&gt;ODR |= GPIO_ODR_ODR6;
        //Check if SCL High
        if((GPIOB-&gt;IDR &amp; GPIO_PIN_6)== GPIO_PIN_RESET)
        {
            for(;;){}
        }
        //Set SDA High
        GPIOB-&gt;ODR |=GPIO_ODR_ODR7;
        //Check if SDA high
        if((GPIOB-&gt;IDR &amp; GPIO_PIN_7)== GPIO_PIN_RESET)
        {
            for(;;){}
        }
        //Set all to alternate function open drain
        GPIOB-&gt;CRL |= 0b11&lt;&lt;24; //I2C1 SCL Open Drain
        GPIOB-&gt;CRL |= 0b11&lt;&lt;28; //I2C1 SDA Open Drain
        //Set Swrst bit
        I2C1-&gt;CR1 |= I2C_CR1_SWRST;
        //Clear Swrst bit
        I2C1-&gt;CR1 &amp;= ~(I2C_CR1_SWRST);
        //Enable I2C modules
        I2C1-&gt;CR1 |= I2C_CR1_PE;
    } else if (module ==2){
        //Disable The I2C's
        I2C2 -&gt; CR1 &amp;= ~( I2C_CR1_PE);
        // Pins are general purpose output open-drain
        GPIOB-&gt;CRH |= 0b01&lt;&lt;8;
        GPIOB-&gt;CRH |= 0b01&lt;&lt;10;
        //Set pins as outputs
        GPIOB -&gt; ODR |= GPIO_ODR_ODR10;
        GPIOB -&gt; ODR |= GPIO_ODR_ODR11;
        //Check whether pins are high
        if((GPIOB -&gt;IDR &amp; GPIO_PIN_11) == GPIO_PIN_RESET || (GPIOB -&gt; IDR &amp; GPIO_PIN_10)== GPIO_PIN_RESET)
        {
            for(;;){}
        }
        //SDA Low Level
        GPIOB -&gt;ODR &amp;= ~(GPIO_ODR_ODR11);
        // Check if SDA pins are really low
        if((GPIOB-&gt;IDR &amp; GPIO_PIN_11)== GPIO_PIN_SET)
        {
            for(;;){}
        }
        // SCL Pins to Low
        GPIOB -&gt; ODR &amp;= ~(GPIO_ODR_ODR10);
        // Check whether SCL pins are cleared
        if((GPIOB-&gt;IDR &amp; GPIO_PIN_10)== GPIO_PIN_SET)
        {
            for(;;){}
        }
        //Configure SCL to High
        GPIOB-&gt;ODR |= GPIO_ODR_ODR10;
        //Check if SCL High
        if((GPIOB-&gt; IDR &amp; GPIO_PIN_10)== GPIO_PIN_RESET)
        {
            for(;;){}
        }
        //Set SDA High
        GPIOB-&gt;ODR |= GPIO_ODR_ODR11;

        //Check if SDA high
        if((GPIOB-&gt;IDR &amp; GPIO_PIN_11)== GPIO_PIN_RESET)
        {
            for(;;){}
        }
        //Set all to alternate function open drain
        GPIOB-&gt;CRH |= 0b11&lt;&lt;8; // I2C2 SCL Open Drain
        GPIOB-&gt;CRH |= 0b11&lt;&lt;10; //I2C2 SDA Open Drain
        //Set Swrst bit
        I2C2-&gt;CR1 |= I2C_CR1_SWRST;
        //Clear Swrst bit
        I2C2-&gt;CR1 &amp;= ~(I2C_CR1_SWRST);
        //Enable I2C modules
        I2C2-&gt;CR1 |= I2C_CR1_PE;
    }
}
</code></pre>

<p>Is there a proper way to reset the I2C module in STM32? How can I recover from a lockup? </p>

<p>Edit: I am using STM32F103C8. Now I added MX_GPIO_Init function and I can reset the modules : </p>

<pre><code>        HAL_I2C_DeInit(&amp;hi2c2);
        osDelay(50);
        MX_GPIO_Init();
        HAL_I2C_Init(&amp;hi2c2);
</code></pre>

<p>But second module in the transmission always fails. If I use hi2c1 first then hi2c2 then hi2c2 fails. If I use hi2c2 first then vice versa. I tried to disable first module then try to communicate with second one but that did not work neither.</p>",arm|stm32|i2c|smbus|lockup,10961392,Günkut Ağabeyoğlu,yes
Acquiring GPS data from mobile browser,"<p>I'm working on a project where I'm supposed to get the GPS location coordinates from a delivery man and send it to a server. I've searched for a script that allows me to do so, and I'm sending data every 5 seconds. The problem is that if I lock the phone (I tried it on safari/iphone and chrome/android phones) the browser stops refreshing and I can't get data anymore. And if i do not lock the phone, the screen, being turned on, will drain my battery...</p>",browser|background|refresh,4818703,Kevin Zero,yes
How to continuous replicate data in background,"<p>In my ios app I have setup pull replication. Here is code</p>

<pre><code>- (void) prepareCouchBaseAuthentication : (NSArray *)arrUserId {
NSError* error;

CBLManager* mng = [CBLManager sharedInstance];
CBLDatabase *database = [mng databaseNamed: kDatabaseScore error: &amp;error];

if (!database) {
    [self showAlert: @""Couldn't open database"" error: error fatal: YES];
    return;
}

NSURL* serverDbURL = [NSURL URLWithString: kServerScoreURL];


objAppDelegete.pull = [database createPullReplication: serverDbURL];
objAppDelegete.pull.continuous =YES;

objAppDelegete.pull.channels = arrUserId;


NSNotificationCenter* nctr1 = [NSNotificationCenter defaultCenter];
[nctr1 addObserver: self selector: @selector(replicationProgressScore:)
              name: kCBLReplicationChangeNotification object: objAppDelegete.pull];

[objAppDelegete.pull start];
}
</code></pre>

<p>I have tried to call this function with NSThread as suggested in couchbase documentation </p>

<pre><code>[NSThread detachNewThreadSelector: @selector(prepareCouchBaseAuthentication) toTarget:self  withObject: nil];
</code></pre>

<p>But after sometime it stop syncing ? is there any exception while syncing. How can i check if any exception occured? </p>

<p>My requirement is continuous  sync live feed from couchserver. Yes it will drain battery.
Is there any suggestion to do this?</p>",ios|couchbase|couchbase-lite,904829,soniji,no
Android Training Sample- Scheduler Sample- unable to stop alarm,"<p>I am using the sample code(Scheduler.zip) available on the Android developer training website- <a href=""http://developer.android.com/training/scheduling/index.html"" rel=""nofollow"">http://developer.android.com/training/scheduling/index.html</a></p>

<p>Here's the code:-</p>

<p>MainActivity.java</p>

<pre><code>/*
 * Copyright 2013 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the ""License"");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an ""AS IS"" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.example.android.scheduler;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuItem;


/**
 * This sample demonstrates how to schedule an alarm that causes a service to
 * be started. This is useful when you want to schedule alarms that initiate
 * long-running operations, such as retrieving a daily forecast.
 * This particular sample retrieves content from the Google home page once a day and  
 * checks it for the search string ""doodle"". If it finds this string, that indicates 
 * that the page contains a custom doodle instead of the standard Google logo.
 */
public class MainActivity extends Activity {
    SampleAlarmReceiver alarm = new SampleAlarmReceiver();

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

    // Menu options to set and cancel the alarm.
    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
            // When the user clicks START ALARM, set the alarm.
            case R.id.start_action:
                alarm.setAlarm(this);
                return true;
            // When the user clicks CANCEL ALARM, cancel the alarm. 
            case R.id.cancel_action:

                alarm.cancelAlarm(this);
                return true;
        }
        return false;
    }
}
</code></pre>

<p>SampleAlarmReceiver.java</p>

<pre><code>package com.example.android.scheduler;

import android.app.AlarmManager;
import android.app.PendingIntent;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.pm.PackageManager;
import android.support.v4.content.WakefulBroadcastReceiver;

import java.util.Calendar;

/**
 * When the alarm fires, this WakefulBroadcastReceiver receives the broadcast Intent 
 * and then starts the IntentService {@code SampleSchedulingService} to do some work.
 */
public class SampleAlarmReceiver extends WakefulBroadcastReceiver {
    // The app's AlarmManager, which provides access to the system alarm services.
    private AlarmManager alarmMgr;
    // The pending intent that is triggered when the alarm fires.
    private PendingIntent alarmIntent;

    @Override
    public void onReceive(Context context, Intent intent) {   
        // BEGIN_INCLUDE(alarm_onreceive)
        /* 
         * If your receiver intent includes extras that need to be passed along to the
         * service, use setComponent() to indicate that the service should handle the
         * receiver's intent. For example:
         * 
         * ComponentName comp = new ComponentName(context.getPackageName(), 
         *      MyService.class.getName());
         *
         * // This intent passed in this call will include the wake lock extra as well as 
         * // the receiver intent contents.
         * startWakefulService(context, (intent.setComponent(comp)));
         * 
         * In this example, we simply create a new intent to deliver to the service.
         * This intent holds an extra identifying the wake lock.
         */
        Intent service = new Intent(context, SampleSchedulingService.class);

        // Start the service, keeping the device awake while it is launching.
        startWakefulService(context, service);
        // END_INCLUDE(alarm_onreceive)
    }

    // BEGIN_INCLUDE(set_alarm)
    /**
     * Sets a repeating alarm that runs once a day at approximately 8:30 a.m. When the
     * alarm fires, the app broadcasts an Intent to this WakefulBroadcastReceiver.
     * @param context
     */
    public void setAlarm(Context context) {
        alarmMgr = (AlarmManager)context.getSystemService(Context.ALARM_SERVICE);
        Intent intent = new Intent(context, SampleAlarmReceiver.class);
        alarmIntent = PendingIntent.getBroadcast(context, 0, intent, 0);

        Calendar calendar = Calendar.getInstance();
        calendar.setTimeInMillis(System.currentTimeMillis());
        // Set the alarm's trigger time to 8:30 a.m.
        calendar.set(Calendar.HOUR_OF_DAY, 8);
        calendar.set(Calendar.MINUTE, 30);

        /* 
         * If you don't have precise time requirements, use an inexact repeating alarm
         * the minimize the drain on the device battery.
         * 
         * The call below specifies the alarm type, the trigger time, the interval at
         * which the alarm is fired, and the alarm's associated PendingIntent.
         * It uses the alarm type RTC_WAKEUP (""Real Time Clock"" wake up), which wakes up 
         * the device and triggers the alarm according to the time of the device's clock. 
         * 
         * Alternatively, you can use the alarm type ELAPSED_REALTIME_WAKEUP to trigger 
         * an alarm based on how much time has elapsed since the device was booted. This 
         * is the preferred choice if your alarm is based on elapsed time--for example, if 
         * you simply want your alarm to fire every 60 minutes. You only need to use 
         * RTC_WAKEUP if you want your alarm to fire at a particular date/time. Remember 
         * that clock-based time may not translate well to other locales, and that your 
         * app's behavior could be affected by the user changing the device's time setting.
         * 
         * Here are some examples of ELAPSED_REALTIME_WAKEUP:
         * 
         * // Wake up the device to fire a one-time alarm in one minute.
         * alarmMgr.set(AlarmManager.ELAPSED_REALTIME_WAKEUP, 
         *         SystemClock.elapsedRealtime() +
         *         60*1000, alarmIntent);
         *        
         * // Wake up the device to fire the alarm in 30 minutes, and every 30 minutes
         * // after that.
         * alarmMgr.setInexactRepeating(AlarmManager.ELAPSED_REALTIME_WAKEUP, 
         *         AlarmManager.INTERVAL_HALF_HOUR, 
         *         AlarmManager.INTERVAL_HALF_HOUR, alarmIntent);
         */

        // Set the alarm to fire at approximately 8:30 a.m., according to the device's
        // clock, and to repeat once a day.
        alarmMgr.setInexactRepeating(AlarmManager.RTC_WAKEUP,  
                calendar.getTimeInMillis(), 2*60*1000, alarmIntent);



        // Enable {@code SampleBootReceiver} to automatically restart the alarm when the
        // device is rebooted.
        ComponentName receiver = new ComponentName(context, SampleBootReceiver.class);
        PackageManager pm = context.getPackageManager();

        pm.setComponentEnabledSetting(receiver,
                PackageManager.COMPONENT_ENABLED_STATE_ENABLED,
                PackageManager.DONT_KILL_APP);           
    }
    // END_INCLUDE(set_alarm)

    /**
     * Cancels the alarm.
     * @param context
     */
    // BEGIN_INCLUDE(cancel_alarm)
    public void cancelAlarm(Context context) {
        // If the alarm has been set, cancel it.
        if (alarmMgr!= null) {
            alarmMgr.cancel(alarmIntent);
        }

        // Disable {@code SampleBootReceiver} so that it doesn't automatically restart the 
        // alarm when the device is rebooted.
        ComponentName receiver = new ComponentName(context, SampleBootReceiver.class);
        PackageManager pm = context.getPackageManager();

        pm.setComponentEnabledSetting(receiver,
                PackageManager.COMPONENT_ENABLED_STATE_DISABLED,
                PackageManager.DONT_KILL_APP);
    }
    // END_INCLUDE(cancel_alarm)
}
</code></pre>

<p>SampleBootReceiver.java</p>

<pre><code>package com.example.android.scheduler;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

/**
 * This BroadcastReceiver automatically (re)starts the alarm when the device is
 * rebooted. This receiver is set to be disabled (android:enabled=""false"") in the
 * application's manifest file. When the user sets the alarm, the receiver is enabled.
 * When the user cancels the alarm, the receiver is disabled, so that rebooting the
 * device will not trigger this receiver.
 */
// BEGIN_INCLUDE(autostart)
public class SampleBootReceiver extends BroadcastReceiver {
    SampleAlarmReceiver alarm = new SampleAlarmReceiver();
    @Override
    public void onReceive(Context context, Intent intent) {
        if (intent.getAction().equals(""android.intent.action.BOOT_COMPLETED""))
        {
            alarm.setAlarm(context);
        }
    }
}
//END_INCLUDE(autostart)
</code></pre>

<p>SampleSchedulingService.java</p>

<pre><code>package com.example.android.scheduler;

import android.app.IntentService;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.support.v4.app.NotificationCompat;
import android.util.Log;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;

/**
 * This {@code IntentService} does the app's actual work.
 * {@code SampleAlarmReceiver} (a {@code WakefulBroadcastReceiver}) holds a
 * partial wake lock for this service while the service does its work. When the
 * service is finished, it calls {@code completeWakefulIntent()} to release the
 * wake lock.
 */
public class SampleSchedulingService extends IntentService {
    public SampleSchedulingService() {
        super(""SchedulingService"");
    }

    public static final String TAG = ""Scheduling Demo"";
    // An ID used to post the notification.
    public static final int NOTIFICATION_ID = 1;
    // The string the app searches for in the Google home page content. If the app finds 
    // the string, it indicates the presence of a doodle.  
    public static final String SEARCH_STRING = ""doodle"";
    // The Google home page URL from which the app fetches content.
    // You can find a list of other Google domains with possible doodles here:
    // http://en.wikipedia.org/wiki/List_of_Google_domains
    public static final String URL = ""http://www.google.com"";
    private NotificationManager mNotificationManager;
    NotificationCompat.Builder builder;

    @Override
    protected void onHandleIntent(Intent intent) {
        // BEGIN_INCLUDE(service_onhandle)
        // The URL from which to fetch content.
        String urlString = URL;

        String result ="""";

        // Try to connect to the Google homepage and download content.
        try {
            result = loadFromNetwork(urlString);
        } catch (IOException e) {
            Log.i(TAG, getString(R.string.connection_error));
        }

        // If the app finds the string ""doodle"" in the Google home page content, it
        // indicates the presence of a doodle. Post a ""Doodle Alert"" notification.
        if (result.indexOf(SEARCH_STRING) != -1) {
            sendNotification(getString(R.string.doodle_found));
            Log.i(TAG, ""Found doodle!!"");
        } else {
            sendNotification(getString(R.string.no_doodle));
            Log.i(TAG, ""No doodle found. :-("");
        }
        // Release the wake lock provided by the BroadcastReceiver.
        SampleAlarmReceiver.completeWakefulIntent(intent);
        // END_INCLUDE(service_onhandle)
    }

    // Post a notification indicating whether a doodle was found.
    private void sendNotification(String msg) {
        mNotificationManager = (NotificationManager)
               this.getSystemService(Context.NOTIFICATION_SERVICE);

        PendingIntent contentIntent = PendingIntent.getActivity(this, 0,
            new Intent(this, MainActivity.class), 0);

        NotificationCompat.Builder mBuilder =
                new NotificationCompat.Builder(this)
        .setSmallIcon(R.drawable.ic_launcher)
        .setContentTitle(getString(R.string.doodle_alert))
        .setStyle(new NotificationCompat.BigTextStyle()
        .bigText(msg))
        .setContentText(msg);

        mBuilder.setContentIntent(contentIntent);
        mNotificationManager.notify(NOTIFICATION_ID, mBuilder.build());
    }

//
// The methods below this line fetch content from the specified URL and return the
// content as a string.
//
    /** Given a URL string, initiate a fetch operation. */
    private String loadFromNetwork(String urlString) throws IOException {
        InputStream stream = null;
        String str ="""";

        try {
            stream = downloadUrl(urlString);
            str = readIt(stream);
        } finally {
            if (stream != null) {
                stream.close();
            }      
        }
        return str;
    }

    /**
     * Given a string representation of a URL, sets up a connection and gets
     * an input stream.
     * @param urlString A string representation of a URL.
     * @return An InputStream retrieved from a successful HttpURLConnection.
     * @throws IOException
     */
    private InputStream downloadUrl(String urlString) throws IOException {

        URL url = new URL(urlString);
        HttpURLConnection conn = (HttpURLConnection) url.openConnection();
        conn.setReadTimeout(10000 /* milliseconds */);
        conn.setConnectTimeout(15000 /* milliseconds */);
        conn.setRequestMethod(""GET"");
        conn.setDoInput(true);
        // Start the query
        conn.connect();
        InputStream stream = conn.getInputStream();
        return stream;
    }

    /** 
     * Reads an InputStream and converts it to a String.
     * @param stream InputStream containing HTML from www.google.com.
     * @return String version of InputStream.
     * @throws IOException
     */
    private String readIt(InputStream stream) throws IOException {

        StringBuilder builder = new StringBuilder();
        BufferedReader reader = new BufferedReader(new InputStreamReader(stream));
        for(String line = reader.readLine(); line != null; line = reader.readLine()) 
            builder.append(line);
        reader.close();
        return builder.toString();

    }
}
</code></pre>

<p>I had to add the android-support-v4.jar file to the build path first of all to make it work.</p>

<p>I am getting notifications after every 2 mins, but on clicking the ""Cancel Alarm"" button, the alarm is not getting canceled.</p>

<p>So , I tried removing the if condition in the cancelAlarm function, but I then got a java.nullpointerexception.</p>

<p>So basically, the alarmMgr is becoming null.</p>

<p>But, I am not able to understand why.</p>

<p>Also, since this is a sample code, I think there must be no errors in it, so I must be missing out on something.</p>",android|android-intent|alarmmanager|alarm,3709792,Naman Sancheti,yes
Live challenge/response between users,"<p>I'm building a game where I'd like 2 players to fight live between their 2 character.</p>

<p>Here is the desired flow :</p>

<ul>
<li>User picks a friend in his friends list and click ""fight him""</li>
<li>Picked friend receives a notification ( even if the app is in the background )</li>
<li>Picked friend accept the challenge</li>
<li>Both players fight</li>
</ul>

<p>The way I want to do it is by using a permanent TCP connection sitting in the background ( service ). I'm afraid of the battery drain it implies. Is there any API/library designed to solve the problem I'm tackling ?</p>",android|tcp|network-programming|push-notification,601659,Alex,yes
Doze mode is making critical to my app,"<p>I think this question is asked many time in stackoverflow but still so many people struggling to resolved it.</p>

<p>In my android app I have to wake up device for every 30 minutes to getting current location and send it to server. For this I have used AlarmManager with setExactAndAllowWhileIdle() method and WakefulBroadcastReceiver. Its working fine in almost all standard/popular devices, But some other devices mostly china devices not supporting or cannot allow device wake up from doze mode with setExactAndAllowWhileIdle(). I have tested it in Moto G4 plus(Android OS 6.1) device which not allow alarm manager to wake up in specific interval.</p>

<p>I am using AlarmManager to call wakefulBroadcastReceiver, which trigers wakefulIntentservice to perform background task. but its draining battery critically and also in doze mode(Nougat), its not doing background task. other than else, its capturing data from backend service.</p>

<pre><code>my code is here-&gt;&gt;

        // Setup periodic alarm every 30 minutes
        if (android.os.Build.VERSION.SDK_INT &gt;= 23) {
            syncDbAlarmManager.setAndAllowWhileIdle(AlarmManager.ELAPSED_REALTIME_WAKEUP,
                    intervalMillis, pIntent);
        } else if (android.os.Build.VERSION.SDK_INT &gt;= 19
                &amp;&amp; android.os.Build.VERSION.SDK_INT &lt; 23){
            syncDbAlarmManager.setInexactRepeating(AlarmManager.RTC_WAKEUP, triggerAtMillis/*firstMillis*/,
                    intervalMillis, pIntent);
        } else {
            syncDbAlarmManager.setRepeating(AlarmManager.RTC_WAKEUP, triggerAtMillis/*firstMillis*/,
                    intervalMillis, pIntent);
        }
</code></pre>

<p>I have used PowerManager also--></p>

<pre><code>PowerManager powerManager = (PowerManager) context.getSystemService(POWER_SERVICE);
PowerManager.WakeLock wakeLock = powerManager.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,
        ""com.example.johnbravado"");
wakeLock.acquire();
// Do Work
MyConstants.getInstance().msgReqAction(intent.getIntExtra(MyConstants.BROADCAST_DATA_REQ, 0));

wakeLock.release();
</code></pre>",android|android-doze,6819563,Ashish Patel,no
How to change location intervals with something like PUSH notifications,"<p>My app is able to track the user even if the app is in background or killed and send the currents lat and long to the server.
I am using FusedLocationApi for this with a PendingIntent. My question is how can i change the interval of LocationRequest if my app is not running in foreground ?</p>

<p>I want to do something like catch the PUSH notification which firebase provide and then change this intervals, but it's not possible.</p>

<p>It would drain too much battery if i set the intervals (setInterval,setFastestInterval and setPriority) to the most frecuency and HIGH_ACCURACY and only catch in the server some of this request, and then when i want to get more frecuency, catch all the location requests?</p>

<p>Is it possible to avoid making the client (the user smartphone) work like a server that wait for a notification, like firebase? </p>

<p>EDIT:
What i'm trying it seems to work but i still have the problem of comunication.
I create a service and 2 differents types of API FusedLocationServices and 1 work at the moment and the other just wait for a signal from the server to start sending location... And that's exactly what i want to know how to do in a good way. How to listening to the server continuously ?? There exists a way like the onMessageReceived of firebase??</p>",android|push-notification|geolocation|android-location,6376349,MatiRC,no
Subscribe and Unsubscribe on Each Emitted Item,"<p>I am using the <a href=""https://github.com/mcharmas/Android-ReactiveLocation"" rel=""nofollow"">reactive-location</a> lib.</p>

<p>My use case is that I have a stream of objects emitted from an observable. These items can be emitted potentially every few hours. As soon as an item is emitted I want to obtain a location and using zipWith(as far as I can understand) emit an object containing the location.</p>

<p>The problem is: as the objects will only be emitted once every few hours, I cannot keep the location observable hot as it would drain the battery.</p>

<p>So I need the following: once an object is passed into the stream, subscribe to the location observable once a location is obtained, unsubscribe to the location observable. This must be done continuously.</p>

<p>As far as I understand this transformer takes care of unsubscribing</p>

<pre><code>public &lt;T&gt; Observable.Transformer&lt;T, T&gt; takeNextAndUnsubscribe() {
    return new Observable.Transformer&lt;T, T&gt;() {

        @Override
        public Observable&lt;T&gt; call(Observable&lt;T&gt; tObservable) {
            final BehaviorSubject subject = BehaviorSubject.create();
            Observable source = tObservable.doOnNext(new Action1&lt;T&gt;() {
                @Override
                public void call(T t) {
                    subject.onNext(t);
                }
            });
            return Observable
                    .merge(source.takeUntil(subject), subject)
                    .take(1);
        }

    };
}
</code></pre>

<p>But how would I subscribe again once a new object is sent down the stream?</p>",java|android|reactive-programming|rx-java|rx-android,690681,jiduvah,yes
android - get light level every ten 10 minutes,"<p>My app needs to have an updated light level value (a 10-15 minute delay is fine or something) (this is not a commercial app) within its background service....</p>

<p>I know how to retrieve the light value using a SensorEventListener and the SensorManager but in the API docs it says explicitly that if you don't unregister the listener when you don't need it it will drain your battery in just a few hours. </p>

<p>now my question is....how can I use the listener along with the sensor manager to retrieve a light level value every 10-15 minutes?</p>

<p>Could I use something like the below with a Timer that runs this task every 10-15 minutes?</p>

<pre><code>    private TimerTask lightSensorTimer  = new TimerTask() {

    @Override
    public void run() {

        if (sensorManager != null)  {

            Sensor lightSensor = sensorManager.getDefaultSensor(Sensor.TYPE_LIGHT);

            if (lightSensor != null) {

                sensorManager.registerListener(sensorListener, lightSensor, SensorManager.SENSOR_DELAY_NORMAL);

                while (newLightLevel == lightLevel) {
                    try {

                        **Thread.sleep(1000);**

                    } catch (InterruptedException e) {

                        Log.e(TAG, ""Interrupted exception in lightsensor timer: "" + e.getMessage());

                    }
                }
                PhoneEvents.this.lightLevel = PhoneEvents.this.newLightLevel;

                sensorManager.unregisterListener(sensorListener, lightSensor);
            }
        }

    }

};
</code></pre>

<p>The sensoreventlistener does nothing but this:</p>

<pre><code>    private SensorEventListener sensorListener = new SensorEventListener() {

    public void onSensorChanged(SensorEvent event) {

        if (event.sensor.getType() == Sensor.TYPE_LIGHT) {

            PhoneEvents.this.newLightLevel = event.values[0];

        }
    }

    public void onAccuracyChanged(Sensor arg0, int arg1) {

    }

};
</code></pre>

<p>I'm not even sure if you can use Thread.sleep within a timer task. But I have ready that TimerTasks need to finish quickly otherwise they batch up.</p>

<p>Is there a cleaner solution for something like this?</p>

<p>Thanks</p>

<p>Regards, 
Andreas</p>",android|timer|listener|sensors|light,364387,kkudi,yes
Android debugging -> battery drains,"<p>Have you noticed a significant battery drain when debugging Android application on the phone? </p>

<p>Also, does a lot of Log.d() messages drains the battery?</p>",android|debugging|power-management,437039,sandalone,no
ActivityRecognitionAPI keeps sending pending intents to the service,"<p>I am using <a href=""https://developers.google.com/android/reference/com/google/android/gms/location/ActivityRecognitionApi"" rel=""nofollow"">ActivityRecognitionAPI</a> in Android 4.4.2 to detect activities on the phone. I am using <a href=""https://github.com/googlesamples/android-play-location/tree/master/ActivityRecognition"" rel=""nofollow"">this</a> code to implement this. </p>

<p>The code requests for activity updates after every 15 seconds (I know, the documentation says that this is the upper bound but I have only this app on my device which requests this information) but the app keeps sending intents after every 3-4 seconds. I was thinking to save some battery based on activity but I guess, it would be draining more of it. Any suggestions for improvement?</p>

<p>Trimmed version of logs:</p>

<pre><code>06-01 19:58:19.774:  Still 100%
06-01 19:58:23.414:  ACCCCCCCCCCTOVOTTTTTTESSS detected
06-01 19:58:27.104:  ACCCCCCCCCCTOVOTTTTTTESSS detected
06-01 19:58:27.104:  Still 100%
06-01 19:58:30.744:  ACCCCCCCCCCTOVOTTTTTTESSS detected
06-01 19:58:30.744:  Still 100%
06-01 19:58:34.424:  ACCCCCCCCCCTOVOTTTTTTESSS detected
06-01 19:58:34.424:  Still 100%
06-01 19:58:38.064:  ACCCCCCCCCCTOVOTTTTTTESSS detected
06-01 19:58:38.064:  Still 100%
06-01 19:58:41.684:  ACCCCCCCCCCTOVOTTTTTTESSS detected
06-01 19:58:41.684:  Still 100%
06-01 19:58:46.544:  ACCCCCCCCCCTOVOTTTTTTESSS detected
06-01 19:58:46.544:  Still 100%
06-01 19:58:50.224:  ACCCCCCCCCCTOVOTTTTTTESSS detected
06-01 19:58:50.224:  Still 100%
</code></pre>",android|activity-recognition,4927041,Max Testing,yes
startMonitoringSignificantLocationChanges called every 47 sec while application in background,"<p><code>startMonitoringSignificantLocationChanges</code> is added for background and delegate ""<code>- (void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations</code>""  is called in every <code>47 sec</code> while application in background.
If application is on same place i don't want to hit the server api to submit the location, if location has changed then I want to submit the lat&amp; long to server.</p>

<p>It's drain the iphone battery. I want to save battery drain which occured by our application.</p>

<p>Please suggest.</p>",ios|objective-c|cllocationmanager,664308,Gauri Shankar,yes
"Could AltBeacon library be used to wake up my app as soon as a beacon comes in range, even on Android 8+?","<p>I wish to code an app that a user installs and then forgets about it. When his/her android smartphone detects a beacon on a street (I don't care about distance, RSSI power,...), it launches my app. Is there a way to react as soon a the beacon is found without draining the battery or having scans occur every 15 min or so in Android 8+? What happens if the user moves along a street where are located 2+ beacons? Can he/she detect the other ones too as soon as he/she approaches them?
Can AltBeacon library suit my needs?</p>

<p>I rapidly read the AltBeacon documentation, just to find if my project could be realistic, but I don't still have a clear vision of the BLE limitations on Android.</p>

<p>Perhaps it's better if I spend a couple more words on what I am trying to code. I wish to place a beacon in 30-40 shops of different kind (clothes, food, services,...) in a relatively small area. When a user, with my app installed (but not running) on his android smartphone, passes by one of those shops, my app shoud wake itself up and notify him that in shop XY there is a particular offer.</p>

<p>So, before I dive into learning Java and Android Studio (I usually code in Delphi), I want to be sure that:</p>

<p>1) Could my app detect the beacon X in shop A and, 2 minutes later, when the user cross the street and gets closer to shop B, detect its beacon Y too? Will the 15 minutes limitation keep me from detecting beacon Y (and all the others)?</p>

<p>2) I don't care about distances between the user and the shops: if my app ""sees"" beacon X it's sufficient to trigger a notification of an offer. Will this requirement drain the user's phone battery?</p>

<p>Regards,
Filippo</p>

<p>Thank you very much,
Filippo</p>",android|altbeacon,11447616,Pino,no
Android battery draining rate,"<p>I'm trying to design an app which changes it's behaviour according to battery draining rate.
That is, there are two states state1 and state2.
it checks for draining rate of each state. 
and switches over to the particular state which drains less battery.</p>

<p>so is it possible to check the draining rate of my app (in particular).
ps: both the states use display and network connections.</p>

<p>if yes how can I get the draining rate?</p>

<p>I've noticed in the Battery options of android setting contains per app battery usage can I access these values?</p>",android|battery|batterylevel|battery-saver,3162583,Ak-,no
CWAC Camera - turn off preview to save battery?,"<p>I'm developing an app that needs to take photos in a time lapse fashion. I'm using CWAC Camera for android. The overall period in which to take these may be long, so constantly showing the preview drains battery fast. I'm wondering how to pause the preview for the timeout period. </p>

<p>The CameraView appears to have a restartPrewiew() method, but there's no stopPreview() or anything else similar that I could find.</p>

<p>In the source <a href=""https://github.com/commonsguy/cwac-camera/blob/master/camera/src/com/commonsware/cwac/camera/CameraView.java#L529"" rel=""nofollow"">here</a> there is a stopPreview() method, but it's private. </p>

<p>Does anyone know how to stop and restart preview to save battery? Any help much appreciated!</p>",android|camera,1291637,Solipsy,yes
How to detect loss of internet reachability when wifi source loses connection?,"<p>I am trying hard to get the authentic internet connectivity status. I have used Apple's Reachability but it's only giving me the status of wifi connectivity i.e. not covering the case when the device is connected via wifi (to a router or hotspot), but the wifi router or hotspot itself is not connected to the internet. This scenario is reproducible by pulling the internet input cable from wifi router. The reachability's notifier returns <code>ReachableViaWiFi</code> for both <code>reachabilityForInternetConnection</code> and <code>ReachabilityWithHostName</code>. I am quite much in a fix with this issue. I tried it via the <code>NSURLConnection</code> too but that's draining battery too much and personally I don't like that solution to keep making URL requests, though in a background thread.</p>

<p>Here's the code that I am using (courtesy of an SO fellow, don't remember the exact link though)</p>

<pre><code> [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(checkNetworkStatus:) name:kReachabilityChangedNotification object:nil];

    internetReachable = [[Reachability reachabilityForInternetConnection] retain];
    [internetReachable startNotifier];

    // check if a pathway to a random host exists
    hostReachable = [[Reachability reachabilityWithHostName: @""www.google.com""] retain];
    [hostReachable startNotifier];
</code></pre>

<p>then in the observer method:</p>

<pre><code> - (void) checkNetworkStatus:(NSNotification *)notice{

    // called after network status changes

    NetworkStatus internetStatus = [internetReachable currentReachabilityStatus];
    switch (internetStatus)

    {
        case NotReachable:
        {
            NSLog(@""The internet is down."");
            self.isInternetReachable = NO;

            break;

        }
        case ReachableViaWiFi:
        {
            NSLog(@""The internet is working via WIFI."");
            self.isInternetReachable = YES;

            break;

        }
        case ReachableViaWWAN:
        {
            NSLog(@""The internet is working via WWAN."");
            self.isInternetReachable = YES;

            break;

        }
    }
    NetworkStatus hostStatus = [hostReachable currentReachabilityStatus];
    switch (hostStatus)

    {
        case NotReachable:
        {
            NSLog(@""A gateway to the host server is down."");
            self.isHostReachable = NO;

            break;

        }
        case ReachableViaWiFi:
        {
            NSLog(@""A gateway to the host server is working via WIFI."");
            self.isHostReachable = YES;

            break;

        }
        case ReachableViaWWAN:
        {
            NSLog(@""A gateway to the host server is working via WWAN."");
            self.isHostReachable = YES;

            break;

        }
}
}
</code></pre>",iphone|ios|objective-c|reachability,804389,Ahmed,yes
Apple Push Notification Service - Does iOS keep an open connection to every registered APNS server?,"<p>If I understand correctly, each application that registers as an APNS provider, basically forces the iPhone to keep a live connection to a specific server.
If so, doesn't it mean that the more apps I use (that register APNS), the more battery drain I will experience?</p>

<p>Would it not be wiser of Apple to allow developers to tap into a big server cluster that will distribute notifications to all devices in the world?</p>",ios|apple-push-notifications,261647,Dor,no
iOS: How to to notify a user on reaching near to a store,"<p>I am writing an application that should alert the user on reaching near (with in 300 meters) to a specified retail store. </p>

<p>I am using the API </p>

<p><code>[locationManager startMonitoringForRegion:grRegion desiredAccuracy:acc];</code></p>

<p>but not able to get the events for enter and exit region. </p>

<p>My Questions are</p>

<ol>
<li>How accurate is this API. Will it me accurate to fire the event if we specify the 300 meter range. Or this event will be fired only when the user changed from one cellular tower to another?</li>
<li>If it is not able to get events with in 300 meters, How can I implement my requirement. </li>
</ol>

<p>PS:- I don't want to use the API <code>[locationManager startUpdatingLocation];</code> as it would drain the battery quite quickly. </p>

<p>Thanks in advance.</p>",ios|geolocation|core-location,669337,M S,no
Battery drain issue while using iBeacons in iOS application,"<p>I am developing an iOS7+ application with <code>iBeacon</code> technology(Using  estimote sdk 2.3.2). Now i am facing device battery drain issue while the app is running in foreground and background.
Has any option for ranging <code>iBeacons</code> without using <code>CLLocationManager</code>? </p>",ios|objective-c|cllocationmanager|ibeacon,811876,John,yes
Updating iOS application data,"<p>I was wondering how some existing apps refresh their application data while the app isn't running. Lets say we have a rain alarm application. This application send you a (local?) notification when its about to rain in your current location or location you've manually entered. What's the best way to achieve something like this?</p>

<p>Is the application getting weather data on the device itself (even when the application is killed) to send a local notification when its about to rain? Doesn't this method drains the battery of my device?</p>

<p>Or do I need to create a standalone application which runs 24/7 and always checks the weather? It then searches a database to see who's device needs a remote notification.</p>

<p>Other methods are also appreciated.</p>",ios|objective-c|updates|weather-api,1649021,Mark Molina,no
Find out which apps are using Battery Life,"<p>My devices are having power issues.  The battery is not lasting as long as we would like.  </p>

<p>There are several components that I could guess are causing the battery issues.  </p>

<p>Right now the best way I can see to find the culprit is to go through one by one and disable each of them, then conduct a test (that is about 6 hours long).</p>

<p>To get a true view of what is going on this would mean weeks of testing each part.  </p>

<p>Is there a better way?  Something that can measure power consumption on a windows mobile device?  Maybe show battery drain against CPU cycles or something like that?</p>

<p>Any help is appreciated. </p>",windows-mobile|windows-mobile-5.0,16241,Vaccano,yes
Firebase JobScheduling in the cloud | How to use the Server SDK for JobScheduling,"<p>I've seen lots of APIs for Job Scheduling, if I may mention:</p>

<ul>
<li><code>AlarmManager</code></li>
<li><code>JobScheduler</code></li>
<li><code>JobSchedulerCompat</code></li>
<li><code>GCMNetworkManager</code></li>
</ul>

<p>And what I'm trying to do is, a user sets a date along with a campaign, he saved it in Firebase, and when that date comes, that created object gets deleted. I've seen something similar with Parse, but as you might know, it's shutting down and I'm storing my data in Firebase anyways.</p>

<p>However, <strong><code>AlarmManager</code></strong> surely doesn't do the task in the <strong>cloud</strong> (<em>The service doesn't run on the device, but in the cloud.</em>)</p>

<p><strong><code>JobScheduler</code></strong> is not available for pre-lollipop.</p>

<p><strong><code>JobSchedulerCompat</code></strong> is deprecated ""<em>There's no guarantee this won't explode your device or drain your battery</em>"" and I don't think it runs in the cloud anyways.</p>

<p>And I'm not sure about <code>GCMNetworkManager</code>. Does it run in the cloud or is it on the device? <strong>Tough example:</strong> If every single user who uses my app has his device shut down, will the task still be completed? </p>

<hr>

<p><strong>Long question short:</strong> Does <code>GCMNetworkManager</code> run in the cloud? If not, what alternatives do I have?</p>

<hr>

<p><strong>Edit:</strong> @qbix's answer gave me a hint, but I still cannot understand anything from that link. If anyone answers my question along with an example, he will be awarded the bounty. This includes @qbix.</p>",java|android|firebase|jobs|gcm-network-manager,3921295,Ali Bdeir,yes
Use IntentService with PendingIntent to receive background location updates,"<p>I searched a lot everywhere and I am using LocationListener to get location update but once application is removed from background, location update stops.</p>
<p>Then I used a service for location update (I clicked &quot;Allow all the time&quot;), and its working just perfect but the problem is it is draining battery very fast. If I select &quot;Allow only when using app&quot;, and remove app from background, again it stops sending update even though my service is ON!.</p>
<p>Please can someone help me with IntentService with PendingIntent to receive background location update.</p>
<p>I need to finish a project before end of July, I already spend 4 days, please help.</p>",java|android|ios|performance|android-studio,13081151,Sharad,yes
JobService after on destroyed keep app process running,"<p>I create a UploadContactsJobService that extend JobService after uploading finish I called stopCurrentJob method </p>

<pre><code>  private void stopCurrentJob() {
        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.N) {
            JOB_INFO = new JobInfo.Builder(JOB_ID,
                    new ComponentName(RDApp.get(), UploadContactsJobService.class))
                    .setRequiredNetworkType(JobInfo.NETWORK_TYPE_ANY)
                    .addTriggerContentUri(
                            new JobInfo.TriggerContentUri(CONTACTS_URI,
                                    JobInfo.TriggerContentUri.FLAG_NOTIFY_FOR_DESCENDANTS))
                    .build();
            scheduleJob(this);
        }
            jobFinished(mRunningParams, false);
    }
</code></pre>

<p>the Service destroyed but the application process is still running and the app still running in the background i notice this on Android Studio it , should I kill app process to prevent battery drain using this </p>

<pre><code>  android.os.Process.killProcess(android.os.Process.myPid());
</code></pre>",android|android-jobscheduler|jobservice,2295429,Ahmed Wahdan,yes
A lightweight and performant way to save audio progress in flutter with just audio,"<p>I want to save the current track and time location in a <a href=""https://suragch.medium.com/managing-playlists-in-flutter-with-just-audio-c4b8f2af12eb?sk=1b1ffa2cb0b3ed50a320d8cc32cef342"" rel=""nofollow noreferrer"" title=""a tutorial for using just audio"">Just Audio playlist</a> in a flutter app.</p>
<p>My current thought is to save the location using something like</p>
<pre><code>_audioPlayer.positionStream.listen((event) {
  // update the progress bar in the UI

  // save the location using SharedPreferences
});
</code></pre>
<p>but I am afraid that this will use a lot of battery life since this function will be run every 16 ms-200 ms. Is there any way to check the battery drain of this one function? And is there any way to save time, but not as often? Would it for instance be better to create another position stream that only runs every 5 seconds? Is there any super failsafe way of saving the location when the user exits the app? Could the solution be to just use another and faster library than <a href=""https://pub.dev/packages/shared_preferences"" rel=""nofollow noreferrer"">SharedPreferences</a>, like <a href=""https://pub.dev/packages/hive"" rel=""nofollow noreferrer"">hive</a>?</p>",flutter|dart|just-audio,19013736,rahokey531,no
How to handle offline messages in React-Native using NodeJS and SocketIO,"<p>I am currently using SocketIO and NodeJS to handle messages. However the problem is that when the user becomes offline there's no way that the other user will receive the message.</p>

<p>The solution I came up with was to store the message in the database. </p>

<p>But a new problem arise, when fetching the message and push notification. </p>

<blockquote>
  <p>If I do fetch for ""n"" minutes in the server when the app is in background/inactive. There will be a lot of request in the server, and I personally think that it is inefficient. and also it drains the battery.</p>
</blockquote>

<p>What is the proper way how to handle fetching the messages from database or pushing notification in app without making too much request in ""n"" minutes and draining too much power?</p>",javascript|node.js|react-native|push-notification|socket.io,10660967,xsephtion,no
How to send push notification after analyzing api call return using firebase or any other cloud service?,"<p>I want to send a notification to the device when some condition satisfies on the data returned by API call on the cloud. I can easily do this on the device but using API every minute, for hours,  might drain the battery and use a lot of internet. API returns JSON data. I have never used Firebase before but have used others (like Kumolos). Is there a way to do this or do I need to write code on the device?</p>

<p>I am coding for android.</p>",android|firebase|push-notification|firebase-cloud-messaging,7732470,Lcukerd,yes
React Native: Detect if a mobile device is in use without user interaction and while app is in background,"<ul>
<li><strong>Goal</strong>: I want to find out if a device that has my React Native app installed is in use or has been in use looking a certain timeframe in the past. If an allowed inactivity timeframe is exceeded, I want to take an action.</li>
<li><strong>Constraint</strong>: This detection of user activity should happen without the user having to interact with the app itself. Sleep detection apps already do this by using sensors apparently but accessing sensors while in background doesn't work for me in React Native (see table below).</li>
<li><strong>Related question</strong>: Is there a working method in purely native (Java/Kotlin, Swift/Objective-C) if I would not use React Native?</li>
</ul>
<p>Following the methods I evaluated but was not able to achieve a working and reliable result with.</p>
<div class=""s-table-container"">
<table class=""s-table"">
<thead>
<tr>
<th>Method</th>
<th>Problem</th>
</tr>
</thead>
<tbody>
<tr>
<td>AppState</td>
<td>would require the user to actively use the app</td>
</tr>
<tr>
<td>battery drain</td>
<td>unreliable because of varying battery life between devices</td>
</tr>
<tr>
<td>screen lock</td>
<td>did not find a way to get this information</td>
</tr>
<tr>
<td>screen on time</td>
<td>did not find a way to get this information</td>
</tr>
<tr>
<td>motion (magnetometer)</td>
<td>did not find a way to read sensors while the app is in background using <code>expo-sensors</code>, <code>react-native-sensors</code> with <code>react-native-background-fetch</code></td>
</tr>
<tr>
<td>(geo)location</td>
<td>would not detect use while the device is still</td>
</tr>
<tr>
<td>app open event</td>
<td>the assumption is to get different results based on the app/device state but <code>Linking.openURL()</code> for a supported URL resolves in every state</td>
</tr>
<tr>
<td>permission request</td>
<td>the assumption is to get different results based on the app/device state but <code>PermissionAndroid.request()</code> doesn't execute in background using <code>react-native-background-fetch</code></td>
</tr>
</tbody>
</table>
</div>
<p>Another thing to have in mind: Background tasks can only be executed every ~15 minutes. Indeed, there exist foreground services but they would be the second choice.</p>",android|ios|react-native|mobile,9378384,alexanderdavide,yes
iOS: how to check if geo-location is still turned on?,"<p>I'm using geo-location in my iPhone app. The battery drains faster even if I've used geo-location for few seconds, or if the app is in background.</p>

<p>How can I check if the geo-location service is still turned on on my iPhone device ? This is the code I've used:</p>

<p>...</p>

<pre><code>    locationManager = [[CLLocationManager alloc] init]; // Create new instance of locMgr
    locationManager.delegate = self;

    locationManager.distanceFilter = kCLDistanceFilterNone; 
    locationManager.desiredAccuracy = kCLLocationAccuracyBest;


    [locationManager startUpdatingLocation];
    NSLog(@""locationManager startUpdatingLocation"");

    reverseGeocoder = [[MKReverseGeocoder alloc] initWithCoordinate:locationManager.location.coordinate];
    reverseGeocoder.delegate = self;
    [reverseGeocoder start];

    }

    ...

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation 
{


}


- (void)reverseGeocoder:(MKReverseGeocoder *)geocoder didFailWithError:(NSError *)error
{
    NSLog(@""reverseGeocoder failed: %@"", [error localizedDescription]);

}

- (void)reverseGeocoder:(MKReverseGeocoder *)geocoder didFindPlacemark:(MKPlacemark *)placemark
{
    NSLog(@""locality %@"", placemark.locality);
    location = [placemark.locality retain];
}
</code></pre>",ios,257022,aneuryzm,no
React Native : Google maps service keeps running in Android devices even after the app is exited,"<p>When the app is in foreground everything seems to works fine. But when we force close the app the map service still seems to work even after the MapView has been destroyed. We are running a background service which lets the app run in background. All the foreground services are killed when app is closed but we noticed a huge battery drain when the app is background and when we ran the Android Profiler we got to know that a service from google maps(csi.gstatic.com) is still open/running even in the background.
When researched and got to know that google maps uses the service to load the static content(images..etc) for the map.Typically the service shouldn't be running when the MapView has been destroyed.</p>

<p><a href=""https://i.stack.imgur.com/O1WXW.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/O1WXW.png"" alt=""When App is in foreground""></a><a href=""https://i.stack.imgur.com/VYkWk.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/VYkWk.png"" alt=""When app is in backgroun/killed state""></a></p>

<p>The first image is when the app is foreground and service is running normally.
The second image is when the app is background/killed and the service is still running even though the MapView has been destroyed.(The events is fabric service). Is there a way to kill all the services related to the MapView?</p>",android|google-maps|react-native|android-mapview|android-background,6567904,Naveen,no
Background app drains too much battery,"<p>I have developed an application for iPhone that runs in the background with GPS mode on. I need to ask the server if there are any new tasks for the user? Fir this purpose, I have added the code in the didUpdateToLocation method. Now the problem is that it consumes the battery very fast.  Please guide me how to avoid the battery consumption. Also, I need to keep the location accuracy at best.
 Also, is there any other way where I can communicate to the server even while the app is running in the background. Please help me, I will be really grateful.</p>",iphone|objective-c|background,455817,engr.rf4u,yes
"ios, get location every hour (ios7)","<p>In my project I need to get location evry hour. My code looks like this:</p>

<pre><code>#import ""AppDelegate.h""

@implementation AppDelegate {
   UIBackgroundTaskIdentifier bgTask;
   CLLocationManager *locationManager;
}


- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

   locationManager = [[CLLocationManager alloc] init];
   locationManager.delegate = self;
   locationManager.pausesLocationUpdatesAutomatically = NO;
   locationManager.activityType = CLActivityTypeOther;
   locationManager.desiredAccuracy = kCLLocationAccuracyNearestTenMeters;
   locationManager.distanceFilter = kCLDistanceFilterNone;

   return YES;
}                       

- (void)applicationDidEnterBackground:(UIApplication *)application {
   __block UIBackgroundTaskIdentifier background_task;

   background_task = [application beginBackgroundTaskWithExpirationHandler:^ {
    [application endBackgroundTask: background_task];
    background_task = UIBackgroundTaskInvalid;
   }];

   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

    [locationManager startUpdatingLocation];

    while(TRUE)
    {
        NSLog(@""Background time Remaining: %f"",[[UIApplication sharedApplication] backgroundTimeRemaining]);
        [NSThread sleepForTimeInterval:200]; //wait for x sec

        [locationManager startUpdatingLocation];
    }

    [application endBackgroundTask: background_task];
    background_task = UIBackgroundTaskInvalid;
   });


}

- (void) locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations {

   CLLocation *location = [locations lastObject];

   NSDate* eventDate   = location.timestamp;
   NSTimeInterval time = [eventDate timeIntervalSinceNow];
   if (abs(time) &lt; 15.0) {
    if (location != nil) {

        NSString *lat = [NSString stringWithFormat:@""%.8f"", location.coordinate.latitude];
        NSString *lng = [NSString stringWithFormat:@""%.8f"", location.coordinate.longitude];

        NSLog(@""location update  ..."");

        //[APIConnection SaveMyPositionWitLat:lat withLng:lng];
        //[locationManager stopUpdatingLocation];
    }
   }
}
</code></pre>

<p>This works, but battery im my phone is drained very fast and location is checking every second. If I enable:</p>

<pre><code>[locationManager stopUpdatingLocation];
</code></pre>

<p>then location service is stoped permanently. How to change this code for saving battery power ?</p>",ios|cllocationmanager,2513405,Nizzre,no
How to kill a stubborn Process in Android?,"<p>I have an unrooted Android 2.3.4 device and am using an app (not my app) that sometimes starts to go nuts and uses 100% cpu power for no reason (its a bug) which drains the battery power really quickly and is also considerably slowing the device down. I can use a taskkiller to end it but thats not really an option so I made an app that monitors that other app and tries to end it whenever it detects too crazy cpu usage.</p>

<p>The problem I face now is how to end that app. I tried the following 4 methods but unfortunately to no avail:</p>

<pre><code>ActivityManager actvityManager = (ActivityManager) getSystemService( ACTIVITY_SERVICE );
actvityManager.killBackgroundProcesses(packagename);

android.os.Process.sendSignal(pid, android.os.Process.SIGNAL_KILL);

android.os.Process.killProcess(pid);

actvityManager.restartPackage(packagename);
</code></pre>

<p>I can use a regular taskkilling tool to end it (it really does, I verified that), but I would like to do that programmatically myself and not with other means (and by that I also mean rebooting and not using the app). </p>

<p>How can I end such a process?</p>

<p>PS: I know that the termination of processes should under normal circumstances be left to Android but that is obviously not sufficient in this case, so I need to handle it myself. </p>",android|process|kill,1095875,HardCoder,no
GPU benchmark for nvidia Optimus cards,"<p>I need a GPGPU benchmark which will load the GPU so that I can measure the parameters like temperature rise, amount of battery drain etc. Basically I want to alert the user when the GPU is using a lot of power than normal use. Hence I need to decide on threshold values of GPU temperature, clock frequency and battery drain rate above which GPU will be using more power than normal use. I have tried using several graphics benchmark but most of them don't use GPU resources to the fullest. 
Please provide me a link to such GPGPU benchmark.</p>",gpgpu|nvidia|optimus,985796,Anup Warnulkar,no
Realtime notifications using socket.io or any other better option ? Want instant notifications like whatsapp,"<p>I am working on a travel app, notifications play a very vital role, as the app involves payments and instant verification. Please suggest how it can be achieved.</p>

<p>Will keeping a service for socket.io connection drain a lot of battery?</p>

<p>will the device kill the service when the user swipe kills the app from recent apps?</p>",android|push-notification|socket.io|notifications,6170600,Bawa,no
"Nearby API, what's the correct way of scanning for beacons in the background?","<p>I'm looking at using Google's Nearby API to detect beacons (Eddystone). The only current approach at the moment seems to be calling <code>Nearby.Messages.subscribe()</code> as described <a href=""https://developers.google.com/nearby/messages/android/get-beacon-messages"">here</a>.</p>

<p>The problem is that this doesn't seem to be suitable for continuous scanning in the background. My app needs to keep monitoring beacons in the background so if one becomes visible, it would perform a call to a REST API. Basically, I'd need something similar to the <a href=""https://community.estimote.com/hc/en-us/articles/203356607-What-are-region-Monitoring-and-Ranging"">beacon monitorning</a> feature provided by the Estimote SDK. </p>

<p>Would this be possible to achieve with the Nearby API without draining the battery? </p>",android|eddystone|google-nearby,1847449,ivacf,yes
How to ensure that a Xamarin Forms app (AVAudioSessionCategoryPlayback mode) is suspended correctly by iOS to prevent battery drain?,"<p>I have a Xamarin Forms app running in AVAudioSessionCategory = Playback mode and it works very nice, background audio is playing and even my timers keep running in the background, which is fine during playback.</p>
<p>How can I ensure that after a user has decided to stop playing audio (either by pressing a button inside of the app or by pressing the pause button on the lock screen) my app will go into a Suspended state and it won't drain the battery?</p>
<p>Is there a way to either force my app to go suspended or a way to verify whether it has?</p>
<p>As a side-note: Hooking the OnSleep method in App.xaml.cs is NOT sufficient because it is being called every time the app goes to the background even if it's playing audio, my timers are running, HTTP calls working, etc.</p>
<p><strong>UPDATE</strong>:</p>
<p>Made an interesting discovery today:</p>
<ul>
<li>Timers keep running running in the background when the app is started from Visual Studio in debug mode (over WiFi).</li>
<li>Timers seem to get suspended automatically by the OS (iOS) when the app enters background in Release mode.</li>
</ul>
<p>My conclusion is: maybe the entire problem lies somewhere in the 'framework' that is added to the app by Xamarin to ensure communication between Visual Studio and the app? (Console, breakpoints, etc.) It would be a logical explanation.</p>",xamarin|xamarin.forms|xamarin.ios,2759255,adamsfamily,yes
My dynamically added table rows are not appearing in my app,"<p>I'm trying to create an app that has a start and stop button, which collects accelerometer data and displays the x, y, and z coordinates in tablerows. Each time the sensor detects a change, a row with the new set of coordinates should be added. Initially, I did not include buttons or an onPause() or onResume() method and the rows would be added dynamically. However, since there were so many rows being added, the application would freeze and drain my battery. As a result I added the onPause and onResume methods, in addition to a start and stop button for recording the data. Unfortunately, the buttons work but the rows of data stop changing after the screen is full of rows. I used the LogCat to check that rows are being added, and they are. I just don't know why they're not all appearing. My code is pasted below. The layout file is after the java file in the same block of code. Any help would be greatly appreciated! </p>

<pre><code>    package com.explorer.extractor;

    //import packages

    import android.app.ActionBar;
    import android.content.Context;
    import android.graphics.Color;
    import android.hardware.Sensor;
    import android.hardware.SensorEvent;
    import android.hardware.SensorEventListener;
    import android.hardware.SensorManager;
    import android.os.Bundle;
    import android.support.v7.app.ActionBarActivity;
    import android.util.Log;
    import android.view.View;
    import android.view.View.OnClickListener;
    import android.widget.Button;
    import android.widget.TableLayout;
    import android.widget.TableRow;
    import android.widget.TextView;

    import java.io.BufferedReader;
    import java.io.BufferedWriter;
    import java.io.FileNotFoundException;
    import java.io.IOException;
    import java.io.InputStream;
    import java.io.InputStreamReader;
    import java.io.OutputStreamWriter;
    import java.util.Calendar;


    public class MainActivity extends ActionBarActivity implements SensorEventListener,OnClickListener {

        Button button1;
        Button button2;

        private SensorManager mSensorManager;
        Sensor accelerometer;

        private static final String TAG = MainActivity.class.getName();
        private static final String FILENAME = ""myFile.txt""; //file where data is written

        //layout variables
        TableLayout t1;
        TextView dataReading; //declare data text object
        Integer count = 0;

        @Override
        protected void onCreate(Bundle savedInstanceState) {

            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);

            //initialize sensor manager
            mSensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
            //initialize accelerometer
            accelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
            //mSensorManager.registerListener(this, accelerometer, SensorManager.SENSOR_DELAY_FASTEST);

            t1 = (TableLayout) findViewById(R.id.main_table);
            button1 = (Button) findViewById(R.id.button1);
            button2 = (Button) findViewById(R.id.button2);

            button1.setOnClickListener(this);
            button2.setOnClickListener(this);
        }

        public void onAccuracyChanged(Sensor sensor, int accuracy){}

        /**onResume() registers the accelerometer for listening
         * to the events
         */
        protected void onResume(){
            super.onResume();
            mSensorManager.registerListener(this, accelerometer, SensorManager.SENSOR_DELAY_FASTEST);
        }

        protected void onPause(){
            super.onPause();
            mSensorManager.unregisterListener(this);
        }

        public void onSensorChanged(SensorEvent event){
           //if sensor status result is unreliable return
            if (event.accuracy == SensorManager.SENSOR_STATUS_UNRELIABLE){
                return;
            }

            Sensor sensor = event.sensor;

            //check sensor type
            if (sensor.getType() == Sensor.TYPE_ACCELEROMETER){
                //assign directions
                float x = event.values[0];
                float y = event.values[1];
                float z = event.values[2];

                try {
                    //write to text file the x, y, and z values each type a sensor detects change
                    writeToFile(Float.toString(x), Float.toString(y), Float.toString(z));
                    //return string of text file
                    String textFromFileString = readFromFile();
                    TableRow tr = new TableRow(this);
                    if(count%2!=0) {
                        tr.setBackgroundColor(Color.GRAY);
                    }
                    tr.setId(100 + count);
                    tr.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.MATCH_PARENT, TableRow.LayoutParams.WRAP_CONTENT));

                    //show data read from file
                    dataReading = new TextView(this);
                    dataReading.setId(200 + count);
                    dataReading.setText(textFromFileString);
                    dataReading.setPadding(2, 0, 5, 0);
                    dataReading.setTextColor(Color.WHITE);
                    tr.addView(dataReading);
                    //finally add data to table row
                    t1.addView(tr, new TableLayout.LayoutParams(ActionBar.LayoutParams.MATCH_PARENT, ActionBar.LayoutParams.WRAP_CONTENT));
                    count++;
                    Log.i(""LIMA"",""Add row. There are now "" + t1.getChildCount()+""rows"");
                }catch (IOException e) {
                    e.printStackTrace();
                }
            }

        }

        public void onClick(View v) {
            switch (v.getId()) {
                case R.id.button1:
                    mSensorManager.registerListener(this, accelerometer, SensorManager.SENSOR_DELAY_FASTEST);
                    break;
                case R.id.button2:
                    mSensorManager.unregisterListener(this);
            }
        }

        /**
         * writeToFile: writes data recordings of accelerometer to text file
         * @param x
         * @param y
         * @param z
         * @throws IOException
         */
        void writeToFile(String x, String y, String z) throws IOException {
            //get exact instance of time in which call to write is being made
            Calendar c = Calendar.getInstance();
            //create string to print to text using values in parameter
            String s =  c.get(Calendar.HOUR) + "":"" + c.get(Calendar.MINUTE) + "":"" + c.get(Calendar.SECOND) + "":"" + c.get(Calendar.MILLISECOND) + "" - "" + ""x: "" + x + "" y: "" + y + "" z: "" + z + ""\n"";
            try {
                //append new string to file
               OutputStreamWriter outputStreamWriter = new OutputStreamWriter(openFileOutput(FILENAME, Context.MODE_PRIVATE));
                BufferedWriter bw = new BufferedWriter(outputStreamWriter);
                bw.write(s);
                bw.flush();
                bw.close();
            } catch(IOException e) {
                Log.e(TAG, ""File write failed: "" + e.toString());
            }
        }

        private String readFromFile(){
            String ret = """";
            try {
                //open text file to read from
                InputStream inputStream = openFileInput(FILENAME);
                if (inputStream != null) {
                    InputStreamReader inputStreamReader = new InputStreamReader(inputStream);
                    BufferedReader bufferedReader = new BufferedReader(inputStreamReader);
                    String receiveString = """";
                    StringBuilder stringBuilder = new StringBuilder();

                    while ((receiveString = bufferedReader.readLine()) != null) {
                        //continue appending to stringBuilder until you've reached the end of file
                        stringBuilder.append(receiveString);
                    }
                    inputStream.close();
                    ret = stringBuilder.toString();
                }
            } catch (FileNotFoundException e) {
                Log.e(TAG, ""File not found: "" + e.toString());
            } catch (IOException e) {
                Log.e(TAG, ""Can not read file: "" + e.toString());
            }
            return ret;
        }
    }



    Here is my layout file: 

&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;

&lt;TableLayout
xmlns:android=""http://schemas.android.com/apk/res/android""
android:id=""@+id/main_table""
    android:layout_weight=""1""
android:layout_width=""match_parent""
android:layout_height=""wrap_content""
android:shrinkColumns=""*""
android:stretchColumns=""*""&gt;

    &lt;TableRow
        android:id=""@+id/tablerow""
        android:layout_width=""wrap_content""
        android:layout_height=""wrap_content""&gt;

         &lt;Button
            android:id=""@+id/button1""
            android:layout_height=""wrap_content""
            android:text=""Start""
            android:layout_weight="".5""
            android:layout_width=""match_parent""
            android:gravity=""center_horizontal""/&gt;

        &lt;Button
            android:id=""@+id/button2""
            android:layout_height=""wrap_content""
            android:text=""Stop""
            android:layout_weight="".5""
            android:layout_width=""match_parent""
            android:gravity=""center_horizontal""/&gt;
    &lt;/TableRow&gt;
&lt;/TableLayout&gt;
</code></pre>",android|button|layout|accelerometer|tablerow,5186790,CompSci1234,yes
"What's the ""right"" way to do polling in an android service in terms of timing(waiting), wifi and power locking","<p>I have an android app, that gets some information from the internet. Usually it gets it through my server, which collets the data and sends it via GCM, but there is a certain scenario, where it goes into a fallback mode, when it starts a service that polls a 3rd party REST API every 2 seconds. I wonder what's the right way to implement this (pros/cons)</p>

<p>1st way: My 1st implementation was to use an AlarmManager and a BroadcastReceiver. In the BroadcastReceiver I locked PowerManager.WakeLock and WifiManager.WifiLock, then when I got the response I unlocked them, and set up the AlarmManager for 2 seconds.</p>

<p>Then I thought that probably all I achieved by this is that my app hardly shows up as a battery consumer in android Settings, while basically it does drain the battery, as probably the WiFi is not disconnected for 2 seconds, then reconnected. Also noticed that because of the BroadcastReceiver I create a new instance of my RestClient every 2 seconds, then garbage collect it. So I am thinking of changing the implementation:</p>

<p>2nd way: lock PowerManager, WifiManager when I start the PollService (this will cause my app to show up in battery consumption with a serious percentage, but does it really draw more battery, or does it only ""correct"" the report?)</p>

<p>Now what should be the way to wait for 2 seconds? Should I continue to use the AlarmManager and garbage collection... Or should I do something like:</p>

<pre><code>try {
    Thread.sleep(2000);
} catch(InterruptedException ex) {
    Thread.currentThread().interrupt();
}
</code></pre>

<p>or</p>

<pre><code>synchronized (this) {
    try {
        wait(2000);
    } catch (Exception e) {}
}
</code></pre>",android|service|locking|wait|thread-sleep,661589,Gavriel,yes
Android Keep thread alive questions,"<p>I am building an Android App that will communicate over TCP with a server. I have a few ideas for implementation and I don't know which way would be best to go. I am new at this and my design is constantly evolving as I learn new things, so now I am looking for advice for how to best implement a solution to fulfill my goal.</p>

<p>Goal: Be able to:</p>

<ol>
<li>send data to a server</li>
<li><p>Send data to a server and read the servers response.</p>

<ul>
<li>Some information I send will be to give the server information, other will be to request information from the server.</li>
</ul></li>
</ol>

<p>Possible implementations:</p>

<ul>
<li>Thread Run() method constantly loops through checking if my send queue has something to send (and sending it if it does) then checking if I have anything to read back in.
<ul>
<li>Will this drain battery/burn CPU?</li>
</ul></li>
<li>Create a new thread each time I want to send/receive, the let it die once I have done 'send' or 'send + receive'
<ul>
<li>How should I synchronize the threads interactions with my one socket? Block making the next thread until this one finishes?</li>
</ul></li>
<li>Make a thread and call a send or send + receive method withing that thread each time I need to write or write + read
<ul>
<li>How do I keep the thread alive without burning battery/CPU?</li>
<li>should I use a queue to handle requests for transmitting data and should I synchronize reading from it until the current read/write is finished?</li>
</ul></li>
</ul>

<p>Any additional pointers, links, or warnings about potential issues would be much appreciated. Sample code is especially appreciate as I am just starting out with this. Thank you.</p>",android|multithreading|tcp,1096697,Nissi,yes
How to load images from URL in App widget Android?,"<p>I am making a widget similar to that of YouTube and default Weather/News one. I have a view flipper in which I add layouts dynamically (which contains an ImageView and a TextView) using:</p>

<pre><code>remoteViews.addView(R.id.viewFlipper, itemViews);
</code></pre>

<p>The problem is that I need to load images from a URL in that layout. What is the best way to do this ?</p>

<p>I have a Lazy List loader but that does not work on RemoteViews and even after modification I think it is not  correct to update the widget for every image which might drain the battery too fast.</p>

<p>Thanks in advance.</p>",android|image|widget|viewflipper,231849,Afzal,no
Can Wi-Fi or the CPU go to sleep when screen is on?,"<p>There are <code>WakeLock</code>s and <code>WifiLock</code>s on Android -- but do I need these if my screen is never turning off?</p>

<p>I'm using persistent connections (e.g. WebSockets) for dozens of minutes or even hours. Will my screen being always on be sufficient to prevent the device from losing those connections (if we assume that the connection remains available and the server is fine)?</p>

<p>To keep the screen on, I use the standard way:</p>

<p><code>getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);</code></p>

<p><strong>What the docs say:</strong></p>

<blockquote>
  <p>To avoid draining the battery, an Android device that is left idle quickly falls asleep.</p>
</blockquote>

<p>(<a href=""https://developer.android.com/training/scheduling/wakelock.html"">https://developer.android.com/training/scheduling/wakelock.html</a>)</p>

<blockquote>
  <p>Normally the Wi-Fi radio may turn off when the user has not used the device in a while.</p>
</blockquote>

<p>(<a href=""http://developer.android.com/reference/android/net/wifi/WifiManager.WifiLock.html"">http://developer.android.com/reference/android/net/wifi/WifiManager.WifiLock.html</a>)</p>

<p><strong>Does this mean that ...</strong></p>

<p>the Wi-Fi radio or the CPU may go to sleep mode or turn off when the user does not interact with the device for a longer time (even if the screen is still on)?</p>

<p>And, more specifically, may a background task's (e.g. <code>IntentService</code>) Wi-Fi or mobile data connection go to sleep when there is still an <code>Activity</code> that keeps the screen on?</p>",android|android-lifecycle|android-networking,89818,caw,no
Find location by means other than GPS / phone network in Android?,"<p>I'm working on an android app that needs to constantly get location data, or as constantly as possible. I know this is going to drain the battery and use lots of data if the user isn't on wifi.</p>

<p>Is there any other way to transmit some kind of you are here message to a phone that wouldn't use data or be a constant drain on the battery by using the GPS. I know enough about phones to think this is a stupid question but I also know enough to know I don't know that much.</p>

<p>So does anyone extremely familiar with Android know <em>if there is any way to get location data, or any data, to the phone without using the GPS or your data connection?</em></p>

<p>Background:
I'm working on an app that notifies the user about interesting things when they are within some radius of a location, like a historical site or mall or theater, I don't really want to constantly ask the GPS or phone network where they are but I don't know of any other way. </p>",android|geolocation,1274764,Hardy,no
making constant internet connection to server without draining battery,<p>Apps like twitter drain phone's battery quickly as it have to wake up the phone when a new tweet comes. My app need constant connection to server. It won't download or upload data constantly.sending TCP keep-alive every 2 minutes can save battery life or the only way we can talk to server constantly is by push notifications? why push itself doesn't drain battery?</p>,android|ios|mobile|tcp|battery,3455628,user3455628,no
Maximum output amperage from USB Smartphones,"<p>The Output voltage from an USB port is 5v, and it can't be changed, isn't it?!</p>

<p>But what is the maximum amperage that I can drain from a smartphone?
It depends on the battery, hardware or is limited by the OS?
There is difference between Android/iPhone/otherOS phones?
Can I control the output amperage with an App? And if the phone is rooted?</p>

<p><strong>Important example what is the maximum amount of current that can provide Iphone 6 from USB?</strong></p>",android|iphone|usb|smartphone|android-hardware,2155494,Apoleo,yes
Exactly how much power is drained by registering a broadcast receiver for ACTION_BATTERY_CHANGED?,"<p>I am planning to write an app whose sole purpose will be to monitor the battery level, and launch an intent the moment it drops below a certain level.  My one concern is that this itself will be a battery drain, and no one will want to use it.</p>

<p>So my question is: Exactly how much power is drained by using the ACTION_BATTERY_CHANGED broadcast receiver? Does anyone know approximately how much battery life we're talking about?</p>",android|broadcastreceiver|battery,471791,malfunction,yes
"Firebase Realtime Database consuming CPU / memory with excessive ""userWrites""","<p>I'm using the Firebase Realtime Database on an iOS project. I've had a growing number of reports from users about my app consuming lots of battery, and have recently done a bit of profiling. On my device the app is using 100% CPU and more than 0.5 Gb memory (and growing) for minutes at a time - the Time Profiler suggests its Firebase that's the culprit, with more than 8.77 minutes out of 10.09 minutes spent in the <code>[FRepo restoreWrites]</code> method (3.22 minutes in <code>[FCompoundWrite addWrite:atPath:]</code>). This is with persistence enabled.</p>

<p>I dug in to the code for <code>restoreWrites</code> and it seems that its performance is related to the number of <code>userWrites</code> records. <code>[[[[[[reference repo] persistenceManager] storageEngine] writesDB] allKeys] count]</code> comes out at about 75,000 (and growing every time I launch the app) - is this how many writes have been persisted to disk that haven't yet been written to the server? Or is this the total number of records across all users? I don't know. But either way it's constantly growing and causing massive performance issues.</p>

<p>Is this inevitable and a reason to migrate to FireStore? Or is this something wrong I'm doing that is fixable?</p>

<p>Here's the full profile info to show you what I'm talking about:      </p>

<pre><code>9.41 min   93.2%    0 s      _dispatch_workloop_worker_thread$VARIANT$mp  0x109890
9.41 min   93.2%    0 s       _pthread_wqthread
9.41 min   93.2%    0 s        _dispatch_workloop_worker_thread$VARIANT$mp
9.41 min   93.2%    0 s         _dispatch_root_queue_drain_deferred_wlh$VARIANT$mp
9.41 min   93.2%    0 s          _dispatch_queue_invoke$VARIANT$mp
9.37 min   92.9%    0 s           _dispatch_queue_serial_drain$VARIANT$mp
9.37 min   92.9%    0 s            _dispatch_client_callout
9.37 min   92.9%    0 s             _dispatch_call_block_and_release
8.78 min   87.0%    0 s              -[FRepo deferredInit]
8.77 min   87.0%    0 s               -[FRepo restoreWrites]
7.30 min   72.3%    0 s                -[__NSArrayM enumerateObjectsWithOptions:usingBlock:]
6.55 min   64.9%    1.00 ms                 __22-[FRepo restoreWrites]_block_invoke
5.69 min   56.3%    4.00 ms                  -[FSyncTree applyUserMergeAtPath:changedChildren:writeId:]
5.67 min   56.2%    8.00 ms                   -[FWriteTree addMergeAtPath:changedChildren:writeId:]
5.63 min   55.8%    5.00 ms                    -[FCompoundWrite addCompoundWrite:atPath:]
5.63 min   55.8%    0 s                     -[FImmutableTree forEach:]
5.63 min   55.8%    1.00 ms                      -[FImmutableTree forEachPathSoFar:withBlock:]
3.43 min   34.0%    1.00 ms                       -[FArraySortedDictionary enumerateKeysAndObjectsReverse:usingBlock:]
3.42 min   33.9%    3.00 ms                        __45-[FImmutableTree forEachPathSoFar:withBlock:]_block_invoke
3.32 min   32.9%    7.00 ms                         -[FImmutableTree forEachPathSoFar:withBlock:]
3.31 min   32.8%    6.00 ms                          __42-[FCompoundWrite addCompoundWrite:atPath:]_block_invoke
3.22 min   31.9%    9.00 ms                           -[FCompoundWrite addWrite:atPath:]
</code></pre>",ios|firebase|firebase-realtime-database,4397,andygeers,no
How to monitor background services for apps in Android devices?,"<p>Lately I have installed several apps for the purpose of Android development and testing. I noticed that my phone has been draining in battery more than before even while apps were not open and active. Is there an Android tool that will help me identify which apps are using background services? And if so, will the tool provide me detail on how much bandwidth application A is using compared to application B? I am interested in knowing if an app is using broadcast receivers, services, etc. incorrectly. I'd also like to use this tool for myself when developing an app to know if I am wasting too many cpu cycles, or memory that might lead to battery draining. Thank you!</p>",android|android-service|android-broadcast|android-networking,1456962,code,yes
Can I detect Beacons with out switch the bluetooth?,"<p>I woould like to do a background scanning of beacons.
But user's bluetooth will not be on always.If i switch on the bluetooth battery will also drain.</p>

<p>Can I detect beacons with out switching on bluetooth in android ?</p>",android|bluetooth-lowenergy|ibeacon-android,3437594,user3437594,no
Getting System UI errors when alarm clock alarms after Oreo upgrade,"<p>I have seen a few articles talking about System UI errors dealing with the built in alarm clock, but none seem to have any answers.  I was just recently forced upgraded to Oreo (8.0.0) on a SAMSUNG-SM-G930A on AT&amp;T.  The alarm seems to go off fine, but after hitting the snooze a few times, I start getting System UI errors.  Then I seem to have some flakiness, slowness, and battery draining until I reboot.</p>

<p>I have also tried resetting all of my app settings to attempt to fix this.</p>

<p>The closest article I can find is this one: </p>

<p><a href=""https://stackoverflow.com/questions/47915026/android-alarm-clock-app-crashes-systemui-with-nullpointerexception-under-oreo-o/48084299#48084299"">Android alarm clock app crashes SystemUI with NullPointerException under Oreo (only)</a></p>

<p>Unless someone knows of a way to try 8.1 without jail breaking?</p>

<p>Thanks!</p>",android|android-8.0-oreo,9391839,Robert Taylor,yes
Yet another question about showing UIActivityIndicator,"<p>I had the UIActivityIndicatorView working fine in simulator and other 3.0 devices in my app. But I found out that it was not spinning (or showing) in the new iphone 4. Basically I need to show the activity indicator when a button is clicked and hide it when the button click event is complete. I was using the approach below.</p>

<p><code>[NSThread detachNewThreadSelector: @selector(spinBegin) toTarget:self withObject:nil];</code></p>

<p>from this <a href=""http://a.prokhorenko.us/this-is-how-we-make-uiactivityindicatorview-w"" rel=""nofollow"">link</a>.  As mentioned, it correctly spins the activity indicator on all except 4.*.. not sure why.  To get around this, I also followed another approach something like (from developer.apple.com)</p>

<p>`
 (IBAction)syncOnThreadAction:(id)sender</p>

<p>{</p>

<pre><code>[self willStartJob];



[self performSelectorInBackground:

    @selector(inThreadStartDoJob:)

    withObject:theJobToDo

];
</code></pre>

<p>}</p>

<p>(void)inThreadStartDoJob:(id)theJobToDo</p>

<p>{</p>

<pre><code>NSAutoreleasePool * pool;

NSString *          status;



pool = [[NSAutoreleasePool alloc] init];

assert(pool != nil);



status = [... do long running job specified by theJobToDo ...]

[self performSelectorOnMainThread:

    @selector(didStopJobWithStatus:)

    withObject:status

    waitUntilDone:NO

];



[pool drain];
</code></pre>

<p>}</p>

<p>`</p>

<p>The problem with this was that, it is showing the acitivityVIewIndicator spinning correctly (at least on the simulator) but after it stops, the built in activity indicator in the top bar (where it shows the battery% etc) is still spinning. </p>

<p>I'm new to objective C. I have finished my app completely but for this silly thing. I realize there is no way to display UIActivityView without starting another thread. and finally, just to rant, I don't understand why they have to make it so complicated. I mean they knew it was going to have this problem, why not provide a sample code everyone can use rather than deriving their own solutions.</p>

<p>Finally, can anyone please provide me with a direction or some sample code. I would really appreciate it. I have been searching for a few hours now and have not found anything really that works! </p>",iphone|objective-c,545517,coder net,yes
Android location manager ignore minTime,"<p>I want to set up a location manager to report the location every time the phone moves 30 meters. I do not care about time. Is there a way to ""ignore"" the minTime parameter? It appears if I set this to zero it is reporting constantly which is draining my battery. Thanks</p>",android|locationmanager|android-location,1200083,user1200083,yes
Sync service stays awake even though the syncAdapter does nothing,"<h2>Background</h2>

<p>We've added an account to the app so that it will be shown when the user clicks on a contact's image (as presented <a href=""http://www.androidpolice.com/2011/11/20/getting-to-know-android-4-0-part-5-everything-changes-in-contacts-even-the-name/"" rel=""nofollow"">here</a> on the ""Contacts Cards"" section).</p>

<p>For now, we don't need to have any functionality when syncing, so the code for ""onPerformSync"" is totally empty. Maybe later we will add code for it.</p>

<h2>The problem</h2>

<p>For some reason, on some devices (like the Nexus 4 , with Android 4.3) , it seems that the Sync service stays awake for a very long time (at least 9 hours, could be more), even though it has nothing to do.</p>

<p>On such devices, the app drains the battery so it's crucial to fix this issue.</p>

<p>However, according to what I've read and heard, the functionality requires that we have a syncAdapter even if it doesn't need to do anything.</p>

<h2>The code</h2>

<p>Actually there is nothing special with the code as it's almost identical with other samples. it even has a lot less code since we don't need syncing at the moment.</p>

<p>I will write it down nevertheless:</p>

<p><strong>SyncAdapter</strong> :</p>

<pre><code>public class SyncAdapter extends AbstractThreadedSyncAdapter {

    public SyncAdapter (Context context, boolean autoInitialize) {
        super(context, autoInitialize);
    }

    @Override
    public void onPerformSync(Account account, Bundle extras, String authority, ContentProviderClient provider,
            SyncResult syncResult) {
    }

}
</code></pre>

<p><strong>SyncService</strong> :</p>

<pre><code>public class SyncService extends Service {

    private static final Object sSyncAdapterLock = new Object();
    private static SyncAdapter sSyncAdapter = null;

    @Override
    public void onCreate() {
        synchronized (sSyncAdapterLock) {
            if (sSyncAdapter == null) {
                sSyncAdapter = new SyncAdapter (getApplicationContext(), true);
            }
        }
    }

    @Override
    public IBinder onBind(final Intent intent) {
        return sSyncAdapter.getSyncAdapterBinder();
    }
}
</code></pre>

<p>EDIT: I've decided to show more code in order to try to give more clues to this problem:</p>

<p><strong>manifest</strong>:</p>

<pre><code>&lt;service
    android:name=""...SyncService""
    android:exported=""true"" &gt;
    &lt;intent-filter&gt;
        &lt;action android:name=""android.content.SyncAdapter"" /&gt;
    &lt;/intent-filter&gt;

    &lt;meta-data
        android:name=""android.content.SyncAdapter""
        android:resource=""@xml/syncadapter"" /&gt;
    &lt;meta-data
        android:name=""android.provider.CONTACTS_STRUCTURE""
        android:resource=""@xml/contacts"" /&gt;
&lt;/service&gt;
</code></pre>

<p><strong>contacts.xml</strong></p>

<pre><code>&lt;ContactsSource xmlns:android=""http://schemas.android.com/apk/res/android"" &gt;

    &lt;ContactsDataKind
        android:detailColumn=""data3""
        android:icon=""@drawable/app_icon""
        android:mimeType=""vnd.android.cursor.item/....profile""
        android:summaryColumn=""data2""/&gt;

&lt;/ContactsSource&gt;
</code></pre>

<p><strong>syncadapter.xml</strong></p>

<pre><code>&lt;sync-adapter xmlns:android=""http://schemas.android.com/apk/res/android""
    android:accountType=""....contacts""
    android:allowParallelSyncs=""false""
    android:contentAuthority=""com.android.contacts""
    android:isAlwaysSyncable=""false""
    android:supportsUploading=""false""
    android:userVisible=""false"" /&gt;
</code></pre>

<p><strong>AuthenticatorActivity</strong>:</p>

<pre><code>public class AuthenticatorActivity extends AccountAuthenticatorActivity {

    @Override
    public void onCreate(final Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        final Intent res = new Intent();
        res.putExtra(AccountManager.KEY_ACCOUNT_NAME, ...);
        res.putExtra(AccountManager.KEY_ACCOUNT_TYPE, ...);
        res.putExtra(AccountManager.KEY_AUTHTOKEN, ...);
        final Account account = new Account(AccountGeneral.ACCOUNT_NAME, ...);
        final AccountManager accountManager = AccountManager.get(this);
        accountManager.addAccountExplicitly(account, null, null);
        ContentResolver.setSyncAutomatically(account, ContactsContract.AUTHORITY, false);
        ContentResolver.setIsSyncable(account, ContactsContract.AUTHORITY, 0);
        setAccountAuthenticatorResult(res.getExtras());
        setResult(RESULT_OK, res);
        finish();
    }
}
</code></pre>

<h2>The question</h2>

<p>Why does it occur?</p>

<p>We've followed all steps like on the samples yet the sync service keep staying alive, which (probably) holds the wake lock (as written <a href=""http://software.intel.com/en-us/articles/wakelocks-detect-no-sleep-issues-in-android-applications#_Toc358278564"" rel=""nofollow"">here</a>) .</p>

<p>Perhaps I need to call ""<a href=""http://developer.android.com/reference/android/content/ContentResolver.html#setSyncAutomatically%28android.accounts.Account,%20java.lang.String,%20boolean%29"" rel=""nofollow"">setSyncAutomatically</a>"" or ""<a href=""http://developer.android.com/reference/android/content/ContentResolver.html#setIsSyncable%28android.accounts.Account,%20java.lang.String,%20int%29"" rel=""nofollow"">setIsSyncable</a>"" ? If so, does it mean that syncAdapters are automatically set to sync by default? And where should I even call it ? In the ""<a href=""http://developer.android.com/reference/android/accounts/AbstractAccountAuthenticator.html#confirmCredentials%28android.accounts.AccountAuthenticatorResponse,%20android.accounts.Account,%20android.os.Bundle%29"" rel=""nofollow"">confirmCredentials</a>"" function?</p>

<p>Yet it still doesn't explain why the service keep running even though it has nothing to do, and when we will use the SyncAdapter for syncing we will have to deal with this problem again.</p>",android|android-service|battery|wakelock|android-syncadapter,878126,android developer,no
How to get battery percentage drained by my app - Android,"<p>We are working on an app monitoring service to check how much an app consumes battery, just like what is seen in the devices battery settings page, after some research I found <code>BatteryManager</code> class and <code>ApplicationErrorReport.BatteryInfo</code> class but neither helped reaching the goal.</p>
<p>We don't intend to show the data to the user, just collect it for analysis purposes.</p>
<p>How to obtain such functionality?</p>",android|performance,10731757,Basel Abuhadrous,yes
What are the most battery-consuming things you can do in an iPhone-app?,"<p>I am making an app that quickly drains the users battery. For this, I am planning on using the sound-framework for vibrating, location services, download large but empty files from the internet, use the flashlight on the back of the phone, and so on.
I know these can effectively drain the battery, but I would like to know if there are more methods that are more or equally power/processor-consuming or that could work for this in any way?</p>

<p>Examples on how to achieve 100% CPU usage is also very appreciated.</p>

<p>Thanks.</p>",iphone|objective-c|ios|battery|consuming,267892,Emil,no
iOS standard location service vs significant-change location service vs region monitoring,"<p>I am developing an iOS app whose one of its main functionalities is listening for the user's location. I need a high location accuracy to be aware of when the user gets inside certain areas, and I am not sure what kind of location service should I use.</p>

<p>AFAIK, <em>significant-change location service</em> provides low accuracy, right? I do not know exactly what should understand by ""significant-change"". I have not read about its accuracy in Apple's docs, but I read something about it in some posts, so this won't fit my needs. If it is that way, I should choose between <em>standard location service</em> and <em>region monitoring</em>. I know that the standard service can be set an accuracy level and a distance filter, but this seems to drain the battery. On the other hand, region monitoring seems to be more efficient in terms of power level, but I am not sure if I can reach high accuracy with this service. And I need to monitor a lot of areas; I don't know if that is possible or it can only be provided one.</p>

<p>Thanks in advance </p>",ios|gps|location|core-location|cllocationmanager,1833423,AppsDev,yes
How can I make a background service for timer without showing a notification?,"<p>I have tried many solution but useless, all say use foreground service.</p>
<p>is there a way to <strong>trick</strong> android or to use a proper way.</p>
<p>i know it's restriction from android to inform the user that an app is draining the battery without using it.</p>",java|android,16816067,Sameer Saeed Anwar,yes
How should I schedule process in android for my purpose,"<p>I have developed an android application which fetches data from online db server like parse.com. I want to schedule a process, that fetches data and updates view every 10 or 20 secs, to execute again and again with fixed delay even if the application is not turned on. I have seen other answers but confused that to use alarm manager or scheduleexecutor. and if alarm manager then please can somebody put code for alarm manager that is optimally designed such a way that battery is not drained out or so otherwise scheduleexecutor should be used then please post code implementing it. I tried but could not achieve even a simple scheduling. Thank you in advance!</p>",android|eclipse|alarmmanager,2867438,Vinay Joshi,yes
Android gps retrieval,"<p>I have an app that track location using a location manager. I want to log a location when a user moved 100 feet, so I set up the listener to request updates for 100 feet and pass in a time of 30 seconds. I can see my gps icon blinking every 30 seconds so it is requesting a location. However, if I am it a building with a poor signal it will try CONSTANTLY to poll a gps location, so the signal never stops blinking, which drains the battery in a hurry. Is there a way to NOT poll for a gps location if it cannot get a signal right away? I tried passing in a large value for time (say 30 minutes) but then my gps only polls every 30 minutes, regardless of the distance I moved. </p>",android|locationmanager|android-location,1200083,user1200083,yes
"Xcode helper ""swift"" consuming a lot of memory","<p>On MacOS Catalina, I run Xcode 11.2 (or 11.2.1 GM). From time to time, a process called ""swift"" appear in Activity Monitor consuming a lot of memory, which is way more than my MacBook Pro 15' 2019 can handle it. The battery is draining very fast and the fans of the laptop are going crazy.</p>

<p>Can anybody can help me, or explain me if this is normal or not?</p>

<p>Thank you</p>

<p><a href=""https://i.stack.imgur.com/a3Ij1.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/a3Ij1.png"" alt=""enter image description here""></a></p>",xcode|macos|macos-catalina|activity-monitor,4644852,Tudor Popa,yes
"Accuracy of ""Region Monitoring"" on iOS 6","<p>I'm trying to make a location-based app that requires constant updating of the location after opening. I was looking for a way to keep the location in the background when the app is closed and I found that is not the best way because it would drain the battery very quickly from any iPhone.</p>

<p>To cut a long story short I found with the ""Region Monitoring"" as I have understood they are the same as Apple uses for their App ""Reminders"" that also works with location. Then I used that option to test my app and I realize that in the simulator ""never"" enters the method ""didEnterRegion"" despite it is correctly created:</p>

<pre><code>-(void) locationManager: (CLLocationManager *) manager didEnterRegion: (CLRegion *) region
 {
     NSLog (@ ""entering the region"");
     CLLocation * location1 = manager.location;
     CLLocation * location2 = [[CLLocation alloc] initWithLatitude: latitud.doubleValue longitude: longitud.doubleValue];
 }
</code></pre>

<p>I finally realized that the method is called but only when I walked away much of the area and I was back to the area, indicating that it did not work because I was already in that location (all this in the simulator), the strange thing is that it was not, the location of the simulator was miles from the region to monitor! Which leads me to think it is problem of accuracy, despite creating the region with 50 or 100 meter radius was spreading the 3 or 4 km, so I was useless.</p>

<p>Has anyone experienced this knows if iOS 6 simulator has this error or if precision problem? I don't have a Developer Licence yet to test it directly on my iPhone and I do not want to buy it yet because my app is far from finished, I appreciate any help on this topic.</p>

<p>Thanks in advance.</p>",ios|location|ios-simulator|region|cllocation,1920606,Roberto Briones Argüelles,no
SyncAdapter stays awake for hours on end,"<p>My Android app uses a <code>SyncAdapter</code> to sync with my API service. I use <code>delayUntil</code> to tell it to only sync every half an hour. However, some users are reporting incidents where it never goes to sleep again once it's done, draining the phone battery (e.g. the app shows up in the device's battery page showing a ""Keep awake"" of 13 hours+).</p>

<p>I'm also certain there's no infinite loops in the <code>onPerformSync</code> method - it makes a few HTTP calls and updates the database and that's about it.</p>

<p>Has anybody else ever experienced anything like this, and if so, what was behind it?</p>",android|android-syncadapter,4397,andygeers,yes
ComponentDidUpdate() causing memory leaks and drainage of battery in IOS,"<p>I am using componentDidUpdate() method for displaying updated data on screen whenever any functionalities is performed like scanning Qr code and storing data. But after searching on net I found that calling this.setState in componentDidUpdate() creates infinite loop. I tried to remove this problem through including prevState in the above method but I failed. Below is my code for more details. How can I update state coming from Asyncstorage without the help of componentDidUpdate()?</p>

<pre class=""lang-js prettyprint-override""><code>componentDidUpdate() {
    try {
      AsyncStorage.getItem('Data').then((value) =&gt; {
        this.setState({
          list: JSON.parse(value)
        })
      })
    } catch (err) {
    }
  }
</code></pre>

<p>Any help or suggestions would be helpful Thanks.</p>",react-native|memory-leaks|react-native-ios|asyncstorage,8017373,ahd786,no
How to check if your location has been confirmed in Android?,"<p>I'm building an app that involves getting the user's current location. I already have it getting the location, but sometimes it's inaccurate. </p>

<p>I've noticed that when I start the app, a location services symbol appears greyed out in the notice bar. While it's greyed out my app will sometimes report that I'm where I was an hour ago, even if I'm miles away. A few moments later the symbol will be solid and then the app reports the correct location.</p>

<p>The phone seems to understand that it's not entirely sure for moment. Is there a way to check this programmatically? </p>

<p>I'm aware of how to check if location services are enabled. The problem is that my location is not updating quickly enough and I'd like to wait until the phone is absolutely sure of where I am.</p>

<p>My current fix is to make a fake loading screen that just forces the user to sit for a few seconds, but this seems a bit sloppy. Also, I have no guarantee that the location will have updated properly by the end of the three seconds.</p>

<p>I'm trying to avoid making the app run in the background and check periodically because I'm worried about draining the battery.</p>",android|geolocation|location,4619411,halfg33k,yes
Sony Smartwatch widget refresh,"<p>I have a Problem with my Sony SmartWatch App. I've developed a widget with control, but after the App is installed by users on the device the scheduled refresh task of the widget starts automatically. This means the refresh task is running all the time, even if the user did not turn on SmartWatch Display or start the widget. This drains the battery. If I go to the widget screen and then turn the display from off, the scheduled Task stops like expected. But if I don't do this the task is running and running and running....
How can I detect if the Display is on and the widget is running?</p>

<p>Thank you very much!</p>

<p>P.S.: It makes no difference if the ""Activate Widget"" preference is checked or not....</p>

<p>EDIT: I've found out that the widget sourcecode does not fire if I uncheck the ""Display as Widget"" Checkbox in preferences. This means if the refresh schedule is running and I uncheck this box, the onDestroy is never called and so the cancel schedule also not....</p>",sdk|sony|sony-smartwatch,980175,user980175,yes
Is Task.Run or Task.Factory.StartNew are bad practice for windows phone or any other client platform?,"<p>I have WP 8.1 app that using web service a lot, and I want to keep it as much responsive as possible. From iOS dev expierense - there is one strict rule: ""Do not do in UI thread any complex calculations! Doesnt matter how you will reach this: with blocks or with GCD"".</p>

<p>Problem that not all API has async versions, e.g. JSON.NET, SQLite or any own complex algorithm in the app. I have read a lot of <a href=""http://blogs.msdn.com/b/pfxteam/archive/2012/03/24/10287244.aspx"" rel=""nofollow"">articles</a> that are defining Task.Run and Task.Factory.StartNew as bad practice + <a href=""https://github.com/JamesNK/Newtonsoft.Json/issues/66"" rel=""nofollow"">this</a>.</p>

<p>So, is it good to write code like this? Will it cause some cpu overloading/battery drain/stability issues? If async wrappers are bad idea - what is the right way to make complex operations async(background thread)?</p>

<pre><code> protected async Task&lt;T&gt; GetDataAsync&lt;T&gt;(string uriString, CancellationToken cancellationToken = default(CancellationToken))
    {
        var uriToLoad = new Uri(uriString);
        using (var httpClient = new HttpClient())
        {
            var response= await httpClient.GetAsync(uriToLoad, cancellationToken).ConfigureAwait(false);
            response.EnsureSuccessStatusCode();
            cancellationToken.ThrowIfCancellationRequested();

            var dataString = await response.Content.ReadAsStringAsync().ConfigureAwait(false);
            cancellationToken.ThrowIfCancellationRequested();

            // async wrapped call to sync API
            var result = await Task.Factory.StartNew(() =&gt; JsonConvert.DeserializeObject&lt;T&gt;(dataString), cancellationToken).ConfigureAwait(false);
            cancellationToken.ThrowIfCancellationRequested();

            return result;
        }
    }
</code></pre>",c#|.net|windows-runtime|windows-phone|async-await,1941262,Ivan Golub,yes
"PhoneStateListener and LocationManager inside a Timer, how to? (Android)","<p>I am developing an app that the main objective is collect data from the sensors in the background and send it to a DataBase. To do so, I am using a <code>Remote Service</code> for taking the data from the background.</p>

<p>Inside the <code>Service</code>, I have a periodic <code>TimerTask</code> in a <code>Timer</code>, that does:</p>

<ol>
<li>Check sensors setting</li>
<li>Activate sensors which data is wanted</li>
<li>Take the data</li>
<li>Stop sensors</li>
</ol>

<p>I decide to start and stop the sensors every time because it is done every 30 sec, and it's better than have them set. Moreover, I have the same problem if I set them before and add a new one that wasn't set, and setting all them is not efficient as the GPS drains a lot the battery.</p>

<p>The problem is that <code>PhoneStateListener</code> and <code>LocationManager</code> don't work inside a non looper thread (<code>Timer</code> is a non looper thread). </p>

<p>Is there any way to solve this problem? Is there any trick to skip it?</p>",android|timer|background|locationmanager|phone-state-listener,3472374,blaider13,no
The effect of using WebSocket on Android battery and memory,"<p>Im using core Android and node.js backend.
I had an HTTP POST API to send user's location to server.</p>
<p>Since I had to frequently update the user location to server for more than 30 minutes, I'm changing the API to better use a WebSocket.</p>
<p>I wanted to know a few things.</p>
<ol>
<li><p>What is the impact of using WebSocket on battery life of Android phone? Does it drain more battery?</p>
</li>
<li><p>Does WebSocket use more internet bandwidth compared to HTTP?</p>
</li>
<li><p>Does WebSocket use more RAM both on Android and backend server?</p>
</li>
</ol>",android|kotlin|websocket,1724453,Gissipi_453,no
Is there an API for Mobile Messenger?,"<p>Do you know if there is an API to connect to the mobile messenger? I have a mobile application that needs to receive a callback when the contacts on the mobile messenger are online.</p>

<p>I know that I can query the live messenger JSON interface but that will require me pulling this information (and draining the battery) but if mobile messenger is running it is already keeping a connection alive to the messenger service.</p>

<p>I can see pleny of documentation on the messenger API for desktop but this is for mobile.</p>

<p>Thanks</p>",windows-mobile|mobile|msn-messenger,87602,No hay Problema,yes
MyLocationOverlay disableMyLocation() not seeming to work,"<p>Just wasted 3 hours trying to figure out why the GPS icon is still showing up in the notification bar when my map activity is paused.  I've narrowed it down to having to do with the MyLocationOverlay object I'm using (I also have a LocationListener and a GpsStatus.Listener).</p>

<pre><code>@Override
protected void onPause() { 
super.onPause();
manager.removeUpdates(locListener);
manager.removeGpsStatusListener(statListener);    

myLocOverlay.disableMyLocation(); //!doesn't seem to work
myLocOverlay.disableCompass();    
}
</code></pre>

<p>If anyone has any idea why this is happening please help so I don't pull all my hair out.  I can't release my app with a battery draining issue like this.</p>",android|gps|onpause|mylocationoverlay,800619,NSjonas,yes
Very Battery Friendly App/Widget(Android),"<p>I have been looking around here and <a href=""http://developer.android.com/reference/android/provider/Settings.System.html"" rel=""nofollow"">There</a>, and I have become curious.</p>

<p>I was wondering if there is anything staple that is usually applied to android apps to make sure they do not become battery hungry. Such as portion of code that is normally added to make sure app gets closed all the way when it is exited?</p>

<p>What would be the best practice(code wise) that I could do to make sure my app/widget does not drain battery life.</p>

<p>For example lets just say my app is an informative one with a little bit of user interaction or a simple widget(Not a game etc.)</p>",android|android-widget|power-management,750711,sealz,no
Best Way to Frequently Poll a Server from an Android App,"<p>I have an Android app which needs to poll a web server at 2 second intervals.  </p>

<p>So I would like to know what the best way to do this would be. My first thought was to use an AlarmManager but I believe this is no good for anything more frequent than about 5 minute intervals. I have also considered using a service but I am concerned this will drain the battery. Are there any options I haven't considered? What is the best way to poll a server very frequently without killing the battery?</p>

<p>I also know that GCM is the ideal way to sync with a server but unfortunately it is not an option at this time.</p>

<p>Edit: ok, it seems from your comments that it is as I feared and there's no good solution for this. I will probably implement it in a service and press for a push mechanism instead. Thanks for your help.</p>",android|android-service|polling,2377793,L. Lowe,yes
Android — How to track bandwidth usage by application or process?,"<p>I can track the overall bandwidth usage of Android device. I wanted to know if there is any method or way, maybe an API or class, that can help me track my bandwidth usage per application or process?</p>

<p>Reason for this question? I want to stop all those processes or applications that are using way too much bandwidth usage and draining the battery.  </p>",android|bandwidth|usage-statistics,435597,Muhammad Shahab,no
How to disable Doze for an app?,"<p>The new <code>Doze</code> mode on <code>Android 6</code> disables nearly every useful background activity. I have an app, which regularly woke up the device (even if no lock screen), kept a partial wake lock, did some scans and reported that to the Internet. It is not a spy app - this operation is on purpose and known to users of the app. </p>

<p>Right now with <code>Android 6</code> it doesn't work anymore, because the <code>Doze</code> mode prevents the final communication with my servers. </p>

<p>I found a new setting under ""Battery"", which did allow me to put my app on a list of those app, which did not support ""battery optimization"". In the first tests it seemed, that this was making my app run again.</p>

<p>After some additional tests I found, that even my app was not supporting <code>Doze</code>, it didn't work anymore in background.</p>

<p>Isn't this setting supposed to disable <code>Doze</code> for particular apps?</p>

<p>Details to Doze here <a href=""http://www.androidpolice.com/2015/06/01/android-m-feature-spotlight-this-is-exactly-how-doze-reduces-battery-drain/"" rel=""nofollow"">http://www.androidpolice.com/2015/06/01/android-m-feature-spotlight-this-is-exactly-how-doze-reduces-battery-drain/</a></p>",android|optimization|battery|android-6.0-marshmallow,409461,decades,yes
iOS 6 - Relaunch the killed app in background,"<p>I know this isn’t possible in iOS 7 But after searching I read on some forums that it was possible in iOS 6. Now the question is, I want to relaunch the app if the app is in background and gets killed because of non activity. Currently I am triggering location updates every 10 minutes when the app is in the background but It drains a lot of battery and I am sure Its not the right way to do it. I would like to know If someone has implemented this type of behavior successfully in iOS 6. </p>

<p>Note: This is a concept app. Not meant for App Store..</p>",ios|objective-c,1861225,Obj-Swift,no
fastboot problems leads to bootable but non-starting glass,"<p>I was hoping to have some Glass hacking fun tonight.  Turned out really bad.  :( </p>

<p>Let me try to explain the steps I have taken. </p>

<ol>
<li>I installed Launcher.apk and Setting.apk</li>
<li>Paired a keyboard and mouse</li>
<li>All was good. </li>
</ol>

<p>Then I tried to unlock the device as described at <a href=""https://developers.google.com/glass/downloads/system"" rel=""nofollow noreferrer"">https://developers.google.com/glass/downloads/system</a></p>

<ol>
<li>adb reboot bootloader</li>
<li>fastboot oem unlock</li>
</ol>

<p>The system sat there for over an hour so I hit Ctrl+c assuming that something had gone wrong.  I checked if the system was in adb or fastboot mode and it looked like it was still in fastboot, so I tried again.  30 minutes later nothing had happened so I Ctrl+c'd it again.  </p>

<p>Here is a copy of the output of the terminal for those steps:</p>

<pre><code>local:Downloads mmicire$ adb install -r Launcher2.apk 
4361 KB/s (9723188 bytes in 2.176s)
    pkg: /data/local/tmp/Launcher2.apk
Success
local:Downloads mmicire$ adb install -r Settings.apk 
3937 KB/s (3269290 bytes in 0.810s)
    pkg: /data/local/tmp/Settings.apk
Success
local:Downloads mmicire$ adb devices
List of devices attached 
015D98410D020013    device

local:Downloads mmicire$ adb reboot bootloader
local:Downloads mmicire$ fastboot oem unlock
...
(bootloader) Warning: Unlocking your device will void your warranty
(bootloader) and erase your personal data from the device.
(bootloader) Run ""fastboot oem unlock"" again to confirm.
(bootloader) Device still locked.
OKAY [  0.001s]
finished. total time: 0.001s
local:Downloads mmicire$ fastboot oem unlock
...
^C
local:Downloads mmicire$ adb reboot bootloader
error: device not found
local:Downloads mmicire$ fastboot devices
015D98410D020013    fastboot
local:Downloads mmicire$ fastboot oem unlock
...
^C
local:Downloads mmicire$ fastboot reboot
rebooting...
</code></pre>

<p>After the device rebooted it went back into the Glass home screen and everything looked fine.  So I tried adb reboot bootloader again and the system seemed unable to boot into fastboot mode.  When I type ""adb reboot bootloader"" the system shutdown, rebooted, showed the GLASS logo and started right back up into Android.</p>

<p>I then tried Jenny Murphy's solution for fastboot here -- <a href=""https://stackoverflow.com/questions/17519865/having-issues-seeing-glass-in-fastboot"">Having issues seeing GLASS in Fastboot</a> -- and it did not change the situation.  The system boots, the LED comes on solid for about 5 seconds, then the system reboots and I see the GLASS logo as the system is coming up. </p>

<p>So I thought that possibly doing a factory reset might fix things.  (It was a stretch at this point.)   I went into the Glass setting and performed a factory reset.</p>

<p>The system rebooted, presented the GLASS logo, and then presents the welcome screen asking me to go to google.com/myglass.  I went to the URL on my laptop and configured a WIFI connection.  The Glass does not seem to be reading QR codes at this point.  I have a very clear picture of the QR code and it just does not seem to be responding at all. </p>

<p>The problem I have now is that I have no way of getting past the second screen for WIFI, I can't turn on debugging since I can't get to the settings menu, and I also can't hardware-enable fastboot to reset the image to factory.  :(</p>

<p>So, after a discouraging evening of hacking, I am needing some help.  At this point, the Glass can only boot, ask me to go to the web, and then pretend to read QR codes to no avail.  Feeling like a d-bag for pseudo-bricking a 48-hour old Glass.  </p>

<p>Thoughts anyone?  </p>

<p>This was on a OSX 10.8.5 machine running adt-bundle-mac-x86_64-20130917.  I do have linux machines available if that helps. </p>

<p>Thank you ahead of time.  </p>

<hr>

<p>EDIT:  I have been able to log back into the device and enable debugging.  ""adb reboot bootloader"" still gives the previous behavior of shutting down, LED is solid for about 5 seconds, reboot, GLASS screen.   I do see a usb device in linux appear and then disappear during what I assume is the fastboot debug device coming up and down during this cycle. </p>

<hr>

<p>EDIT:  Tried it on my linux box as recommended by Jenny, but no dice.  The Glass is not willing to stay in fastboot mode.  On reboot, while watching dmesg, I can see the Android debug device dissapear, the glass reboots, I see the fastboot device come up and then three seconds later it dissapears.  Then the Glass reboots into normal Android.  </p>

<p>:(</p>

<hr>

<p>SOLUTION:  (And this makes <em>NO</em> sense to me.)  I basically ran the battery completely dead.  I have had other Android phones where I needed to pull the batteries and let them sit for a while, so I tried the closest thing that I could accomplish without disassembling the battery from the unit.  It sat on my desk completely drained for a couple days.  I would turn the Glass on even after dying to drain the battery as far as possible.  Frankly, this was as much out of frustration as anything else.</p>

<p>72 hours later, I charged it for about 30 minutes and plugged it into my Linux machine and did the following:</p>

<pre><code>mmicire@blue:~$ sudo fastboot devices
015D98410D020013    fastboot
mmicire@blue:~$ sudo fastboot oem unlock
...
(bootloader) Warning: Unlocking your device will void your warranty
(bootloader) and erase your personal data from the device.
(bootloader) Run ""fastboot oem unlock"" again to confirm.
(bootloader) Device still locked.
OKAY [  0.001s]
finished. total time: 0.001s
mmicire@blue:~$ sudo fastboot oem unlock
...
(bootloader) Erasing personal data. This could take a while...
(bootloader) Erasing cache...
(bootloader) Erasing userdata...
(bootloader) Unlocking...
(bootloader) Device unlocked!
OKAY [256.353s]
finished. total time: 256.353s
</code></pre>

<p>Nothing done differently from the last test for Jenny.  Not sure what I did, but it just decided to work.  I suppose there was something resident with the charged battery?  </p>

<p>Thank you to everyone that helped.  I hope that this helps someone else.  Off to hacking....  </p>",google-glass|fastboot,2848522,mmicire,yes
Background location service stops working in a period of time,"<p>I'm developing an iOS application that users can save their traveling route to server (by posting their locations through API). The issue I am struggling with is several users reported that the route they saved is interrupted in the middle of the trip. In detail, when users review their saved route on map, there is a part of route being just a straight line because somehow locations of that route section are not sent to server or just because the device can not receive locations at that time. 
The weird thing is that the rest of route was recorded normally so seems like the location service stopped working for a period of time but after that it started again so my app could record it fine.</p>

<p>And the most frustrating thing is that I can not reproduce this issue.</p>

<p>Here are circumstances of the issue that user reported:
<br>- User started the app then locked device screen and put it in their pocket, they did not touch it in the whole journey. No battery drain or crash happened.
<br>- After driving about 8-9km and everything worked fine, route recording was interrupted in the next ~ 65km, then well-recorded again in the rest ~ 80km.</p>

<p>Below is my project setup:
<br>- Background Modes in ON in Capabilities with Location updates.
<br>- Locations received from location service are filtered based on timestamp and accuracy and saved to core data with a “isSent” flag marking if a location is sent successfully to server. This way my app can cover the case when network connection is down.
<br>- Locations marked with false “isSent” flag will be sent to server every 30 seconds. </p>

<p>My LocationManager code:</p>

<pre><code>class LocationManager: NSObject, CLLocationManagerDelegate {

    var locationManager: CLLocationManager = {
        var _locationManager = CLLocationManager()
        _locationManager.delegate = self
        _locationManager.desiredAccuracy = kCLLocationAccuracyBestForNavigation
        _locationManager.activityType = .automotiveNavigation
        _locationManager.allowsBackgroundLocationUpdates = true
        _locationManager.pausesLocationUpdatesAutomatically = false

        return _locationManager
    }()


    func startLocationService() {
        locationManager.startUpdatingLocation()
        locationManager.allowsBackgroundLocationUpdates = true
        locationManager.pausesLocationUpdatesAutomatically = false
    }

    func locationManager(_ manager: CLLocationManager, didUpdateLocations locations: [CLLocation]) {
        var positionsToSavedToDb: [DbPositionModel] = []

        for location in locations {
            let howRecent = location.timestamp.timeIntervalSinceNow

            guard abs(location.timestamp.timeIntervalSinceNow) &lt; 10 &amp;&amp; location.horizontalAccuracy &gt; 0 &amp;&amp; location.horizontalAccuracy &lt; 33 else {
                continue
            }

            if self.locations.count &gt; 0 {
                let distanceSinceLastLocation = location.distance(from: self.locations.last!)
                let timeSinceLastLocation = location.timestamp.timeIntervalSince(self.locations.last!.timestamp)
                if (distanceSinceLastLocation &lt; 5 &amp;&amp; abs(timeSinceLastLocation) &lt; 10) {
                    continue
                }
            }

            // Create DbPositionModel from location and append to positionsToSavedToDb
        }

        // Save positionsToSavedToDb to core data
    }

    @objc func each30Seconds(_ timer: Timer) {
        // Select in database DbPositionModel objects with false “isSent” flag to send to server
    }
}
</code></pre>

<p>Can you guys help me find out black holes in my code or anything I can do to reproduce / fix this issue? Thanks a lot!!!</p>",ios|core-location|ios-background-mode,2365840,thy.nguyen,yes
Add trial period to app. Shall I use Timer or DispatchQueue in Swift (iOS)?,"<p>That application I am making has 5 days trial period. Please tell me what is the best way to show alert or something after trial period is over. I want to use the method which drains less battery and is more efficient. Following are two ideas. </p>

<p><strong>Timer:</strong></p>

<pre><code>Let fiveDays = 5 * 24 * 60 * 60    
Timer.scheduledTimer(withTimeInterval: fiveDays, repeats: false, block: { (timer) in print(""Hi!"")})
</code></pre>

<p><strong>DispatchQueue</strong></p>

<pre><code>Let fiveDays = 5 * 24 * 60 * 60 
DispatchQueue.main.asyncAfter(deadline: .now() + fiveDays, execute: {
    self.functionToCall()
})
</code></pre>

<p>Please suggest:</p>

<blockquote>
  <ol>
  <li>What is the best approach? Is it <strong>Timer</strong> or <strong>DispatchQueue</strong></li>
  <li>Why is it the best approach?</li>
  </ol>
</blockquote>",ios|objective-c|iphone|swift|xcode,8187839,Ella,no
Android - Tamagotchi game background service,"<p>I try to build a Tamagotchi game with Unity for Android. The Tamagotchi has a food attribute that should go down even when the Game is closed.</p>

<p>So my approach would be build a IntentService that holds the variables, increase and decrease them if needed. For Batterie reasons i would use Alarm manager to start the Service only every 10 minutes if the App is closed. If the app is started it would bind the Service so it never closes and i can get the Variables. </p>

<p>Is there a more efficient way to handle this? I dont want my app to battery drain too much.</p>

<p>€: 
If the food gets low it should also display a notification. </p>",android|android-intent|unity3d|android-service,1326797,roadis,no
Battery usage of sencha touch 2 application,"<p>//Hi i have developed one application in sencha touch 2 framework with the help of phonegap build.The thing is that i need to test my application so that i come to know battery usage of of my application. Can u provide some detail how to do that and whats the minimum battery consumption of a normal application .My application size is 2mb after phonegap build. Because i dont want my application drain mobile battery.</p>

<p>//Hey and one more thing is there any way to check battery level of mobile so that i can alert user battery is low and close application or put for mobile charge. The device itself show battery low than also i need to check.Provide me proper guidance in this.</p>",extjs|sencha-touch-2,1425393,swathi001,yes
iPhone SDK: CLocationAccuracy. What constants map to what positioning technology?,"<p>With respect to CLocationManager docs....</p>

<p>Constant values you can use to specify the accuracy of a location.</p>

<pre><code>extern const CLLocationAccuracy kCLLocationAccuracyBestForNavigation;
extern const CLLocationAccuracy kCLLocationAccuracyBest;
extern const CLLocationAccuracy kCLLocationAccuracyNearestTenMeters;
extern const CLLocationAccuracy kCLLocationAccuracyHundredMeters;
extern const CLLocationAccuracy kCLLocationAccuracyKilometer;
extern const CLLocationAccuracy kCLLocationAccuracyThreeKilometers;
</code></pre>

<p>Given that, I have the following questions.</p>

<ol>
<li>What triangulation method (GPS, cell tower or wi-fi)  corresponds to each accuracy level?</li>
<li>Does iPhone SDK utilize Skyhook Wireless API?</li>
<li>For kCLLocationAccuracyBestForNavigation, there is note stating the phone must be plugged in. Is this enforced or is it just warning the developer the battery is likely to drain quick from using the GPS receiver.</li>
</ol>

<p>Thanks in advance.</p>",ios|iphone|core-location,265550,user265550,yes
WIll overlaying the screen with a dark UIView save battery power?,"<p>Would a full screen black overlay UIView with a 0.8 alpha value reduce battery drain the same as setting the device system brightness to a low value?</p>

<p>I would prefer to use my own UIView overlay so I can animate it smoothly dimming the screen rather than messing with the users device settings.</p>

<p>Thanks for any help.</p>

<p>Geoff
iOS 6, Universal app</p>",ios|battery|batterylevel,641665,GeoffCoope,no
Android App high cpu usage and battery drain,"<p>I've been working on an android game for awhile now. I have the basic game implemented so now I'm going back and trying to optimize. It seems like the battery drain and CPU usage are too high for what I'm doing. I really only have my main thread and then all the drawing and updating is done on a separate thread.</p>

<p>Below is the code for the actual game thread that does updating and all the drawing. All of the actual code has been removed, what's left is what I've been experimenting with to figure out the abnormal CPU usage/battery drain. </p>

<p>So basically if I start the below thread with only an infinite while loop the app uses about 315mAh or about 9% of my phones battery in 30 minutes of use. If I start the thread with no code inside the run method so that it expires after one run through it uses roughly 70mAh or 2% of the phone battery in the same amount of time. The CPU usage also jumps from 2%-3% without the thread running to about 14%-15% when the thread running and just running the infinite loop. </p>

<p>To summarize it seems like running the thread with only an infinite while loop, that does nothing, increases the battery usage by 7% over 30 minutes. I don't see how this is possible and think I must be missing something. I'll keep working to figure this out but there's no more code to take out. If anyone has any suggestions or can provide some insight as to why this is happening I'd greatly appreciate it. Thanks in advance.</p>

<pre><code>class InnerThread extends Thread
    {
        public InnerThread()
        {
            super();
        }

        public void run()
        {
           while(true){}
        }
    }
</code></pre>",android|cpu|battery,5282850,Envenge,yes
Airplaying video from url to ATV using lots of battery on iphone,"<p>I am writing an app that plays a url using MPMoviePlayerController.  The app works in the background and using airplay also works with an ATV, macmini using airserver and XBMC.  The url is to a movie file on the local network.  The way I <a href=""http://nto.github.com/AirPlay.html"" rel=""nofollow"">understand</a> is that the phone doesn't do any heavy lifting but merely passes the url to the apple tv and as long as the url points to media that the AppleTV supports then it will play.</p>

<p>The problem I am having is that the apple TV must be aggressively pinging the iphone and keeping the wifi active since the battery life is hit really hard.  Playing an average sized movie knocks the battery life by about 2/3 on an IPhone 3GS and 1/2 on an IPhone 4S.  </p>

<p>If I am playing on the mac mini using <a href=""http://www.airserverapp.com/"" rel=""nofollow"">air server</a> then the battery life on the phone reduces at the same rate as if the phone was backgrounded and not playing anything.  I noticed that if I stop the wifi on the iphone then the movie will keep playing on the mac mini but stops within about 30s on the ATV.  I am guessing the ATV keeps pushing out an event saying that it is playing and if it doesn't receive an OK in return then it stops playing.</p>

<p>Is there something I am doing wrong? Have other people experienced the same battery drain using airplay from their phone?  I have tried someone else's app and it also did the same.</p>",iphone|airplay|apple-tv,1321728,Ajaxharg,yes
What is active GPS effect on mobile devices battery life?,"<p>How much does active GPS drain the battery? Without the overhead of the gps navigator software. s
ay I want to sample the gps every 2 minutes and save it to a file. how much battery power will that cost me?</p>

<p>Will I get 10% shorter life? 20%? ..?</p>",iphone|android|mobile|gps|mobile-phones,161753,eyalw,no
Fusionlocationprovider not working without gps in android,"<p>I am working on googlemaps application,i am using google fusion location provider for finding currentlocation and i am trying requestlocationupdates but the problem i am facing when i am using gps and locationrequest priority HIGH_ACCURACY,my battery is getting drain very fast thats why i wanted to change my locationrequest priority to BALANCED_POWER but without gps i am unable to get latitude and longitude but in google docs they mentioned without gps also it should work please reply</p>

<p>code:</p>

<pre><code>_googleApiClient = new GoogleApiClient.Builder(this)
                .addApi(LocationServices.API)
                .addConnectionCallbacks(this)
                .addOnConnectionFailedListener(this)
                .build();
 _locationRequest = new LocationRequest();
 _locationRequest.setPriority(LocationRequest.PRIORITY_BALANCED_POWER_ACCURACY);
  PendingResult&lt;Status&gt; pendingResult = LocationServices.FusedLocationApi.requestLocationUpdates(
                    _googleApiClient, _locationRequest,this);
</code></pre>",android|gps|location,2991069,skyshine,yes
How to increase consistency of Android geofence enter/exit notifications?,"<p>I am using the built in geofence APIs (play services) and have been having mixed results. It looks like after setting a geofence, the notifications for entering/exiting are very inconsistent even when GPS is on, with an up-to-date location (LocationClient connected, running in the background.) I started monitoring (polling) location changes and distances in a debug text field, and saw that, even when based on the location registered by the device and the location of the geofence I am technically inside/outside of the geofence, notifications are sometimes triggered and sometimes not. Any way to make this more predictable? I am almost tempted to abandon this api and implement my own (battery draining) geofences based on polling of device location.</p>",android|android-maps-v2|android-geofence,316597,oviroa,yes
What strategy to adopt to monitor the user location in background?,"<p>I want to <strong>track the user location in background</strong>, in the purpose to show him an alert when he is close to one of his friend. </p>

<p>So i start with <code>CLLocationManager</code>. As far as i know their is only one reliable way to let the app know about the location update even if the user reboot the Iphone or kill the app: <code>startMonitoringSignificantLocationChanges</code>. But the problem is that even inside a city with many wifi, <code>startMonitoringSignificantLocationChanges</code> fire the <code>DidUpdateLocations</code> when the user move around 1km and that is really too much for my need</p>

<p>on the other way <code>startUpdatingLocation</code> is firing <code>DidUpdateLocations</code> at good interval (even too much because even when the user do not move it's fire quite often <code>DidUpdateLocations</code>). But <code>startUpdatingLocation</code> not survive to iphone reboot or app being killed by the user. Also I suspect that even with an accuracy of 100m, <code>startUpdatingLocation</code> use lot of battery consumption.</p>

<p>So the question: <strong>What strategy i can use in my app to track</strong> efficiently without draining too much the battery <strong>the user location at full time</strong>? I need an accuracy of around 100m and if possible an interval between 2.5 - 5 min for each track (i didn't find any option to specify a delay to wait before to catch a new location)</p>

<p>Actually i think to do something like this :</p>

<ul>
<li>2 <code>locationManager</code>, 1 <strong>GPS</strong> and 1 <strong>Significant Changes</strong> </li>
<li>when app start I do with <strong>significantChangesLocationManager</strong>: <code>startMonitoringSignificantLocationChanges</code> and <code>startMonitoringVisits</code></li>
<li>I also call <strong>GPSLocationManager</strong> <code>startUpdatingLocation</code> to retrieve the accurate user position. I set up <code>PausesLocationUpdatesAutomatically(true)</code> so that the <strong>GPSLocationManager</strong> will stop by himself soon or late</li>
<li>on <code>DidUpdateLocations</code> raise by the <strong>GPSLocationManager</strong> I start monitoring region enter/exit (100m radius around the obtained latitude/longiture) with <strong>significantChangesLocationManager</strong></li>
</ul>

<p>What do you think of such strategy ?</p>",ios|core-location|cllocationmanager,1114043,zeus,yes
Determine whether user is at a specific location,"<p>What's the best way to determine whether the user is at a specific location, i.e. at a gas station? </p>

<p>I've implemented an approach where the app is listening for major location changes until the user get's close enough to a location. Then the app switches to the more accurate location updates (<code>kCLLocationAccuracyBest</code>). It then checks if the user is close enough, and if so, I consider this as a ""check-in"". This works quite well. If the user moves away from our location of interest, I switch back to the major location updates to save energy.</p>

<p>This works as the user does not live or work within the first threshold (I currently use 300 meters). This situation drains the user's battery for no reason. If I set this threshold to low, the major location updates might not be accurate enough to detect the user in front of our location.</p>

<p>I'm using <code>MKLocalSearchRequest</code> to find all the places of interest in close proximity to the user.</p>

<p>So, I assume there are better ways. Any suggestions?</p>

<p>Thanks!<br>
– Flo</p>",ios|swift|mapkit|core-location|mklocalsearchrequest,322603,flohei,no
Android Application drains battery too fast,"<p>The android application I am developing needs to read the info from the sensors, mostly the accelerometer. I want my application to be able to get the info from the sensors, but I do not want the phone's screen to be constantly on because this drains the battery very fast. I need to find a way for the phone to read the info from the sensors, but remain locked or in sleep. The application is supposed to be running in the background constantly and be reading this info. Any ideas?</p>",android|accelerometer|battery,597302,Alex,yes
Google maps - distanceTo vs proximity alert vs geofence,"<p>I'm building an app for mobile which needs to monitor the distance between the user's location and multiple location markers at regular intervals. From what I have read here and on other sites, I have three options:</p>

<p>1) use the distanceTo and distanceBetween functions to calculate the distance between the user's  location and each location marker
<br />2) use proximity alerts associated with each marker location
<br />3) use geofences associated with each marker location as per <a href=""https://developer.android.com/training/location/geofencing.html"" rel=""nofollow"">Creating and Monitoring Geofences
</a></p>

<p>Which approach is the best to use in light of (a) ease of implementation, (b) battery drain, and (c) gps / location accuracy? Given that I am designing predominantly for mobile, I am assuming that wifi will not always be available. </p>",android|distance|google-maps-api-2|proximity|android-geofence,3603025,ConfusedByTheMetricSystem,yes
Cellular network location service draining too much battery?(android),"<p>we are developing an application in android which uses cellular(GSM) network location service (NOT GPS).Drains  battery very fast when we use this location service in our application...</p>

<p>I dont know what causes this draining .. any pitfalls, suggestions?</p>

<p>thanks for help</p>",android|networking|location|battery,4974816,Efe Engin ÇÖLOĞLU,yes
wakelock fails to keep service alive,"<p>I am implementing simple timer and I require it to perfectly measure time.<br>
 Problem is that even using foreground, START_STICKY and wake lock when timer is started somehow time measuring is killed after some time when phone is not used. I assume it is going in deep sleep mode and then somehow my partial wakelock (only cpu required) is ignored.
Is there some way to prevent that? Just for the record, I am going with that solution as I think that simple time counting is not a big deal for cpu and it won't drain battery as hell.</p>

<p>One more thing, when testing on API 19 it seems not likely to be killed. On API 25, device with 'cleaner' Android it is usually killed after 30min to 2h after running. Kill is in my opinion not related to too high memory usage as my app is the only one running in background ( user started).</p>

<p>Thanks in advance for any ideas.</p>",android|wakelock,5525590,kolboc,yes
App crashes on API level 23 : Exception java.lang.IllegalArgumentException: Invalid notification (no valid small icon):,"<p>I am displaying a custom view notification, it is working perfect except in marshmallow ,while i am using 24x24 ,36x36, 48x48, 72x72 px icon</p>

<pre><code>    android.support.v7.app.NotificationCompat.Builder builder = new android.support.v7.app.NotificationCompat.Builder(m_context);
    Intent i = new Intent(m_context, RunningAppsActivity.class);
    i.setFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP);
    PendingIntent intent = PendingIntent.getActivity(m_context, 0, i, PendingIntent.FLAG_UPDATE_CURRENT);
    builder.setTicker(m_context.getResources().getString(com.soopermo.batterybooster.R.string.click_to_optimize));
    builder.setSmallIcon(R.drawable.battry_notify);
    builder.setAutoCancel(true);
    Notification notification = builder.build();
    RemoteViews contentView = new RemoteViews(m_context.getPackageName(),R.layout.status_bar);
    // Set text on a TextView in the RemoteViews programmatically.
    final String text = m_context.getResources().getString(com.soopermo.batterybooster.R.string.draining_apps) ;
    contentView.setTextViewText(com.soopermo.batterybooster.R.id.status_bar_content_desc2, text);
    contentView.setOnClickPendingIntent(com.soopermo.batterybooster.R.id.optimization, intent);
    notification.contentView = contentView;

    // Add a big content view to the notification if supported.
    // Support for expanded notifications was added in API level 16.
    // (The normal contentView is shown when the notification is collapsed, when expanded the
    // big content view set here is displayed.)
    if (Build.VERSION.SDK_INT &gt;= 16) {
        // Inflate and set the layout for the expanded notification view
        RemoteViews expandedView =
                new RemoteViews(m_context.getPackageName(), com.soopermo.batterybooster.R.layout.status_bar);
        notification.bigContentView = expandedView;
        expandedView.setOnClickPendingIntent(com.soopermo.batterybooster.R.id.optimization, intent);
    }
    NotificationManager nm = (NotificationManager) m_context.getSystemService(NOTIFICATION_SERVICE);
    nm.notify(POWER_ISSUES_ID, notification);
    //...........................................................
</code></pre>",android|android-notifications|android-6.0-marshmallow,7320716,Sam,yes
My app drains battery even that I release wake lock,"<p>I'm building a simple app that has <code>BroadcastReciever</code> that listens to PHONE_STATE:</p>

<pre><code>        &lt;receiver android:name="".PhoneStateBroadcastReceiver"" &gt;
            &lt;intent-filter&gt;
                &lt;action android:name=""android.intent.action.PHONE_STATE"" /&gt;
            &lt;/intent-filter&gt;
        &lt;/receiver&gt;
</code></pre>

<p>In the <code>BroadcastReciever</code>'s <code>onRecieve()</code> I start a service when the state is <code>OFFHOOK</code> and stop the service when the state is <code>IDLE</code>:</p>

<pre><code>public class PhoneStateBroadcastReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {

        Bundle bundle = intent.getExtras();

        String state = bundle.getString(TelephonyManager.EXTRA_STATE);
        if(state.equals(TelephonyManager.EXTRA_STATE_OFFHOOK)){
            context.startService(new Intent(context, ProximityService.class));
        }
        else if(state.equals(TelephonyManager.EXTRA_STATE_IDLE)){
            context.stopService(new Intent(context, ProximityService.class));
        }
    }

}
</code></pre>

<p>In the service I'm registering proximity sensor listener, and creating a <code>WakeLock</code> so the screen will turn off well while on call.
After the call ends I stop the service, and in its <code>onDestroy()</code> I'm unregistering the listener and release the <code>WakeLock</code>.
But it seems that something is not releasing out there because I see a huge battery drain from my app (30%).</p>

<p>I put a Log when the listener unregistering and also on the <code>WakeLock</code> release, and I can see that the <code>WakeLock</code> is released and the listener is unregistered successfully (I can also see the Log from <code>SensorManager</code> that the listener is unregistered).</p>

<p>What am I missing here?
That's really annoying.</p>

<p>Some code of the service:</p>

<pre><code>public int onStartCommand(Intent intent, int flags, int startId){

    Log.d(""CALL"", ""Service started"");

    // Get an instance of the sensor service, and use that to get an instance of
    // a particular sensor.
    mSensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
    mProximity = mSensorManager.getDefaultSensor(Sensor.TYPE_PROXIMITY);

    mSensorManager.registerListener(this, mProximity, SensorManager.SENSOR_DELAY_NORMAL);

    mAudioManager = (AudioManager)this.getSystemService(Context.AUDIO_SERVICE);

    mPowerMngr = (PowerManager) getSystemService(Context.POWER_SERVICE);
    try{
        mWakeLock = mPowerMngr.newWakeLock(PROXIMITY_SCREEN_OFF_WAKE_LOCK, ""Proximity"");

        if (!mWakeLock.isHeld()) {
            Log.d(""CALL"", ""Wake lock acquired"");
            mWakeLock.acquire();
        }
    }
    catch (Exception e){
        mWakeLock = null;
    }


    return START_STICKY;
}

public void onDestroy(){
    super.onDestroy();
    mSensorManager.unregisterListener(this);

    if (mWakeLock != null) {
        if (mWakeLock.isHeld()) {
            Log.d(""CALL"", ""Wake lock released"");
            mWakeLock.release();
        }
    }


            Log.d(""CALL"", ""Service stopped"");
    }
</code></pre>

<p>The log I see:</p>

<pre><code>09-30 03:35:09.120: D/SensorManager(21565): unregisterListener:: disable all sensors for this listener,  listener = com.eladaharon.android.proximity.ProximityService@41a31a18
09-30 03:35:09.125: D/CALL(21565): Wake lock released
09-30 03:35:09.125: D/CALL(21565): Service stopped
</code></pre>

<p>Thanks a lot!
Elad</p>",android|battery|proximity|wakelock,713441,Elad92,no
AndEngine - Battery drain & device heating,"<p>I've developed my game using AndEngine and have one serious problem. Users report me that game heat device too much and drains battery. I don't understand why it's happen because game is just simple puzzle and I don't use complex animations or physics. Also, I disabled updates for major part of sprites and set wakelock options:</p>

<pre><code>engineOptions.setWakeLockOptions(WakeLockOptions.SCREEN_ON);
</code></pre>

<p>but this not helps.
You can see game here: <a href=""https://play.google.com/store/apps/details?id=com.icecat.hex"" rel=""nofollow"">https://play.google.com/store/apps/details?id=com.icecat.hex</a></p>

<p>I'll be happy to ask any questions about code. Please, write what do you think about possible problems or engine settings that can cause this problem.</p>",android|andengine|battery|overheating,1033230,Dimmerg,no
Run upload process in background even when phone is asleep,"<p>So I have developed an android application that determines the user's location every 5 seconds using the fused location (LocationClient), and send this data to my server. This whole process repeats itself every 5 seconds when the app is running. I am uploading the data in background using AsyncTask class.</p>
<ul>
<li><p><strong>The Problem:</strong></p>
<p>Data uploading stops when user closes the app or when the phone is put to sleep.</p>
</li>
<li><p><strong>What I want:</strong></p>
<p>I want the app to continuously send location data to my server even when the user closes the app or when the phone is asleep. This process should run on a seperate thread as I don't want this process to make my UI thread unresponsive.</p>
</li>
<li><p><strong>What I found till now:</strong></p>
<p>I have heard of services, intentservices and alarmmanager but I don't know which one to use. I also heard of wakelocks to force the CPU not to sleep. Remember I don't want to keep the screen ON all the time as this will drain the battery.</p>
</li>
</ul>
<p>How can I make my app send data to server all the time ?</p>",android|multithreading|service|alarmmanager,2979117,Rakesh,yes
Using OpenGL on lower-power side of Hybrid Graphics chip,"<p>I have hit a brick wall and I wonder if someone here can help. My program opens an OpenGL surface for very minor rendering needs. It seems on the MacbookPro this causes the graphics card driver to switch the hybrid card from low performance intel graphics to high performance AMD ATI graphics.</p>

<p>This causes me problems as there seems to be an issue with the AMD driver and putting the Mac to sleep, but also it drains the battery unnecessarily fast. I only need OpenGL to create a static 3D image on occasion, I do not require a fast frame rate!</p>

<p>Is there a way in a Cocoa app to prevent OpenGL switching a hybrid graphics card into performance mode?</p>",c++|cocoa|opengl,2645677,Paul Norman,yes
ios: How to restart app when it terminated in background?,"<p>I write app (for use in auto) which works in background and use gps (startUpdatingLocations).
Of'cource I know about bgModes in plist and battery drain.
And I need exactly gps - with high accuracy.</p>

<p>Application works normally until the other gps-app not goes to foreground.
After some time, since user open another navigation program the iOs system terminate my program.
I can just notify user ""Sorry, but os decide to kill my application. Restart it again"".
But it's not good.</p>

<p>So, is it a way to restart program (in background)???</p>

<p>Absolutely standard code. Nothing special</p>

<pre><code>class ""gps""
-(id)init
{
.....
    locMan = [[CLLocationManager alloc] init];
    locMan.delegate=self;
    locMan.distanceFilter = kCLDistanceFilterNone;
    locMan.desiredAccuracy = kCLLocationAccuracyBestForNavigation;
.....   
}

-(void)start
{
..............
    if(sysVer&gt;=8.0)
    {
        [locMan requestAlwaysAuthorization];
    }
    [locMan startUpdatingLocation];
    if(sysVer&gt;=6)
    {
        locMan.pausesLocationUpdatesAutomatically=NO;
    }
............
}

- (void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations
{
    ... processing
}

-(void)locationManager:(CLLocationManager *)manager didFailWithError:(NSError *)error
{
   ... processing
}
</code></pre>",ios|background|gps|location,4582863,klvd57,yes
Know if the device has moved and register gps coords,"<p>I'm doing an app and I want to check on internet some information, but I only want to do it if the device has been moved <em>X</em> meters.
For example, if the user has moved 300 meters, make a call to the server, if not, do nothing. But I think I can't launch a service listening all the time the gps coords and calculating the distance, because the battery will draing to fast.</p>

<p>And my question is: There are any way that Android start a service o send a broadcast warning me that the gps coord has changed X meters?</p>

<p>Currently I have an AlarmManager and every 30 minutes gets the gps coords, but I need more accurate.</p>",java|android|gps,681666,Pipeline,yes
Application with GPS that consults a web service every X minutes,"<p>I'm try to build an application that runs in the background in my Android and every X time units sends the position to a remote web service that returns some data or null. It's necessary to send the position in every consult. It's necessary that the cellphone initialize the event.
The use case is that I'm walking in the city, and when I'm next to a point in the maps my cell  provides information about that place.</p>

<p>What is the best way to handle this that will not drain the battery?</p>

<p>My idea is run in the background the gps handler that every ten minutes gets the current position, and to have a service that sends the information to the web service.</p>",android|gps|android-service|battery,1435753,user1435753,yes
Creating Java Rechargeable Battery Tester,"<p>I can't figure out how to make the code for this tester part of my program.
I provided the Battery class I made but need help making the tester to run everything.</p>

<pre><code>package batterytester;

public class Battery {
    // identifies variables and cap means capacity
    double fullCharge = 2500;
    double batteryCap;

    Battery() {
        fullCharge = 2500;
    }

    public Battery(double cap) {

        batteryCap = cap;
        fullCharge = cap;

    }

    void charge() {
        batteryCap = fullCharge;
    }

    void drain(double amount) {
        batteryCap = batteryCap - amount;
    }

    double getRemainingCapacity() {
        return batteryCap;
    }
}
</code></pre>",java,5344082,Rachel Herndon,yes
android how to keep gps open and locked,"<p>I'm working on a project to get geolocation within 10 seconds interval via gps on android. I'm using a background service to do it,i'm using <code>requestLocationUpdates</code> to get exact location, problem is 10 seconds is not enough time for GPS lock it's usually takes 20 seconds to 1 minute exact lock, to fix that problem i'm increasing time interval to 3 minutes,then gps activating,locking to satellite and getting exact geolocation. But after getting exact location GPS going to sleep and GPS icon disappear from screen,until to next update. There is <code>stopUsingGPS()</code> in the class but i'm not calling or using in anywhere in my code. As you guys know when you open yandex navi or google maps it keeps GPS open and locked until you destroy the application,how i can do the same ? I've tried this approach <a href=""https://stackoverflow.com/questions/1993016/android-how-to-keep-gps-active-until-more-accurate-location-is-provided"">Android: How to keep GPS active until more accurate location is provided?</a> but result was the same, GPS icon appears, locking to satellite,getting geolocation and going to sleep, how i can keep GPS open and locked until i stop the service ?</p>

<p>PS : I know that kind of method will drain the battery very quickly but in this project battery life is not important. Also i'm a beginner about Android Studio,i've used and edited class from StackOverflow,if you guys can explain the solution it will be great for me.</p>

<p>Thanks in advance.</p>

<p>Here is my GPSTracker Class;</p>

<pre><code>package com.atalay.reporter.Control;

import android.app.Activity;
import android.app.AlertDialog;
import android.app.Service;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.os.IBinder;
import android.provider.Settings;
import android.util.Log;

import com.atalay.reporter.Service.Reporter;

/**
 * Created by BARISUSER on 9.12.2015.
 */
public class GPSTracker extends Service implements LocationListener {

    private final Context mContext;

    // flag for GPS status
    boolean isGPSEnabled = false;

    // flag for network status
    boolean isNetworkEnabled = false;

    // flag for GPS status
    boolean canGetLocation = false;

    Location location; // location
    double latitude; // latitude
    double longitude; // longitude
    double speed;

    // The minimum distance to change Updates in meters
    private static final long MIN_DISTANCE_CHANGE_FOR_UPDATES = 10; // 10 meters

    // The minimum time between updates in milliseconds
    private static final long MIN_TIME_BW_UPDATES = 1000 * 60 * 1; // 1 minute

    // Declaring a Location Manager
    protected LocationManager locationManager;


    public GPSTracker(Context mContext) {
        this.mContext = mContext;
        getLocation();
    }

    public Location getLocation() {
        try {
            locationManager = (LocationManager) mContext
                    .getSystemService(mContext.LOCATION_SERVICE);

            // getting GPS status
            isGPSEnabled = locationManager
                    .isProviderEnabled(LocationManager.GPS_PROVIDER);

            // getting network status
            isNetworkEnabled = locationManager
                    .isProviderEnabled(LocationManager.NETWORK_PROVIDER);

            if (!isGPSEnabled &amp;&amp; !isNetworkEnabled)
            {
                //B.A. 08.12.2015 TODO: Buradan devam et
                showSettingsAlert();
            } else
            {
                this.canGetLocation = true;
                // First get location from Network Provider
                if (isNetworkEnabled)
                {
                    locationManager.requestLocationUpdates(
                            LocationManager.GPS_PROVIDER,
                            MIN_TIME_BW_UPDATES,
                            MIN_DISTANCE_CHANGE_FOR_UPDATES, this);
                    Log.d(""Network"", ""Network"");
                    if (locationManager != null)
                    {
                        location = locationManager
                                .getLastKnownLocation(LocationManager.GPS_PROVIDER);
                        if (location != null) {
                            latitude = location.getLatitude();
                            longitude = location.getLongitude();
                            speed = location.getSpeed();
                        }
                    }
                }
                // if GPS Enabled get lat/long using GPS Services
                if (isGPSEnabled) {
                    if (location == null) {
                        locationManager.requestLocationUpdates(
                                LocationManager.NETWORK_PROVIDER,
                                MIN_TIME_BW_UPDATES,
                                MIN_DISTANCE_CHANGE_FOR_UPDATES, this);
                        Log.d(""GPS Enabled"", ""GPS Enabled"");
                        if (locationManager != null) {
                            location = locationManager
                                    .getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
                            if (location != null) {
                                latitude = location.getLatitude();
                                longitude = location.getLongitude();
                                speed = location.getSpeed();
                            }
                        }
                    }
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
        }

        return location;
    }

    /**
     * Stop using GPS listener
     * Calling this function will stop using GPS in your app
     * */
    public void stopUsingGPS(){
        if(locationManager != null){
            locationManager.removeUpdates(GPSTracker.this);
        }
    }

    /**
     * Function to get latitude
     * */
    public double getSpeed ()
    {
        if(location != null)
        {
            speed = location.getSpeed();
        }
        else
        {
            speed = 0;
        }
    return speed;
    }
    public double getLatitude(){
        if(location != null)
        {
            latitude = location.getLatitude();
        }

        // return latitude
        return latitude;
    }

    /**
     * Function to get longitude
     * */
    public double getLongitude(){
        if(location != null){
            longitude = location.getLongitude();
        }

        // return longitude
        return longitude;
    }

    /**
     * Function to check GPS/wifi enabled
     * @return boolean
     * */
    public boolean canGetLocation() {
        return this.canGetLocation;
    }

    /**
     * Function to show settings alert dialog
     * On pressing Settings button will lauch Settings Options
     * */
    public void showSettingsAlert(){
        AlertDialog.Builder alertDialog = new AlertDialog.Builder(mContext);

        // Setting Dialog Title
        alertDialog.setTitle(""GPS is settings"");

        // Setting Dialog Message
        alertDialog.setMessage(""GPS is not enabled. Do you want to go to settings menu?"");

        // On pressing Settings button
        alertDialog.setPositiveButton(""Settings"", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog,int which) {
                Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
                mContext.startActivity(intent);
            }
        });

        // on pressing cancel button
        alertDialog.setNegativeButton(""Cancel"", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int which) {
                dialog.cancel();
            }
        });

        // Showing Alert Message
        alertDialog.show();
    }

    @Override
    public void onLocationChanged(Location location) {
        Reporter.aktifEnlem = location.getLatitude();
        Reporter.aktifBoylam = location.getLongitude();
        Reporter.hiz = location.getSpeed();
    }

    @Override
    public void onProviderDisabled(String provider) {
    }

    @Override
    public void onProviderEnabled(String provider) {
    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
    }

    @Override
    public IBinder onBind(Intent arg0) {
        return null;
    }

}
</code></pre>

<p>My Reporter Class;</p>

<pre><code>package com.atalay.reporter.Service;

import android.app.Service;
import android.content.Context;
import android.content.Intent;
import android.os.IBinder;
import android.telephony.TelephonyManager;

import com.atalay.reporter.Common.ApiHelper;
import com.atalay.reporter.Common.Utils;
import com.atalay.reporter.Control.GPSTracker;

/**
 * Created by BARISUSER on 7.12.2015.
 */
public class Reporter  extends Service {
    final static long Dakika = 10000;
    private ApiHelper apiHelper;
    private GPSTracker gpsTracker;
    public static double aktifEnlem = 0;
    public static double aktifBoylam = 0;
    public static double hiz = 0;
    private boolean ilkKonum = false;

    @Override
    public void onCreate(){
        super.onCreate();
        apiHelper = new ApiHelper();
        gpsTracker = new GPSTracker(Reporter.this);
        if(!ilkKonum){
            if(aktifBoylam==0 || aktifEnlem==0)
                if(gpsTracker.canGetLocation()){
                    aktifEnlem = gpsTracker.getLatitude();
                    aktifBoylam = gpsTracker.getLongitude();
                    hiz = gpsTracker.getSpeed();
                }
        }

    }

    @Override
    public void onDestroy()
    {
        //gpsTracker.stopUsingGPS();
    }

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId)
    {
        new Thread(new Runnable() {
            @Override
            public void run() {
                while (true)
                {
                    try {

                        if (Utils.InternetControl(Reporter.this.getApplicationContext())) {
                            isYap();
                        }
                        Thread.sleep(Dakika * 1);
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }
            }
        }).start();
        return Service.START_STICKY;
    }

    public String getIMEI(Context context)
    {

        TelephonyManager mngr = (TelephonyManager) context.getSystemService(context.TELEPHONY_SERVICE);
        String imei = mngr.getDeviceId();
        return imei;

    }
    private void isYap()
    {
        if(aktifBoylam!=0 || aktifEnlem!=0)
        {

            apiHelper.setParam(""enlem"", aktifEnlem);
            apiHelper.setParam(""boylam"", aktifBoylam);
            apiHelper.setParam(""hiz"", Math.round(hiz/1000));//hiz means speed
            apiHelper.setParam(""cid"", getIMEI(this));
            apiHelper.responseString(ApiHelper.ResponseType.POST);
        }
    }
}
</code></pre>",android|gps|geolocation,5416882,BMF,no
Suspend all firebase connections when react-native app is in background,"<p>I want to suspend all firebase connections when my app goes in background. My app plays music in the background. I also create some realtime-database event handlers when the app is started. After the app is put in background and the app is playing music, I see that there is a continuous network activity in my app due to which the battery drains quickly. I checked out the below two methods</p>

<p><a href=""https://firebase.google.com/docs/reference/js/firebase.database.Database#goOffline"" rel=""nofollow noreferrer"">https://firebase.google.com/docs/reference/js/firebase.database.Database#goOffline</a></p>

<p><a href=""https://firebase.google.com/docs/reference/js/firebase.database.Database#goOnline"" rel=""nofollow noreferrer"">https://firebase.google.com/docs/reference/js/firebase.database.Database#goOnline</a></p>

<p>which seem to suggest that they would suspend and resume firebase connections respectively. I hooked up these methods with my app but I still see network activity in the app when the app is in background. So, I want to know are the above two methods suppose to suspend and resume all firebase connections? If not, then is there a way to achieve it?</p>

<p>I am checking the network activity in the ""Energy Report"" on Xcode. I have pasted a screenshot of the report below. Please observe that the app is shown to be in the background by grey blocks but there is also some amount of network activity.</p>

<p><a href=""https://i.stack.imgur.com/E4qcm.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/E4qcm.png"" alt=""enter image description here""></a></p>",ios|firebase|react-native|firebase-realtime-database,2923135,Varun Gupta,no
AlarmsManager triggers whenever it wants,"<p>I want to trigger a notification each day at a specific time choosen by the user, like 6' / 7' / 8'.</p>

<p>For this, I created a <code>WakefulBroadcastReceiver</code>, that pass to an <code>IntentService</code> to create the notification.</p>

<p>And this is how I setup my AlarmsManager. <code>timeInHours</code> is an integer passed as parameter, between 6 and 12 :</p>

<pre><code>    Intent i = new Intent(context, StepCountNotifyBroadcast.class);
    PendingIntent pi = PendingIntent.getBroadcast(context, 0, i, 0);

    // Get the next day at timeInHours hours'.
    Calendar cal = Calendar.getInstance();
    cal.setTime(new Date()); // compute start of the day for the timestamp
    cal.set(Calendar.HOUR_OF_DAY, timeInHours);
    cal.set(Calendar.MINUTE, 0);
    cal.set(Calendar.SECOND, 0);
    cal.set(Calendar.MILLISECOND, 0);
    cal.set(Calendar.AM_PM, Calendar.AM);

    if (new Date().getTime() &gt; cal.getTime().getTime())
        cal.add(Calendar.DAY_OF_YEAR, 1);

    long nextDay = cal.getTime().getTime();

    // Setup the alarm.
    long timeBetween = AlarmManager.INTERVAL_DAY;      // Each day.
    AlarmManager alarms = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
    alarms.cancel(pi);
    alarms.setRepeating(AlarmManager.RTC_WAKEUP, nextDay, timeBetween, pi);

    Date nextDayAsDate = new Date(nextDay);
    GLog.d(""AlarmUtils"", ""scheduleNotifiation for next date: "" + nextDayAsDate.toString());
</code></pre>

<p>It works well 50% of the time, but still do crazy things like... Trigger the notification at 2:00 AM ?!
I know the system will not trigger the notification at the specific time I want and this is ok. But here we talk about approximately 18 hours later.</p>

<p>In logs, it seems that my IntentService code is effectively running in the middle of the night in some cases. So that's not an issue with the notification itself.</p>

<p>I can switch this line :</p>

<pre><code>    alarms.setRepeating(AlarmManager.RTC_WAKEUP, nextDay, timeBetween, pi);
</code></pre>

<p>to another line of code :</p>

<pre><code>    alarms.setExact(AlarmManager.RTC_WAKEUP, nextDay, pi);
</code></pre>

<p>But this is not good for the battery life I'm afraid.</p>

<p><strong>Now my questions :</strong></p>

<ul>
<li>Can somebody tell me a reason about the way Android devices works with AlarmsManager ?</li>
<li>Do you find another solution than will not drain battery life and be sure the notification will be triggered in maximum 2 or 3 hours later?</li>
<li>Do you have any ideas, in this particular case, to debug and do code testing without waiting a day or two to detect issues?</li>
</ul>

<p>Thanks in advance.</p>",android|notifications|android-alarms,2235748,doubotis,no
What is the most battery-efficient way of monitoring proximity to a number of locations in Android?,"<p>I have an app which will take some (internet) action every time the user approaches any one of a set of locations (for example, let's say it notifies a server whenever I am near a Starbucks shop, so my coffee habits can be analysed).</p>

<p>What's the most battery-efficient (yet reliable and relatively accurate) way of causing the phone to do something whenever it's at a certain location? I don't need perfect location accuracy - within 50m or so is fine.</p>

<p>Currently, I set a ProximityAlert for each location with a 100m radius, and have it raise an Intent, which is then served by a Service which runs in the background. The service also includes an Alarm which causes a download every three hours or so.</p>

<p>The Service itself doesn't appear to drain any significant amount of battery - the battery is all drained by ""Android OS"". According to the Android 4.1.2 Battery monitor, Android OS is using 3x as much CPU as a phone without my app, and has ""stay awake"" on for most of the time.</p>

<p>Would changing it to an IntentService make a difference?</p>

<p>Would reducing (or increasing) the radius of the alert make a difference?</p>

<p>Would converting it to a Geofence (<a href=""https://developer.android.com/training/location/geofencing.html"" rel=""nofollow"">https://developer.android.com/training/location/geofencing.html</a>) make much difference?</p>

<p>Can I set it to use a cheaper location service unless it thinks it's close to one of the locations (or will it do that automatically?)</p>",android|android-location|geofencing|android-geofence,1882129,Richard Russell,no
Does having multiple ProximityAlerts (or Geofences) set drain more battery than just having one set?,"<p>Does each additional ProximityAlert or Geofence locations increase the battery drain of an Android App?
Would there be a significant difference between an app monitoring one location vs five locations vs one hundred locations?
Would there be a difference if all these locations are in one city or if they are spread around the world?
Do these characteristics differ between ProximityAlerts and Geofences?</p>",android|android-location|geofencing|android-geofence,1882129,Richard Russell,yes
Does Android ProximityAlert or Geofence drain more battery when the phone is closer to a monitored location?,"<p>If I use an Android ProximityAlert with a given radius (say 100m), and my phone is regularly near (or at) that location, will the battery drain be greater than if I am rarely near that location? Is there a distance within which the battery drain increases?</p>

<p>What about with Geofences instead?</p>

<p>Ideally, I'd like to understand the impact on battery life of the following scenarios:</p>

<p>R = radius of the proximityAlert or Geofence area
D = distance of phone from location in proximityAlert</p>

<ul>
<li>D &lt; R (phone definitely within proximity alert location)</li>
<li>D >> R (phone definitely outside proximity alert location)</li>
<li>D ~= R (phone near boundary of proximity alert location)</li>
</ul>

<p>Is there any particular location (ie value of D or of D-R) where the phone will automatically change location provider to a more expensive option to increase accuracy?</p>",android|android-location|geofencing|android-geofence,1882129,Richard Russell,yes
Capture lat long using gps without battery drain,"<p>In my application I want to capture lat long using gps with particular interval. The interval should be 5 or 10 minute. 
My question is the GPS is enable only at the time of capture the location or it always enable the GPS to find the location updates</p>",android|geolocation,609050,Krishna,no
Location tracking windows 8,"<p>Im working on a reminder which also supports location-based reminders (eg when you get near your house it tells you to switch off the alarm for example)..</p>

<p>I need the app to check the location lets say every 2 minutes (so it doesnt drain the battery too much).</p>

<p>What technology should I use? I was thinking about toast notifications but this is to remind the user the he is approaching the location, but there needs to be a background task which checks the location even if the app is not running?</p>

<p>Are there any other technologies apart from background tasks that I should consider?</p>",c#|windows-8|background|gps|location,1808126,Alexander Ciesielski,no
Disable Bluetooth hardware programmatically in iOS?,"<p>How can I turn off the bluetooth hardware when I'm done with it so that my app does not drain the battery?</p>

<p>I've seen references to private frameworks but not how to do this in a way that will not get rejected by Apple.</p>

<p>What Framework/code do I need?</p>",iphone|hardware|bluetooth|ios,224988,Moshe,yes
Background user location when app is terminated/suspended,"<p>I've been trying to figure out how to get the user's location when the app is terminated like how the app Moves does it. The only way I know of doing so is with Significant Location Changes. However with significant location changes, the app only gets woken up either every 500 meters and only if it has been around 5 minutes past the last update. </p>

<p>According to Apple:</p>

<blockquote>
  <p>Apps can expect a notification as soon as the device moves 500 meters or more from its previous notification. It should not expect notifications more frequently than once every five minutes. If the device is able to retrieve data from the network, the location manager is much more likely to deliver notifications in a timely manner.</p>
</blockquote>

<p>In the Moves app, even with the app is terminated, it is able to retrieve the user's location very accurately without having much drainage in battery. It also doesn't seem to have background location turned on as it's reason in the battery usage list only shows ""Background Activity"". So I'm wondering how an app like Moves is doing this. Any help would be great! Thanks.</p>",ios|objective-c|cllocationmanager,391812,Zack,no
Android - Activity Recognition best practices,"<p>In my Android application, I want to display a notification only when the user is not moving or only slowly moving. For example, when a user is driving, I don't want to display notifications. To accomplish this, I've looked into the Activity Recognition API and implemented a basic component -- and it basically works alright. </p>

<p>During some first test, I've noticed that occasionally see some strange output when I simply check for the activity with the highest confidence, e.g., getting a <code>IN_VEHICLE</code> while walking. Since this is based on statistics and what not, I'm not surprised of that. I, therefore, use simple sliding window over the last N activity types. Only when all values in the window are the same, I assume the respective activity.</p>

<p>Now I have 3 configuration parameters:</p>

<ul>
<li><p><code>TIME_BETWEEN_REQUESTS</code> (in milliseconds) as the minimum time between the request for the current activity value as part of the Activity Recognition API. The lower to value the more up-to-date but the higher the battery drain. For testing, I currently set it only to 5000 (=5sec)</p></li>
<li><p><code>MIN_CONFIDENCE</code> (0..100) minimum confidence referring <code>DetectedActivity.getConfidence()</code>. Only if the confidence is larger than this threshold, I consider that the API is confident enough about the detected activity. On the Web, I see most commonly a <code>MIN_CONFIDENCE &gt;= 75</code></p></li>
<li><p><code>WINDOW_SIZE</code> (>= 1) as the minimum number of the same activity types before I'm sure about the detected activity. Currently, I use <code>WINDOW_SIZE = 3</code>. So if a user is walking and the phone detects an occasional <code>IN_VEHICLE</code> I don't immediately assume that the users are driving. Only if the next two values are also <code>IN_VEHICLE</code>, I change the user's activity state.</p></li>
</ul>

<p>Does this make sense? I'm a bit worried if I increase <code>TIME_BETWEEN_REQUESTS</code> -- What is a practical value anyway -- because it takes at least <code>WINDOW_SIZE * TIME_BETWEEN_REQUEST</code> before the activity state of a user will change. Right now it's 15sec, but if I would set <code>TIME_BETWEEN_REQUESTS</code> to 30sec and keep <code>WINDOW_SIZE 3</code>, it would require at least 90sec for a change to occur.</p>

<p>What are good/best practices here? Is the window even necessary or do larger values for <code>TIME_BETWEEN_REQUESTS</code> already do some kind of smoothing?</p>",android|android-googleapiclient|activity-recognition,874380,Christian,yes
Background location tracking: iOS,"<p>I'm trying to decide between Apple's significant location change services and start / stopping the location manager regularly myself. This is what Apple says about it : </p>

<blockquote>
  <p>Gathering location data is a power-intensive operation. It involves powering up the onboard radios and querying the available cell towers, Wi-Fi hotspots, or GPS satellites, which can take several seconds. Leaving the standard location service running for extended periods can drain the device’s battery. (The significant-change location service drastically reduces battery drain by monitoring only cell tower changes, but the service works only on devices with cellular radios.) <strong>For most applications, it is usually sufficient to establish an initial position fix and then acquire updates only periodically after that</strong>. If you are sure you need regular position updates, you should use the significant-change location service where you can; otherwise, you should configure the parameters of the standard location service in a way that minimizes its impact on battery life.</p>
</blockquote>

<p>So, my usecase is to be able to alert the user if they are near (~1km) a certain location. Should I just skip Significant location updates and poll the location manager every 10 minutes or so myself?</p>

<p>Thanks, <br />
Teja.</p>",iphone|objective-c|ipad|ios4|cllocationmanager,116858,Tejaswi Yerukalapudi,no
How can server notify mobile app?,"<p>I have been researching for the last few days but have not found any concrete answer for this question.</p>

<p>I have a mobile app that users logged in to . The app makes call to an external database using REST Api and fetches data when required e.g : Button press , loading etc...</p>

<p>However , i can't figure out how to make the server notify a user/mobile app when something happens.></p>

<p>The only way i can think of is to make the app check the server every second which is overkill and will drain battery life along with database call.</p>

<p>Let's say one user messages another user , how can i make the server send a ping or something to that specific user's mobile app to inform him of a new message ?</p>

<p>As far as i know , REST is completely independent of the server/app and the communications goes only one way : app -> server -> return data to app</p>

<p>Is there any way for the server to send data to the app without any initial request ?</p>

<p>Or if there is a better way to do this</p>

<hr>

<p>I'm using Xamarin cross-platform with a php backend (Slim)</p>

<p>I read a bit about push notifications , but i'm not sure if thats what im looking for . </p>

<p>I want to update the app while the user is still on at times - like when they get a message - instead of receiving a push notification from google , the app should simply be alerted by the server that a new message is in and reload the ""thread""</p>",rest|mobile|notifications,3443451,Jimmy,yes
Battery drain while transmitting Eddystone beacons,"<p>I am trying to use an Android device to transmit Eddystone beacons. I would like to know the approximate battery drain the device consumes to transmit beacons in the background.
Thanks.</p>",beacon|eddystone,6292885,Parth Parekh,no
Does ObjectAnimator drain bettery,"<p>I am using ObjectAnimator to create an Animation in the background of my text.I have a frameLayout containing 10  views which uses ObjectAnimator to create a random animation. This frameLayout is used as background to a text view.</p>

<p>I observed that after creating this background using ObjectAnimator the battery of my device has started draining fast.
I could not find any references where someone has faced similar problem.</p>

<p>Does ObjectAnimator cause battery drain if run continuously ? If yes, what could be the way to prevent this. </p>",android|objectanimator|batterylevel,2674995,Pankaj Goyal,yes
Android. Show notification in exact time,"<p>I have a question, that has been asked here many times, but I still can't find correct solution.</p>
<p>I need to implement in an app a feature, that will show notification in exact time (for example, show notification every 30 minutes).</p>
<p>I tried use::</p>
<ol>
<li>Standard notifications with High Priority flag</li>
<li>Standard notifications with High Priority flag and disabled doze optimization</li>
<li>Notifications with Alarm Manager</li>
<li>Alarm Manager and disabled Doze</li>
</ol>
<p>Points 2 and 4 are working well, but not enough. In this case notification could be delayed for 3 minutes (if phone is not used in a long time period).</p>
<p>So, the question is :: Is there any way to show notifications in exact time without delay larger than 1 min ??</p>
<p>P.S. It is said everywhere, that using of AlarmManager will drain you battery much. I didn't find that.</p>",android|push-notification|alarmmanager|battery|android-powermanager,17436856,Lim,yes
ios 8 periodic background process even after app termination,"<p><strong>NOTE: This app I am working on is completely for my own usage and will not be on app store so please don't give answers referring that.</strong></p>

<p>I want my app to do some process in background or after termination (double tap the home button and swipe the app from applications multitask) every few minutes. The process is very very light and quick so it won't drain the battery. This process shouldn't require internet connection. I have seen some answers here like and I will explain what are the problems:</p>

<ol>
<li><p>VoIP. The problem with VoIP is wither it should be in background to use <code>UIApplication.sharedApplication().setKeepAliveTimeout(..)</code> method which doesn't work when the app is terminated or it should be connected to the internet to establish tcp connection and receive commands from sever and as mentioned before I want it to be internet independent. </p></li>
<li><p>Location Services. I found <a href=""http://mobileoop.com/getting-location-updates-for-ios-7-and-8-when-the-app-is-killedterminatedsuspended"" rel=""nofollow"">this</a> excellent site with some great articles but the problem is it only works when the mobile phone is moved more than 500 meters. It depends on the location movement so when the phone is staying somewhere there will be no code execution.</p></li>
<li><p>Playing an silent audio loop. The problem here is if the user plays another audio (which is completely possible like music or phone call) the app will terminate!</p></li>
<li><p>Jailbreak Launch Daemons. I can't require jailbreak so it should be solved with a non-jailbreak solution:(.</p></li>
</ol>

<p>I am free to use any kind of private-API's and there will be no restriction for that.</p>

<p>Thanks in advanced</p>",ios|iphone|ios8|background-process|iphone-privateapi,1138273,Hamed,yes
Connect Automatically to Bluetooth Paired Device Efficiently,"<p>I've been looking around a lot at the best way to connect to a paired Bluetooth device when it comes back in range, and so far I have a background service that cycles through all of the paired devices and attempts to connect to them every 10 seconds or so. </p>

<p>I was wondering if there was a better way to accomplish this, such as receiving a message when it comes back in range, so that I wouldn't have my device constantly attempting to connect to devices and draining battery life.  I've found that ACTION_FOUND doesn't work consistently for paired devices, but maybe there's something I'm missing.</p>",android|android-bluetooth|pairing,4086752,Jacob Frey,yes
Is it possible to write a Chrome extension that adds CPU usage to the tab name? e.g. [xx%] SiteName,"<p>Chrome 81.</p>

<p>Would it be possible to build a Chrome extension with access to per-tab CPU usage, i.e. these numbers here: 
<a href=""https://i.stack.imgur.com/YgJXq.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/YgJXq.png"" alt=""cpuusage""></a></p>

<p>...and prepend them to the tab titles, e.g. for Gmail, instead of ""<strong>Inbox</strong>"" it would display as ""<strong>[51%] Inbox</strong>"". Or better yet, only do so if the 10-second average CPU usage crossed a user-defined threshold, e.g. 25%. The goal there being to identify tabs which might be draining your battery.</p>

<p>I took at look at <a href=""https://developer.chrome.com/extensions/processes"" rel=""nofollow noreferrer"">chrome.processes</a> but it seems it's still only available in the Dev channel, and even then, not sure what I am asking for is available using the API. I am also aware of a similar question such as <a href=""https://stackoverflow.com/questions/56844762/how-to-get-cpu-usage-of-current-tab-from-chrome"">How to get cpu usage of current tab from chrome</a> and <a href=""https://stackoverflow.com/questions/48640168/getting-cpu-usage-per-process-of-chrome"">Getting CPU usage per Process of Chrome</a>, but both of those remain unanswered at the time of this writing.</p>

<p>I am also aware of extensions such as <a href=""https://chrome.google.com/webstore/detail/system-monitor/ecmlflnkenbdjfocclindonmigndecla"" rel=""nofollow noreferrer"">System Monitor</a> (<a href=""https://github.com/pd4d10/system-monitor"" rel=""nofollow noreferrer"">github</a>) but that appears to display the global system CPU usage, not per-tab stats. </p>",javascript|performance|google-chrome-extension,617864,luckman212,no
Android webkit and battery consumption,"<p>I´ve been working on a android webkit application, which has a considerably sophisticated UI (plenty of icons, CSS, JS and HTML5 pages). However, the application drains device battery. I installed some tools to measure power consumption and it´s pretty clear that the Android webkit (not the application engine) really demands CPU to render HTML content and it also impacts on battery consumption (oh! and memory as well). I´d like to know if anyone has ever had any problem with webkit vs. performance (power and CPU consumption). In addition, is there any Android webkit component (instead of WebView) with better performance?</p>

<p>--Raul</p>",android|webkit|battery,931770,s9rlherb,yes
Symbian App life cycle: Apps never killed?,"<p>Coming from Android/WP7 and having been involved in Symbian projects by the past, i would like now to exactly understand the Symbian App life cycle. I want to understand how the Apps are killed.. if they are..</p>
<p>I found this:</p>
<blockquote>
<p>&quot;The Symbian platform is a modern preemptive multitasking operating system. Applications are created in their own process, running in a single main thread. The kernel preemptively schedules all threads in the system, based on their priority. While it is possible to create secondary threads, Symbian strongly encourages applications to co-operatively multi-task using active objects. &quot;. <a href=""http://www.developer.nokia.com/Community/Wiki/Using_Qt_and_Symbian_C++_Together#Multi-tasking_on_the_Symbian_platform"" rel=""nofollow noreferrer"">Ref-link</a></p>
<p>&quot;(..) applications may be up and running at the same time and the user may switch between active applications. When a asynchronous event occurred, running application is moved to the background but it remains active&quot;. <a href=""http://windowsphone.interoperabilitybridges.com/articles/qt-to-wp7-chapter-5-introducing-windows-phone-application-life-cycle"" rel=""nofollow noreferrer"">Ref-link</a></p>
</blockquote>
<p>It seems to me that the Apps are never killed, even when they are in background..</p>
<p>My question is: If the system does not kill them, how the system deals with the RAM issue? What about the possible battery drain? Does it mean that Symbian allows starting each single App, till there is not enough memory? Is there a specific meaning about the use of the Cancel/Back key that might destroy the App in certain conditions?
In UIQ framework i remember a lowMemory() call-back, but one never used that..</p>
<p>Thanks, for your help..</p>",symbian|application-lifecycle,1257492,pedro242,no
"Google maps showing logo, but not displaying in Android emulator","<p>My app is supposed to display a Google Map with a heatmap, but I can't even get the map to display. It's only showing the logo in the bottom left corner. There seems to be no errors. I also checked the gradle and all the necessary dependencies are there. I can't tell if this is due to an actual error or lack of memory/slow processing.</p>

<p>Here's the MainActivity</p>

<pre><code>package com.example.alexlevine.oceanapp;

package com.example.alexlevine.oceanapp;

import android.app.Dialog;
import android.content.Intent;
import android.support.v4.view.GravityCompat;
import android.support.v4.widget.DrawerLayout;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;
import android.view.MenuItem;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.SeekBar;
import android.widget.Spinner;
import android.widget.TextView;
import android.widget.Toast;

import com.google.android.gms.common.ConnectionResult;
import com.google.android.gms.common.GoogleApiAvailability;
import com.google.android.gms.maps.CameraUpdate;
import com.google.android.gms.maps.CameraUpdateFactory;
import com.google.android.gms.maps.GoogleMap;
import com.google.android.gms.maps.OnMapReadyCallback;
import com.google.android.gms.maps.SupportMapFragment;
import com.google.android.gms.maps.model.LatLng;
import com.google.android.gms.maps.model.TileOverlayOptions;
import com.google.maps.android.heatmaps.HeatmapTileProvider;
import com.google.maps.android.heatmaps.WeightedLatLng;

import android.view.View;

import java.util.ArrayList;
import java.util.List;

import static com.example.alexlevine.oceanapp.R.id.seekBar;
import static com.example.alexlevine.oceanapp.fetchSOCATData.co2array;

public class MainActivity extends AppCompatActivity 
implements OnMapReadyCallback {

public static SeekBar seekbar;

public static GoogleMap mGoogleMap;
private HeatmapTileProvider mProvider;

public static TextView minyear;
public static TextView maxyear;
public static TextView currentyeartext;
public static int displayyear;
public static boolean usingSOCAT;
public static String typeKey;
public static Spinner dropdown;

private String[] mNavigationDrawerItemTitles;
private DrawerLayout mDrawerLayout;
android.support.v7.app.ActionBarDrawerToggle mDrawerToggle;

Button b2;
Button b4;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    if (googleServicesAvailable()) {
        Toast.makeText(this, ""Play services available"", Toast.LENGTH_LONG).show();;
        initMap();

        b2 = (Button) findViewById(R.id.button2);
        b4 = (Button) findViewById(R.id.button4);

        b2.setOnClickListener(
                new View.OnClickListener() {
                    @Override
                    public void onClick(View v) {
                        if (v.getId() == R.id.button2) {
                            Intent i = new Intent(MainActivity.this, CarbonCalcActivity.class);
                            startActivity(i);
                            finish();
                        }
                    }
                });

        b4.setOnClickListener(
                new View.OnClickListener() {
                   @Override
                    public void onClick(View v) {
                       if(v.getId() == R.id.button4) {
                           Intent i = new Intent(MainActivity.this, CalcData.class);
                           startActivity(i);
                           finish();
                       }
                   }
                }
        );

        //get the spinner from the xml.
        dropdown = (Spinner)findViewById(R.id.spinner);
        //create a list of items for the spinner.
        String[] items = new String[]{""Ocean CO2 Densities"", ""Land CO2 Emissions (all sources)"", ""Electricity CO2 Emissions"", ""Aviation CO2 Emissions"", ""Ocean Shipping CO2 Emissions""};
        //create an adapter to describe how the items are displayed, adapters are used in several places in android.
        //There are multiple variations of this, but this is the basic variant.
        ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(this, android.R.layout.simple_spinner_dropdown_item, items);
        //set the spinners adapter to the previously created one.
        dropdown.setAdapter(adapter);


        currentyeartext = (TextView) findViewById(R.id.currentyear);

        minyear = (TextView) findViewById(R.id.minyear);
        maxyear = (TextView) findViewById(R.id.maxyear);

        typeKey = ""00totals"";
        dropdown.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            public void onItemSelected(AdapterView&lt;?&gt; parent, View view, int position, long id)
            {
                switch (position) {
                    case 0: {
                        usingSOCAT = true;
                        displayyear = 1991;
                        seekbar.setMax(24);
                        minyear.setText(""1991"");
                        maxyear.setText(""2015"");
                        break;
                    }
                    case 1: {
                        usingSOCAT = false;
                        displayyear = 1997;
                        minyear.setText(""1997"");
                        maxyear.setText(""2010"");
                        seekbar.setMax(14);
                        typeKey = ""00totals"";
                        break;
                    }
                    case 2: {
                        usingSOCAT = false;
                        displayyear = 1997;
                        minyear.setText(""1997"");
                        maxyear.setText(""2010"");
                        seekbar.setMax(14);
                        typeKey = ""01elec"";

                        // Whatever you want to happen when the thrid item gets selected
                        break;
                    }
                    case 3: {
                        usingSOCAT = false;
                        displayyear = 1997;
                        minyear.setText(""1997"");
                        maxyear.setText(""2010"");
                        seekbar.setMax(14);
                        typeKey = ""11aviation"";;
                        // Whatever you want to happen when the thrid item gets selected
                        break;
                    }
                    case 4: {
                        usingSOCAT = false;
                        displayyear = 1997;
                        minyear.setText(""1997"");
                        maxyear.setText(""2010"");
                        seekbar.setMax(14);
                        typeKey = ""12shipping"";
                        // Whatever you want to happen when the thrid item gets selected
                        break;
                    }
                }
            }
            public void onNothingSelected(AdapterView&lt;?&gt; parent)
            {

            }
        });

        seekbar = (SeekBar) findViewById(seekBar);
        seekbar.setOnSeekBarChangeListener(
                new SeekBar.OnSeekBarChangeListener() {

                    @Override
                    public void onProgressChanged(SeekBar seekBar, int progress, boolean fromUser) {

                        displayyear = progress + 1991;
                        if(usingSOCAT)
                        {
                            displayyear = progress + 1991;

                            new fetchSOCATData().execute();

                        }
                        else
                        {
                            displayyear = progress + 1997;
                            new fetchFFDASData().execute();
                            //List&lt;WeightedLatLng&gt; calledData = fetchFFDASData.ffdasArray;

                            //createHeatMap(fetchFFDASData.ffdasArray);
                            minyear.setText((CharSequence) fetchFFDASData.ffdasArray);
                        }
                        currentyeartext.setText(""Showing: "" + displayyear);
                    }

                    @Override
                    public void onStartTrackingTouch(SeekBar seekBar) {

                    }

                    @Override
                    public void onStopTrackingTouch(SeekBar seekBar) {

                    }
                });

        if(usingSOCAT) {

        }
        //new fetchSOCATData().execute();
        /*minyear = (TextView) findViewById(R.id.minyear);
        maxyear = (TextView) findViewById(R.id.maxyear);
        minyear.setText(""1957"");
        maxyear.setText(""2015"");*/

        //fetchSOCATData process = new fetchSOCATData();
        //process.execute();

    } else {
        //No maps layout
    }
}

//@Override
public void onNothingSelected(AdapterView&lt;?&gt; parent) {

}

public void initMap() {
   SupportMapFragment mapFragment = (SupportMapFragment) this.getSupportFragmentManager()
           .findFragmentById(R.id.mapFragment);

   if(mapFragment != null) {
       mapFragment.getMapAsync((OnMapReadyCallback)this);
   }
}

public void createHeatMap(List&lt;WeightedLatLng&gt; dataset)
{
   List&lt;WeightedLatLng&gt; locations = dataset;
   /*mProvider = new HeatmapTileProvider.Builder().weightedData(locations).build();
   mProvider.setRadius( HeatmapTileProvider.DEFAULT_RADIUS );
   mGoogleMap.addTileOverlay(new TileOverlayOptions().tileProvider(mProvider));
    mProvider = new HeatmapTileProvider();
    mProvider.setWeightedData(dataset);
    mProvider = mProvider.build();*/

    //for (LatLng coordinate : coordinates) {
        //WeightedLatLng weightedCoordinate = new WeightedLatLng(coordinate);
        //com.google.maps.android.geometry.Point point = weightedCoordinate.getPoint();

        // Filter points at infinity
       /* if (Double.isInfinite(point.x) || Double.isInfinite(point.y)) {
            Log.w(TAG, ""Attempted to add undefined point "" + coordinate);
            continue;
        }
        weightedCoordinates.add(weightedCoordinate);*/
    //}

    mProvider = new HeatmapTileProvider.Builder()
            .weightedData(dataset)
            .opacity(0.5)
            .build();
    mGoogleMap.addTileOverlay(new TileOverlayOptions().tileProvider(mProvider));
    Toast.makeText(this, ""working"", Toast.LENGTH_SHORT).show();
}

public void onMapReady(GoogleMap googleMap) {
    mGoogleMap = googleMap;
    //goToLocation(-65, -12);
}

public void goToLocation(double lat, double lng) {
    LatLng ll = new LatLng(lat, lng);
    CameraUpdate update = CameraUpdateFactory.newLatLng(ll);
    mGoogleMap.moveCamera(update);
}

public boolean googleServicesAvailable() {
    GoogleApiAvailability api = GoogleApiAvailability.getInstance();
    int isAvailable = api.isGooglePlayServicesAvailable(this);
    if (isAvailable == ConnectionResult.SUCCESS)
        return true;
    else if (api.isUserResolvableError(isAvailable)) {
        Dialog dialog = api.getErrorDialog(this, isAvailable, 0);
        dialog.show();
    } else
        Toast.makeText(this, ""Can't connect to play services"", Toast.LENGTH_LONG).show();
    return false;
}

}
</code></pre>

<p>Here's my code to fetch the data for the heatmap:</p>

<pre><code>package com.example.alexlevine.oceanapp;

import android.os.AsyncTask;
import android.os.Build;
import android.support.annotation.RequiresApi;
import android.util.Log;

import com.google.android.gms.maps.model.LatLng;
import com.google.gson.Gson;
import com.google.gson.reflect.TypeToken;
import com.google.maps.android.heatmaps.WeightedLatLng;

import java.io.IOException;
import java.lang.reflect.Type;
import java.net.MalformedURLException;
import java.net.URL;
import java.util.ArrayList;
import java.util.Collection;
import java.util.List;

import okhttp3.OkHttpClient;
import okhttp3.Request;
import okhttp3.Response;

import static com.example.alexlevine.oceanapp.MainActivity.displayyear;
import static com.example.alexlevine.oceanapp.MainActivity.minyear;



@RequiresApi(api = Build.VERSION_CODES.CUPCAKE)
public class fetchSOCATData extends AsyncTask&lt;Object, Object, ArrayList&lt;WeightedLatLng&gt;&gt; {
//String data = ""http://ferret.pmel.noaa.gov/socat/erddap/tabledap/socat_v4_fulldata.geoJson?year%2Cmonth%2Cday%2Chour%2Cminute%2Csecond%2Clongitude%2Clatitude%2Csal%2CTemperature_equi%2CTemperature_atm%2CpCO2_atm_wet_actual%2Cdelta_fCO2%2Crelative_humidity%2Cspecific_humidity%2Cwind_speed_true%2Cwind_speed_rel%2Cwind_dir_true%2Cwind_dir_rel%2CfCO2_recommended%2Cregion_id%2Ctime&amp;organization=%22%22"";
//public static SOCATCO2DataPoint.FeaturesBean[] co2array;
public static List&lt;WeightedLatLng&gt; co2array;

@Override
protected ArrayList&lt;WeightedLatLng&gt; doInBackground(Object... params) {

    co2array = new ArrayList&lt;WeightedLatLng&gt;();

    int year = displayyear;

    URL url = null;
    try {
        //url = new URL(""http://ferret.pmel.noaa.gov/socat/erddap/tabledap/socat_v4_fulldata.geoJson?year%2Cmonth%2Cday%2Chour%2Cminute%2Csecond%2Clongitude%2Clatitude%2Csal%2CTemperature_equi%2CTemperature_atm%2CpCO2_atm_wet_actual%2Cdelta_fCO2%2Crelative_humidity%2Cspecific_humidity%2Cwind_speed_true%2Cwind_speed_rel%2Cwind_dir_true%2Cwind_dir_rel%2CfCO2_recommended%2Cregion_id%2Ctime&amp;organization=%22%22&amp;year%3E=2015&amp;month%3C=1&amp;day%3C=1&amp;hour%3C=1&amp;minute%3C=1&amp;second%3C=10"");
        //url = new URL(""http://ferret.pmel.noaa.gov/socat/erddap/tabledap/socat_v4_fulldata.json?year%2Clongitude%2Clatitude%2CfCO2_recommended%2Ctime&amp;organization=%22%22&amp;year%3E="" + year + ""&amp;year%3C="" + year);
        //url = new URL(""http://ferret.pmel.noaa.gov/socat/erddap/tabledap/socat_v4_fulldata.json?year%2Clongitude%2Clatitude%2CfCO2_recommended%2Ctime&amp;organization=%22%22&amp;year%3E=2015&amp;year%3C=2015&amp;month%3E=1&amp;month%3C=1&amp;day%3E=1&amp;day%3C=1&amp;hour%3E=1&amp;hour%3C=1"");
        //url = new URL(""http://ferret.pmel.noaa.gov/socat/erddap/tabledap/socat_v4_fulldata.geoJson?year%2Cmonth%2Cday%2Chour%2Cminute%2Csecond%2Clongitude%2Clatitude%2CfCO2_recommended%2Ctime&amp;organization=%22%22&amp;year%3E="" + year + ""&amp;year%3C="" + year);

        url = new URL(""http://ferret.pmel.noaa.gov/socat/erddap/tabledap/socat_v4_fulldata.json?longitude%2Clatitude%2CfCO2_recommended&amp;organization=%22%22&amp;year="" + displayyear + ""&amp;day=1&amp;hour=1&amp;minute%3C=5&amp;second%3C=30&amp;longitude!=NaN&amp;longitude!=NaN&amp;latitude!=NaN&amp;latitude!=NaN"");
    } catch (MalformedURLException e1) {
        e1.printStackTrace();
    }

    OkHttpClient client = new OkHttpClient();
            Request request = new Request.Builder().url(url).build();
    Response response = null;
    try {
        response = client.newCall(request).execute();
    } catch (IOException e1) {
        e1.printStackTrace();
    }
    String result = null;
    try {
        result = response.body().string();
    } catch (IOException e1) {
        e1.printStackTrace();
    }

    //System.out.print(""result"" + result);

    Gson gson = new Gson();

    Type collectionType = new TypeToken&lt;Collection&lt;OfficialSOCATPoint.TableBean&gt;&gt;() {}.getType();
    OfficialSOCATPoint enums = gson.fromJson(result, OfficialSOCATPoint.class);
    //Collection&lt;OfficialSOCATPoint.TableBean&gt; enums = gson.fromJson(result, collectionType);
    /*SOCATCO2DataPoint.FeaturesBean[] protoExtract = enums.toArray(new SOCATCO2DataPoint.FeaturesBean[enums.size()]);*/
    OfficialSOCATPoint protoExtract = gson.fromJson(result, OfficialSOCATPoint.class);
    //OfficialSOCATPoint.TableBean[] protoExtract = enums.toArray(new OfficialSOCATPoint.TableBean[enums.size()]);

    List&lt;List&lt;String&gt;&gt; dataArray = (List&lt;List&lt;String&gt;&gt;) protoExtract.getTable().getRows();

    //for (int i = 0; i &lt; dataArray.size(); i++)
    for (int i = 0; i &lt; 2; i++)
    {
        if(dataArray.get(i).get(2) != ""null"" &amp;&amp; dataArray.get(i).get(1) != ""null"" &amp;&amp; dataArray.get(i).get(0) != ""null"")
        {
            //co2array.add(new WeightedLatLng(new LatLng(Double.parseDouble(dataArray.get(i).get(0)), Double.parseDouble(dataArray.get(i).get(1))), Double.parseDouble(dataArray.get(i).get(2))));
        }

    }

    return (ArrayList&lt;WeightedLatLng&gt;) co2array;
    }

//@Override
protected void onPostExecute(ArrayList&lt;WeightedLatLng&gt; fb) {
    super.onPostExecute(fb);
}
}
</code></pre>

<p>Here's the logcat:</p>

<pre><code>10-17 16:45:27.884 1583-1593/? W/WallpaperManagerService: Cannot extract colors because wallpaper could not be read.
10-17 16:45:27.886 1583-1593/? W/WallpaperManagerService: Cannot extract colors because wallpaper could not be read.
10-17 16:45:17.747 2160-2160/? W/zygote: Common causes for lock verification issues are non-optimized dex code
10-17 16:45:17.955 1583-1807/? W/WallpaperManagerService: Cannot extract colors because wallpaper could not be read.
10-17 16:45:19.896 2138-2227/? W/zygote: Common causes for lock verification issues are non-optimized dex code
10-17 16:45:28.114 2188-2312/? W/ErrorProcessor: onFatalError, processing error from engine(4)
                                             com.google.android.apps.gsa.shared.speech.b.g: Error reading from input stream

at com.google.android.apps.gsa.staticplugins.recognizer.j.a.a(SourceFile:28)

at com.google.android.apps.gsa.staticplugins.recognizer.j.b.run(SourceFile:15)

at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:457)

at java.util.concurrent.FutureTask.run(FutureTask.java:266)

at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:457)

at java.util.concurrent.FutureTask.run(FutureTask.java:266)

at com.google.android.apps.gsa.shared.util.concurrent.a.ag.run(Unknown Source:4)

at com.google.android.apps.gsa.shared.util.concurrent.a.bo.run(SourceFile:4)

at com.google.android.apps.gsa.shared.util.concurrent.a.bo.run(SourceFile:4)

at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1162)

at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:636)

at java.lang.Thread.run(Thread.java:764)

at com.google.android.apps.gsa.shared.util.concurrent.a.ak.run(SourceFile:6)

Caused by: com.google.android.apps.gsa.shared.exception.GsaIOException: Error code: 393238 | Buffer overflow, no available space.

at com.google.android.apps.gsa.speech.audio.Tee.f(SourceFile:103)

at com.google.android.apps.gsa.speech.audio.au.read(SourceFile:2)

at java.io.InputStream.read(InputStream.java:101)

at com.google.android.apps.gsa.speech.audio.ao.run(SourceFile:18)

at com.google.android.apps.gsa.speech.audio.an.run(SourceFile:2)

at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:457) 

at java.util.concurrent.FutureTask.run(FutureTask.java:266) 

at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:457) 

at java.util.concurrent.FutureTask.run(FutureTask.java:266) 

at com.google.android.apps.gsa.shared.util.concurrent.a.ag.run(Unknown Source:4) 

at com.google.android.apps.gsa.shared.util.concurrent.a.bo.run(SourceFile:4) 

at com.google.android.apps.gsa.shared.util.concurrent.a.bo.run(SourceFile:4) 

at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1162) 

at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:636) 

at java.lang.Thread.run(Thread.java:764) 

at com.google.android.apps.gsa.shared.util.concurrent.a.ak.run(SourceFile:6) 
10-17 16:45:38.815 2510-2510/? I/Finsky: [2] com.google.android.finsky.setup.VpaService.a(32): Should not show workaround PAI step because experiment disabled
10-17 16:45:48.416 1767-2047/? I/GCoreUlr: WorldUpdater:init: Ensuring that reporting is stopped because of reasons: (no Google accounts)
10-17 16:45:49.205 2069-2069/? I/MediaRouter: Unselecting the current route because it is no longer selectable: null
10-17 16:46:16.401 1767-2047/? W/NetworkScheduler: Immediate task was not started com.google.android.videos/.service.drm.RefreshLicenseTaskService{u=0 tag=""refresh_license_forced"" trigger=window{start=0s,end=1s,earliest=-1s,latest=0s} requirements=[NET_CONNECTED] attributes=[] scheduled=-1s last_run=N/A jid=N/A status=PENDING retries=0 client_lib=MANCHEGO_GCM-10400000}. Rescheduling immediate tasks can cause excessive battery drain.
10-17 16:46:16.928 1767-2047/? W/NetworkScheduler: Immediate task was not started com.google.android.gms/.tapandpay.gcmtask.TapAndPayGcmTaskService{u=0 tag=""immediate"" trigger=window{start=0s,end=1s,earliest=-1s,latest=0s} requirements=[NET_CONNECTED] attributes=[] scheduled=-1s last_run=N/A jid=N/A status=PENDING retries=0 client_lib=MANCHEGO_GCM-14366000}. Rescheduling immediate tasks can cause excessive battery drain.
</code></pre>

<p>Please help me with this. Thanks!</p>",java|android|google-maps,8351952,AL144,yes
Notify iOS app to update its content,"<p>How can an iOS app be notified that it needs to update its content?</p>

<p>I would like to have an app that listens for update alerts that trigger a download rather than doing a data request to be able to stay in sync with the server.</p>

<p>What is the correct way to have an iOS app that needs to be in sync with a server stay in sync while minimizing network activity?</p>

<p>Im aware of using a cache locally, NSURL Cache or Core data etc. and adhere to the timeout in the http header etc. but I would like to correctly setup a sync mechanism without having an update button that a user needs to press to get updates.</p>

<p>I have thought of implementing a dispatch_source on a socket but wont that keep the network active and drain battery?</p>

<p>Rather than request a token for the version of the data to sync from the server I would rather like the server to notify the device that it needs to update. Is this practical?</p>

<p>How does the OS handle listening to push notifications? Is it on POSIX level?</p>",ios|networking|grand-central-dispatch,356387,some_id,yes
How to calculate distance while running on Android?,"<p>I understand that there are three approaches for it</p>

<ol>
<li><strong>GPS Based:</strong> Add up short distances travelled (calculated using Location.distanceTo) in small time intervals (5-10 secs), but this method is prone to GPS errors and would not work indoors or in short running area (like a small park)</li>
<li><strong>Double Integration of acceleration:</strong> I can do double integral of accelerometer data to calculate distance but errors due to noise in accelerometer readings may add up.</li>
<li><strong>Step counting:</strong> I can detect steps by measuring spikes in accelerometer data OR using Google Fit API and then multiply the total number of steps with the average stride length. But the problem here is figuring out average stride length.</li>
</ol>

<p>I am inclined towards using #3 as it works indoors and is not much error prone OR battery draining. But How do I get average stride length for each step, especially when runner's stride varies in length when sprinting and jogging.</p>

<p>Does anyone know of any combination of these methods to get the best results? OR any other totally different but efficient method?</p>",android|gps|accelerometer,2061158,ankit209,no
FCM push with high priority to topic comes with delay,"<p>I'm sending push messages to small group of devices (less than 5) subscribed to one topic with priority parameter set to <strong>high</strong></p>

<blockquote>
  <p><strong>High priority.</strong> FCM attempts to deliver high priority messages
  immediately, allowing the FCM service to wake a sleeping device when
  possible and open a network connection to your app server. Apps with
  instant messaging, chat, or voice call alerts, for example, generally
  need to open a network connection and make sure FCM delivers the
  message to the device without delay. Set high priority only if the
  message is time-critical and requires the user's immediate
  interaction, but beware that setting your messages to high priority
  contributes more to battery drain compared with normal priority
  messages.</p>
</blockquote>

<p>But when I put device to IDLE state it comes with big delay. On Nougat 7.1 delay is more than 10 mins. This type of push requires delay less than 10 secs.</p>

<p>Setting <code>time_to_live</code> to 0 solves issues only on Marshmallow. Nougat still failing.</p>

<p>So, I see only 3 possible causes of issue</p>

<ol>
<li><p>Messages sent to topic can't be high priority. But sending independent messages to each device will increase app-server load. I need to load fresh token from Firebase Database, so the result will be - 10 http requests for 5 users instead of 1.</p></li>
<li><p>App must be in whitelist. But according to <a href=""https://developer.android.com/training/monitoring-device-state/doze-standby.html#whitelisting-cases"" rel=""noreferrer"">docs</a> it's not acceptable, if I'm using FCM. And I don't want it, because it will cause battery drain.</p></li>
<li><p>Bug? <a href=""https://github.com/firebase/quickstart-android/issues/100"" rel=""noreferrer"">https://github.com/firebase/quickstart-android/issues/100</a></p></li>
</ol>

<p>If real cause is first, then why it isn't described in documentation?</p>",android|firebase|firebase-cloud-messaging|android-7.0-nougat|android-7.1-nougat,5593959,Dmytro Rostopira,no
Make a delay while listening to en event in c#,"<p>I have the following code snippet, which is a listener : </p>

<pre><code>locationManager.DidRangeBeacons += HandleDidRangeBeacons;
</code></pre>

<p>I have a Xamarin mobile app that detects iBeacons. Once I click a button, the method <code>HandleDidRangeBeacons</code> keeps on running since it is a  listener. How can I make a delay after each execution ? This is because, its draining my battery.</p>

<pre><code> private void HandleDidRangeBeacons(object sender, CLRegionBeaconsRangedEventArgs e)
    {
        if (e.Beacons.Length &gt; 0) // beacons length &gt; 0
        {
            foreach (var b in e.Beacons)
            {
                if (_foundBeacons != null &amp;&amp; _foundTrackers.Count &gt; 0)
                {

                      _foundBeacons?.Add(new DetectedBeacon
                            (b.ProximityUuid.ToString(), """", b.Major.ToString(), b.Minor.ToString(), string.Concat(b.Major, b.Minor),null));                
            }
        }
      }
    }
</code></pre>

<p><strong>Edited</strong> </p>

<pre><code>private void SetupBeaconRanging(string uuid)
    {
        locationManager = new CLLocationManager();
        locationManager.AuthorizationChanged += LocationManagerAuthorizationChanged;
        var rUuid = new NSUuid(uuid);
        _rBeaconRegion = new CLBeaconRegion(rUuid, uuid);

        var eUuid = new NSUuid(uuid);
        _eBeaconRegion = new CLBeaconRegion(eUuid, uuid);

        _rBeaconRegion.NotifyEntryStateOnDisplay = true;
        _rBeaconRegion.NotifyOnEntry = true;
        _rBeaconRegion.NotifyOnExit = true;

        _eBeaconRegion.NotifyEntryStateOnDisplay = true;
        _eBeaconRegion.NotifyOnEntry = true;
        _eBeaconRegion.NotifyOnExit = true;

        locationManager.DidRangeBeacons += HandleDidRangeBeacons;
        locationManager.RequestAlwaysAuthorization();
    }
</code></pre>",c#|xamarin,8997650,ExpertGenie,yes
CLBeaconRegion consumes too much battery issue while detecting beacons in Xamarin.iOS,"<p>I have implemented a beacon detector application in <code>Xamarin.iOS</code> that uses the following class to detect <strong>iBeacons</strong>. </p>

<p>The method <code>StartScanning</code> and <code>GetAvailableBeacons()</code> are invoked recursively to get the detected beacons. However, in a short span of time, the battery drains too much. How can I make the scan happen periodically like after each 60 seconds? After some research, I have found that we can stop the ranging. Could someone advise where should I put stop the ranging in the below code ? </p>

<p>Hereunder the implementation logic that performs the detection of iBeacons.</p>

<pre><code>    private CLLocationManager _locationManager;

    private CLBeaconRegion _rBeaconRegion;

    private CLBeaconRegion _eBeaconRegion;

    readonly ObservableCollection&lt;DetectedBeacon&gt; _foundBeacons;


    private ObservableCollection&lt;string&gt; _editableBeaconsList;

    private bool _firstInitialization;


    public BeaconDetector()
    {
        _foundBeacons = new ObservableCollection&lt;DetectedBeacon&gt; ();

        Timer(); // see the implementation below

       _firstInitialization = true;
    }


    private void SetupBeaconRanging(string uuid)
    {
        _locationManager = new CLLocationManager();
        _locationManager.AuthorizationChanged += LocationManagerAuthorizationChanged;
        var rUuid = new NSUuid(uuid);
        _rBeaconRegion = new CLBeaconRegion(rUuid, uuid);

        var eUuid = new NSUuid(uuid);
        _eBeaconRegion = new CLBeaconRegion(eUuid, uuid);

        _rBeaconRegion.NotifyEntryStateOnDisplay = true;
        _rBeaconRegion.NotifyOnEntry = true;
        _rBeaconRegion.NotifyOnExit = true;

        _eBeaconRegion.NotifyEntryStateOnDisplay = true;
        _eBeaconRegion.NotifyOnEntry = true;
        _eBeaconRegion.NotifyOnExit = true;

        _locationManager.DidRangeBeacons += HandleDidRangeBeacons;
        _locationManager.RequestAlwaysAuthorization();



    }

    private void LocationManagerAuthorizationChanged(object sender, CLAuthorizationChangedEventArgs e)
    {
        if (e.Status == CLAuthorizationStatus.AuthorizedAlways)
        {
            _locationManager.StartRangingBeacons(_rBeaconRegion);
        }
    }

    private void HandleDidRangeBeacons(object sender, CLRegionBeaconsRangedEventArgs e)
    {
        if (e.Beacons.Length &gt; 0) // beacons length &gt; 0
        {
            foreach (var b in e.Beacons)
            {
                if (_foundBeacons != null &amp;&amp; _foundTrackers.Count &gt; 0)
                {

                      _foundBeacons?.Add(new DetectedBeacon
                            (b.ProximityUuid.ToString(), """", b.Major.ToString(), b.Minor.ToString(), string.Concat(b.Major, b.Minor),null));                
            }
        }
    }

    public void Timer()
    {
        Device.StartTimer(TimeSpan.FromSeconds(20),
            () =&gt;
            {
                SetNewRegion(_rBeaconRegion);

                return true;    
            });
    }


    public void DiscardRegion()
    {
        _locationManager.StopRangingBeacons(_eBeaconRegion);
    }

    public void SetNewRegion(CLBeaconRegion region)
    {
        _locationManager.RequestState(region);

        _locationManager.StartMonitoring(region);

        _locationManager.StartRangingBeacons(region);
    }


    public ObservableCollection&lt;DetectedBeacon&gt; GetAvailableBeacons()
    {
        return !_paused ? _foundBeacons : null;
    }


    public void StartScanning(ObservableCollection&lt;string&gt; beaconList)
    {
        CreatePreDefinedList(beaconList);
        _foundBeacons.Clear();
        DetectRegion();
    }    
}
</code></pre>",ios|xamarin.ios|cllocationmanager|ibeacon|cllocation,8997650,ExpertGenie,yes
Needed: Cross platform C++ 2D graphics library for fast audio waveform presentation,"<p>I am trying to build a multimedia editor. It includes audio and relatively simple 2D graphics. I am using C++. I would like as much of it to be cross platform as possible.</p>
<p>I wrote audio interface classes for android and windows using a common API so I have that under control for now but I need a 2D graphics package and possibly a cross platform GUI as well.</p>
<p>The big challenge is in trying to render the time line. It needs to generate many rows of waveforms and intersperse them with characters and other shapes some of which may include blends and transparencies. Or rather I should say the big challenge has been animating the time line as often I will need to update it in real time. I have this working nicely using a lot of cashing and shifting around of the pixels of off-screen bitmaps. If I have 50 lines on the screen and the screen is 1000 pixels wide that translates to over 50,000 line draw operations per frame. Actually I use multi segment lines that end up drawing 3 times as many segments. To generate each line of the audio waveform it needs to look at a few hundred samples of audio and compute the max and min values or maybe do an FFT to create a line of different colored pixels if I want to offer this to the user some day. Various forms of cashing let me do this with reasonable latency.</p>
<p>The animation side of things will include everything from moving poly lines and polygons around in 2D to importing images and playing back moving multiple images (video) at different arbitrary frame rates. I don’t think 3D is very useful for now anyway.</p>
<p>At the moment I am using a crazy mix of GDI and GDI plus on windows and running it all in a win32 “thing”.  This is not great as I cannot invert regions in off screen bitmaps and I cannot draw individual pixels quickly enough to for instance show a spectrogram in real time. I think they were written in the 90s so there must be something newer I can use and get better performance and cross platform capabilities. I have been pulling out my remaining hair to figure out what to use.
I found another library on android that will let me set pixels and the performance actually seems a lot better but it does not support writing text. So I am hoping there is something else I could use for that.  On Android the plan is to generate the bitmap and then blit it into an interface build with a Native Android GUI.  These solutions do not seem great though a vast majority of the rest of the code can be ported without issue just being standard C++ and these horrors being cleanly wrapped.</p>
<p>I have seen a few potential candidates: openGL and Vulkan, seem to do 2D graphics as well as 3D but perhaps they are much more complex then what I need.
For the GUI I looked at QT but gave up on it (it seems to need half of my hard drive and has an incomprehensible licensing model). I recently started looking at IMGUI. They say it redraws on every frame. I don’t know how that will play with my existing rendering system and if it would drain a phones battery. A while ago I was able to get visual studio to create a cross platform App that would run on android but for some reason ditched that perhaps I should revisit it.</p>
<p>For the time line I need to draw a waveform. This could be done by drawing a lot of lines (50-150 k/frame) they can just be vertical ones for the most part, they do not need to be of fractional pixel width they need not be anti-aliased, and can have their end points specified with just integers. I also need to add some other lines polygons and text that does need to be anti-aliased. I may need to set a lot of pixels directly. Blends and transparencies would be nice but not essential. I also need to copy square chunks of bit map around. I also need sprites for things like the cursor. I am currently doing this by copying fragments of the bit map on and off screen. It would also be very nice to be able to select square regions of off screen bitmaps to invert for doing selections. And I need to assemble this off screen in a 2 or 3 buffer configuration so I can reuse chunks of one bitmap to make the next one and present it to the user in a real time animation. (all of this works with my GDI / GDI + wrapper though I have to work around the inversion problem)</p>
<p>For the animation part I need to draw similar graphics primitives, though it would also be nice to draw characters at arbitrary angles and scaling. As for Video if I can extract the images I guess I could blit them to the screen as needed. Maybe I would need yet another package to composite them into the other parts of the frame. Farther it would be nice to be able to write the animation out in a higher quality format in non real time to make a video file of some kind. It would be nice if I did not have to wrap yet another framework to make this happen though I can deal with this if I need to.</p>
<p>For the GUI it does not have to be all that fancy. Ideally I would like to have 2 or 3 floating and dockable windows on the PC and a few screens on a phone. I will have to make slightly different UIs for both but the time line bitmap and the media window bitmaps should be reusable for the most part. I just need standard widgets for the most part though.</p>
<p>My needs are somewhere in-between that of a game and that of a regular boring old forms app except for the need to animate the waveform.</p>
<p>Does anyone have any suggestions and perhaps know these systems well enough to know if they have a good chance to do what I need?</p>
<p>I fear I would have to spend weeks learning each one just to see if they give me the capabilities I need.</p>
<p>Is IMGUI likely to eat the phones battery just to make the cursor blink?</p>
<p>Any tips would be most welcome.</p>",c++|user-interface|2d|cross-platform,5420698,Andre .M,yes
"Even if my android app destroy, com.google.android.gms drain battery","<p>I am developing an android application that use google-play-services-lib. This app has a google map and use locationManager to determine user location. Next find google Places and track google directions for them. 
In my code i use</p>

<pre><code>@Override
   protected void onDestroy(){
       super.onDestroy();
   }
</code></pre>

<p>But the com.google.android.gms services dont stop (even if wifi, 3G and gps turn off) and the battery drain. When i see battery usage of my device it has</p>

<p>CPU total usage 2min 3sec</p>

<p>CPU usage in background 2min 3sec</p>

<p>GPS 10 hours 30min.</p>

<p>In my code the only situations that require location update are</p>

<pre><code>@Override
    public void onLocationChanged(Location location) {
            mLatitude = location.getLatitude();
            mLongitude = location.getLongitude();   
            LatLng latLng = new LatLng(mLatitude, mLongitude);
            mGoogleMap.moveCamera(CameraUpdateFactory.newLatLng(latLng));
            mGoogleMap.animateCamera(CameraUpdateFactory.zoomTo(12));
        } 
</code></pre>

<p>and</p>

<pre><code>// Getting LocationManager object from System Service LOCATION_SERVICE
            LocationManager locationManager = (LocationManager) getSystemService(LOCATION_SERVICE);

            // Creating a criteria object to retrieve provider
            Criteria criteria = new Criteria();

            // Getting the name of the best provider
            String provider = locationManager.getBestProvider(criteria, true);

            // Getting Current Location From GPS
            Location location = locationManager.getLastKnownLocation(provider);

locationManager.requestLocationUpdates(provider, 2000, 0, this);
</code></pre>

<p>But i thought that with super.destroy() that functions stop.</p>

<p>Can anyone help me with my problem?
Thanks in advance!</p>",android|google-maps|gps|locationmanager|batterylevel,1856182,Mixalis,yes
lua_newthread is stopping,"<p>I'm working with in LUA's thread and I'm using lua_newthread for this in my code must perform the same function n times.</p>

<p>To work with the competition's thread instantiate some threads in C + + and for each thread assigns a lua_state this lua_state = lua_newthread.
This thread's are destroyed only at the end of the application, so I'm always reuse the attribute lua_state these thread's. My question is this, 
after some run time, a crash happens in the application, this can be caused by the garbage collector?</p>

<p>In my last application I used the command lua_gc (thread, LUA_GCSTOP, 0), and yet the error persisted.</p>

<p>Another strategy I tried was the end of each run of lua_resume, I added the command lua_settop (thread, 0), so that the battery was drained and 
did not consume any memory space.</p>

<p>Please help me, what can happen?</p>",c++|lua|garbage,1078562,Saulo Cabral,yes
How to make random algorithm more efficient,"<p>I wrote a piece of code that simulate the binary numbers flow in the Matrix. It works perfectly fine, and whenever I run this code people ask if I am hacking something. Run on MacOS 10.12.3.</p>

<pre><code>#!/usr/local/bin/python3.6
import random
import time

while True:
    for j in range(204): #my full screen terminal is 204 characters wide
        print(random.randint(0,1),end='')
        time.sleep(0.0001)
    print('')
</code></pre>

<p>However, this code is very inefficient and drains lots of battery. So is there anyway to make this code more power efficient? Also, I don't want to have a huge amount of I/O to my hard drive.   </p>",python|algorithm|python-3.x|random,7416363,Mia,no
Polling service: irregular intervals,"<p>I've, for test purpose, a little android app composed by a simple activity where you can insert an host, a port and a interval in second. The app starts a service that creates a thread with a cycle that reads from an input stream of a socket until it is intentionally stopped.
Here is the code of the service:</p>

<pre><code>@Override
public int onStartCommand(Intent intent, int flags, int startId) {


    prepareFileLogging();

    FILELOG.info(""PollingService: onStartCommand"");

    mNotificationManager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);
    Intent bIntent = new Intent(this, MainActivity.class);
    PendingIntent pbIntent = PendingIntent
            .getActivity(this, 0, bIntent, Intent.FLAG_ACTIVITY_CLEAR_TOP);
    Notification.Builder bBuilder =
            new Notification.Builder(this)
                    .setSmallIcon(android.R.drawable.stat_notify_sync)
                    .setContentTitle(""PollingTest"")
                    .setContentText(""Servizio di polling attivo"")
                    .setAutoCancel(true)
                    .setOngoing(true)
                    .setContentIntent(pbIntent);

    this.startForeground(1, bBuilder.build());

    Log.i(""PollingService"", ""Received start id "" + startId + "": "" + intent);

    FILELOG.info(""PollingService: Received start id "" + startId + "": "" + intent);


    hostName = intent.getExtras().getString(PAR_HOST);
    portNumber = intent.getExtras().getInt(PAR_PORT);
    freqSeconds = intent.getExtras().getInt(PAR_FREQ);


    if(pollingThread == null){

        FILELOG.info(""pollingThread not running: starting..."");

        pollingThread = new Poll();
        pollingThread.start();


    }



    Toast.makeText(this, ""Servizio in Background: ServizioSincronizzazione.onCreate()"",
            Toast.LENGTH_LONG).show();

    mReceiver = new BroadcastRec();

    getApplication().registerReceiver(mReceiver, filter);


    return START_REDELIVER_INTENT;

}




@Override
public void onDestroy() {

    mNotificationManager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);
    Notification.Builder bBuilder = new Notification.Builder(this)
            .setSmallIcon(android.R.drawable.stat_notify_error).setContentTitle(
                    ""PollingTest"")
            .setContentText(""Il Servizio di polling è sinterrotto"");

    Toast.makeText(this, ""Servizio interrotto"", Toast.LENGTH_SHORT).show();

    getApplication().unregisterReceiver(mReceiver);

    stopPollingService();
    Log.i(""PollingService"", ""onDestroy"");

    super.onDestroy();
}



private class Poll extends Thread {

    @Override
    public void run() {

        Thread thisThread = Thread.currentThread();

        FILELOG.info(""pollingThread: started"");

        try {

            Socket echoSocket = new Socket(hostName, portNumber);

            PrintWriter out =
                    new PrintWriter(echoSocket.getOutputStream(), true);
            BufferedReader in =
                    new BufferedReader(
                            new InputStreamReader(echoSocket.getInputStream()));


            int nanos = 250000;

            while (pollingThread == thisThread) {

                Log.i(""PollThread"", ""start of a new call"");

                out.println(""prova"");
                String response = in.readLine();
                FILELOG.info(""pollingThread: server response: "" +response);

                System.out.println(""server: "" + response);

                if (response != null &amp;&amp; response.equals(""null"")) {
                    FILELOG.info(""pollingThread: server down (reponse 'null'), new socket"");

                    echoSocket = new Socket(hostName, portNumber);
                }


                sendBroadcast(new Intent());

                try {
                    Log.i(""PollThread"", ""timeout start..."");
                    Thread.sleep(freqSeconds*1000, nanos);
                } catch (InterruptedException e) {
                    Log.i(""PollThread"", e.getMessage());
                    FILELOG.info(""pollingThread error: "" + e.getMessage());
                }
            }


        } catch (UnknownHostException e) {
            FILELOG.info(""pollingThread error: Don't know about host "" + e.getMessage());

            System.err.println(""Don't know about host "" + hostName);
            stopPollingService();

        } catch (IOException e) {
            FILELOG.info(""pollingThread error: Couldn't get I/O for the connection to "" + e.getMessage());
            System.err.println(""Couldn't get I/O for the connection to "" +
                    hostName);
            stopPollingService();


        }


    }
}
</code></pre>

<p>I've keep the app running on a tablet for one day analyzing the drain of battery and the intervals between two request to the server.
The problem I noticed is that for about 10 minutes the 5 seconds interval is respected, then it changes between 5 and 20 seconds! 
The tablet has been waked up a couple of times and unlocked and the service never crashed.
Here it is the sequence of intervals observed by the server:</p>

<p><img src=""https://i.stack.imgur.com/DWFhX.png"" alt=""http://i.imgur.com/di5WKWA.png""></p>

<p>Someone can think a reason of why this happened?</p>",android|service|polling,1080191,brescia123,no
Demistifying iOS device CPU usage,"<p>My app use CPU so it drain battery really quick. 
I'm trying to detect what is using CPU with instruments. 
I'm running counters and i/o events but can't understand information I recieved. In counters I see only dispatch_mgr_thread at the first place. I'm hiding system libraries and have [UIApplication run] -> method from app in call three. 
Is that method the reason of CPU usage?</p>

<p>UPD: I've also checked app with time profiler and here is the result:
<img src=""https://i.stack.imgur.com/XRCwj.png"" alt=""enter image description here""></p>

<p>And I don't understant what is this ""_dispatch_mgr_thread"" or ""_dispatch_worker_thread3"" that works the mostly in my app even while I don't push any bottons - just start app and it does nothing.</p>",ios|objective-c|cpu|battery,2803425,Maria,no
Android Service: Restarting once killed or removed from task stack from phone(Clear All) tasks,"<p>I am trying to run my service continuously in background. I understand it will drain a lot of battery but still it is a use case for me.</p>

<p><strong>Case 1:</strong> Starting BackgroundService using <code>startService(intent)</code> method.
<strong>Case 2:</strong> Starting a BoundService using <code>bindService(intent,serviceConnection, Context.BIND_AUTO_CREATE);</code></p>

<p>In both the case, my service <code>onStartCommand</code> code is like below,</p>

<pre><code> @Override
public int onStartCommand(Intent intent, int flags, int startId) {
    new Thread(new Runnable() {
        @Override
        public void run() {
            while(count &lt; 10000){
                try {
                    Thread.sleep(500);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                count++;

            }

        }
    }).start();
    // TODO: flag not start itself when stopped
    // TODO: use START_STICKY to keep running
    return START_STICKY;
}
</code></pre>

<p><em>Scenario when my service does not die means it will keep running:</em></p>

<p><strong>case 1:</strong> If I press HOME button.
<strong>case 2:</strong> If I press back and come out of the application.</p>

<p><em>Scenario when my service will definitely be killed:</em></p>

<p><strong>case 1:</strong> If I remove my application from task stack of the phone.
<strong>case 2:</strong> I go to settings and stop the service.</p>

<p><strong><em>I want my service to get started once it will be killed in either of the scenarios mentioned above.</em></strong></p>

<p>I have referred many questions from stackoverflow to do like this,</p>

<pre><code>  @Override
    public void onDestroy() {
        super.onDestroy();

        startService(new Intent(this, BackgroundService.class));
    }

    @Override
    public void onTaskRemoved(Intent rootIntent) {
        super.onTaskRemoved(rootIntent);

        startService(new Intent(this, BackgroundService.class));

    }
</code></pre>

<p>But definitely <code>onDestroy()</code> is not that kind of method which will be called every time. I have checked it in my logs.</p>",android|android-activity|android-service|background-process|android-service-binding,2204790,Custadian,yes
Can Socket.io be combined with long polling in a php mysql server?,"<p>I have read I lot about making live updates on android and ios applications with <code>long polling</code> or <code>websockets</code>. Although, long polling method isn't a good choice for what I need as it is draining too much battery. However, my website is designed using <code>Wordpress</code> so there is a plugin to my website that uses long polling to send data in realtime. So, is there a way I can connect the long polling <code>JSON API</code> with <code>Socket.io</code> in order to get updates into the application only if there is any change into the database?</p>",java|android|socket.io,17492682,Gus Rasmusen,yes
Checking the location every 10 minutes in the background,"<p>My requirement is to check the location of the device every 10 minutes using a background service. So the basic gist of what should happen every 10 minutes is this - </p>

<ul>
<li>Start the service.</li>
<li>Wait a minute (maximum) for the listener to get a location, once the location is taken, remove the listener and then stop the service.</li>
<li>If the listener doesn't respond, use getLastKnownLocation(), remove the listener and then stop the service.</li>
<li>If the GPS is off, it reports to the app (this step is working fine)</li>
</ul>

<p>What I have tried doing till now - </p>

<ul>
<li>Made a service which is triggered every 10 minutes using an AlarmManager</li>
<li>Added a Location Listener inside this service.</li>
<li>onLocationChanged() from the LocationListener has the method - stopSelf() included, so that the service ends after receiving a location. However, this method is called a numerous times. I checked that while debugging. Is this because there are many instances of onLocationChanged() called ?  </li>
</ul>

<p>I don't need an entire code as the answer, I would rather appreciate a strategy I should adopt which will fulfil my requirements without hurting the battery much. As with my approach, unless and until the location is found, the GPS remains ON draining the battery constantly. </p>",android|gps|location,6188742,Raviraj Pophale,no
Restrict android application to specific region,"<p>I want my application to work in specific region e.g US.</p>

<p>We can limit distribution of application from play market but i found there are some hacks to install those apps.</p>

<p>I have to somehow limit the use within application.</p>

<p>For that I can retrieve user's GPS location and use Google's Geocode API for first run. But what if user travels to some other region?</p>

<p>I will have to use Location change listener to cater this scenario, but this will drain battery.</p>

<p>If I go for device's timezone, User can change it.</p>

<p>Is there any other thing i can possibly do to restrict application to specific region?</p>",android|region|restriction,1153808,Syed Muhammad Umair,no
Android Long Polling TCP Connection,"<p>im trying since month to do a proper ""push"" without using external librarys or gcm.</p>

<p>First i tried xmpp with asmack, then mosquitto with paho or ibm mqtt client and http with alarmtimer.</p>

<p>Finally i ended with deacon and meteord but since it's not very good (on server side - high cpu and memory load) im trying to do a longpolling connection.</p>

<p>I know that it requires a heartbeat and finally i was thinking about the Delay (300 seconds heartbeat should be enough?) and the proper way.</p>

<p>Is it better (battery usage and so on) to send a Heartbeat (with 1 Byte or whatever) from server to client (delay for example 300 seconds) and setting a socket timeout on client side of 300, or is it better to do send it from the client to the server?</p>

<p>Currently im using a Service which register an observer in onCreate and unregister in onDestroy.</p>

<p>The Observer is observing an object which do establish a tcp socket connection in a Thread and retry it onec it's disconnects (socket timeout).</p>

<p>I do also check with a broadcastreciever if the network connection changed and reconnect if needed.</p>

<p>What happen when the device go into standby? Do i really need an alarmmanager or timertask to recieve OR send the packet? </p>

<p>Does the Device drop the Connection onec it goes into standby? </p>

<p>Currently i tried sending from server to client with a 120 second delay and even when the devices display turned of its still possible to send the heartbeat.</p>

<p>But at least it looks like that the battery drain is not ""acceptable"".</p>

<p>So.. What is the best way to do that? </p>

<p>Thank you so far.</p>",java|android|sockets|tcp|long-polling,2032539,Emanuel,yes
Is there a way to get my Apple Watch App to vibrate when the screen sleeps?,"<p>I own a Apple Watch series 3 and I made an app for it that vibrates every specified amount of seconds. I know haptics drain your battery but, regardless, its the purpose of my app. I tried to test it on my watch and I encountered a problem. When the screen is on the app functions like its supposed to but as soon as I put my wrist down and the screen sleeps, the app runs in the background but it doesn't vibrate like supposed to. Is there a way around this? Like I said I have a series 3 therefore I don't have access to the always on screen display function.
My app code is below:</p>
<pre><code>import SwiftUI
    

struct ContentView: View {
    @State var timerScreenShown = false
    @State var timeVal = 10
    
    var body: some View {
        VStack{
            Text(&quot;Select \(timeVal)s intervals&quot;).padding()

            Picker(
                selection: $timeVal,
                label: Text(&quot;&quot;)){
                    ForEach(10...120, id: \.self) {
                        Text(&quot;\($0)&quot;)
                    }
                }
            
            NavigationLink(destination: SecondView(timerScreenShown: $timerScreenShown, timeVal: timeVal), isActive: $timerScreenShown, label: {Text(&quot;Go&quot;)})
            
        }
    }
}

struct SecondView: View{
    @Binding var timerScreenShown:Bool
    @State var timeVal = 10
    @State var startVal = 0
    
    var body: some View {
        VStack{
            if timeVal &gt; 0 {
                Text(&quot;Timer&quot;)
                    .font(.system(size: 14))
                Text(&quot;\(startVal)&quot;)
                    .font(.system(size: 40))
                    .onAppear(){
                        Timer.scheduledTimer(withTimeInterval: 1.0, repeats: true) { _ in
                            if self.timeVal &gt; 0{
                                self.startVal += 1
                                if self.timeVal == self.startVal{
                                    
                                    WKInterfaceDevice.current().play(.failure)
                                    
                                    self.startVal = 0
                                }
                            }
                        }
                    }
                Text(&quot;seconds&quot;)
                    .font(.system(size: 14))
                Button(action: {
                    self.timerScreenShown = false
                }) {
                    Text(&quot;Cancel&quot;)
                        .foregroundColor(.red)
                }
            } else {
                Button(action: {
                    self.timerScreenShown = false
                }) {
                    Text(&quot;Done&quot;)
                        .foregroundColor(.green)
                }
            }
        }
    }
}

struct ContentView_Previews: PreviewProvider {
    static var previews: some View {
        Group {
            ContentView()
            ContentView()
        }
    }
}
</code></pre>",swift|xcode|swiftui|watchos|haptic-feedback,14467531,CollegeMonday,yes
iPhone Development: CoreLocation and MapKit,"<p>How bad is it to use Location Manager to retrieve the location information when MapView.showUserLocation is also TRUE?</p>

<p>I have a situation where i want to show the blue dot to indicate the user's current location, and i want to record the user's current location after some time interval. Having said that, there may be situations where the user's current location is now being shown, but i still want to get the user's current location. </p>

<p>I think i'll have to use the Location Manager in my controller class, but setting showUserLocation = YES would mean that i'll be draining more battery since two Location Managers are working at the same time? Is this assumption correct?</p>",iphone|mapkit|core-location|showuserlocation,49739,Mustafa,no
accelerometer sensor avaiblable in locked screen / screen off mode?,"<p>it seems that there is a bug in froyo with respect to the <code>onSensorChanged</code> method when the phone goes to lock screen mode, i.e. there are no values coming from the accelerometer.</p>

<p>I read about this issue in this <a href=""https://stackoverflow.com/questions/2143102/accelerometer-stops-delivering-samples-when-the-screen-is-off-on-droid-nexus-one?answertab=active#tab-top"">topic</a></p>

<p>Now, the topic does mention a workaround which involves keeping the screen on, although dimmed, but it seems to me that this would drain the battery. </p>

<p>In my application I don't need the screen to be visible at all (brightness can  be zero), but it should respond to touch. </p>

<p>The application should also respond to shaking and movement. </p>

<p>Would this still drain the battery fast?</p>

<p>EDIT: Is there a difference between screen lock and screen off?</p>",android|locking|accelerometer|power-management,628918,jorrebor,yes
Efficient data structure/algorithm for transliteration based word lookup,"<p>I'm looking for a efficient data structure/algorithm for storing and searching transliteration based word lookup (like google do: <a href=""http://www.google.com/transliterate/"" rel=""nofollow"">http://www.google.com/transliterate/</a> but I'm not trying to use google transliteration API). Unfortunately, the natural language I'm trying to work on doesn't have any soundex implemented, so I'm on my own.</p>

<p>For an open source project currently I'm using plain arrays for storing word list and dynamically generating regular expression (based on user input) to match them. It works fine, but regular expression is too powerful or resource intensive than I need. For example, I'm afraid this solution will drain too much battery if I try to port it to handheld devices, as searching over thousands of words with regular expression is too much costly.</p>

<p>There must be a better way to accomplish this for complex languages, how does Pinyin input method work for example? Any suggestion on where to start?</p>

<p>Thanks in advance.</p>

<hr>

<p>Edit: If I understand correctly, this is suggested by @Dialecticus-</p>

<p>I want to transliterate from <strong>Language1</strong>, which has 3 characters <code>a,b,c</code> to <strong>Language2</strong>, which has 6 characters <code>p,q,r,x,y,z</code>. As a result of difference in numbers of characters each language possess and their phones, it is not often possible to define one-to-one mapping.</p>

<p>Lets assume phonetically here is our associative arrays/transliteration table:</p>

<pre><code>a -&gt; p, q
b -&gt; r
c -&gt; x, y, z
</code></pre>

<p>We also have a valid word lists in plain arrays for <strong>Language2</strong>:</p>

<pre><code>...
px
qy
...
</code></pre>

<p>If the user types <code>ac</code>, the possible combinations become <code>px, py, pz, qx, qy, qz</code> after transliteration step 1. In step 2 we have to do another search in valid word list and will have to eliminate everyone of them except <code>px</code> and <code>qy</code>.</p>

<hr>

<p>What I'm doing currently is not that different from the above approach. Instead of making possible combinations using the transliteration table, I'm building a regular expression <code>[pq][xyz]</code> and matching that with my valid word list, which provides the output <code>px</code> and <code>qy</code>.</p>

<p>I'm eager to know if there is any better method than that.</p>",algorithm|data-structures|transliteration,761555,Mehdi,no
Prevent iOS app from deep sleeping efficiently,"<p>I'm building an alarm clock that allows the user to play a continuous sound at a specific fire date while the app is in the foreground and the screen is locked.</p>

<p><a href=""https://github.com/mruegenberg/MMPDeepSleepPreventer"" rel=""nofollow"">https://github.com/mruegenberg/MMPDeepSleepPreventer</a> is the only solution I've found to prevent my app from exiting after 10 minutes. However, this approach is causing significant battery drain.</p>

<p>Are there any other approaches to this problem without draining the battery significantly? I know it is possible because there are other alarm clocks out there that do this without killing the battery and without jailbreak.</p>",ios,1103115,gabe.roze,yes
Playing a sound while app is in the foreground and the screen is locked - iOS,"<p>Preface: I'm building an alarm clock app. Many other alarm apps such as Alarm Clock Pro are able to play an alarm while the screen is locked and the app is in the foreground. Their alarms can play for an unlimited amount of time and can progressively increase in volume using the system volume. They also do not take control of the music controls (if you open up the multitasking screen and scroll to playing audio, you will not see their icon)</p>

<p>I am having some trouble reproducing that functionality.</p>

<p>To play alarms while the app is in the foreground we fire Local notifications which works great.  I've have some limited success  while the screen is locked (the and the app is in the Inactive state)</p>

<p>I've used the following methods:</p>

<ol>
<li><p>Run an <code>NSTimer</code> every second with a background task when the screen is locked. I managed to keep the app open past the 10 minute maximum but I was unable to play a sound. when the time came</p></li>
<li><p>Play a 1 second silent sound using <code>AVAudioPlayer</code>. When the sound ends, replay the sound and check if the app is in the Inactive (locked screen) state. If it is in the locked screen state and it's time to play an alarm, play it. The problem here is I must use</p>

<p><code>[[UIApplication sharedApplication] beginReceivingRemoteControlEvents];</code>   </p></li>
</ol>

<p>in order to continue updating the song while it's in the background. That method will display Wake in the music controls and will stop any currently playing music which we want to avoid.</p>

<ol start=""3"">
<li>A combination of #1 and #2. When the app opens play a silent sound on infinite repeat. When the screen is locked fire a timer to check if its time to play an alarm. When it's time to play an alarm, switch the silent sound to the alarm sound. The system would eventually force close the app</li>
</ol>

<p>Related knowledge that has helped but hasn't solved my question:</p>

<ol>
<li><a href=""https://stackoverflow.com/questions/9725192/how-do-i-start-playing-audio-when-in-silent-mode-locked-in-ios-6"">How do I start playing audio when in silent mode &amp; locked in iOS 6?</a></li>
<li><a href=""https://stackoverflow.com/questions/8561504/ios-5-deep-sleep-prevention"">iOS 5 deep sleep prevention</a></li>
<li><a href=""https://stackoverflow.com/questions/10406874/resuming-execution-of-code-after-interruption-while-app-is-in-background"">Resuming execution of code after interruption while app is in background</a> </li>
<li><a href=""https://stackoverflow.com/questions/11843326/how-to-play-music-in-background-iphone-sdk?rq=1"">How to play music in background iphone sdk</a></li>
</ol>

<p><strong>Summary: While the screen is locked and in the app is in the foreground, I am unable to prevent the process from being killed off after the 10 minute mark.</strong></p>

<p><strong>UPDATE</strong></p>

<p>I ended up using <a href=""https://github.com/mruegenberg/MMPDeepSleepPreventer"" rel=""nofollow noreferrer"">https://github.com/mruegenberg/MMPDeepSleepPreventer</a> which let me play a sound after 10 minutes. However, this eats up battery like crazy. I need to find a more efficient solution.</p>

<p><strong>UPDATE 2</strong></p>

<p>I downloaded some of <a href=""http://marcopeluso.com/"" rel=""nofollow noreferrer"">http://marcopeluso.com/</a> apps from the app store. He is the creator of the Deep Sleep Preventer. I downloaded some of his apps and ran some instruments tests and saw his app was not draining battery as much as my app is (roughly 2.5% per hour as claimed somewhere on his blog). I am very certain that I need to optimize my app and the battery drain problems will disappear and my problems will be solved!</p>

<p><strong>UPDATE 3</strong>
I ended up using <a href=""https://github.com/mruegenberg/MMPDeepSleepPreventer"" rel=""nofollow noreferrer"">https://github.com/mruegenberg/MMPDeepSleepPreventer</a></p>

<p>I ran it in it's own separate xCode project and it only uses 0.5% of the cpu when the app is in the background. It turns out it was my app was sucking the cpu. So all it working well now :)</p>",iphone|ios|background|screen|locked,1103115,gabe.roze,yes
Joining columns in pandas incorrectly,"<p>I am running TF-IDF on a single column. I want to use this TF-IDF and another scaled integer column to train my Logistic Regression classifier. Unfortunately I am running into problems doing this as I am just beginning in machine-learning. The code currently has a bug, but the bigger issue is that I am simply unsure how to join the two features together and what is best practice here. Would anyone be able to help me get this running please ?</p>

<pre><code>  from sklearn import metrics,preprocessing,cross_validation
  from sklearn.feature_extraction.text import TfidfVectorizer
  import sklearn.preprocessing
  import sklearn.linear_model as lm
  import pandas as p
  loadData = lambda f: np.genfromtxt(open(f,'r'), delimiter=',')

  print ""loading data..""
  traindata = list(np.array(p.read_csv('FinalCSVFin.csv', delimiter="";""))[:,2])#reading text column to make tf-idf
  testdata = list(np.array(p.read_csv('FinalTestCSVFin.csv', delimiter="";""))[:,2])
  y = np.array(p.read_csv('FinalCSVFin.csv', delimiter="";""))[:,-2] #reading our labels
  AlexaTrainData = p.read_csv('FinalCSVFin.csv', delimiter="";"")[[""alexarank""]] #reading integer columns
  AlexaTestData = p.read_csv('FinalTestCSVFin.csv', delimiter="";"")[[""alexarank""]]
  AllAlexaAndGoogleInfo = AlexaTestData.append(AlexaTrainData) #joining integer columns

  tfv = TfidfVectorizer(min_df=3,  max_features=None, strip_accents='unicode',  
        analyzer='word',token_pattern=r'\w{1,}',ngram_range=(1, 2), use_idf=1,smooth_idf=1,sublinear_tf=1)

  rd = lm.LogisticRegression(penalty='l2', dual=True, tol=0.0001, 
                             C=1, fit_intercept=True, intercept_scaling=1.0, 
                             class_weight=None, random_state=None)

  X_all = traindata + testdata #joining tf-idf columns
  lentrain = len(traindata)

  print ""fitting pipeline""
  tfv.fit(X_all)
  print ""transforming data""
  X_all = tfv.transform(X_all) #running TF-IDF

  X = X_all[:lentrain]
  AllAlexaAndGoogleInfo = AllAlexaAndGoogleInfo[:lentrain]
  X_test = X_all[lentrain:]
  X = np.hstack((X, AllAlexaAndGoogleInfo))
  sc = preprocessing.StandardScaler().fit(X)
  X = sc.transform(X)
  X_test = sc.transform(X_test)

  print ""20 Fold CV Score: "", np.mean(cross_validation.cross_val_score(rd, X, y, cv=20, scoring='roc_auc'))

  print ""training on full data""
  rd.fit(X,y)
  pred = rd.predict_proba(X_test)[:,1]
  testfile = p.read_csv('test.tsv', sep=""\t"", na_values=['?'], index_col=1)
  pred_df = p.DataFrame(pred, index=testfile.index, columns=['label'])
  pred_df.to_csv('benchmark.csv')
  print ""submission file created..""
</code></pre>

<p>Currently the code dies with the following error : </p>

<pre><code>ValueError: all the input arrays must have same number of dimensions
</code></pre>

<p>Extract from FinalCSVFin.csv :</p>

<pre><code>url;urlid;boilerplate;label;alexarank;;;;
http://www.bloomberg.com/news/2010-12-23/ibm-predicts-holographic-calls-air-breathing-batteries-by-2015.html;4042;""{""""title"""":""""IBM Sees Holographic Calls Air Breathing Batteries ibm sees holographic calls, air-breathing batteries"""",""""body"""":""""A sign stands outside the International Business Machines Corp IBM Almaden Research Center campus in San Jose California Photographer Tony Avelar Bloomberg Buildings stand at the International Business Machines Corp IBM Almaden Research Center campus in the Santa Teresa Hills of San Jose California Photographer Tony Avelar Bloomberg By 2015 your mobile phone will project a 3 D image of anyone who calls and your laptop will be powered by kinetic energy At least that s what International Business Machines Corp sees in its crystal ball The predictions are part of an annual tradition for the Armonk New York based company which surveys its 3 000 researchers to find five ideas expected to take root in the next five years IBM the world s largest provider of computer services looks to Silicon Valley for input gleaning many ideas from its Almaden research center in San Jose California Holographic conversations projected from mobile phones lead this year s list The predictions also include air breathing batteries computer programs that can tell when and where traffic jams will take place environmental information generated by sensors in cars and phones and cities powered by the heat thrown off by computer servers These are all stretch goals and that s good said Paul Saffo managing director of foresight at the investment advisory firm Discern in San Francisco In an era when pessimism is the new black a little dose of technological optimism is not a bad thing For IBM it s not just idle speculation The company is one of the few big corporations investing in long range research projects and it counts on innovation to fuel growth Saffo said Not all of its predictions pan out though IBM was overly optimistic about the spread of speech technology for instance When the ideas do lead to products they can have broad implications for society as well as IBM s bottom line he said Research Spending They have continued to do research when all the other grand research organizations are gone said Saffo who is also a consulting associate professor at Stanford University IBM invested 5 8 billion in research and development last year 6 1 percent of revenue While that s down from about 10 percent in the early 1990s the company spends a bigger share on research than its computing rivals Hewlett Packard Co the top maker of personal computers spent 2 4 percent last year At Almaden scientists work on projects that don t always fit in with IBM s computer business The lab s research includes efforts to develop an electric car battery that runs 500 miles on one charge a filtration system for desalination and a program that shows changes in geographic data IBM rose 9 cents to 146 04 at 11 02 a m in New York Stock Exchange composite trading The stock had gained 11 percent this year before today Citizen Science The list is meant to give a window into the company s innovation engine said Josephine Cheng a vice president at IBM s Almaden lab All this demonstrates a real culture of innovation at IBM and willingness to devote itself to solving some of the world s biggest problems she said Many of the predictions are based on projects that IBM has in the works One of this year s ideas that sensors in cars wallets and personal devices will give scientists better data about the environment is an expansion of the company s citizen science initiative Earlier this year IBM teamed up with the California State Water Resources Control Board and the City of San Jose Environmental Services to help gather information about waterways Researchers from Almaden created an application that lets smartphone users snap photos of streams and creeks and report back on conditions The hope is that these casual observations will help local and state officials who don t have the resources to do the work themselves Traffic Predictors IBM also sees data helping shorten commutes in the next five years Computer programs will use algorithms and real time traffic information to predict which roads will have backups and how to avoid getting stuck Batteries may last 10 times longer in 2015 than today IBM says Rather than using the current lithium ion technology new models could rely on energy dense metals that only need to interact with the air to recharge Some electronic devices might ditch batteries altogether and use something similar to kinetic wristwatches which only need to be shaken to generate a charge The final prediction involves recycling the heat generated by computers and data centers Almost half of the power used by data centers is currently spent keeping the computers cool IBM scientists say it would be better to harness that heat to warm houses and offices In IBM s first list of predictions compiled at the end of 2006 researchers said instantaneous speech translation would become the norm That hasn t happened yet While some programs can quickly translate electronic documents and instant messages and other apps can perform limited speech translation there s nothing widely available that acts like the universal translator in Star Trek Second Life The company also predicted that online immersive environments such as Second Life would become more widespread While immersive video games are as popular as ever Second Life s growth has slowed Internet users are flocking instead to the more 2 D environments of Facebook Inc and Twitter Inc Meanwhile a 2007 prediction that mobile phones will act as a wallet ticket broker concierge bank and shopping assistant is coming true thanks to the explosion of smartphone applications Consumers can pay bills through their banking apps buy movie tickets and get instant feedback on potential purchases all with a few taps on their phones The nice thing about the list is that it provokes thought Saffo said If everything came true they wouldn t be doing their job To contact the reporter on this story Ryan Flinn in San Francisco at rflinn bloomberg net To contact the editor responsible for this story Tom Giles at tgiles5 bloomberg net by 2015, your mobile phone will project a 3-d image of anyone who calls and your laptop will be powered by kinetic energy. at least that\u2019s what international business machines corp. sees in its crystal ball."""",""""url"""":""""bloomberg news 2010 12 23 ibm predicts holographic calls air breathing batteries by 2015 html""""}"";0;345;;;;
http://www.popsci.com/technology/article/2012-07/electronic-futuristic-starting-gun-eliminates-advantages-races;8471;""{""""title"""":""""The Fully Electronic Futuristic Starting Gun That Eliminates Advantages in Races the fully electronic, futuristic starting gun that eliminates advantages in races the fully electronic, futuristic starting gun that eliminates advantages in races"""",""""body"""":""""And that can be carried on a plane without the hassle too The Omega E Gun Starting Pistol Omega It s easy to take for granted just how insanely close some Olympic races are and how much the minutiae of it all can matter The perfect example is the traditional starting gun Seems easy You pull a trigger and the race starts Boom What people don t consider When a conventional gun goes off the sound travels to the ears of the closest runner a fraction of a second sooner than the others That s just enough to matter and why the latest starting pistol has traded in the mechanical boom for orchestrated electronic noise Omega has been the watch company tasked as the official timekeeper of the Olympic Games since 1932 At the 2010 Vancouver games they debuted their new starting gun which is a far cry from the iconic revolvers associated with early games it s clearly electronic but still more than a button that s pressed to get the show rolling About as far away as you can get probably while still clearly being a starting gun Pull the trigger once and off the Olympians go If it s pressed twice consecutively it signals a false start Working through a speaker system is what eliminates any kind of advantage for athletes It s not a big advantage being close to a gun but the sound of the bullet traveling one meter every three milliseconds could contribute to a win Powder pistols have been connected to a speaker system before but even then runners could react to the sound of the real pistol firing rather than wait for the speaker sounds to reach them This year s setup will have speakers placed equidistant from runners forcing the sound to reach each competitor at exactly the same time It wouldn t be an enormous difference Omega Timing board member Peter H\u00fcrzeler said in an email but when you think about reaction times being measured in tiny fractions of a second placing a speaker behind each lane has eliminated any sort of advantage for any athlete They all hear the start commands and signal at exactly the same moment There s also an ulterior reason for its look In a post September 11th world a gun on its way to a major event is going to raise more than a few TSA eyebrows even if it s a realistic looking fake Rather than deal with that the e gun can be transported while still maintaining the general look of a starting gun But there s still nothing like hearing a starting gun go off at the start of a race more than signaling the runners there s probably some Pavlovian response after more than a century of Olympic games that make people want to hear the real thing not a whiny electronic noise Everyone in the stands at home thankfully will still be getting that The sound is programmable and can be synthesized to sound like almost anything H\u00fcrzeler says but we program it to sound like a pistol it s a way to use the best possible starting technology but to keep a rich tradition alive and that can be carried on a plane without the hassle, too technology,gadgets,london 2012,london olympics,olympics,omega,starting guns,summer olympics,timing,popular science,popsci"""",""""url"""":""""popsci technology article 2012 07 electronic futuristic starting gun eliminates advantages races""""}"";1;5304;;;;
http://www.menshealth.com/health/flu-fighting-fruits?cm_mmc=Facebook-_-MensHealth-_-Content-Health-_-FightFluWithFruit;1164;""{""""title"""":""""Fruits that Fight the Flu fruits that fight the flu | cold &amp; flu | men's health"""",""""body"""":""""Apples The most popular source of antioxidants in our diet one apple has an antioxidant effect equivalent to 1 500 mg of vitamin C Apples are loaded with protective flavonoids which may prevent heart disease and cancer Next Papayas With 250 percent of the RDA of vitamin C a papaya can help kick a cold right out of your system The beta carotene and vitamins C and E in papayas reduce inflammation throughout the body lessening the effects of asthma Next Cranberries Cranberries have more antioxidants than other common fruits and veggies One serving has five times the amount in broccoli Cranberries are a natural probiotic enhancing good bacteria levels in the gut and protecting it from foodborne illnesses Next Grapefruit Loaded with vitamin C grapefruit also contains natural compounds called limonoids which can lower cholesterol The red varieties are a potent source of the cancer fighting substance lycopene Next Bananas One of the top food sources of vitamin B6 bananas help reduce fatigue depression stress and insomnia Bananas are high in magnesium which keeps bones strong and potassium which helps prevent heart disease and high blood pressure Next everything you need to know about cold and flu so you don\u2019t get sick this season, at men\u2019s health.com cold, flu, infection, sore throat, sneeze, immunity, germs, allergies, stay healthy, sick, contagious, medicines, cold medicine"""",""""url"""":""""menshealth health flu fighting fruits cm mmc Facebook Mens Health Content Health Fight Flu With Fruit""""}"";1;2663;;;;
</code></pre>

<p>And FinalCSVTestFin.csv : </p>

<pre><code>url;urlid;boilerplate;alexarank
http://www.lynnskitchenadventures.com/2009/04/homemade-enchilada-sauce.html;5865;""{""""title"""":""""Homemade Enchilada Sauce Lynn s Kitchen Adventures """",""""body"""":""""I usually buy my enchilada sauce Yes I knew I should be making it but I had never found a recipe that I was really happy with I had tried several and they just weren t very good So I stuck to the canned stuff you can get at the grocery store I was recently talking to a friend of mine about this She lived in Mexico for a few years so she knows some about Mexican cooking I asked her how she made her enchilada sauce She told me the basics and then gave me an exact recipe I decided to give it a try This recipe was really good This was the best enchilada sauce that I have made It had great flavor I think it was even better than the canned sauce My husband thought it could have been spicier But he likes his enchiladas spicy You can always add more chili powder or chilies if you like it really spicy The kids and I thought it was really good just like it is I did change two things It called for green onions I did not have any so I used regular onions I thought they worked great so I will probably continue to make it this way I also pureed everything in the blender I wanted a very smooth sauce If you want it more chunky just mix the ingredients together and do not blend Enchiladas are a pretty frugal meal and homemade enchilada sauce is a great way to make enchiladas even more frugal 2 8 ounce cans tomato sauce 1 4 ounce can chopped green chilies undrained 1 2 cup onion chopped 2 teaspoons chili powder 1 teaspoon ground cumin 1 4 teaspoon dried oregano 1 clove garlic minced Combine all tomato sauce ingredients and place in a blender Puree ingredients Then place in a saucepan Heat over medium heat until heated through about 5 minutes Use as desired for enchiladas Get your free Quick Easy Breakfasts ebook Just subscribe for free email updates from Lynn s Kitchen Adventures Like this article Share it this homemade enchilada sauce recipe came from a friend of mine who spent several years in mexico."""",""""url"""":""""lynnskitchenadventures 2009 04 homemade enchilada sauce html""""}"";169088
http://lolpics.se/18552-stun-grenade-ar;782;""{""""title"""":""""lolpics Stun grenade ar """",""""body"""":"""" funny pictures at lolpics.se. the best funny images on the internet funny photo images, funny videos, can has cheezburger ,roliga bilder, lol pics, lolpics"""",""""url"""":""""lolpics se 18552 stun grenade ar""""}"";459983
</code></pre>

<p>I want to train on the TF-IDF column and the alexaranking column to produce a .csv file of answers but I am sure despite my best efforts I have made a number of errors here. Any help or suggestion would be appreciated.</p>

<p>Thank you.</p>

<hr>

<p>Update :</p>

<p>I am running the following code : </p>

<pre><code>from sklearn import metrics,preprocessing,cross_validation
  from sklearn.feature_extraction.text import TfidfVectorizer
  import sklearn.preprocessing
  import sklearn.linear_model as lm
  import pandas as p
  loadData = lambda f: np.genfromtxt(open(f,'r'), delimiter=',')
  print ""loading data..""
  traindata = list(np.array(p.read_csv('FinalCSVFin.csv', delimiter="";""))[:,2])
  testdata = list(np.array(p.read_csv('FinalTestCSVFin.csv', delimiter="";""))[:,2])
  y = np.array(p.read_csv('FinalCSVFin.csv', delimiter="";""))[:,-2]
  AlexaTrainData = p.read_csv('FinalCSVFin.csv', delimiter="";"")[[""alexarank""]]
  AlexaTestData = p.read_csv('FinalTestCSVFin.csv', delimiter="";"")[[""alexarank""]]
  AllAlexaAndGoogleInfo = AlexaTestData.append(AlexaTrainData)
  tfv = TfidfVectorizer(min_df=3,  max_features=None, strip_accents='unicode',  
        analyzer='word',token_pattern=r'\w{1,}',ngram_range=(1, 2), use_idf=1,smooth_idf=1,sublinear_tf=1)
  rd = lm.LogisticRegression(penalty='l2', dual=True, tol=0.0001, 
                             C=1, fit_intercept=True, intercept_scaling=1.0, 
                             class_weight=None, random_state=None)
  X_all = traindata + testdata
  lentrain = len(traindata)

  print ""fitting pipeline""
  tfv.fit(X_all)
  print ""transforming data""
  X_all = tfv.transform(X_all)
  X = X_all[:lentrain]
  AllAlexaAndGoogleInfo = AllAlexaAndGoogleInfo[:lentrain]
  X_test = X_all[lentrain:]
  print ""X.shape =&gt; "" + str(X.shape)
  print ""AllAlexaAndGoogleInfo.shape =&gt; "" + str(AllAlexaAndGoogleInfo.shape)
  print ""X_all.shape =&gt; "" + str(X_all.shape)
  #X = np.column_stack((X, AllAlexaAndGoogleInfo))
  X = np.hstack((X, AllAlexaAndGoogleInfo))
  sc = preprocessing.StandardScaler().fit(X)
  X = sc.transform(X)
  X_test = sc.transform(X_test)
</code></pre>

<p>Which produces the following output : </p>

<pre><code>loading data..
fitting pipeline
transforming data
X.shape =&gt; (7395, 238377)
AllAlexaAndGoogleInfo.shape =&gt; (7395, 1)
X_all.shape =&gt; (10566, 238377)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
&lt;ipython-input-12-2b310887b5e4&gt; in &lt;module&gt;()
     31 print ""X_all.shape =&gt; "" + str(X_all.shape)
     32 #X = np.column_stack((X, AllAlexaAndGoogleInfo))
---&gt; 33 X = np.hstack((X, AllAlexaAndGoogleInfo))
     34 sc = preprocessing.StandardScaler().fit(X)
     35 X = sc.transform(X)

C:\Users\Simon\Anaconda\lib\site-packages\numpy\core\shape_base.pyc in hstack(tup)
    271     # As a special case, dimension 0 of 1-dimensional arrays is ""horizontal""
    272     if arrs[0].ndim == 1:
--&gt; 273         return _nx.concatenate(arrs, 0)
    274     else:
    275         return _nx.concatenate(arrs, 1)

ValueError: all the input arrays must have same number of dimensions
</code></pre>",python|csv|pandas|machine-learning|scikit-learn,963156,Simon Kiely,no
how to measure and improve battery use in iPhone/iPad game (Android also),"<p>My game uses too much battery. I don't know exactly how much it uses as compared to comparable games, but it uses too much. Players complain that it uses a lot, and a number of them note that it makes their device ""run hot"". I'm just starting to investigate this and wanted to ask some theoretical and practical questions to narrow the search space. This is mainly about the iOS version of my game, but probably many of the same issues affect the Android version. Sorry to ask many sub-questions, but they all seemed so interrelated I thought it best to keep them together.</p>

<p>Side notes: My game doesn't do network access (called out in several places as a big battery drain) and doesn't consume a lot of battery in the background; it's the foreground running that is the problem.</p>

<p>(1) I know there are APIs to read the battery level, so I can do some automated testing. My question here is: About how long (or perhaps: about how much battery drain) do I need to let the thing run to get a reliable reading? For instance, if it runs for 10 minutes is that reliable? If it drains 10% of the battery, is that reliable? Or is it better to run for more like an hour (or, say, see how long it takes the battery to drain 50%)? What I'm asking here is how sensitive/reliable the battery meter is, so I know how long each test run needs to be.</p>

<p>(2) I'm trying to understand what are the likely causes of the high battery use. Below I list some possible factors. Please help me understand which ones are the most likely culprits:</p>

<p>(2a) As with a lot of games, my game needs to draw the full screen on each frame. It runs at about 30 fps. I know that Apple says to ""only refresh the screen as much as you need to"", but I pretty much need to draw every frame. Actually, I could put some work into only drawing the parts of the screen that had changed, but in my case that will still be most of the screen. And in any case, even if I can localize the drawing to only part of the screen, I'm still making an OpenGL swap buffers call 30 times per second, so does it really matter that I've worked hard to draw a bit less?</p>

<p>(2b) As I draw the screen elements, there is a certain amount of floating point math that goes on (e.g., in computing texture UV coordinates), and some (less) double precision math that goes on. I don't know how expensive these are, battery-wise, as compared to similar integer operations. I could probably cache a lot of these values to not have to repeatedly compute them, if that was a likely win.</p>

<p>(2c) I do a certain amount of texture switching when rendering the scene. I had previously only been worried about this making the game too slow (it doesn't), but now I also wonder whether reducing texture switching would reduce battery use.</p>

<p>(2d) I'm not sure if this would be practical for me but: I have been reading about shaders and OpenCL, and I want to understand if I were to unload some of the CPU processing to the GPU, whether that would likely save battery (in addition to presumably running faster for vector-type operations). Or would it perhaps use even more battery on the GPU than on the CPU?</p>

<p>I realize that I can narrow down which factors are at play by disabling certain parts of the game and doing iterative battery test runs (hence part (1) of the question). It's just that that disabling is not trivial and there are enough potential culprits that I thought I'd ask for general advice first.</p>",android|ios|opengl-es|power-management,384670,M Katz,yes
android os deletes my files when battery drain?,"<p>I have developed small application contains long running Service which listening to incoming UDP messages.</p>

<p>I'm saving some of my data to my internal storage.</p>

<p>Usualy everything goes fine, and i can get back my data from the internal storage even after reboot.</p>

<p>Yesterday my application was running and the battery drained. 
I've noticed that some of my data in the internal storage gone.</p>

<p>Does android delete my files when battery drained?</p>",android|file|internal|battery,1080528,user1080528,no
How can I make a service that activates over bluetooth?,"<p>I have made myself familiar with how services work and how Bluetooth works. My code already works if I am in the app, but I want it to also work when it is not open.</p>

<p>So I basically want to make a service. When I am running the app I simply open a Bluetoothsocket and wait until the other device sends that it's ready.</p>

<p>Here are my questions:</p>

<ol>
<li><p>Would opening a Bluetoothsocket with a device in the service as long as it's nearby be a big battery issue?</p></li>
<li><p>Is there any downside to leaving the socket up?</p></li>
<li><p>Would listening to an Inputstream the whole day drain a lot of battery? I assume so, and if yes is there a better way to activate the service?</p></li>
</ol>",java|android|bluetooth,7927099,JDoeKnought,no
How to retrieve GPS location from one android device and provide it to another android device in realtime,"<p>I want to retrieve GPS location of one android device and fetch it to another android device in realtime. I have gone through many resources and came to know that it can be implemented using GCM, FCM, sockets or by polling. However GCM or FCM cannot provide the updates in realtime and polling will lead to more battery drainage. For Sockets I have gone through <strong>socket.io</strong> implementation but I don't know whether it is the perfect implementation. So please provide suggestions on how to better implement that.</p>

<p>Now another scenario is if multiple users are connected to the server through the same socket then how can we figure which user is monitoring whom ?</p>

<p>Please help...</p>",android|sockets|socket.io|android-location|android-gps,7538821,sam,no
"Interpretation of results of ""Energy Usage"" instrument tool","<p>I am running ""energy usage"" instrument over ios application using a device, I wanted to use it to check how much battery is getting drained because of the app I am testing. It shows ""Energy usage level"" which is giving me numbers like 13/20 , 12/20 , etc over different points of time. </p>

<p>How to interpret the results(I know, it gives relative energy usage on a scale of 0-20) in terms of :<br>
1) How much battery is getting drained because of the app and particular operation.<br>
2) Which operation / function is causing this drain.<br>
3) What number is considered as safe and what number should be considered as high / too high.<br>
4) Any other conclusion that we can make ?  </p>

<p>I would appreciate if some one can answer above questions or give me link for reference. I have searched around and could not find answers to above questions, I just found how to find out those relative energy usage numbers only.</p>",ios|battery,1693750,Kabs,yes
Push Notification from Device to Device over Local Network WITHOUT C2DM,"<p>I will have two android tablets working in the same retail location, both connected to a local network.</p>

<p>A customer will use one tablet to place an order. That tablet needs to send a notification to another tablet when the order is placed.</p>

<p>I am using a MySql database, and I could poll constantly from the tablet that needs to receive information, but that would drain the battery.</p>

<p>I could use C2DM, but it is absolutely necessary that the system works even if there is an internet slowdown/loss of connectivity.</p>

<p>How can I do what is basically C2DM over a local network from android device to android device? No android device will have cell phone service.</p>",android|mysql|notifications|push|android-c2dm,1004347,Louis T.,yes
Android : Battery drains around 4 hours common with wifi ON and screen ON always,"<p>My app is single activity app which is used to generate token slip using WiFi printer over wifi which are connected locally. So the WiFi is always ON. Also the screen is always ON. </p>

<p>I have set <code>android:keepScreenOn=""true""</code> in my activity xml file for this.</p>

<p>The tablet is exclusively used for this single app only not more than that. Even though, the battery drains around 4 hours. </p>

<p>Is this common? Or Would I change anything to achieve good battery backup?</p>",android|android-wifi,4604115,Keerthi Keyan,no
Stop unBound service in Android,"<p>I have a service that autoupdates a database in a given time interval. To do this it gets information from the Internet.</p>

<p>I need to have it unbound, so that It runs over all activities. But when the application is closed,  it would be nice to terminate the service. To prevent battery drain. How can this be achieved?</p>",android|android-service,671203,johan,no
Heavy CPU processing to heat device,"<p>My company has created an enterprise app that is used out on the field.</p>

<p>We've discovered that our iPhone 5 does not function properly below 0*C.  </p>

<p>One solution we're looking to experiment with is running heavy CPU-intensive tasks (equivalent to running a 3D game) which will add heat to the device (outside of the other external heat we're using to help them).</p>

<p>Using a laser temperature gauge indoors as a baseline, I measured 24*C on the iPhone 5 screen when it's idling on the app home screen.  When I launch an intensive 3D game, the phone heats up and the screen registers 35*C within a few minutes.  </p>

<p>How can we recreate an intensive background-threaded CPU process that does not consume resources and crash the app?  I've tried various open-source iOS benchmark apps from GitHub but when I put them on an infinite loop in a background thread, after a few minutes the app goes out of memory and crashes. </p>

<p>Here's an example of one of the benchmarks I put in to the background on an infinite loop. (while 1=1).  No matter what variation of benchmark code I try, the ""Total Bytes"" will grow without stopping until the app crashes. <a href=""http://i.stack.imgur.com/FwqWa.png"" rel=""nofollow"">Click to see Instruments Screenshot.</a></p>

<p>Does anyone have examples of CPU-intensive code that I could use that would make the device get nice and hot and also prevent the app from eating resources indefinitely?</p>

<p>Battery drain is not an issue as we will use external battery packs connected to offset any drain.</p>

<p>All help appreciated!</p>

<p>Adam</p>

<pre><code>    UIApplication * application = [UIApplication sharedApplication];

if([[UIDevice currentDevice] respondsToSelector:@selector(isMultitaskingSupported)])
{
    NSLog(@""Multitasking Supported"");

    __block UIBackgroundTaskIdentifier background_task;
    background_task = [application beginBackgroundTaskWithExpirationHandler:^ {

        //Clean up code. Tell the system that we are done.
        [application endBackgroundTask: background_task];
        background_task = UIBackgroundTaskInvalid;
    }];

    //To make the code block asynchronous
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0), ^{

        //### background task starts
        NSLog(@""Running in the background\n"");
        static NSString *staticString = @""some const value string to referece"";
        while (1 == 1)
        {
            NSDictionary *dictionary;
            NSString *string;
            NSDate *staticStart = [NSDate date];
            NSLog(@""start timing"");
            int times = 10000000;
            while (times--) {
                static dispatch_once_t onceToken;
                static NSDictionary *dict;
                dispatch_once(&amp;onceToken, ^{
                    dict = @{@""somekey"":@""someotherlongvalue"", @""someotherkey"":@""someotherlongvalue"", @""onelastkey"":@""onelastvalue""};
                });
                dictionary = dict;
            }
            NSDate *staticEnd = [NSDate date];
            NSLog(@""finished static dict in %f sec"", [staticEnd timeIntervalSinceDate:staticStart]);

            times = 10000000;
            while (times--) {
                dictionary = @{@""somekey"":@""someotherlongvalue"", @""someotherkey"":@""someotherlongvalue"", @""onelastkey"":@""onelastvalue""};
            }

            NSDate *dictEnd = [NSDate date];
            NSLog(@""finished dict create in %f sec"", [dictEnd timeIntervalSinceDate:staticEnd]);

            times = 10000000;
            while (times--) {
                static dispatch_once_t stringOnceToken;
                static NSString *dispatchString;
                dispatch_once(&amp;stringOnceToken, ^{
                    dispatchString = @""someotherlongvalue"";
                });
                string = dispatchString;
            }
            NSDate *staticStringEnd = [NSDate date];
            NSLog(@""finished static string in %f sec"", [staticStringEnd timeIntervalSinceDate:dictEnd]);
            times = 10000000;
            while (times--) {
                string = @""someotherlongvalue"";
            }
            NSDate *stringEnd = [NSDate date];
            NSLog(@""finished string create in %f sec"", [stringEnd timeIntervalSinceDate:staticStringEnd]);
            times = 10000000;
            while (times--) {
                string = staticString;
            }
            NSDate *refEnd = [NSDate date];
            NSLog(@""finished string reference in %f sec"", [refEnd timeIntervalSinceDate:stringEnd]);
        }
        //#### background task ends

        //Clean up code. Tell the system that we are done.
        [application endBackgroundTask: background_task];
        background_task = UIBackgroundTaskInvalid; 
    });
}
else
{
    NSLog(@""Multitasking Not Supported"");
}
</code></pre>",ios|objective-c|iphone|multithreading,2853289,Adam,yes
Is location provider really a battery drain?,"<p>I need to implement location-based service. I don't need fine location, so no GPS is needed.</p>

<p>Easiest would be to start listening for locations updates at app start, and leave it ON:</p>

<pre><code>    mLocationMgr.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 10000, 100, mPendingIntent);
</code></pre>

<p>Since I don't need much accuracy, I set max frequency of updates, to 10s, and 100m instead of default 0, 0.</p>

<p>When we think location, we think battery drain, but I guess this is a shortcut and that only GPS really drains the battery. I think that such a use of network provider wouldn't drain the battery. Any thoughts?</p>",android|location|battery,961243,gpo,no
App Engine Channel API vs polling: which is better suiting in a mobile web chat scenario?,"<p>I'm trying to build a chat/messaging application, which may be consumed on the desktop, but also likely consumed on the mobile web (iOS Safari etc.). I started using the App Engine Channel API, but see that its making a <em>very</em> frequent request to the server (~1/sec). I'm worried this would have an adverse impact on battery life and data consumption.</p>

<p>The application is a chat/inbox type application, so it's OK to be 2-5 secs late IMHO. In this situation, is it just better to stick with traditional polling and ping the server every 3 secs to see if any new messages have arrived? And what would I be gaining by using the Channel API?</p>

<p>The actual experience (and so the tradeoffs) depend on my application, but I'm trying to understand if my worry about battery drain is warranted or unfounded?</p>",google-app-engine|channel-api,2448805,Debnath Sinha,yes
Android: diagnosing source of app's excessive battery drain with battery historian,"<p>I'm trying to identify why my alarm clock app's ""app usage"" under my battery settings is so high (~10%) with very light use given the fact that the app's ""device usage"" is only 1% (running on android 8.0). This is my first time using battery historian and was hoping for help identifying any red flags in the app stats for my app that could account for this discrepancy (super high app usage and low device usage battery stats).</p>

<p><a href=""https://i.stack.imgur.com/OlOnr.png"" rel=""nofollow noreferrer"">app stats part 1</a></p>

<p><a href=""https://i.stack.imgur.com/h7F3z.png"" rel=""nofollow noreferrer"">app stats part 2</a></p>",android|performance|profiling|battery|android-8.0-oreo,8150823,spaceman,yes
Check if Socket is connected on physical machine,"<p>Preface:</p>

<p>I have an asynchronous socket server where we receive telemetry data, and when the remote devices do not send us data, we have the ability to send commands to request data.  The listener and command processing are done on separate threads.  The listener listens on one port, while the commands send on a different port.  </p>

<p>My overall question is: Is it possible with C# to check if a socket is connected without having to call a ""connect"" method in the first place?  Our customers device will establish a connection to the server and will remain connected always (unless service coverage drops or battery drains etc.).  I'd like to avoid having to keep track of all the connected socket objects in memory if possible.</p>

<p>To be honest I'm not even sure if what I'm asking is feasible.  I'd like to hear people's thoughts.</p>",c#|sockets,969388,Chris Fischer,yes
Does Reach-ability class keep sending / receiving data in iOS dev?,"<p>I have been working on Reachability class for a while and have tried both the one from Apple sample and the one from ddg. I wonder whether the Reachability class keep sending / receiving data after starting the notifier. </p>

<p>As I'm developing an app which connect to different hosts quite often, I decided to write a singleton and attach the reachability classes I need on it. The reacability classes would be initiated and start their notifiers once the app start. I use the singleton approach as I want this singleton class to be portable and can be applied to other apps without much rewriting. I am not sure if it is good idea to implement like this but it worked quite well.</p>

<p>However, someone reported that the battery of his device drain significantly faster after using the app and someone reported more data usage. My app does not send / receive data on background so I start wondering if it is related to the reachability.</p>

<p>I tried profiling the energy usage with Instrument and I notice that there are continuous small data (few hundred bytes in average) coming in via the network interfaces even I put my app in idle. However, there are almost no data sending out. </p>

<p>I know that Reachability requires data usage when initiate (resolving DNS etc) but I am not sure that whether it still keep using data after starting notifier. Does anyone can tell?</p>

<p>I am not familiar with the low-level programming, it would be nice if someone could explain how does the Reachability work.</p>",objective-c|ios|power-management|reachability|network-monitoring,1648333,Clement T,yes
Turn off proximity sensor after closing app - Android,"<p>I made an app that reads values off of the proximity sensor and performs certain actions based off of that data. My problem is that the actions will continue to perform even when the user presses the home button and leaves the app, thus causing a drainage in the battery.</p>

<p>My question is how do I turn off the proximity sensor once the app is existed or simple when the home button is pressed (without the app being exited properly)</p>

<p>This is my first Android app. Here is how I assign the proximity sensor in my code:</p>

<pre><code>    sm = (SensorManager) getSystemService(SENSOR_SERVICE);
    proxSensor = sm.getDefaultSensor(Sensor.TYPE_PROXIMITY);

    sm.registerListener(this,proxSensor,SensorManager.SENSOR_DELAY_NORMAL);
</code></pre>

<p>Thanks</p>

<p><strong>EDIT</strong>
To those that are wondering and don't want to look it up, I solved it by using the following:</p>

<pre><code>public void onPause()
{
    super.onPause();
    sm.unregisterListener(this);
}
public void onResume()
{
    super.onResume();
    sm.registerListener(this,proxSensor,SensorManager.SENSOR_DELAY_NORMAL);
}
</code></pre>",java|android|android-sensors|proximitysensor|auto-close,2124252,Mo2,yes
App needs accurate localization - huge battery drain,"<p>one of our programmers developed an app that needs some geotagging capabilities:</p>

<ul>
<li>the app is not a mapping one and does not need a constant knowledge of current user position</li>
<li><strong>the app needs to know the current position ONLY when the user uses a particular geotag feature</strong>, but it has to be as accurate as possible (a pretty common one use case anyway)</li>
</ul>

<p>The problem is that the devices shows a huge battery drain that completely depletes them in 2 hours.</p>

<p>The code prodeced shows a Service that every 10 seconds check for the current location, I guess maybe this is the problem since it doesn't do an <em>ad hoc</em> check:</p>

<pre><code>public class BatchService extends Service {

    private long UPDATE_INTERVAL = 10 * 1000;  /* 10 secs */
    private long FASTEST_INTERVAL = 2000; /* 2 sec */
    public String latitudine;
    public String longitudine;
    public int count;

    PowerManager pm;
    PowerManager.WakeLock wl;

    private static BatchService istanza;

    public static BatchService getInstance()
    {
        if (istanza == null)
        {
            istanza = new BatchService();
        }

        return istanza;
    }

    Handler handler = new Handler();
    private Runnable periodicUpdate = new Runnable() {
        @Override
        public void run() {
            handler.postDelayed(periodicUpdate, 10000);
            count = 0;
            startLocationUpdates();
        }
    };

    private boolean isRunning  = false;

    @Override
    public void onCreate() {
        Log.i(TAG, ""Service onCreate"");

        isRunning = true;

        pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
        wl = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, ""GpsTrackerWakelock"");
        wl.acquire();
    }

    protected void startLocationUpdates() {

        // Create the location request to start receiving updates
        mLocationRequest = new LocationRequest();
        mLocationRequest.setPriority(LocationRequest.PRIORITY_BALANCED_POWER_ACCURACY);
        mLocationRequest.setInterval(UPDATE_INTERVAL);
        mLocationRequest.setFastestInterval(FASTEST_INTERVAL);


        // Create LocationSettingsRequest object using location request
        LocationSettingsRequest.Builder builder = new LocationSettingsRequest.Builder();
        builder.addLocationRequest(mLocationRequest);
        LocationSettingsRequest locationSettingsRequest = builder.build();

        // Check whether location settings are satisfied
        // https://developers.google.com/android/reference/com/google/android/gms/location/SettingsClient
        SettingsClient settingsClient = LocationServices.getSettingsClient(this);
        settingsClient.checkLocationSettings(locationSettingsRequest);

        // new Google API SDK v11 uses getFusedLocationProviderClient(this)
      getFusedLocationProviderClient(this).requestLocationUpdates(mLocationRequest, new LocationCallback() {
                    @Override
                    public void onLocationResult(LocationResult locationResult) {
                        if(count==0){
                            count++;
                            onLocationChanged(locationResult.getLastLocation());
                        }




                    }
                },
                null);

  public void onLocationChanged(Location location) {
        if(location!=null){
            // New location has now been determined
                if(location.getAccuracy()&lt;=50){
                    getInstance().latitudine = String.valueOf(location.getLatitude());
                    getInstance().longitudine = String.valueOf(location.getLongitude());
                }else{
                    getInstance().latitudine = null;
                    getInstance().longitudine = null;
                }
        }
    }
}
</code></pre>

<p>What can we investigate in order to resolve our issues and to better handle this kind of cases?</p>

<p>Thanks</p>",android|geolocation|gps|battery,2260924,frankieta,yes
Is ConnectivityManager.getActiveNetworkInfo() expensive to call often?,"<p>I'm trying to figure out a strategy for my application, where I need to perform different network operations. My question is, whether calling <code>ConnectivityManager.getActiveNetworkInfo()</code> is considered a long-running and battery-draining operation and whether it's all right to call it often, or should I optimize my application's performance by applying another strategy? Thanks in advance.</p>",android|optimization|android-networking,543539,Egor,yes
Motion sensors to detect the user movent (speed). Is it possible?,"<p>Is it possible to use Motion Sensors to detect the speed at which the user is moving ?? Currently I am planning to use device's GPS but I know it will drain the battery of my device like hell. Is there any way around to detect users speed through my app ??</p>

<p>Any help will be appreciated thanks :)</p>",android|gps|latitude-longitude|sensors|android-sensors,3064175,ik024,yes
Efficiency of regular wakeups (Alarms) vs. staying awake (WakeLocks),"<p>I want to accept Bluetooth connections (even when the screen is off) for building a mobile ad-hoc P2P network. Since it <a href=""https://stackoverflow.com/questions/7014124/android-bluetooth-wakelock-relationship"">seems</a> that incoming connections don't wake the device up, I think I will either need to keep the device permanently awake with a partial WakeLock (which will drain the battery relatively quickly), or wake it up for short periods of time to check for new connections.</p>

<p>Now, my question is: Is it more efficient to wake the device up at regular intervals, or is it better to just keep it awake because the wakeup-sleep-transition will eat more power than simply keeping the device awake all the time? The intervals I am talking about here are on a scale of 1-10 seconds.</p>

<p>Alternate solutions that get around the issue are also highly welcome, of course, if they aren't limited to a small set of devices.</p>",android|alarmmanager|alarm|android-alarms|wakelock,1939031,Jan Schejbal,yes
Android - How can i write to file when the screen times out,"<p>We are writing an (industry specific) application that maintains it's own log file (I know we should use the android log, but for business purposes we need to maintain this log file in a very specific format.) This app is not for mass market, and users will be well aware of the battery drain the app will suffer.</p>

<p>First the app has a service that must maintain a connection to a server at all times. We have achieved this through the use of a partial wakelock, which works as expected once the screen time's out.</p>

<p>Our problem however, when the screen time's out, our logger module ceases to write to a file located on external storage, once the screen is started again the logger resumes after a short period.</p>

<p>We know the app isn't being killed by the system (due to the foreground service) as when it is restarted everything remains as it should. (A restart brings us back to a different screen)</p>

<p>Is there another way to force the system to keep the stream to the file open? Why does the partial-wake-lock we hold not do this already?</p>

<p>There must be a way we can write to file at all times.</p>",android|android-wake-lock,953837,Gov,no
Reading voltage from laptop's battery third party bms and activate charging,"<p>Has anyone tried recell laptop battery and replace onboard controller board (ie: bq8050) with simple cheap bms? Obviously there would be no smbus communication therefore no information are being reported back to OS. Now, we can get the battery to power the laptop and run until its drained, however since there is no way to measure battery voltage within OS by means of typeperf command(or is it ??) and as a result laptop cannot trigger charging procedure. Any solutions?</p>",windows|battery,19319668,mike_z,yes
How to keep Screen On while looping urls in the Browser.apk?,"<p>Currently I am using IntentService to loop urls in the Browser.apk. I am running it until the battery drains. Here is my dirty code. =)</p>

<pre><code>@Override
protected void onHandleIntent(Intent intent) {
    int size = intent.getStringArrayExtra(""addresses"").length;
    int counter = sp.getInt(""counter"", 0);
    String address = intent.getStringArrayExtra(""addresses"")[counter];
    Intent i = new Intent(Intent.ACTION_VIEW);

    i.setData(Uri.parse(address));
    i.setFlags(Intent.FLAG_FROM_BACKGROUND | Intent.FLAG_ACTIVITY_REORDER_TO_FRONT | Intent.FLAG_ACTIVITY_NEW_TASK);
    startActivity(i);

    counter++;
    if(counter == size) {
        counter = 0;
    }
    spe.putInt(""counter"", counter);
    spe.commit();
}
</code></pre>

<p>I tried to use wakelock but not all devices stays awake. It is working with Motorola Xoom but not in Thinkpad tablet slate.</p>

<p>Do you know other option other than using the wakelock. Or How should I properly implement the wakelock?</p>

<p>Can I tell the Browser that I should keep the Screen On while loading the urls? By using intent or other means.</p>",android|wakelock,654862,quiel,no
Android execute a function after 1 hour,"<p>I have an android application where I am storing user's data on database when he/she activates the app. My app requires the user to stop the application manually in order to remove  its entry from the database and along with that other services which keep running when the app is activated. </p>

<p>So I want to write a function which will be executed after every hour (when the app is activated) and will give a notification to user just to remind  him/her about the service which is running .If the user had forgot to stop the service then they can stop it or continue with service.</p>

<p>What is the best efficient way of doing this. I dont want to drain too much of battery with thihs 1 hour basis check if the user considers it to run for a day or so. Please advice. Thanks :)</p>",android|performance|timer|android-asynctask,3064175,ik024,no
Handling ActivityRecognition.API intents while app is inactive,"<p>I'm looking for the general design to implement this:</p>

<p>I want to register to the ActivityRecognition API to receive regular updates in a IntentService called from time to time by this API, while everything else in my App is completely inactive (the goal here is to avoid draining too much battery power on the device).</p>

<p>The issue is that with the new ActivityRecognition API design, it is tied to a GooglePlayServices client, like this for example: </p>

<pre><code>ActivityRecognition.ActivityRecognitionApi.requestActivityUpdates(
    myGoogleApiClient, 
    3000L, 
    myActivityRecognitionPendingIntent);
</code></pre>

<p>And logically, this client disappears if the Activity or Service that created it is destroyed, resulting of the loss of any ActivityRecognition updates. </p>

<p>Obviously everything can go well if I keep a Service (or Activity) alive, holding constantly the GooglePlayServices client used to initiate the ActivityRecognition API (<em>myGoogleApiClient</em> in this example)… But that is what I want to avoid…</p>

<p>How can this be achieved?</p>",android|design-patterns|google-play-services|activity-recognition,1720332,JBA,yes
How do I calculate the battery drain for a particular app using dumpsys batterystats?,"<p>I am new to Android and adb commands. I have executed the following command in a terminal: <code>adb shell dumpsys batterystats --charged com.google.android.youtube</code>. This gives me the estimated power use in mAh, as shown below. I have two questions:</p>

<p>What does <code>computed drain: 93.8</code>  mean and can I use this to calculate the percentage of power consumed by particular app?</p>

<pre><code>adb shell dumpsys batterystats --charged com.google.android.youtube 

Estimated power use (mAh):
    Capacity: 2390, Computed drain: 93.8, actual drain: 0.00000000
    Screen: 52.5
    Cell standby: 23.3
    Uid u0a96: 6.26
    Uid 1000: 3.91
</code></pre>",android|adb|battery,8482213,anbu,yes
Ionic Analytics data takes up most of localStorage space,"<p>I'm developing a mobile App using Ionic Framework. I tried to get the Ionic Analytics running by doing <a href=""http://docs.ionic.io/docs/analytics-from-scratch"" rel=""nofollow"">everything from scratch</a>.</p>

<p>According to <a href=""http://docs.ionic.io/docs/analytics-javascript-api"" rel=""nofollow"">this</a> : </p>

<blockquote>
  <p>To cut down on battery drain when sending events, Ionic Analytics does not send an HTTP request for every event tracked. Instead, it queues events in memory and sends a batch of events every 30 seconds. This 30 seconds is the dispatch interval.</p>
</blockquote>

<p>So i assume every 30 seconds my analytics data should sync. For development i'm using <code>Ionic serve --lab</code> to debug my app and i'm tracking my localStorage usage with <a href=""https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0CCAQFjAAahUKEwjby_6KuN_HAhUBVRoKHXYWDrw&amp;url=https%3A%2F%2Fchrome.google.com%2Fwebstore%2Fdetail%2Fhtml5-storage-manager-all%2Fgiompennnhheakjcnobejbnjgbbkmdnd%3Fhl%3Den&amp;usg=AFQjCNH45688OB-axYL5B0GEs85Zfv9rOw&amp;bvm=bv.102022582,d.bGQ"" rel=""nofollow"">HTML5 Storage Manager All In One</a> extension.</p>

<p>As i'm working with my app and tapping around and going to different states, Ionic is capturing my movements and in the log i see <code>Ionic Analytics: enqueuing event to send later: Tap Object{...}</code> and as i'm tracking my localStorage, the available space gets smaller and smaller. As this go on for quite some time, eventually i'll hit the size quota limit and i'll receive error until i manually delete my localStorage.</p>

<p>My question would be why the 30 second interval doesn't free up the space used by Ionic Analytics queued events? Is this behavior normal when i'm testing on browser and will it be okay on actual mobile devices?</p>",local-storage|ionic-framework,4582649,Sobhan,no
AlarmManager with notification not firing,"<p>I'm making an app with a persistent notification, so I'm trying to use <code>AlarmManager</code> to periodically update the notification.</p>

<p>I've extended <code>BroadcastReceiver</code>:</p>

<pre><code>public class Notification extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        updateNotification();
    }
</code></pre>

<p>If I just run notification.onReceive, the notification updates as expected, so I believe the problem isn't here. I've also added code in 'MainActivity.onCreate<code>that is supposed to create and run an</code>alarmManager`:</p>

<pre><code>protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Intent alarmIntent = new Intent(getApplicationContext(), Notification.class);
    PendingIntent pendingIntent = PendingIntent.getBroadcast(this, 0, alarmIntent, 0);

    AlarmManager manager = (AlarmManager) getSystemService(Context.ALARM_SERVICE);
    manager.set(AlarmManager.ELAPSED_REALTIME, SystemClock.elapsedRealtime() + 5000,
        pendingIntent);
}
</code></pre>

<p>Nothing appears to happen when I run the app, but I see the <code>AlarmManager</code> service draining my battery, so I'm pretty sure something is running. I think the problem is with <code>pendingIntent</code>; Either that or I am missing something (haven't done anything else in the project relating to <code>AlarmManager</code>).</p>

<p>Coding this on Android Studio and running it on my Note 4. <code>minSdkVersion 19</code>, <code>targetSdkVersion 21</code></p>

<p>Any help is greatly appreciated. Thanks!</p>",android|android-studio|alarmmanager|android-notifications,2256053,Calvin Li,yes
iPhone Significant Location Change Battery Drain?,"<p><strong>Question:</strong> Does the Significant Location Change background service drain battery easily?  I'm trying to track longitude latitude readings when the there is a Significant Location Change.  However, before starting, I just want to make sure that this doesn't drain the battery.  </p>

<p>If the Location service described above does <strong>not</strong> drain battery, can someone recommend a way to store the location changes that would be battery efficient.  My initial thought was to store the longitude latitude points locally on iPhone and then send the information to the server on a much less frequent basis (2 hours).  Anyone have a better approach?  </p>

<p>I'm trying to build a simple location tracking app that is battery efficient.  Thanks all. </p>",iphone|location|battery,177941,Ryan,no
Prevent GPS draining battery of cell phone when location is searched,"<p>I'm using LocationManager's method <code>requestLocationUpdates</code> to get the location of the cell phone.</p>

<p>I'm using GPS as the Provider and working with a <code>LocationListener</code> to update the UI of my app.</p>

<p>I need to call a method on my Activity every 1000 milliseconds. To do that, I configured the <code>requestLocationUpdates</code> like this:</p>

<pre><code>locationManager.requestLocationUpdates(provider, 0, 1000, listener);
</code></pre>

<p>Everything is working well. The <code>onLocationChanged</code> method is called and the Latitude and Logitude are showed ok.</p>

<p>But I have some doubts. </p>

<ol>
<li>What happens if I'm in a place with no GPS signal?. </li>
<li>There is some <code>automatic</code> Timeout? </li>
<li>Or the App will try to get the position using the GPS all the time and will drain the battery.</li>
<li>What happens if I switch to <code>WiFI/3G</code> Provider and thats signals also aren't working? It happens the same?</li>
</ol>

<p>I search over Internet looking for the answer but I can't find the right solution.</p>",android|gps|android-location,215540,Mark Comix,no
sensor data saving at CSV file,"<p>I am new in android developing, I developed this code based on previous code related to Mr.liwatiz to find orientation from sensor fusion, I added writeCSV file to store data, The application work and the file created but there is no data store! So please what is the problem. my code clear below</p>

<pre><code>public class MainActivity extends Activity implements SensorEventListener, RadioGroup.OnCheckedChangeListener{
private SensorManager mSensorManager = null;

    // angular speeds from gyro
    private float[] gyro = new float[3];

    // rotation matrix from gyro data
    private float[] gyroMatrix = new float[9];

    // orientation angles from gyro matrix
    private float[] gyroOrientation = new float[3];

    // magnetic field vector
    private float[] magnet = new float[3];

    // accelerometer vector
    private float[] accel = new float[3];

    // orientation angles from accel and magnet
    private float[] accMagOrientation = new float[3];

    // final orientation angles from sensor fusion
    private float[] fusedOrientation = new float[3];

    // accelerometer and magnetometer based rotation matrix
    private float[] rotationMatrix = new float[9];

    public static final float EPSILON = 0.000000001f;
    private static final float NS2S = 1.0f / 1000000.0f;
    private int timestamp;
    private boolean initState = true;

    public static final int TIME_CONSTANT = 30;
    public static final float FILTER_COEFFICIENT = 0.98f;
    private Timer fuseTimer = new Timer();

    // The following members are only for displaying the sensor output.
    public Handler mHandler;
    private RadioGroup mRadioGroup;
    private TextView mAzimuthView;
    private TextView mPitchView;
    private TextView mRollView;
    private int radioSelection;
    DecimalFormat d = new DecimalFormat(""#.##"");


    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        gyroOrientation[0] = 0.0f;
        gyroOrientation[1] = 0.0f;
        gyroOrientation[2] = 0.0f;

        // initialise gyroMatrix with identity matrix
        gyroMatrix[0] = 1.0f; gyroMatrix[1] = 0.0f; gyroMatrix[2] = 0.0f;
        gyroMatrix[3] = 0.0f; gyroMatrix[4] = 1.0f; gyroMatrix[5] = 0.0f;
        gyroMatrix[6] = 0.0f; gyroMatrix[7] = 0.0f; gyroMatrix[8] = 1.0f;

        // get sensorManager and initialise sensor listeners
        mSensorManager = (SensorManager) this.getSystemService(SENSOR_SERVICE);
        initListeners();

        // wait for one second until gyroscope and magnetometer/accelerometer
        // data is initialised then scedule the complementary filter task
        fuseTimer.scheduleAtFixedRate(new calculateFusedOrientationTask(),
                1000, TIME_CONSTANT);

        // GUI stuff
        mHandler = new Handler();
        radioSelection = 0;
        d.setRoundingMode(RoundingMode.HALF_UP);
        d.setMaximumFractionDigits(3);
        d.setMinimumFractionDigits(3);
        mRadioGroup = (RadioGroup)findViewById(R.id.radioGroup1);
        mAzimuthView = (TextView)findViewById(R.id.textView4);
        mPitchView = (TextView)findViewById(R.id.textView5);
        mRollView = (TextView)findViewById(R.id.textView6);
        mRadioGroup.setOnCheckedChangeListener(this);
    }

    @Override
    public void onStop() {
        super.onStop();
        // unregister sensor listeners to prevent the activity from draining the device's battery.
        mSensorManager.unregisterListener(this);
    }

    @Override
    protected void onPause() {
        super.onPause();
        // unregister sensor listeners to prevent the activity from draining the device's battery.
        mSensorManager.unregisterListener(this);
    }

    @Override
    public void onResume() {
        super.onResume();
        // restore the sensor listeners when user resumes the application.
        initListeners();
    }

    // This function registers sensor listeners for the accelerometer, magnetometer and gyroscope.
    public void initListeners(){
        mSensorManager.registerListener(this,
                mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER),
                SensorManager.SENSOR_DELAY_NORMAL);

        mSensorManager.registerListener(this,
                mSensorManager.getDefaultSensor(Sensor.TYPE_GYROSCOPE),
                SensorManager.SENSOR_DELAY_NORMAL);

        mSensorManager.registerListener(this,
                mSensorManager.getDefaultSensor(Sensor.TYPE_MAGNETIC_FIELD),
                SensorManager.SENSOR_DELAY_NORMAL);
    }

    @Override
    public void onAccuracyChanged(Sensor sensor, int accuracy) {
    }



    public void writeToCsvGy(String x,String y,String z) throws IOException {

        Calendar c = Calendar.getInstance();
        File folder = new File(Environment.getExternalStorageDirectory() + ""/TollCulator"");
        boolean success = true;
        if (!folder.exists()) {
            success = folder.mkdir();
        }
        if (success) {
            // Do something on success



            String csv = ""/storage/sdcard0/project/GyroscopeValue.csv"";
            FileWriter file_writer = new FileWriter(csv,true);




            String s= c.get(Calendar.YEAR)+"",""+c.get(Calendar.MONTH)+"",""+c.get(Calendar.DATE)+"",""+c.get(Calendar.HOUR)+"",""+c.get(Calendar.MINUTE)+"",""+c.get(Calendar.SECOND)+"",""+ c.get(Calendar.MILLISECOND)+"",""+x + "",""+y+"",""+z+""\n"";

            file_writer.append(s);
            file_writer.close();
        }


    }

















    @Override
    public void onSensorChanged(SensorEvent event) {
        switch(event.sensor.getType()) {
            case Sensor.TYPE_ACCELEROMETER:
                // copy new accelerometer data into accel array and calculate orientation
                System.arraycopy(event.values, 0, accel, 0, 3);
                calculateAccMagOrientation();
                break;

            case Sensor.TYPE_GYROSCOPE:
                // process gyro data
                gyroFunction(event);
                break;

            case Sensor.TYPE_MAGNETIC_FIELD:
                // copy new magnetometer data into magnet array
                System.arraycopy(event.values, 0, magnet, 0, 3);
                break;
        }
    }

    // calculates orientation angles from accelerometer and magnetometer output
    public void calculateAccMagOrientation() {
        if(SensorManager.getRotationMatrix(rotationMatrix, null, accel, magnet)) {
            SensorManager.getOrientation(rotationMatrix, accMagOrientation);
        }
    }

    // This function is borrowed from the Android reference
    // at http://developer.android.com/reference/android/hardware/SensorEvent.html#values
    // It calculates a rotation vector from the gyroscope angular speed values.
    private void getRotationVectorFromGyro(float[] gyroValues,
                                           float[] deltaRotationVector,
                                           float timeFactor)
    {
        float[] normValues = new float[3];

        // Calculate the angular speed of the sample
        float omegaMagnitude =
                (float)Math.sqrt(gyroValues[0] * gyroValues[0] +
                        gyroValues[1] * gyroValues[1] +
                        gyroValues[2] * gyroValues[2]);

        // Normalize the rotation vector if it's big enough to get the axis
        if(omegaMagnitude &gt; EPSILON) {
            normValues[0] = gyroValues[0] / omegaMagnitude;
            normValues[1] = gyroValues[1] / omegaMagnitude;
            normValues[2] = gyroValues[2] / omegaMagnitude;
        }

        // Integrate around this axis with the angular speed by the timestep
        // in order to get a delta rotation from this sample over the timestep
        // We will convert this axis-angle representation of the delta rotation
        // into a quaternion before turning it into the rotation matrix.
        float thetaOverTwo = omegaMagnitude * timeFactor;
        float sinThetaOverTwo = (float)Math.sin(thetaOverTwo);
        float cosThetaOverTwo = (float)Math.cos(thetaOverTwo);
        deltaRotationVector[0] = sinThetaOverTwo * normValues[0];
        deltaRotationVector[1] = sinThetaOverTwo * normValues[1];
        deltaRotationVector[2] = sinThetaOverTwo * normValues[2];
        deltaRotationVector[3] = cosThetaOverTwo;
    }

    // This function performs the integration of the gyroscope data.
    // It writes the gyroscope based orientation into gyroOrientation.
    public void gyroFunction(SensorEvent event) {
        // don't start until first accelerometer/magnetometer orientation has been acquired
        if (accMagOrientation == null)
            return;

        // initialisation of the gyroscope based rotation matrix
        if(initState) {
            float[] initMatrix = new float[9];
            initMatrix = getRotationMatrixFromOrientation(accMagOrientation);
            float[] test = new float[3];
            SensorManager.getOrientation(initMatrix, test);
            gyroMatrix = matrixMultiplication(gyroMatrix, initMatrix);
            initState = false;
        }

        // copy the new gyro values into the gyro array
        // convert the raw gyro data into a rotation vector
        float[] deltaVector = new float[4];
        if(timestamp != 0) {
            final float dT = (event.timestamp - timestamp) * NS2S;
            System.arraycopy(event.values, 0, gyro, 0, 3);
            getRotationVectorFromGyro(gyro, deltaVector, dT / 2.0f);
        }

        // measurement done, save current time for next interval

        switch ( timestamp = (int) event.timestamp ) {
        }

        // convert rotation vector into rotation matrix
        float[] deltaMatrix = new float[9];
        SensorManager.getRotationMatrixFromVector(deltaMatrix, deltaVector);

        // apply the new rotation interval on the gyroscope based rotation matrix
        gyroMatrix = matrixMultiplication(gyroMatrix, deltaMatrix);

        // get the gyroscope based orientation from the rotation matrix
        SensorManager.getOrientation(gyroMatrix, gyroOrientation);
    }

    private float[] getRotationMatrixFromOrientation(float[] o) {
        float[] xM = new float[9];
        float[] yM = new float[9];
        float[] zM = new float[9];

        float sinX = (float)Math.sin(o[1]);
        float cosX = (float)Math.cos(o[1]);
        float sinY = (float)Math.sin(o[2]);
        float cosY = (float)Math.cos(o[2]);
        float sinZ = (float)Math.sin(o[0]);
        float cosZ = (float)Math.cos(o[0]);

        // rotation about x-axis (pitch)
        xM[0] = 1.0f; xM[1] = 0.0f; xM[2] = 0.0f;
        xM[3] = 0.0f; xM[4] = cosX; xM[5] = sinX;
        xM[6] = 0.0f; xM[7] = -sinX; xM[8] = cosX;

        // rotation about y-axis (roll)
        yM[0] = cosY; yM[1] = 0.0f; yM[2] = sinY;
        yM[3] = 0.0f; yM[4] = 1.0f; yM[5] = 0.0f;
        yM[6] = -sinY; yM[7] = 0.0f; yM[8] = cosY;

        // rotation about z-axis (azimuth)
        zM[0] = cosZ; zM[1] = sinZ; zM[2] = 0.0f;
        zM[3] = -sinZ; zM[4] = cosZ; zM[5] = 0.0f;
        zM[6] = 0.0f; zM[7] = 0.0f; zM[8] = 1.0f;

        // rotation order is y, x, z (roll, pitch, azimuth)
        float[] resultMatrix = matrixMultiplication(xM, yM);
        resultMatrix = matrixMultiplication(zM, resultMatrix);
        return resultMatrix;





    }

    private float[] matrixMultiplication(float[] A, float[] B) {
        float[] result = new float[9];

        result[0] = A[0] * B[0] + A[1] * B[3] + A[2] * B[6];
        result[1] = A[0] * B[1] + A[1] * B[4] + A[2] * B[7];
        result[2] = A[0] * B[2] + A[1] * B[5] + A[2] * B[8];

        result[3] = A[3] * B[0] + A[4] * B[3] + A[5] * B[6];
        result[4] = A[3] * B[1] + A[4] * B[4] + A[5] * B[7];
        result[5] = A[3] * B[2] + A[4] * B[5] + A[5] * B[8];

        result[6] = A[6] * B[0] + A[7] * B[3] + A[8] * B[6];
        result[7] = A[6] * B[1] + A[7] * B[4] + A[8] * B[7];
        result[8] = A[6] * B[2] + A[7] * B[5] + A[8] * B[8];

        return result;
    }

    class calculateFusedOrientationTask extends TimerTask {
        public void run() {
            float oneMinusCoeff = 1.0f - FILTER_COEFFICIENT;

            /*
             * Fix for 179? &lt;--&gt; -179? transition problem:
             * Check whether one of the two orientation angles (gyro or accMag) is negative while the other one is positive.
             * If so, add 360? (2 * math.PI) to the negative value, perform the sensor fusion, and remove the 360? from the result
             * if it is greater than 180?. This stabilizes the output in positive-to-negative-transition cases.
             */

            // azimuth
            if (gyroOrientation[0] &lt; -0.5 * Math.PI &amp;&amp; accMagOrientation[0] &gt; 0.0) {
                fusedOrientation[0] = (float) (FILTER_COEFFICIENT * (gyroOrientation[0] + 2.0 * Math.PI) + oneMinusCoeff * accMagOrientation[0]);
                fusedOrientation[0] -= (fusedOrientation[0] &gt; Math.PI) ? 2.0 * Math.PI : 0;
            }
            else if (accMagOrientation[0] &lt; -0.5 * Math.PI &amp;&amp; gyroOrientation[0] &gt; 0.0) {
                fusedOrientation[0] = (float) (FILTER_COEFFICIENT * gyroOrientation[0] + oneMinusCoeff * (accMagOrientation[0] + 2.0 * Math.PI));
                fusedOrientation[0] -= (fusedOrientation[0] &gt; Math.PI)? 2.0 * Math.PI : 0;
            }
            else {
                fusedOrientation[0] = FILTER_COEFFICIENT * gyroOrientation[0] + oneMinusCoeff * accMagOrientation[0];
            }

            // pitch
            if (gyroOrientation[1] &lt; -0.5 * Math.PI &amp;&amp; accMagOrientation[1] &gt; 0.0) {
                fusedOrientation[1] = (float) (FILTER_COEFFICIENT * (gyroOrientation[1] + 2.0 * Math.PI) + oneMinusCoeff * accMagOrientation[1]);
                fusedOrientation[1] -= (fusedOrientation[1] &gt; Math.PI) ? 2.0 * Math.PI : 0;
            }
            else if (accMagOrientation[1] &lt; -0.5 * Math.PI &amp;&amp; gyroOrientation[1] &gt; 0.0) {
                fusedOrientation[1] = (float) (FILTER_COEFFICIENT * gyroOrientation[1] + oneMinusCoeff * (accMagOrientation[1] + 2.0 * Math.PI));
                fusedOrientation[1] -= (fusedOrientation[1] &gt; Math.PI)? 2.0 * Math.PI : 0;
            }
            else {
                fusedOrientation[1] = FILTER_COEFFICIENT * gyroOrientation[1] + oneMinusCoeff * accMagOrientation[1];
            }

            // roll
            if (gyroOrientation[2] &lt; -0.5 * Math.PI &amp;&amp; accMagOrientation[2] &gt; 0.0) {
                fusedOrientation[2] = (float) (FILTER_COEFFICIENT * (gyroOrientation[2] + 2.0 * Math.PI) + oneMinusCoeff * accMagOrientation[2]);
                fusedOrientation[2] -= (fusedOrientation[2] &gt; Math.PI) ? 2.0 * Math.PI : 0;
            }
            else if (accMagOrientation[2] &lt; -0.5 * Math.PI &amp;&amp; gyroOrientation[2] &gt; 0.0) {
                fusedOrientation[2] = (float) (FILTER_COEFFICIENT * gyroOrientation[2] + oneMinusCoeff * (accMagOrientation[2] + 2.0 * Math.PI));
                fusedOrientation[2] -= (fusedOrientation[2] &gt; Math.PI)? 2.0 * Math.PI : 0;
            }
            else {
                fusedOrientation[2] = FILTER_COEFFICIENT * gyroOrientation[2] + oneMinusCoeff * accMagOrientation[2];
            }

            // overwrite gyro matrix and orientation with fused orientation
            // to comensate gyro drift
            gyroMatrix = getRotationMatrixFromOrientation(fusedOrientation);
            System.arraycopy(fusedOrientation, 0, gyroOrientation, 0, 3);


            // update sensor output in GUI
            mHandler.post(updateOreintationDisplayTask);
        }
    }


    // **************************** GUI FUNCTIONS *********************************

    @Override
    public void onCheckedChanged(RadioGroup group, int checkedId) {
        switch(checkedId) {
            case R.id.radio0:
                radioSelection = 0;
                break;
            case R.id.radio1:
                radioSelection = 1;
                break;
            case R.id.radio2:
                radioSelection = 2;
                break;
        }
    }

    public void updateOreintationDisplay() {
        switch(radioSelection) {
            case 0:
                mAzimuthView.setText(d.format(accMagOrientation[0] * 180/Math.PI) + '?');
                mPitchView.setText(d.format(accMagOrientation[1] * 180/Math.PI) + '?');
                mRollView.setText(d.format(accMagOrientation[2] * 180/Math.PI) + '?');



                try {
                    writeToCsv((d.format(accMagOrientation[0] * 180/Math.PI) + '?'),(d.format(accMagOrientation[1] * 180/Math.PI)+ '?'),(d.format(accMagOrientation[2] * 180/Math.PI) + '?'));
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }



                break;
            case 1:
                mAzimuthView.setText(d.format(gyroOrientation[0] * 180/Math.PI) + '?');
                mPitchView.setText(d.format(gyroOrientation[1] * 180/Math.PI) + '?');
                mRollView.setText(d.format(gyroOrientation[2] * 180/Math.PI) + '?');

                try {
                    writeToCsv((d.format(gyroOrientation[0] * 180/Math.PI) + '?'),(d.format(gyroOrientation[1] * 180/Math.PI)+ '?'),(d.format(gyroOrientation[2] * 180/Math.PI) + '?'));
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }




                break;
            case 2:
                mAzimuthView.setText(d.format(fusedOrientation[0] * 180/Math.PI) + '?');
                mPitchView.setText(d.format(fusedOrientation[1] * 180/Math.PI) + '?');
                mRollView.setText(d.format(fusedOrientation[2] * 180/Math.PI) + '?');



                try {
                    writeToCsv((d.format(fusedOrientation[0] * 180/Math.PI) + '?'),(d.format(fusedOrientation[1] * 180/Math.PI) + '?'),(d.format(fusedOrientation[2] * 180/Math.PI) + '?'));
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

                break;
        }
    }

    private void writeToCsv(String x, String y, String z)  throws IOException {

        Calendar c = Calendar.getInstance();

       // File path = getFilesDir();

        File folder = new File(getFilesDir() + ""/TollCulator"");
        boolean success = true;
        if (! folder.exists()) {
            success = folder.mkdir();
        }
        if (success) {
            // Do something on success



            String csv = ""data.csv"";
            FileWriter file_writer = new FileWriter(csv,true);




            String s= c.get(Calendar.YEAR)+"",""+c.get(Calendar.MONTH)+"",""+c.get(Calendar.DATE)+"",""+c.get(Calendar.HOUR)+"",""+c.get(Calendar.MINUTE)+"",""+c.get(Calendar.SECOND)+"",""+ c.get(Calendar.MILLISECOND)+"",""+x + "",""+y+"",""+z+""\n"";

            file_writer.append(s);
            file_writer.close();
        }


    }

    private Runnable updateOreintationDisplayTask = new Runnable() {
        public void run() {
            updateOreintationDisplay();
        }
    };

}
</code></pre>",android|accelerometer|gyroscope|sensor-fusion,8678648,danub,yes
Why use MQTT over WebSockets instead of WebSockets?,"<p>MQTT is a lightweight protocol with low bandwidth and battery drain. In opposition, Websockets have hight battery drain. <strong>But if I need to use MQTT over Websockets, woundn't it be better just to use Websockets in the first place?</strong></p>
<p>I'm designing a mobile application which needs live data and I'm concerned with battery drain.</p>",mobile|websocket|mqtt|bandwidth|battery,18402651,João,yes
Best way to implement proximity alerts android,"<p>Hi I am developing android application and in my application i wanted to proximity alert for few location and those location are dynamic points mean location list can be change dynamically according users current location.</p>

<p>so I implemented proximity alerts in my application its working fine with entering and exiting events. But problem is that if I set expiration time as -1 it continuously uses GPS which drains device battery. </p>

<p>If I set expiration time then it stop searching for that location after expiration time exceeds.</p>

<p>And another question setting multiple proximity alerts causes battery consumption heavily?</p>

<p>How to use proximity alerts efficiently. Is there any better way to handle this scenario. </p>

<p>Need help.. Thank you...    </p>",android|geolocation|batterylevel|proximitysensor,861204,nilkash,yes
Efficient Background service for tracking user location,"<p>I am developing a small android application in which I want to have Geolocation functionality.
What I want to code is one service which gives the updated location of a user whether they are using my application or not.</p>

<p>I know that if I am continuously checking the user's location it will drain the battery of the  device, so I want good solution for that. For example, to give me updates every 5 or 10 minutes. I have read about this question a lot but I wanted to get one good solution.</p>

<p>I read <a href=""http://android-developers.blogspot.ro/2011/06/deep-dive-into-location.html"" rel=""noreferrer"">this page</a> and it's a good solution if the user is using my application but if the user not using my application then what should I do? How do I solve this challenge?</p>",android|service|geolocation|batterylevel,861204,nilkash,yes
Android embedded barcode scanner,"<p>I'm trying to build an Android app, like a Point Of Sale machine. 
On opening the app, one corner of the app should have the camera view, listening for barcode (battery drain part understandable and that's acceptable in this case). Remaining part of the app should show the items added to the cart.  </p>

<p>The use case here is to keep listening for barcode in one part of UI and remainng part of the app shows the scanned content. There should not be any switch between the apps main screen and barcode scanner. </p>

<p>Can someone please help on this?</p>",java|android|android-layout|barcode-scanner,1057093,Anand,no
Android Management API - boot device when power is conncted,"<p>So, as the title describes, I'm looking for a way to boot an Android device when the power charger is connected. We are making dedicated devices, in kiosk mode, and are using the Android Management API to setup everything on the device.</p>

<p>This covers most of our requirements, like preinstalling apps, disabling everything else, hooking it up to Managed Google Play, getting device reports etc... But for this power thing, I can't find any solutions in the docs. </p>

<p>The problem is that the physical power button isn't accessible to the user (don't ask my why :)), and when the battery drains they have to be able to power it up again, without unscrewing the case to get to the physical button.</p>

<p>I know this can be done in different ways, but I can't find anything that would work with Android Management API. I'm looking at this ""fastboot"" approach, since it seems pretty simple <a href=""https://source.android.com/devices/bootloader/unlock-trusty#off-mode-charging"" rel=""nofollow noreferrer"">https://source.android.com/devices/bootloader/unlock-trusty#off-mode-charging</a> </p>

<p>Initially, I though I could run this somehow using the devices/issueCommand endpoint <a href=""https://developers.google.com/android/management/reference/rest/v1/enterprises.devices/issueCommand"" rel=""nofollow noreferrer"">https://developers.google.com/android/management/reference/rest/v1/enterprises.devices/issueCommand</a>, but that seems to support only some predefined commands like: LOCK, RESET_PASSWORD and REBOOT.</p>

<p>Maybe I'm just missing something. If someone has another approach in mind, please share. </p>

<p>If it's any help, we also have the Android Management API hooked up to the PubSub API, and a topic there that the pulls the reports of the devices. Theoretically, I could listed to the ""power connected"" event there, and run some command on the device. But again, the problem is how to run this command on the device remotely.</p>

<p>Maybe a solution would be to make another app that will run as a background process that runs this command. I guess I would need to add it as ""receiverActivity"" in the policy. But the same problem remains... how to invoke this activity from the Android Management API.</p>

<p>The bottom line is that this needs to be fully automated. Running this command on each device manually is not an option.</p>

<p>Also, worth mentioning, this is an Ionic app. Although it's probably not impossible, we would like to keep this logic outside of the app itself. Ideal solution would be just to run some adb command remotely using the Android Management API.</p>

<p>Or maybe there is a good 3rd party app that does this, and I could install that app in the policy and invoke it somehow.</p>

<p>All suggestions are welcome. Maybe there is a simple solution that I've missed.</p>

<p><strong>UPDATE AFTER COMMENTS:</strong> I'm not looking how the actual app can do this. I'm looking for a way to execute some ""native"" command when the device is initially setup from the Android Management API policy. So it should execute only once. When it sets up everything initially. It should edit some file on the device (or run some command) to enable this feature. Later, it shouldn't care if the device is turned on or not, or what apps are running on it. There are a few different ways how to do this suggested here <a href=""https://android.stackexchange.com/questions/20021/automatically-power-on-android-when-the-charger-is-connected"">https://android.stackexchange.com/questions/20021/automatically-power-on-android-when-the-charger-is-connected</a>. I'm looking for a way to trigger one of these commands when the device is setup initially (only once). In other words, this should execute only when the device is enrolled. It shouldn't care about any apps running on the device.</p>",android|ionic-framework|google-cloud-pubsub|android-management-api,329200,ZolaKt,yes
How to make sure the Broadcast Receiver is disconnected,"<p>I wrote a simple Broadcast Receiver which catches incoming calls and starts activity with the caller's number: </p>

<pre><code>package com.example.nrsearch;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.telephony.PhoneStateListener;
import android.telephony.TelephonyManager;
import android.util.Log;

public class CallReceiver extends BroadcastReceiver {
public CallReceiver() {
}

public Context context;

@Override
public void onReceive(Context context, Intent intent) {
    Log.i(""CallReceiverBroadcast"", ""onReceive() is called. "");
    this.context = context;
    TelephonyManager teleMgr = (TelephonyManager)context.getSystemService(Context.TELEPHONY_SERVICE);
    PhoneStateListener psl = new PhoneStateListener() {
        @Override
        public void onCallStateChanged(int state, String incomingNumber) {
            Log.i(""CallReceiverBroadcast"", ""onCallStateChanged() is called. "");
            switch (state) {
            case TelephonyManager.CALL_STATE_RINGING:
                Log.i(""CallReceiverBroadcast"", ""Incoming call caught. Caller's number is "" + incomingNumber + ""."");
                startNumberDisplayActivity(incomingNumber);
            }
        }
    };
    teleMgr.listen(psl, PhoneStateListener.LISTEN_CALL_STATE);
    teleMgr.listen(psl, PhoneStateListener.LISTEN_NONE);
}

public void startNumberDisplayActivity(String incomingNumber) {
    Intent i = new Intent(context, MainActivity.class);
    i.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    i.putExtra(""incomingNumber"", incomingNumber);
    context.startActivity(i);
}
}
</code></pre>

<p>However, after the first incoming call I feel like my device's battery starts to drain pretty quickly. I'm afraid that some process still prevents my Broadcast Receiver from disconnecting (I mean my Broadcast Receiver may be running forever). So, is there something in my code that could cause such a behavior and does this line really stops the TelephonyManager from listening for call state changes: <code>teleMgr.listen(psl, PhoneStateListener.LISTEN_NONE);</code> or should I do it some other way? </p>

<p>EDIT: I'm almost sure that this class causes battery drain, because now I'm testing battery life with my app uninstalled and it's much lower than previous when this app was installed and broadcast receiver was called. I can't swear that this class is the cause of the drain but the battery consumption difference is clearly visible with and without this app. Could somebody look at this code and say what could cause the battety drain? Thanks in advance! </p>",android|broadcastreceiver|telephonymanager|disconnect|phone-state-listener,2883597,Salivan,yes
Avoid data polling for Flutter,"<p>So basically, right now i'm currently call API from the backend every 2 second to get the realtime if there's any changes occur. What i'm facing is polling which is not good since it can drain handphone battery. Is there a way for me to avoid polling, for example the app can detect only if there's changes with the database</p>",flutter|dart,9216577,ali,yes
Android MapView keeps Location on,"<p>I have a simple fragment with a mapview displayed. I have override all the necessary methods according to the documentation (destroy, resume and start) to cal the same method of the mapview. However when I detach the fragment or exit the application the location keeps on. It will drain too much battery. Is there any procedure I can make to stop the location feature?. I've tried calling mapview.onDestroy, mapview=null, etc etc and the location keeps on.</p>

<p>Thanks</p>",android|google-maps-android-api-2,3410697,Pedro Oliveira,no
Region Monitoring (Geofencing) drains battery (iOS),"<p>I've implemented in my app the region monitoring feature of <code>CLLocationManager</code>, it works but it kills my battery:</p>

<p>-</p>

<p><a href=""https://i.stack.imgur.com/qGxQ4.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/qGxQ4.png"" alt=""Image""></a></p>

<p>-</p>

<p>Is it should be like that?</p>

<p>My code:</p>

<p><strong>monitorLocationViewController.m</strong> (please scroll to see the full code):</p>

<pre><code>-(void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray&lt;CLLocation *&gt; *)locations
{
    //If ""allStores""(NSMutableArray) isn't nil - calling ""locationChangeHandler"" to update monitoring
    if (self.allStores!=nil) {
        [self locationChangeHandler];
    }

    CLLocation *currentLocation=(CLLocation*)[locations lastObject];
    NSSet *monitoredRegionsSet=self.locationManager.monitoredRegions;
    [monitoredRegionsSet enumerateObjectsUsingBlock:^(CLCircularRegion *region, BOOL *stop) {
        if ([region containsCoordinate:currentLocation.coordinate]) {
            [self.locationManager stopMonitoringForRegion:region];
            [self locationManager:self.locationManager didEnterRegion:region];
        }
    }];
}

-(void)locationManager:(CLLocationManager *)manager didEnterRegion:(CLRegion *)region
{
     Store *store=[self storeForRegion:region];
    if (store.alreadySendNotification==NO) {
        UILocalNotification *notification=[[UILocalNotification alloc] init];
        notification.alertTitle=@""Arounder"";
        notification.alertBody=[[self storeForRegion:region] address];
        [[UIApplication sharedApplication] scheduleLocalNotification:notification];

        store.alreadySendNotification=YES;
    }
}

    //For updating monitoring
-(void)locationChangeHandler
{
//If ""allStores""(NSMutableArray) isn't nil
    if (self.allStores!=nil) {
        //Finding the 20 closest stores to he user's location and adding it to ""twentyClosestStores""(NSMutableArray)
        [self sortClosestStores];
        //Stop monitoring ""previousTwentyStores""(NSMutableArray) (20 closest stores before user's location  updated)
        [self stopMonitoringStores];
        //Start monitoring ""twentyClosestStores""(NSMutableArray)
        [self startMonitoringClosestStores];
    }
}

//Start monitoring ""twentyClosestStores""(NSMutableArray)
-(void)startMonitoringClosestStores
{
    //If monitoring isn't availible for ""CLCircularRegion""
    if (![CLLocationManager isMonitoringAvailableForClass:[CLCircularRegion class]]) {
        NSLog(@""Monitoring is not available for CLCircularRegion class"");
        return;
    }

    //Run on all ""twentyClosestStores""(NSMutableArray)'s objects
    for (Store *currentStore in self.twentyClosestStores) {
        //Start monitoring ""region""(CLCircularRegion)
        [self.locationManager startMonitoringForRegion:currentStore.circularRegion];
    }
}

//Stop monitoring ""previousTwentyStores""(NSMutableArray) (20 closest stores before user's location  updated)
-(void)stopMonitoringStores
{
    //Run on all ""monitoredRegions""(NSSet) of ""locationManager""(CLLocationManager) objects
    for (CLCircularRegion *currentRegion in self.locationManager.monitoredRegions) {
        //Stop monitoring ""region""(CLCircularRegion)
        [self.locationManager stopMonitoringForRegion:currentRegion];
    }
}

//Finding a store for region
-(Store*)storeForRegion:(CLCircularRegion*)region
{
    //Run on all ""allStores""(NSMutableArray)'s objects
    for (Store *currentStore in self.allStores) {
        //If ""currentStore""(Store)'s ""circularRegion""'s identifier is equal to ""region""(CLCircularRegion)'s identifier
        if ([currentStore.circularRegion.identifier isEqualToString:region.identifier]) {
            //Returning ""currentStore""(Store)
            return currentStore;
        }
    }
    //Store not found - returning nil
    NSLog(@""No store found for this region: %f,%f"",region.center.latitude,region.center.longitude);
    return nil;
}
</code></pre>

<p><strong>AppDelegate.m</strong>:</p>

<pre><code>-(BOOL)application:(UIApplication *)application willFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.monitorLocationVC=[[monitorLocationViewController alloc] init];
    self.monitorLocationVC.locationManager=self.locationManager;

    [self configureLocationManager];
    [self.locationManager startUpdatingLocation];

    return YES;
}

-(void)configureLocationManager
{
    //Initializing locationManager
    self.locationManager=[[CLLocationManager alloc] init];
    //setting ""locationManager""'s(CLLocationManager) delegate to ""self""
    self.locationManager.delegate=self.monitorLocationVC;
    //Setting ""locationManager""'s(CLLocationManager)'s distance filter to none
    self.locationManager.distanceFilter=kCLDistanceFilterNone;
    //Setting ""locationManager""'s(CLLocationManager)'s activityType to navigation
    self.locationManager.activityType=CLActivityTypeAutomotiveNavigation;
    //setting ""locationManager""'s(CLLocationManager) desiredAccuracy to ""best""
    self.locationManager.desiredAccuracy=kCLLocationAccuracyBestForNavigation;

    self.locationManager.pausesLocationUpdatesAutomatically=NO;

    //If OS version is 9 or above - setting ""allowsBackgroundLocationUpdates"" to YES
    if ([[[UIDevice currentDevice] systemVersion] floatValue] &gt;= 9) {
        self.locationManager.allowsBackgroundLocationUpdates = YES;
    }
}
</code></pre>

<p>Thank you!</p>",ios|objective-c|iphone|cocoa-touch|cllocationmanager,5836823,FS.O,yes
Keyboard battery level inquiry on a Microsoft modern keyboard,"<p>Recently bought a Microsoft modern keyboard with fingerprint id. It has no way to tell the battery percentage besides battery drained red light. 
It registers in device manager as Hid Keyboard Device. Curious if I can write my own driver or figure out if the existing driver can get this information. 
I don't even know if the firmware returns this information in anyway. I haven't done anything in this sense, where do I start?  </p>",c#|usb|hid,977744,drewex,yes
how to conserve battery life in a location based iOS app,"<p>I have an iOS app which gets the latitude /longitude of the user every second.. I am trying to conserve battery life.
If the app turns on the CLLocationManager() service every 30 seconds, then turn it off right away. Will this drain the battery?</p>",ios|swift|objective-c|optimization|geolocation,14550565,SA DL,no
What are the things which reduces (Android) battery time?,"<p>In one of our application we need to use the <code>GPS continuesly</code> ,the purpose is to get the user driving speed. Recently I found that while using the GPS continuesly can drain the device battery. 
If the GPS device is not used, device battery will work for hours but if the GPS is used it reduces the battery life dramatically.</p>

<ol>
<li><p>I was wondering that ""what are other things"" which can reduce the battery time?</p></li>
<li><p>How we can avoid them ?</p></li>
<li><p>What are the best practices to use them?</p></li>
</ol>",android|gps|wifi|power-management|battery,265167,Yaqub Ahmad,yes
Android SPP Bluetooth: Implement a Background connection attempt,"<p>I would like to minimize the need for user involvement in working with SPP medical devices. The user should only have to pair the device and then connections happen automatically when the device becomes connectable. HDP classic devices are like this and so are BTLE devices (the latter takes work on Android).</p>

<p>So the obvious solution is after pairing, create the RFCOMM Socket and invoke the connect() method (and perhaps all the workarounds to handle the various bugs).</p>

<p>However, this blocking method times out after 12 or so seconds according to the documentation so if I really want to continuously be ready for the device when it 'comes on-line', I need to do this in a while-loop until the connection succeeds.</p>

<p>So the question is if I do this, will this continuous 'pinging' for the device overload the system and drain the battery? Given that something like this happens for HDP implementations on Android, they must also do something like this but maybe they reduce the frequency of pinging so it isn't so resource demanding.</p>

<p>Does anyone have any experience with attempting to do continuous monitoring for SPP devices?  Thanks!</p>",android|android-bluetooth|spp,1099820,Brian Reinhold,yes
Automatically boot-up MTK devices (non-samsung) when docked,"<p>I'm developing a standalone kiosk using an android tablet(iBall running on 4.2.2).Its has the chinese MTK in it.</p>

<p>Suppose when there is no power,then eventually the tab's battery will drain out and have no juice left in it.When the power comes back I want the tab to automatically bootup without any manual intervention.I read online that if we modify the code present in the battery animation file we can achieve this.For the same,I replaced the original code of the battery charging animation file called 'ipod' located at '/system/bin' with :</p>

<pre><code>    #!/system/bin/sh
    /system/bin/reboot
</code></pre>

<p>However,when my tab was shutdown and docked it didnt boot-up,instead it was just stuck at the charging logo.When I replaced the above code with:</p>

<pre><code>    /system/bin/reboot
</code></pre>

<p>my tab did boot-up when it was shutdown and docked.This means my code was getting stuck at '#!/system/bin/sh' . <b>What could be the reason?</b></p>

<p>Also,while booting up the tab using the above process I want to boot it up after a delay,for which I used </p>

<pre><code>    sleep 20
    /system/bin/reboot
</code></pre>

<p>but there was no delay in the bootup process(irrespective of the value of sleep that I give)
<b>How do I create this delay ?</b></p>

<p>PS: I gave 777 permission to the file; owner-root; group-shell.
Kindly assist.Many thanks !</p>",android|linux|linux-kernel|android-kernel|android-reboot,2735209,Basher51,yes
Check if Sensor.TYPE_SIGNIFICANT_MOTION is hardware supported,"<p>I'm going to use Activity Recognition API to do some optimizations on an App.
In short I need to know when a device is STILL. But I do not want the App became battery draining by leaving sensors always on.</p>

<p>On  is reported:</p>

<blockquote>
  <p>To conserve battery, activity reporting may stop when the device is 'STILL' for an extended period of time. It will resume once the device moves again. This only happens on devices that support the Sensor.TYPE_SIGNIFICANT_MOTION hardware.</p>
</blockquote>

<p>I would register to ActivityRecognitionAPI only for devices that support significant motion detection by HW.
But I cannot find a way to check when this support exists.</p>

<p>Using:</p>

<pre><code>    SensorManager sensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
    Sensor sensor = sensorManager.getDefaultSensor(Sensor.TYPE_SIGNIFICANT_MOTION);
    boolean supportSignificantMotion = (sensor != null);
</code></pre>

<p>does not discriminate if support is by HW or by SW (on most devices this may be implemented just by software on accelerometer sensor).</p>

<p>Does anyone know if is it possibile to perform that check?</p>

<p>Thanks</p>",android|sensors|android-sensors,3257025,ARLabs,yes
Keep android service from draining battery,"<p>DISCLAIMER: This is at once a system design question, since I am interested in alternative approaches; and a coding question, since I am looking for specific technique.</p>

<p>Say I have a server at ip <code>89.374.52.452</code> and port <code>7893</code>: so I am using <strong>Socket</strong>. I want to track/consumer every message that this server sends out using an android app. Tracking the server while the app is running is <em>simple enough. But <strong>I want to track the server even when the app is not running? How do I do that?</em></strong></p>

<p><strong>Present Solution</strong></p>

<p>I am using a service to track the server. I start the service with <code>START_STICKY</code>. The problem I seem to be experiencing is that the service seems to be killing my battery. Is my assessment right? Is the very fact — in itself — of having a service running indefinitely killing my battery? Or is it something else? Is my approach good system design? Assuming I have no control over the server and so cannot have the server send notifications: is there another way to track activity on a server besides</p>

<pre><code> public class MyThread implements Runnable {        
    @Override    
    public void run() {
            try {    
            if(null == socket || !socket.isConnected() || socket.isClosed()){

                InetAddress theServer = InetAddress.getByName(server_IP); 
                socket = new Socket(theServer, serverIPPort);  }

             BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream()));
                while ((line = reader.readLine()) != null) {
                    handlers.post(new Runnable() {    
                    public void run() {
                            if (line.length() &gt; 0) {    
                            …//store line    
                        }
                        }    
                });
                }    
        } catch (Exception e) {    
            e.printStackTrace();
                try {
                    if (null != socket) {
                        socket.close();
                        socket=null;    
                }
                } catch (IOException io) {    
                io.printStackTrace();
                }
            }        
    }    
}
</code></pre>",android|sockets|service|android-service,1612593,learner,no
Assured wakeup of AsyncTask after Thread.sleep,"<p>I have a foreground service, which creates an asynctask in its onCreate().
The asynctask has a <code>while(true)</code>in its doInBackground. In this function, it performs certain network operation and goes to sleep for a random interval after each iteration. Here is the logic:</p>

<pre><code>doInBackground(){
     while(true){
         //Do network operation
         //randomNumber is a random number calculated each iteration and is in range of 60-180
         Thread.sleep(randomoNumber*1000);
     }

}
</code></pre>

<p>Now my issue is that as soon as the device goes to sleep, it sleeps the asynctask too. The network operation is highly critical in sticking to the time interval(randomNumber) and it can not be afforded that it be sleeping more than the randomNumber seconds(although difference of a few seconds can be tolerated). So how do I assure that the asynctask does wakes up after Thread.sleep, even when the device is not in active state?
I think I can use a wakelock, but that may keep the task running forever as it has a while(true) loop and hence drain out the battery. If I use it before Thread.sleep and release it after the network operation, again the same issue of the task not waking after the thread.sleep may occur. So what can be done here?</p>",java|android|android-asynctask|powermanager,1291122,rahulserver,yes
Create a custom Task.WhenAll() in java?,"<p>I've been trying to port bits of a project of mine from C# to Java (more accurately, from .NET Core 3 to Android 5.0), one of these bits relies heavily on the TPL (lots of async/await, spawining many tasks, etc...), and I couldn't get the performance I wanted usaing a simple <code>ConccurrentQueue&lt;T&gt;</code> and a bunch of threads polling from it.</p>
<p>So I embarked on the foolish journey of building my own small TPL for java, and I think I succeeded in the fundamentals (Task lifecycle, global and thread-local Task queues, building a Task that can 'await', etc...), however I am stuck at replicating C#'s <code>Task.WhenAll()</code> efficitiently.</p>
<p>Right now, I implemented it with a normal task that simply returns <strong>IDLE</strong> until all of the other tasks it can wait for are over, however this task sits in the task queue for potentially very long periods of time, consuming an entire Thread that could otherwise <code>Wait()</code> without draining the device battery.</p>
<p>I had an idea of creating* an ad-hoc thread that would specifically wait for all the waiting tasks completed signal, thus avoiding putting the waiting task in any queue.</p>
<p>However this 'solution' has the potential problem that there could be easily tens or hundreds of threads waiting, if my <code>Task.WhenAll()</code> is used frequently (which it is).</p>
<p>I have been looking through the .NET documentation on the TPL looking for some implementation details (tho no source code for .NET Core/5, as this project will not be MIT-compatible), with little luck.</p>
<p>If anyone can help in any way, I'd be super grateful!</p>
<p>Also, if I've missed a library/utility comparable to .NET's TPL in Android 5, feel free to let me know.</p>
<p>*: of course, such threads would be saved and re-used if necessary, with the usual timeouts when there's no work for them.</p>",java|c#|multithreading,5598990,JPSgfx,no
How does the battery drain in Android when the phone search others?,"<p>I will make the app about searching periodically with a bluetooth in Android.</p>

<p>The app is operating in background and the period may be too short, about 1 min.</p>

<p>but i dont know how I decide that.</p>

<p>I heard the energy with bluetooth gets low.</p>

<p>So. I want the quantitative data about searching with bluetooth.
Or approximate data, fine.</p>

<p>Plz give a hand to set the period.</p>",android|bluetooth|bluetooth-lowenergy|battery,8800871,Hopark,yes
Android TextClock seems to cause background battery drain on a full screen intent notification,"<p>I have an reminder type of app that generates a full-screen notification via <code>setFullScreenIntent</code> when the alarm triggers. It works well.</p>
<p>The full screen activity is backed by a native XML that simply displays some text data from the passed <code>intent</code>. On top of it, I have a <code>TextClock</code> widget in default settings: so it simply displays a text clock with hours and minutes. This is similar to Android's default lockscreen.</p>
<p>What I found is that, if the user does not dismiss this notification (say the phone is just left aside in idle state), the existence of this full-screen activity with TextClock will rack up background time and usage percentage under Android's battery stats.</p>
<p>Now the full-screen activity does have <code>showWhenLocked</code> and <code>turnScreenOn</code> set, so it'd wake up the screen briefly. However, the screen does go back off very shortly without user action, because it does NOT use <code>keepScreenOn</code>.</p>
<p>I'd imagine the <code>TextClock</code>, being a native widget, should be fairly optimized and not cause any battery drain, especially when the screen is off and phone is idle. It should only need to update itself when screen is back on again.</p>
<p>But instead the phone seems to treat this as being running in background the entire time if not dismissed.</p>
<p>Any idea if this is normal, and if there's any way to optimize it without sacrificing the utility?</p>",android|kotlin|xamarin|android-notifications|alarmmanager,683202,thankyoussd,yes
Is it ok to run CLLocationManager in background,"<p>I want to check the user current location in every 20 meters user move.All in active state and background.I know its ok to do it in active state.But i want to know is it ok to do the same thing in background mode in ios.Specially  want to know is apple reject this method.But in ios7 i think its ok</p>

<p>Actually i want to do get the currant location and if user move more than 1km call serve API ,if user move every 20m check with local data base pop up some data.</p>

<p>All i want to do it on both active state and background state.
at the moment i m using significant location change and region monitoring.But region monitoring have lower accuracy.I want at leaset 20m accuracy.
That why i try to do above method.I know that method give lot of battery drain. But i want accuracy best.
Any one have idea. </p>",ios|iphone|geolocation|cllocationmanager|clregion,820578,mychar,yes
Receiving push notifications in iOS without alert message even when app is not active,"<p>From Apple's Push Notification Guide:</p>

<blockquote>
  <p>If the target application isn’t running when the notification arrives, the alert message, sound, or badge value is played or shown. If the application is running, iOS delivers it to the application delegate as an NSDictionary object. The dictionary contains the corresponding Cocoa property-list objects (plus NSNull).</p>
</blockquote>

<p>I have implemented this in my app and everything works fine. If the app is in focus, the app gets the message directly. If not active, an alert is shown, the app launches when the user clicks the alert, and finally the app gets hold of the message.</p>

<p>Would it be possible, however, in the case of a message arriving when the app is not active, to get iOS to activate the app and pass the message on without showing any message or requiring any user interaction?</p>

<p>I would like this behavior because the push message from my server only <em>might</em> be of interest to the user, depending on her current position. The app works like this: When it starts, it registers for push and tells my server: I am at this position and would like to be notified when something interesting happens near me. At a later point the server sends a message, but since the user might have moved from the area, I would like the app to check the user's position again, and not bother the user if she now is too far from the original position.</p>

<p>I suppose it would be possible to have a background service that notifies the server about the current position every <em>n</em> minutes, but I fear that this will drain the battery.</p>

<p>Any thoughts on this?</p>",ios|geolocation|push-notification|apple-push-notifications,2007070,roshammar,no
Significant Location change battery drain Issue,"<p>Does anyone know if the significant location change service drains battery or not? I can see a significant drain overnight, approximately 15-20% drain with this service enabled else 5-10% drain.</p>",ios|swift|core-location,16313273,Akilan C B,no
Android: ACTION_TIME_TICK in AppWidget,"<p>I've got a clock in my widget that I'm making and I want it to update every minute in sync with the system clock. ACTION_TIME_TICK seems like the perfect solution however much of my research says it's impossible in an AppWidget while others say there are workarounds but their very vague.</p>

<p>I'd prefer not to do an AlarmManager as I'd have to update very frequently to make sure that it changes minutes when the system clock changes minutes and that would drain the battery more.</p>

<p>Is there a workaround for ACTION_TIME_TICK or what's the best way to update every minute in sync with the system clock with minimal battery drain?</p>",java|android|clock,1269977,user1269977,yes
Android GCM sent successfully but not received on some devices,"<p>On the server side, I am using GCM server 1.0.2 library provided by Google. On the client side, I set up GCM as provided on the <a href=""http://developer.android.com/google/gcm/client.html"" rel=""noreferrer"">official documentation</a>.</p>
<p>My problem is that everything works fine on most devices, but on few devices, push is not recieved.</p>
<pre><code>if (case1)
    message = new Message.Builder()
        .timeToLive(0)
        .collapseKey(&quot;0&quot;)
        .delayWhileIdle(false)
        .addData(&quot;msg&quot;, msg).build();
else if (case2)
    message = new Message.Builder()
        .collapseKey(&quot;2&quot;)
        .addData(&quot;msg&quot;, msg).build();
else
    message = new Message.Builder().addData(&quot;msg&quot;, msg).build();

Result result = sender.sendNoRetry(message, regId);
System.out.println(&quot;Message ID:&quot;+result.getMessageId());
System.out.println(&quot;Failed:&quot; + result.getErrorCodeName());
</code></pre>
<p>From what I can see from tests with the above code, there are no error. The message id is present, but error code name is null(which is a sign of <a href=""http://developer.android.com/reference/com/google/android/gcm/server/Result.html"" rel=""noreferrer"">successful push</a>).</p>
<p>I've tried almost every setting. Tested with TTL, collapse key, delay while idle set on and off.</p>
<p>What are some cases that can cause to block(?) GCM push? And how can I resolve this?</p>
<h2>EDIT</h2>
<p>I have no idea why but the temporary solution below solved my problem.</p>
<p>In GcmIntentService#onHandleIntent just remove</p>
<pre><code>GcmBroadcastReceiver.completeWakefulIntent(intent);
</code></pre>
<p>This line releases the wakeful service. I am curious though because on other devices, push messages are sent continuously even when this line was not removed.</p>
<p>This is not a solution because <a href=""http://developer.android.com/reference/android/support/v4/content/WakefulBroadcastReceiver.html#startWakefulService%28android.content.Context,%20android.content.Intent%29"" rel=""noreferrer"">this document</a> states that I should call completeWakeFulIntent after each work. Also, my method will drain the battery significantly.</p>
<p>Any suggestion?</p>",android|google-cloud-messaging,2558506,Jee Seok Yoon,no
Verify network identity through unix commands,"<p><strong>First some background:</strong> I'm using the LaunchD feature in Mac OSX to periodically launch an application I'll call ""<em>AppX</em>"". Optimally I like to run this application nearly 24/7. But due to issues with memory leakage (that is my best guess), <em>AppX</em> closes periodically. To solve this, I've created and loaded a simple plist file to launch the application every 6 hours. This itself works perfectly and minimizes application downtime. However, <em>AppX</em> itself can be a drain on my battery, and I'd prefer it only launch when I'm at home, connected to my wifi network.</p>

<p>Please be aware that while I have some experience with C++ and Java, I know very little in the way of Unix.</p>

<p><strong>My question:</strong> I'd like to use an if statement to check whether the network I'm connected to is my home wifi network. Being the case that it is, the system will execute the command:</p>

<p><code>open -a AppX</code></p>

<p>So... How would I implement an if statement to accomplish this? Any help is appreciated.</p>",macos|unix|networking|identity|launchd,3923537,user3923537,yes
How to receive FCM notification and start periodic work in any circumstances (even in doze mode)?,"<p>I have 2 PeriodicWorker that I need to execute every 15 minutes (from 9:00 to 18:00) and receive a notification from FCM and based on the received notification do some work with another worker (oneTimeWorker).</p>

<p>The first problem is that sometimes I do not receive any notification (and when I open my app I then receive the notification). I'm using Data message rather than notification message since I have to start a worker when I receive the notification. Is it correct? Or I should use ""data message"" and insert in the notification even the ""Notification"" part with ""title"" and ""body""?</p>

<p>Note: I always display the notification using as title and body data that come from the ""data"" part of the message.</p>

<p>My message is:</p>

<pre><code>  return com.google.firebase.messaging.Message.builder()
            .setNotification(message.getTitle() != null &amp;&amp; message.getBody() != null ? new Notification(message.getTitle(), message.getBody()) : null)
            .setToken(message.getToken())
            .setTopic(message.getTopic())
            .putAllData(setDataMap(message, projectId))
            .setAndroidConfig(AndroidConfig.builder()
                    .setPriority(Priority.HIGH)
                    .putAllData(setDataMap(message))
                    .build())
            .build();
</code></pre>

<p>Regarding the periodic worker there is a way to ""wake up"" the smartphone and make it exit doze mode? using a alarmManager scheduled each 4 hours for example is it possibile?. According to documentation alarmManager should work in doze mode:</p>

<blockquote>
  <p>If you must have an alarm fire even in Doze mode you can use either setAndAllowWhileIdle() or setExactAndAllowWhileIdle().</p>
</blockquote>

<p>Is it a good idea?</p>

<p>Note: More battery drain is not a serious problem as long as I solve these issues.</p>

<p>Edit1: 
I tried to do some test using:</p>

<pre><code>adb shell dumpsys deviceidle force-idle

adb shell am set-inactive &lt;my_package&gt; true
</code></pre>

<p>deviceidle  seem to replicate my ""not working condition"". So there is a way to exit from idle-mode?</p>",java|android|firebase|firebase-cloud-messaging,10732477,AM13,no
Increasing App badge count without showing push notification,"<p>I know how to increase badge count. how to send a push notification with badge count.</p>

<p><strong>My question is that how Facebook increase app badge count without push notification if somebody like your post.</strong></p>

<p>If I run service continuously in the background it will drain the battery.</p>

<p>Please suggest the correct way to achieve this. </p>",ios|swift|facebook|push-notification|badge,2439156,Bug,yes
"Can I use Android Beacon Library in foreground service, even on Android 8 (Oreo)?","<h2>What I want to achieve</h2>

<p>I am building an app for a shopping mall, with large amount of beacons installed not quite far away from each other (assume ~20m distance).<br>
When a user walks in this mall, even without opening the app, the app needs to keep scan for beacons. When a beacon is detected, I will then query the server to ask if I need to and what local notification to push to user.</p>

<h2>What I planned to do</h2>

<p>My original plan was to create a <code>Service</code>, returns <code>START_STICKY</code> in <code>onStartCommand()</code> in order to make sure that the service will restart itself even the app is killed by a task manager.  </p>

<p>This <code>Service</code> will keep scanning for beacons.</p>

<p>In fact, this is the existing approach of my colleague. According to this colleague, the service starts almost immediately after the app was killed by a task manager.</p>

<h2>The problem</h2>

<p>But soon I found that this approach is problematic.<br>
The above approach has now 2 major problems:  </p>

<ul>
<li>It drains batteries because it keeps scanning;</li>
<li>It does not work on
Android 8 due to <a href=""https://developer.android.com/about/versions/oreo/background.html"" rel=""nofollow noreferrer"">new limitations introduced in Android
8</a>.</li>
</ul>

<h2>My next plan</h2>

<p>Although I know that <code>JobScheduler</code> can be used to replace Service, which is also the <a href=""http://www.davidgyoungtech.com/2017/08/07/beacon-detection-with-android-8"" rel=""nofollow noreferrer"">existing approach of Android Beacon Library</a>, perform a scan every 15-25 minutes absolutely cannot fulfill my requirements, where beacons are very close to each other and therefore beacons need to be scanned frequently.</p>

<p>Therefore I come up with another plan:</p>

<ol>
<li>Use Android Beacon Library to run background detection</li>
<li>Once the
first beacon in filter list has been detected, start a foreground
service (which will not be killed even in Android 8) that
<strong>continuously scan for beacons</strong></li>
<li>When all beacons in the filter has been exited, stop the above foreground service. Android Beacon
Library shall resume to its background detection state.</li>
</ol>

<p>The intentions of this approach are:</p>

<ol>
<li>Make advantage of Android Beacon Library's background detection which saves battery, according to their <a href=""http://altbeacon.github.io/android-beacon-library/battery_manager.html"" rel=""nofollow noreferrer"">documentation</a></li>
<li>Step away of Android Beacon Library's handling of Android 8 due to its built-in limitation of long scanning interval</li>
<li>Scanning goes on even on Android 8 since I am going to use a foreground service</li>
</ol>

<h2>My major question</h2>

<p>By reading documentations, I already know how to scan for beacons in the background.<br>
But how do I make use of Android Beacon Library to scan in a foreground service?<br>
Plus, is there any problem that you can discover in the above approach / Do you have any better suggestions to achieve such requirements?</p>

<h2>My other question</h2>

<p>In fact according to <a href=""https://stackoverflow.com/a/33521529/7870874"">this post</a>, the background service starts <strong>5 minutes</strong> after an app is killed.<br>
But by returning <code>START_STICKY</code> in <code>onStartCommand()</code> of a <code>Service</code>, it is restarted almost immediately.<br>
Then, why will there be a 5 minutes delay, even in pre-Oreo?</p>",android|service|ibeacon|beacon|android-ibeacon,7870874,Sira Lam,no
How does lockscreen affect to an app?,"<p>I am creating an app which needs to listen to a (hardware) keypress during a long time period so, I thought that if I lock the screen during that period the phone would save a lot of battery. But some months ago I read something about androids lockscreen.. It was said that during lockscreen, the phone would not be able to listen to hardware keypresses...  Am  I right?</p>

<p>After this explanation, my question is: Does anyone know any way of listening to a keypress with locked screen in order to not drain a lot of battery?</p>

<p>I thought something about putting screen brightness to its lowest value, but Cpu will be draining battery, because phone is not in deep sleep, so I think this is not the correct way :) </p>

<p>any other way, please???</p>

<p>Thanks in advance!!! ;)</p>",android|locking|screen|keypress,1354096,BamsBamx,yes
How much battery would drain an Android service with BroadcastReceiver,"<p>Lets put the following service in as an example:</p>

<pre><code>public class MyService extends Service {

    final BroadcastReceiver mScreenStateReceiver = new BroadcastReceiver() {
        @Override public void onReceive(Context context, Intent intent) {
            //Do nothing
        }
    };

    @Override
    public void onCreate() {
        super.onCreate();
        IntentFilter intentFilter = new IntentFilter();
        intentFilter.addAction(Intent.ACTION_SCREEN_OFF);
        intentFilter.addAction(Intent.ACTION_SCREEN_ON);
        registerReceiver(mScreenStateReceiver, intentFilter);
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        unregisterReceiver(mScreenStateReceiver);
    }

}
</code></pre>

<p>Note that THIS BroadcastReceiver requires being registered at RUNTIME (lets say, Service or Activity). That is the reason I am using a Service</p>

<p>Supposing that this Service is going to be running the whole time the device is turned on, have a working BroadcastReceiver and is doing nothing, would it drain battery life? If it would, how much? Can make it running make the Android framework drain more battery due to have a Service or Broadcast Receiver running?</p>

<p>I know, I am a battery life maniac</p>",android|service|broadcastreceiver|battery,1354096,BamsBamx,yes
iphone: location manager + adwhirl = battery drain :(,"<p>In my app I am using CLLocationManager and AdWhirl. I have made no specific development regarding background mode: I don't want my app to be working when it is in background, i.e. when the user press the ""home button"", GPS location should no be updated.</p>

<p>Yesterday evening I pressed ""home button"", and this morning the iPhone was out of battery. It's an iPhone 4 with iOS 4.1, not jailbreaked, and there is no background app running.</p>

<p>The battery was about 35% yesterday evening, and 0% this morning (iPhone was shutdown).</p>

<p>I have set breakpoint in my delegate, which is called each time GPS location is updated. When app is in background mode, delegate is not called. So I'm thinking GPS is really disabled in background mode: ok.</p>

<p>This morning, I am following battery drain: it's about 1% drop each 15 min. I think it a bit too much.</p>

<p>Should I do something specific when the app goes to background mode? Do you think this 1% drop is normal?</p>",iphone|gps|battery|locationmanager,446576,Francois,yes
Android | Push notifications on local network,"<p>I've been doing a lot of research without success on finding a solution to my (simple) problem. I'm building an application that does not requires to be connected to the internet but it does consumes a restful API from a server installed in the local network LAN. </p>

<p>Currently I'm dispatching a HTTP request every minute to see if there were any changes in the DB and alert the user of said changes. However this is not very efficient and it results in a poor performance / battery drain. </p>

<p>I've heard that push notifications can be implemented using Google cloud messaging, but that is not an option since it requires to go through google servers, in other words, internet.</p>

<p>I'm using Square's Retrofit framework for handling HTTP requests on Android, and PHP + Laravel on the server side. </p>

<p>Is there a way to send push notifications? If not, is 'long polling' a good practice in Android? Will it even work with Retrofit?</p>",android|http|laravel|push-notification|retrofit,1949554,frankelot,no
Android LocationListener: is removeUpdates necessary?,"<p>When developing a location-aware Android application using a <code>LocationListener</code>, is it obligatory to call <code>LocationManager.removeUpdates()</code> before the application finishes?</p>

<p>Or more generally, is it obligatory to call <code>LocationManager.removeUpdates()</code> before the <code>Looper</code> passed in <code>LocationManager.requestLocationUpdates()</code> quits?</p>

<p>Does the <code>LocationManager</code> automatically find out that the <code>Looper</code> is no longer alive and location updates are no longer necessary? If yes, how? If not, will it keep blindly updating (and draining the battery) forever?</p>",android|locationmanager|locationlistener|looper,1911213,bryn,yes
How to kill background processes on Samsung devices programmatically,"<p>Some apps keep running in background after being closed.
I can see them in the device maintenance (battery).
I would like to close these apps programmatically (These apps are mine too, so I could modify them if needed).</p>

<p>I tried ""killBackgroundProcesses"", but it doesn't work. Actually, the app doesn't even show in the processes list when I execute ""adb shell ps -A"".
I also tried to close these apps differently, but they randomly appear in the ""apps that drain battery"" list.</p>

<p>How can I close them programmatically from my Android app?</p>",android|samsung-mobile,9354197,Damien Jacquemin,yes
Stopping and starting a Service based on application state,"<p>I have a Service which tracks the location of the user.  Currently, the Service boots when the application starts and stops when the application terminates.  Unfortunately, if users keep the application in the background, the Service never stops and drains battery.</p>

<p>I would like the Service to stop when my application is not in the foreground.  I was hoping the Application class would let me Override onPause and onResume handlers, but it does not have them.  Is there another way I can accomplish this?</p>",android|service|battery,406790,Andrew,yes
Background Location,"<p>I need to track the user's location in the background at a specific time. Can the background task be started at e.g 7pm-11pm?</p>

<p>The only way I have been able to acheive this so far is to have the background task continually running and this seems a bad approach as it considerably drains battery. </p>

<p>I have set the accuracy and distance filter of the CLLocation manager to conserve battery outside of these times:</p>

<pre><code>[locationManager setDesiredAccuracy:kCLLocationAccuracyThreeKilometers];
[locationManager setDistanceFilter:2000.0f];
</code></pre>

<p>I then change this between 7-11pm back to:</p>

<pre><code>[locationManager setDesiredAccuracy:kCLLocationAccuracyBest];
[locationManager setDistanceFilter:10.0f];
</code></pre>

<p>I have turned off <code>locationManager.pausesLocationUpdatesAutomatically</code> as this seems to kill the background task when the user stays still for 15-20mins - it doesn't resume when the user moves again.</p>

<p>Is there a better way to minimise battery drain outside of these times.</p>

<p>Also, am I correct in thinking that startMonitoringSignificantLocationChanges only does a location update when you move over 500m - if this is the case it would not be accurate enough during 7-11pm.</p>

<p>Any ideas?</p>",ios|objective-c|xcode|cllocationmanager|background-task,3578399,Joe Benton,yes
Why MQTT Android drains battery?,"<p>i have developed mqtt service on android device, the service work fine, reach notify, and in WIFI the battery is not drained, but when i pass on 3g network the service drain more battery over 40% in wifi is arround 3% the battery drains,
on low profile phones the problem not appear the service in 3g network drains arround 10% of battery, i have see it drain more battery on 4.4.2 Andorid version.. can help me?</p>

<p>p.s. i use paho client!</p>",battery|mqtt,3608219,Salvosnake,yes
Google Activity Recognition API called too frequently,"<p>Im trying to use Google Activity Recognition API, and get only results when activity changes or about every 30mins (+- 10mins or more if Activity does not change). Instead, when I call the piece of code below, I get Activity Recognition results very often in my <code>IntentService</code>, like every minute: </p>

<pre><code>ActivityRecognition
            .ActivityRecognitionApi
            .requestActivityUpdates(mGoogleApiClient, 60000 * 30, getSensingServicePendingIntent())
            .setResultCallback(this);
</code></pre>

<p>The method to create <code>PendingIntent</code> object:</p>

<pre><code>private PendingIntent getSensingServicePendingIntent(Integer userLabel) {
    Intent i = new Intent(mContext, SenseDataIntentService.class);

    return PendingIntent
            .getService(mContext, 0, i, PendingIntent.FLAG_UPDATE_CURRENT);
}
</code></pre>

<p>The method to get<code>GoogleApiClient</code>:</p>

<pre><code> private GoogleApiClient buildGoogleApiClient() {
    mGoogleApiClient = new GoogleApiClient.Builder(mContext)
            .addApi(ActivityRecognition.API)
            .addConnectionCallbacks(this)
            .addOnConnectionFailedListener(this)
            .build();
    return mGoogleApiClient;
}
</code></pre>

<p>I know that <a href=""https://developers.google.com/android/reference/com/google/android/gms/location/ActivityRecognitionApi"" rel=""nofollow"">the official documentation</a> says this:</p>

<blockquote>
  <p>Activities may be received more frequently than the detectionIntervalMillis parameter if another application has also requested activity updates at a faster rate. It may also receive updates faster when the activity detection service receives a signal that the current activity may change, such as if the device has been still for a long period of time and is then unplugged from a phone charger.</p>
</blockquote>

<p>But I just think that I get the updates too frequently (even if activity does not change). Any solutions, as I want to save some battery drainage. </p>",android|google-play-services|google-api-client|activity-recognition,5355700,urgas9,yes
Find the approximate location of android device using only internet not GPS,"<p>I want to find the approximate location of the android device using only internet, because I don't want user to feel the overhead of having the location on all the time which also drains out the battery, Over internet search I found people suggesting to use GPS for more accurate results, but it is ok for me, even if I get approximate location using internet, I have seen there is a term network location, can some one share a code snippet that would help me.</p>",android|geolocation,3286353,murali kurapati,no
Would running an ethereum node of a private network in android drain battery?,"<p>I am building an android application where users can pay for items they buy with ether. Application will use a private ethereum network.</p>

<p>As I understood, I have to run an ethereum node in the android device as a separate process and my android app has to communicate with it using either sending commands or through JSON RPC.</p>

<p>Since android is very concerned about the power consumption, would android allow running a separate process continuously? Would android kill the process after some time?</p>

<p>Also, would running the node continuously in the device cause a huge battery drain?</p>",android|ethereum,1015678,Lahiru Chandima,yes
Does keeping a file handle open on an iPhone drain an apprecible amount of battery power?,"<p>I am taking a stream of readings from the GPS controller and storing them in an array, and occasionally writing the readings in the array to a file.</p>

<p>Should I keep the file handle to the file open, or open and close the file each write? And how much does this matter in the scheme of power consumption?</p>",iphone|cocoa-touch,108512,Andrew Johnson,no
iOS push notification with killed app - swift,"<p>I'm developing an iOS chat with push notifications and I use Firebase Cloud Messaging but I have this problem:</p>

<p>When the app is killed (not in background) there is a way to get a callback from the notification to get the content (the chat message)?</p>

<p>The only way to get a message and save it in the internal database is check on my server when I start the app if there is a unread message? </p>

<p>The documentantion of Firebase doesn't seem very clear on this argument.
Only if I send a silent notification (without ""notification"" field) the app <code>didReceiveRemoteNotification</code> callback was called when I open the app but I can get only last notification. This callback isn't called in background </p>

<p><strong>UPDATE 02/12/2016:</strong></p>

<p>After a lot of tests, I have contacted apple support and they have responded to me with this email:</p>

<blockquote>
  <p>I'm responding to your question about background push notifications.</p>
  
  <p>This topic was first discussed in the WWDC 2013 session 204 WWDC 2013:
  What’s New with Multitasking. Silent push notifications (those whose
  payloads contain only the content-available key and no alert, badge,
  or sound keys) are throttled to be delivered only when iOS determines
  that it’s energy-efficient to do so. </p>
  
  <p>Push notifications with user-visible keys such as alert, sound, or
  badge sent at high priority (priority 10) are always displayed.
  However, if the notification also contains the content-available key,
  the notification may be throttled and thus not be sent to the app in
  the background unless the user taps the notification.</p>
  
  <p>Notifications sent at low priority (priority 5) are throttled,
  regardless of payload. Silent push notifications should always be sent
  at low priority.</p>
  
  <p>As the WWDC session says, you may expect up to several silent push
  notifications per hour across all apps on a device. But it is entirely
  possible and appropriate that you may receive none at all.</p>
  
  <p>The purpose of the throttle is to predict when the user will launch an
  app and thus allow background activity to update the app’s content in
  an energy-efficient manner. It also serves to prevent apps from
  consuming too much of the user’s battery or cellular data with
  background traffic. </p>
  
  <p>Once the device-wide battery or data budgets have been exhausted, no
  more background push notifications will be delivered until the budgets
  are reset. The budgets are reset every 24 hours, and this schedule
  cannot be changed by user or developer action. </p>
  
  <p>Since these budgets apply across all apps on a device, it’s possible
  that an app other than your own has exhausted the budgets. You can
  check the overall battery usage of an app in Settings > General >
  Usage > Battery Usage.</p>
  
  <p>The throttle also tracks when the device has poor network
  connectivity, because repeated attempts to connect to APNs when
  network connectivity is spotty can cause significant power drain. This
  is by far the most common reason why push notifications do not reach a
  device. To check if poor network connectivity is affecting your push
  notifications, you can use the steps in Observing Push Status
  Messages.</p>
  
  <p>The throttle is disabled if you run your app with a debugger attached.
  This allows you to test that your notifications are being received
  correctly, but should only be considered a best-case scenario. </p>
  
  <p>Additionally, starting with iOS 9, users have the ability to turn the
  throttle on any time they please by turning on Low Power Mode in
  Settings > Battery.</p>
  
  <p>To test background push notifications, follow these steps. </p>
  
  <ol>
  <li>Attach your device to your Mac.</li>
  <li>Start your app from Xcode.</li>
  <li>When it has launched, stop your app from within Xcode by clicking the Stop button (square icon at upper left).</li>
  <li>In Xcode, do Debug -> Attach to Process -> [Fill in Process Name to wait for] -> Attach</li>
  <li>Send the push notification with content-available:1 and your app will receive the notification every time. </li>
  </ol>
  
  <p>You can use the process list in Instruments to confirm that your app
  is running in the background.</p>
  
  <p>You can also test using Wi-Fi and a device that is plugged in to wall
  power.</p>
  
  <p>If you’re sending silent push notifications, be sure you’re using the
  APNs Provider API or the Binary Provider API so you can set the
  notification priority to 5. (The default priority is 10.)</p>
  
  <p>If you believe throttling is not working properly, please file a bug
  report at <a href=""https://developer.apple.com/bug-reporting"" rel=""noreferrer"">https://developer.apple.com/bug-reporting</a>. The details of
  how throttling works are not public API, but iOS Engineering looks at
  these bug reports and can determine if notifications are being
  throttled as expected.</p>
  
  <p>The important point is that apps should never be designed expecting
  that every push notification will be received. This is not how APNs is
  intended to work; it is intended to inform the user or app that some
  event of interest has occurred. Apps are expected to work properly,
  albeit perhaps with degraded functionality, if push notifications are
  not received. The user can turn off push notifications or background
  app updates at any time, and of course push notifications will not be
  received if the device doesn’t have Internet connectivity.</p>
  
  <p>Starting with iOS 7, all background categories except location and
  VoIP (on iOS 9.3 and later) behave consistently when a user
  force-quits an app from the multitasking display. An app will not be
  launched again automatically until the user chooses to launch it
  again. This respects the user's intent not to have the app running,
  which can be a very important recovery technique if an app is
  misbehaving and crashing on launch.</p>
  
  <p>If you close an app that has been configured to receive background
  notifications, it won't receive them until it has been reopened.</p>
</blockquote>

<p>After this email, I have tried to send a notification with Telegram killed. Telegram receive the push notification and show it but if I open the app after setting the offline mode the message isn't shown in the chat (this mean that surely telegram contact server to check unread message when I open it)! Instead whatsapp can add message in background because it is a VoIP app and it can call a background callback.</p>

<p>So the only way to add message is contact the server and get the unread message.</p>

<p>There is the same problem in android but probably you can solve it with a background service (and restart it when it is killed). </p>

<p>Now I have to choose if use Apple Push notifications or FCM push notifications. The reliability is the same? (Because, for example, Telegram in android uses both a proprietary push service and FCM because they say that FCM isn't very reliable)</p>",ios|swift|firebase|firebase-cloud-messaging,4654930,diegocom,yes
Android Location Services draining the Battery - Fused Location API,"<p>We have a location based application, where based on the users location we are trying to push some notifications of campaigns. But this seems to be draining the battery of the phone and at times consuming up to 30-35% of the charge.</p>

<p>Below is the implementation of Location in our app.</p>

<pre><code>public class DashboardActivity extends BaseActivity implements GoogleApiClient.OnConnectionFailedListener, GoogleApiClient.ConnectionCallbacks,
        LocationListener, ExitConfirmationDialog.OnExitResponseListner {


    private final int HAS_PERMISSION_COARSE_LOCATION = 1;
    private final int HAS_PERMISSION_FINE_LOCATION = 2;


    LocationManager locationManager;

    CustomTextViewDemi mNotificationCount;
    String count = """";
    Menu menu;
    List&lt;CreateFragmentsPojo&gt; fragments;

    boolean isSettingsScreenOpen = false;
    int backPresedCount = 0;


    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_dashboard);

        setTitle(""Dashboard"");

        setupNavigationView(0);

        fragments = new ArrayList&lt;&gt;();

        Utils.HandleViews(mLayout, false);

        locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);

        if (isGPSLocationEnabled(locationManager)) {
            buildGooleApiClient();
        } else if (isNetworkLocationEnabled(locationManager)) {
            buildGooleApiClient();
        } else {
            showAlert();
        }


    }


    private void buildGooleApiClient() {

        buildGoogleApiClient();

        if (Build.VERSION.SDK_INT &gt;= 23) {
            requestPermission();
        } else {
            if (mGoogleApiClient != null) {
                if (mGoogleApiClient.isConnected()) {
                    getUserCurrentLocation();
                } else {
                    mGoogleApiClient.connect();
                }
            } else {
                getDashBoard("""", """");
            }
        }
    }


    public void getData(String lat, String lng) {
        if (Utils.isInternetConnection(this)) {
            getCampaignDetails(lat, lng);
        } else {
            Utils.HandleViews(progressBar, false);
            Utils.showMessages(this, Params.CHECK_INTERNET_MESSAGE, true);
        }
    }


    private void getUserCurrentLocation() {

        try {
            Utils.HandleViews(progressBar, true);
            if (mGoogleApiClientAwareness == null) {
                buildGoogleApiAwarenessClient();
            }


            Awareness.SnapshotApi.getLocation(mGoogleApiClientAwareness)
                    .setResultCallback(new ResultCallback&lt;LocationResult&gt;() {
                        @Override
                        public void onResult(@NonNull LocationResult locationResult) {
                            if (!locationResult.getStatus().isSuccess()) {
                                Log.e(""awareness demo api "", ""Could not get location."");

                                if (mGoogleApiClient != null) {
                                    try {
                                        Location mLastLocation = LocationServices.FusedLocationApi.getLastLocation(mGoogleApiClient);
                                        if (mLastLocation != null) {
                                            getDashBoard(mLastLocation.getLatitude() + """", mLastLocation.getLongitude() + """");
                                        } else {
                                            getDashBoard("""", """");
                                        }
                                    } catch (SecurityException e) {
                                        e.printStackTrace();
                                    }
                                } else {

                                    if (locationManager != null) {
                                        String provider = Utils.getUserLastLocation(locationManager);
                                        if (provider != null) {
                                            try {
                                                Location location = locationManager.getLastKnownLocation(provider);
                                                if (location != null) {
                                                    getDashBoard(location.getLatitude() + """", location.getLongitude() + """");
                                                } else {
                                                    getDashBoard("""", """");
                                                }
                                            } catch (SecurityException e) {
                                                e.printStackTrace();
                                            }
                                        }
                                    }
                                }
                            }
                            try {
                                Location location = locationResult.getLocation();

                                if (location != null) {
                                    getDashBoard(location.getLatitude() + """", location.getLongitude() + """");
                                } else {
                                    getDashBoard("""", """");
                                }

                            } catch (Exception e) {
                                e.printStackTrace();
                            }
                        }
                    });

        } catch (SecurityException se) {
            se.printStackTrace();
        }
    }



    private void showAlert() {
        final AlertDialog.Builder dialog = new AlertDialog.Builder(this);
        dialog.setTitle(""Enable Location"")
                .setMessage(""Your Locations Settings is set to 'Off'.\nPlease Enable Location to "" +
                        ""get campaigns at your location."")
                .setPositiveButton(""Location Settings"", new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface paramDialogInterface, int paramInt) {
                        isSettingsScreenOpen = true;
                        Intent myIntent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
                        startActivityForResult(myIntent, 201);
                    }
                })
                .setNegativeButton(""Cancel"", new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface paramDialogInterface, int paramInt) {
                        getUserCurrentLocation();
                    }
                });

        dialog.show();
    }



    /**
     * Get user permissions for location based updates
     */
    @TargetApi(23)
    private void requestPermission() {
        int HAS_REQUEST_PERMISSION_COARSE_LOCATION = ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_COARSE_LOCATION);

        if (HAS_REQUEST_PERMISSION_COARSE_LOCATION
                != PackageManager.PERMISSION_GRANTED) {

            if (ActivityCompat.shouldShowRequestPermissionRationale(this, android.Manifest.permission.WRITE_EXTERNAL_STORAGE)) {

                new AlertDialog.Builder(this)
                        .setTitle(""Request Permission"")
                        .setMessage(""Provide permission to access your location"")
                        .setNegativeButton(android.R.string.cancel, null)
                        .setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialog, int which) {
                                requestPermissions(new String[]{Manifest.permission.ACCESS_COARSE_LOCATION},
                                        HAS_PERMISSION_COARSE_LOCATION);
                            }
                        }).create().show();


            } else {
                requestPermissions(new String[]{Manifest.permission.ACCESS_COARSE_LOCATION},
                        HAS_PERMISSION_COARSE_LOCATION);

            }
        } else {
            requestFineLocationPermission();
        }

    }

    @TargetApi(23)
    private void requestFineLocationPermission() {

        int HAS_REQUEST_PERMISSION_FINE_LOCATION = ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION);

        if (HAS_REQUEST_PERMISSION_FINE_LOCATION
                != PackageManager.PERMISSION_GRANTED) {

            if (ActivityCompat.shouldShowRequestPermissionRationale(this, android.Manifest.permission.WRITE_EXTERNAL_STORAGE)) {

                new AlertDialog.Builder(this)
                        .setTitle(""Request Permission"")
                        .setMessage(""Provide permission to access your location"")
                        .setNegativeButton(android.R.string.cancel, null)
                        .setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialog, int which) {
                                requestPermissions(new String[]{Manifest.permission.ACCESS_FINE_LOCATION},
                                        HAS_PERMISSION_FINE_LOCATION);
                            }
                        }).create().show();

            } else {
                requestPermissions(new String[]{Manifest.permission.ACCESS_FINE_LOCATION},
                        HAS_PERMISSION_FINE_LOCATION);


            }
        } else {
            getUserCurrentLocation();
        }
    }


    @Override
    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {
        super.onRequestPermissionsResult(requestCode, permissions, grantResults);
        if (requestCode == HAS_PERMISSION_COARSE_LOCATION) {
            if (grantResults.length &gt; 0
                    &amp;&amp; grantResults[0] == PackageManager.PERMISSION_GRANTED) {
                requestFineLocationPermission();
            }
        } else if (requestCode == HAS_PERMISSION_FINE_LOCATION) {
            if (grantResults.length &gt; 0
                    &amp;&amp; grantResults[0] == PackageManager.PERMISSION_GRANTED) {
                getUserCurrentLocation();
            }
        }
    }

    /**
     * Call to detect new campaigns near by
     */
    private void getUserLocationBackgroundProcess() {
        try {
            //Utils.getCurrentLocation(this);
            startLocationUpdates();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }


    private boolean isGPSLocationEnabled(LocationManager locationManager) {
        return locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER);

    }

    private boolean isNetworkLocationEnabled(LocationManager locationManager) {
        return locationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER);
    }


    protected synchronized void buildGoogleApiAwarenessClient() {
        try {
            Log.i(TAG, ""activity Building GoogleApiClient==="");
            mGoogleApiClientAwareness = new GoogleApiClient.Builder(this)
                    .addApi(Awareness.API)
                    .addConnectionCallbacks(this)
                    .addOnConnectionFailedListener(this)
                    .build();

            mGoogleApiClientAwareness.connect();
            //createLocationRequest();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }


    protected synchronized void buildGoogleApiClient() {
        try {
            Log.i(TAG, ""activity Building GoogleApiClient==="");

            buildGoogleApiAwarenessClient();

            mGoogleApiClient = new GoogleApiClient.Builder(this)
                    .addConnectionCallbacks(this)
                    .addOnConnectionFailedListener(this)
                    .addApi(LocationServices.API)
                    .build();

            createLocationRequest();
        } catch (Exception e) {
            e.printStackTrace();
            getUserCurrentLocation();
        }
    }


    protected void createLocationRequest() {
        mGoogleApiClient.connect();
        mLocationRequest = new LocationRequest();
        mLocationRequest.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);
        mLocationRequest.setSmallestDisplacement(30);
    }


    @Override
    public void onLocationChanged(Location location) {
        mCurrentLocation = location;
    }

    @Override
    public void onConnected(@Nullable Bundle bundle) {
        getUserCurrentLocation();
       // startLocationUpdates();
    }

    protected void startLocationUpdates() {
        try {
            mRequestingLocationUpdates = true;

            Intent receiverIntentService = new Intent(this, LocationIntentService.class);
            PendingIntent pendingIntent = PendingIntent.getService(this, 1, receiverIntentService, 0);

            if (mGoogleApiClient != null) {
                if (mGoogleApiClient.isConnected()) {
                    LocationServices.FusedLocationApi.requestLocationUpdates(
                            mGoogleApiClient, mLocationRequest, pendingIntent);
                }
                /*else {
                    mGoogleApiClient.connect();
                    LocationServices.FusedLocationApi.requestLocationUpdates(
                            mGoogleApiClient, mLocationRequest, pendingIntent);

                }*/
            } else {
                buildGoogleApiClient();
            }
        } catch (SecurityException se) {
            se.printStackTrace();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }


    @Override
    protected void onResume() {
        super.onResume();

        try {
            if (isSettingsScreenOpen) {
                isSettingsScreenOpen = false;
                getUserCurrentLocation();
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    @Override
    public void onConnectionSuspended(int i) {

    }


    @Override
    public void onConnectionFailed(@NonNull ConnectionResult connectionResult) {

    }


    @Override
    protected void onStop() {
        super.onStop();

        if (mGoogleApiClient != null) {
            if (mGoogleApiClient.isConnected())
                mGoogleApiClient.disconnect();
        }
    }


}
</code></pre>",android|android-location,155196,Harsha M V,no
"CountDownTimer, ViewPager, Ad and constant refreshing ListView items - strange behaviour","<p>I'm using ViewPager and the ad (from Admob) in layout xml.
I have two fragments (HomeFragment and TeamFragment), one has a CountDownTimer and the other has a ListView. As we know, ViewPager keeps both with created views so both are active at the same time.</p>

<p>The problem is that: <strong>When my CountDonwTimer ticks (onTick is called), items (rows) from ListView are refreshed (getView() from ListAdapter are called).</strong> </p>

<p>What is interesting, it only occurs when the ad shows (Internet connection is on). When there is no ad, everythings works ok (no refresh from ListView).</p>

<p>This is not a big problem, but it drains battery.</p>

<p>Logs:</p>

<pre><code>01-21 15:56:35.150: D/HomeFragment(17366): onTick() in CountDownTimer - just before counterTV.setText(...)
01-21 15:56:35.155: D/ListAdapter in TeamFragment(17366): getView() position: 0
01-21 15:56:35.215: D/ListAdapter in TeamFragment(17366): getView() position: 1
01-21 15:56:35.230: D/ListAdapter in TeamFragment(17366): getView() position: 2
01-21 15:56:35.245: D/ListAdapter in TeamFragment(17366): getView() position: 3
01-21 15:56:35.255: D/ListAdapter in TeamFragment(17366): getView() position: 4
01-21 15:56:35.260: D/ListAdapter in TeamFragment(17366): getView() position: 0
01-21 15:56:35.265: D/ListAdapter in TeamFragment(17366): getView() position: 1
01-21 15:56:35.265: D/ListAdapter in TeamFragment(17366): getView() position: 2
01-21 15:56:35.270: D/ListAdapter in TeamFragment(17366): getView() position: 3
01-21 15:56:35.275: D/ListAdapter in TeamFragment(17366): getView() position: 4
01-21 15:56:40.160: D/HomeFragment(17366): onTick() in CountDownTimer - just before counterTV.setText(...)
01-21 15:56:40.170: D/ListAdapter in TeamFragment(17366): getView() position: 0
01-21 15:56:40.185: D/ListAdapter in TeamFragment(17366): getView() position: 1
01-21 15:56:40.200: D/ListAdapter in TeamFragment(17366): getView() position: 2
01-21 15:56:40.215: D/ListAdapter in TeamFragment(17366): getView() position: 3
01-21 15:56:40.225: D/ListAdapter in TeamFragment(17366): getView() position: 4
01-21 15:56:40.245: D/ListAdapter in TeamFragment(17366): getView() position: 0
01-21 15:56:40.260: D/ListAdapter in TeamFragment(17366): getView() position: 1
01-21 15:56:40.260: D/ListAdapter in TeamFragment(17366): getView() position: 2
01-21 15:56:40.265: D/ListAdapter in TeamFragment(17366): getView() position: 3
01-21 15:56:40.270: D/ListAdapter in TeamFragment(17366): getView() position: 4
01-21 15:56:45.165: D/HomeFragment(17366): onTick() in CountDownTimer - just before counterTV.setText(...)
01-21 15:56:45.170: D/ListAdapter in TeamFragment(17366): getView() position: 0
01-21 15:56:45.185: D/ListAdapter in TeamFragment(17366): getView() position: 1
01-21 15:56:45.200: D/ListAdapter in TeamFragment(17366): getView() position: 2
01-21 15:56:45.215: D/ListAdapter in TeamFragment(17366): getView() position: 3
01-21 15:56:45.225: D/ListAdapter in TeamFragment(17366): getView() position: 4
01-21 15:56:45.245: D/ListAdapter in TeamFragment(17366): getView() position: 0
01-21 15:56:45.260: D/ListAdapter in TeamFragment(17366): getView() position: 1
01-21 15:56:45.265: D/ListAdapter in TeamFragment(17366): getView() position: 2
01-21 15:56:45.270: D/ListAdapter in TeamFragment(17366): getView() position: 3
01-21 15:56:45.270: D/ListAdapter in TeamFragment(17366): getView() position: 4
</code></pre>

<p>HomeFragment:</p>

<pre><code>public class HomeFragment extends SherlockFragment {
    (...)

    private OpeningCeremonyTimer countDownTimer;
    private TextView counterTV;

    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        (...)

        countDownTimer = new OpeningCeremonyTimer(initialTime, 5000);
        countDownTimer.start();

        return view;
    }

    private class OpeningCeremonyTimer extends CountDownTimer {
        private StringBuilder time = new StringBuilder();

        public OpeningCeremonyTimer(long millisInFuture, long countDownInterval) {
            super(millisInFuture, countDownInterval);

        }

        @Override
        public void onTick(long millisUntilFinished) {
            time.setLength(0);
            if (millisUntilFinished &gt; DateUtils.DAY_IN_MILLIS) {
                long count = millisUntilFinished / DateUtils.DAY_IN_MILLIS;
                if (count &gt; 1)
                    time.append(count).append("" days "");
                else
                    time.append(count).append("" day "");
                millisUntilFinished %= DateUtils.DAY_IN_MILLIS;
            }

            time.append(DateUtils.formatElapsedTime(Math.round(millisUntilFinished / 1000d)));

            Log.d(TAG, ""onTick() in CountDownTimer - just before counterTV.setText(...)"");
            counterTV.setText(time.toString());
        }

        @Override
        public void onFinish() {
            counterTV.setText(DateUtils.formatElapsedTime(0));

        }

    }
}
</code></pre>

<p>TeamFragment:</p>

<pre><code>public class TeamFragment extends SherlockFragment {
    (...)


    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        (...)

        TeamFragmentListAdapter matchesListAdapter = new TeamFragmentListAdapter(context, matchesList);
        matchesLV.setAdapter(matchesListAdapter);

        return view;
    }
}
</code></pre>

<p>Here is my main layout:</p>

<pre><code>&lt;RelativeLayout xmlns:android=""http://schemas.android.com/apk/res/android""
    xmlns:ads=""http://schemas.android.com/apk/lib/com.google.ads""
    android:layout_width=""match_parent""
    android:layout_height=""match_parent"" &gt;

    &lt;com.google.ads.AdView
        android:id=""@+id/adView""
        android:layout_width=""match_parent""
        android:layout_height=""wrap_content""
        android:layout_alignParentBottom=""true""
        ads:adSize=""SMART_BANNER""
        ads:adUnitId=""xxx""
        ads:loadAdOnCreate=""true""/&gt;

    &lt;android.support.v4.view.ViewPager
        android:id=""@+id/pager""
        android:layout_width=""match_parent""
        android:layout_height=""match_parent""
        android:layout_above=""@id/adView""/&gt;

&lt;/RelativeLayout&gt;
</code></pre>",android|android-fragments|android-viewpager|ads|countdowntimer,1550077,AppiDevo,yes
how does bitmoji detect whatsapp activation on android,"<p>i read that there are basiclly 2 ways to detect application launches in android:</p>

<p>1)poll activity manager for the foreground activity (top of the stack)</p>

<p>2)poll the log - although i read that you can no longer do that in newer android versions because the READ_LOG permission has been moved to higher level duo to security issues</p>

<p>now both methods revolve around polling every few millyseconds, this seems to me to be a huge drain on battery life.</p>

<p>even so i seen more than a few apps that display such an ability,
one example is bitmoji - which detects whatsapp viber etc.</p>

<p>what i want to know is: </p>

<p>how it does it, is it using the above methods?</p>

<p>am i wrong to assume that this will drain the battery or is it not as big dill as i seem to think?</p>",android|battery|activity-manager,1146499,Gabriel H,yes
Can a background app (with a location UIBackgroundMode) use a timer to poll a server every few hours?,"<p>I have a background app with a UIBackgroundMode of location. </p>

<p>I would like my app to additionally contact a server every few or several hours to see if there is some new data for it (because using apple notification push would notify the user and that is not desirable).</p>

<p>Polling is something I would never use on any other OS, but with iOS they don't leave you much choice if there is certain functionality you would like to try to achieve.
If the polling interval is quite lengthy such as a few or several hours between polls, and the polling activity itself only lasts several seconds then the usual knee-jerk reaction about it draining battery life is greatly diminished.</p>

<p>Would a repeating NSTimer fire when an app is in background mode? If not is there another type of timer or mechanism available?</p>",ios,1082219,Gruntcakes,no
Is there any way to improve performance on using Handler and Runnable?,"<p>I'm using Handler and Runnable to repeat one segment of the song, but it seems to drain the phone's battery because it is checking every millisecond. Here is my code:</p>

<p>Whenever user starts looping I do the following:</p>

<pre><code>anotherHandler.post(mPlayLoopTask); 
</code></pre>

<p>anotherHandler is a global variable declared at the top""</p>

<pre><code>         private Handler anotherHandler = new Handler();
</code></pre>

<p>Here is my Runnable:</p>

<pre><code>    private Runnable mPlayLoopTask = new Runnable() {


        public void run() 
           {

                if( mp != null)
                {
                    if( isLoopOn &amp;&amp; start_position != -1 &amp;&amp; end_position != -1 )
                    {
                        long currentPosition = mp.getCurrentPosition();




                        if( currentPosition &gt;=end_position )
                        {
                            mp.seekTo(start_position);
                        }
                    }


                    anotherHandler.post(this);
                }
           }
        };
</code></pre>

<p>Is there any way to improve the performance? </p>",android|performance,1777661,user1777661,no
Right way to use wake lock (minimizing battery use) to process incoming SMS's,"<p>Let me start by admitting that I am learning (or struggling to learn) Android, while also doing something that appears to be somewhat challenging.</p>

<p>While I think I have understood the basic usage of BroadcastReceivers and I can use one to receive SMS's and do some processing, I would like for this processing to happen even when device goes to sleep. Reading around, and asking a question (<a href=""https://stackoverflow.com/questions/25730227/wake-lock-required-for-broadcastreceiver-while-phone-sleeps"">this one</a>), I understand that I need to acquire a PARTIAL wake lock (to keep the CPU active, while screen+keyboard are asleep), to <em>process the incoming SMS requests</em>, much in the way the main Messaging application (or say Hangout or other general messaging apps) that can receive the incoming SMS and flash the notification LED and vibrate (if configured to do so).</p>

<p>However, what I am confused about is the following:</p>

<ul>
<li>Wake lock has to be acquired when work is to be done, and released when there is no work to be done. If wake lock is acquired and never released, you drain battery much faster.</li>
<li>If the above is true, then how is a SMS reading application is expected to be immediately notified (perhaps using a BroadcastReceiver) of the incoming message, while not having to acquire the wake-lock permanently ?</li>
<li>One way that comes to my mind is, to use a Service that mostly sleeps, and only periodically wakes up, to check if there are any SMSs. However, this is contrary to the logic that the incoming SMS and it's corresponding Broadcast Intent could happen <em>any time</em>, clearly with ample opportunity for the application to <em>miss</em> the broadcast.</li>
</ul>

<p>So, how can one develop an application that:</p>

<ul>
<li>Never misses, any incoming SMS, and hopefully is notified as soon as it arrives (even when device is otherwise sleeping)</li>
<li>Consumes minimum battery, especially since the processing of the SMS Broadcast Intent is very small and simple... computationally minimal.</li>
</ul>

<p><strong><em>Edit (12-Sept-2014)</em></strong></p>

<p>While I've accepted the answer, I wanted to add what I understood, although I am still not 100% sure that my understanding is correct.</p>

<p>What I understood is that, at a low level (operating system, firmware and device HW), in an Android device, when the device goes to sleep, there are multiple events that can cause it to 'wake up'. Network events, keyboard events, some (if not all) sensor events, timer events etc. will cause the device to wake up, and <em>quickly</em> process the event, and try it's best to go back to sleep ASAP. As I understand, the last bit is the key. This means, that events like incoming-call, incoming SMS, keypress or other causes that result in a Broadcast Intent, always lead to an Intent to be generated and delivered to all registered BroadcastReceivers. This part is ensured. However, what is not ensured is that all BroadcastReceivers would get enough time, to spend as much time as they need to process the Intent. Instead, they need to acquire a Wake lock (of the appropriate kind) and ensure that the device doesn't go back to sleep until the Wake lock is released. Now, as I realize, there are multiple ways of acquiring the Wake lock. It could be done directly in the BroadcastReceiver, but apparently not always intuitive as to what is the best and most efficient way to manage it, s.t. it is held for the least amount of time and released as soon as it is not required. For this the SDK provides the 'WakefulBroadcastReceiver' mechanism, making the task of writing software that handled BroadcastIntent simpler when holding a wake-lock is necessary. Then there is the alternative called WakefulIntentService, developed by CommonsWare (unless I am not mistaken, it is not from the SDK, but 3rd party). </p>

<p>I hope I am right :)</p>

<p><strong><em>Edit (13-Sept-2014)</em></strong></p>

<p>More information available in <a href=""https://stackoverflow.com/questions/25229685/broadcastreceiver-wake-lock-needed-if-only-asynctask-is-executed?rq=1"">this SO Q&amp;A</a></p>",android|android-broadcast|android-wake-lock|android-powermanager,409251,bdutta74,yes
Getting network location in background in ANDROID,"<p>I am researched from many threads here for getting location information in Android OS, and tried few designs. However, I was getting lots of battery drain everytime, just couldn't get rid of it. Here is a part of my code.</p>

<p>LocationReceiver.Java</p>

<pre><code>public class LocationReceiver extends BroadcastReceiver {
public static double latestUpdate = 0;
public static int status = 0;
public static int count_upload = 0;
public static int count_ignored = 0;
public static Geocoder gc;
public void onReceive(Context context, Intent intent) {
    // Do this when the system sends the intent
    Bundle b = intent.getExtras();
    Location loc = (Location) b
            .get(android.location.LocationManager.KEY_LOCATION_CHANGED);
    if (loc == null)
        return;
    if (gc == null)
        gc = new Geocoder(context);
    update(loc, context);
}

public void update(Location loc, Context context) {
    // Here I am checking if 10 minutes passed from last update to now.
    // and if so, I am uploading my location to my server.
    if (latestUpdate != 0
            &amp;&amp; latestUpdate + ((LaunchReceiver.interval - 2) * 1000) &gt; SystemClock
                    .elapsedRealtime()) {
        // duplicate (ignore)
        count_ignored++;
    } else {
        // Upload to server on an async task.
        // ...
        LocationReceiver.latestUpdate = SystemClock.elapsedRealtime();
        count_upload++;
    }

}
}
</code></pre>

<p>LaunchReceiver.Java</p>

<pre><code>public class LaunchReceiver extends BroadcastReceiver {
public static boolean registered = false;
public static LocationManager lm;
public static int interval = 600000;
public static PendingIntent pendingIntent;
SharedPreferences sharedPrefs = null;

@Override
public void onReceive(Context context, Intent intent) {
    if (registered)
        return;
    sharedPrefs = PreferenceManager.getDefaultSharedPreferences(context);
    interval = Integer.parseInt(sharedPrefs.getString(""updates_interval"",
            ""600000""));
    Intent in = new Intent(""bdd.sanalmusavir.LOCATION_READY"");
    pendingIntent = PendingIntent.getBroadcast(context, 0, in,
            PendingIntent.FLAG_UPDATE_CURRENT);
    lm = (LocationManager) context
            .getSystemService(Context.LOCATION_SERVICE);
    // Register for broadcast intents
    lm.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, interval,
            0, pendingIntent);

    registered = true;
}
}
</code></pre>

<p>AndroidManifest.Xml</p>

<pre><code>&lt;application
    &lt;receiver
        android:name="".LaunchReceiver""
        android:label=""@string/app_name"" &gt;
        &lt;intent-filter&gt;
            &lt;action android:name=""android.net.conn.CONNECTIVITY_CHANGE"" /&gt;
        &lt;/intent-filter&gt;
    &lt;/receiver&gt;
    &lt;receiver android:name="".LocationReceiver"" &gt;
        &lt;intent-filter&gt;
            &lt;action android:name=""bdd.sanalmusavir.LOCATION_READY"" /&gt;
        &lt;/intent-filter&gt;
    &lt;/receiver&gt;
&lt;/application&gt;
</code></pre>

<p>Of course, this is just part of my code. I tried before same thing with a service by adding alarms periodically but that was draining battery as well. </p>

<p>In this practice, let's say I set the interval to 10 minutes, and when I register location updates (requestLocationUpdates), I am getting location updates random intervals (every 30 seconds or so). How can I get rid of it? What is wrong with checking if 10 minutes passed and uploading to server if so?</p>

<p>When I check count_ignored and count_uploaded after 1 day, ignored count was 2100~ and uploaded count was 50~ (upload count was true). And my application was used 90 minutes of CPU, which was unacceptable. (Upload part of application is just calling an URL on the web, with HttpRequest).</p>

<p>How can I implement better design? Any suggestions?</p>",android|location|broadcastreceiver,394622,EvanBlack,no
Would my application get rejected if i need to call web service in background to update the location?,"<p>I tried reading about this in several places but i did not find anything that helped me.</p>

<p>For my app to work i will need to update the users location in the background AND call a web service to store some relevant information about the location. Now from what i know is that some background features only allows you to run code in the background for a specific amount of time. But not when it comes to location services and playing audio.</p>

<p>I am thinking about using Significant-Change Location Service so the battery drain wont be to much. Since it can work using that service why not. My question is will the app be rejected using this or is it ok to:</p>

<ol>
<li>Get the users location by using significant change location service. (which i know is ok)</li>
<li>Store that information by calling a web service ( all done in the background) &lt;--- This i dont know if it is ok to do?</li>
</ol>

<p>Thank you all!</p>",ios|appstore-approval|background-service,4153021,Timo Cengiz,yes
Batching requests to minimize cell drain,"<p>This article hit the top of HackerNews recently: <a href=""http://highscalability.com/blog/2013/9/18/if-youre-programming-a-cell-phone-like-a-server-youre-doing.html#"" rel=""noreferrer"">http://highscalability.com/blog/2013/9/18/if-youre-programming-a-cell-phone-like-a-server-youre-doing.html#</a></p>

<p>In which it states:</p>

<blockquote>
  <p>The cell radio is one of the biggest battery drains on a phone. Every time you send data, no matter how small, the radio is powered on for up for 20-30 seconds. Every decision you make should be based on minimizing the number of times the radio powers up. Battery life can be dramatically improved by changing the way your apps handle data transfers. Users want their data now, the trick is balancing user experience with transferring data and minimizing power usage. A balance is achieved by apps carefully bundling all repeating and intermittent transfers together and then aggressively prefetching the intermittent transfers.</p>
</blockquote>

<p>I would like to modify <code>$.ajax</code> to add an option like ""doesn't need to be done <em>right now</em>, just do this request when another request is launched"". What would be a good way to go about this?</p>

<p>I started with this:</p>

<pre><code>(function($) {
    var batches = [];
    var oldAjax = $.fn.ajax;
    var lastAjax = 0;
    var interval = 5*60*1000; // Should be between 2-5 minutes
    $.fn.extend({batchedAjax: function() {
        batches.push(arguments);
    }});
    var runBatches = function() {
        var now = new Date().getTime();
        var batched;
        if (lastAjax + interval &lt; now) {
            while (batched = batches.pop()) {
                oldAjax.apply(null, batched);
            }
        }
    }
    setInterval(runBatches, interval);
    $.fn.ajax = function() {
        runBatches();
        oldAjax.apply(null, arguments);
        lastAjax = now;
    };
})(jQuery);
</code></pre>

<p>I can't tell by the wording of the paper, I guess a good batch ""interval"" is 2-5 minutes, so I just used 5.</p>

<p>Is this a good implementation?</p>

<ul>
<li><p>How can I make this a true modification of just the <code>ajax</code> method, by adding a <code>{batchable:true}</code> option to the method? I haven't quite figured that out either.</p></li>
<li><p>Does <code>setInterval</code> also keep the phone awake all the time? Is that a bad thing to do? Is there a better way to not do that?</p></li>
<li><p>Are there other things here that would cause a battery to drain faster?</p></li>
<li><p>Is this kind of approach even worthwhile? There are so many things going on at once in a modern smartphone, that if my app isn't using the cell, surely some other app is. Javascript can't detect if the cell is on or not, so <em>why bother</em>? Is it worth bothering?</p></li>
</ul>",javascript|jquery|ajax|asynchronous,1253312,Joe Frambach,yes
Network-based geolocation in off-line smartphone,"<p>Very simple question: does network-based geolocation (either cell phone tower or wifi AP) work without an internet connection? </p>

<p>If not, could you somehow cache the cell phone and wifi ap database for specific areas? Could I download a full database of all wifi access points and cell phone towers in Belgium, and filter those near to my tourist locations?</p>

<p><em>Background information:</em>
I want to make a smartphone app that alerts you when you are near a tourist location. I have a database with the addresses of all tourist locations (and can thus find lattitude/longitude).
I do not want to rely on GPS as it drains the battery too much. The phone will not have a data connection.</p>",android|google-maps|offline,944336,parasietje,yes
Small Eclipse x64 distribution for Windows?,"<p>All the official Eclipse distributions I can find are for specific purposes: <a href=""http://www.eclipse.org/downloads/"" rel=""nofollow"">http://www.eclipse.org/downloads/</a></p>

<p>I currently have an installation of <strong>Eclipse Juno</strong> up and running with PHP, PyDev, PDT, Chrome Theme, Django Template Editor and JGit+EGit.</p>

<p><strong>This is getting a little too beefy though, the IDE runs sluggishly and drains my battery.</strong></p>

<p>So my plan is to separate these into different installations—note that separate workspaces alone wouldn't fix aforementioned issue.</p>

<p>Should I just use Eclipse for Testers or is there an even smaller x64 distribution I can work with? - E.g.: an unofficial one</p>",eclipse|performance|64-bit|distribution|eclipse-juno,587021,A T,no
Will Bluetooth 4.0 actually reduce battery drainage on smartphones?,"<p>One major drawback that always made me reluctant to using Bluetooth in apps was the battery drainage factor. With Bluetooth 4.0 and the low-energy hype, I've started to change my position. But after reading up on it more carefully, I've gotten the understanding that smartphones currently delivered with Bluetooth 4.0 run a so called dual-mode, implementing Bluetooth 4.0 capabilities ontop of a regular Bluetooth controller. This would mean that the battery drainage the Bluetooth controller would have on the device won't change much with Bluetooth 4.0 (note: I'm not interested in data transfer, just idle/scan).</p>

<p>My question:
Will a Bluetooth 4.0 supported smartphone be able to broadcast its device name and scan for other devices more energy efficiently than predecessing Bluetooth supported models?</p>",bluetooth|bluetooth-lowenergy,3547137,user3547137,no
Android / Google Play Services - turn on location without WiFi scanning,"<p>In my app I'm try to get last known location (when user klick on specific button). According to Google principle, to do that I'm using getLastLocation() method via Google Play Services.</p>

<p><a href=""http://developer.android.com/training/location/retrieve-current.html#last-known"" rel=""nofollow noreferrer"">http://developer.android.com/training/location/retrieve-current.html#last-known</a></p>

<p>That working just fine, but when Location is disabled in device settings, I'm using SettingsApi to show dialog to the user without leaving application, where he can turn on necessary settings.</p>

<p><a href=""https://developers.google.com/android/reference/com/google/android/gms/location/SettingsApi"" rel=""nofollow noreferrer"">https://developers.google.com/android/reference/com/google/android/gms/location/SettingsApi</a></p>

<p>And this working fine too, BUT even when I set PRIORITY_LOW_POWER (that’s all I need), the dialog ask (apart of turning on needed location settings) that if I want also turn on WiFi scanning:</p>

<p><a href=""https://i.stack.imgur.com/07Bkc.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/07Bkc.png"" alt=""enter image description here""></a></p>

<p>This even ask if I want to enable WiFi scanning when location is turned on with highest precision! Generally, it always ask whet the WiFi is turned off. It’s really annoying, especially when in Android 6 exists a WiFi bug causes draining battery and the only workaround is turning off WiFi scanning:</p>

<p><a href=""https://code.google.com/p/android/issues/detail?id=188909"" rel=""nofollow noreferrer"">https://code.google.com/p/android/issues/detail?id=188909</a></p>

<p>So here is my question - is there any possibility to use SettingsApi dialog to turn on Location WITHOUT WiFi scanning?</p>

<p>Here is a snippet of my code:</p>

<pre><code>    LocationRequest locationRequest = new LocationRequest().setPriority(LocationRequest.PRIORITY_LOW_POWER);

    LocationSettingsRequest.Builder builder = new LocationSettingsRequest.Builder()
            .addLocationRequest(locationRequest)
            .setAlwaysShow(true);

    PendingResult&lt;LocationSettingsResult&gt; result =
            LocationServices.SettingsApi.checkLocationSettings(googleApiClient, builder.build());
</code></pre>",android|google-play-services,4265500,miecio,no
How to detect if phone is scanning or connected to wifi,"<p>Certain users of my app are saying that the battery is getting drained quite quickly. I've determined that its when they have gps and wifi turned on.</p>

<p>I have the following code that i thought determined whether wifi was on or off. It always returns is  not connected. For some reason my phone cannot connect to the office wifi, so that figures.</p>

<p>What i would like is to be able to detect if the wifi has been switched on in the phone settings. </p>

<p>I'm not sure if i'm correct but if the wifi is on but not connected, would this still drain the battery?</p>

<p>Is there any code that tells me if the wifi is switched on or off?</p>

<pre><code>private static boolean isConnectedWiFi(Context context) {

    ConnectivityManager connManager = (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);
    NetworkInfo mWifi = connManager.getNetworkInfo(ConnectivityManager.TYPE_WIFI);

        if (mWifi.isConnected()) {

            return true;

        } else {

            return false;
        }

}
</code></pre>",android|wifi,532462,turtleboy,no
Google Play Services for Android. Location client not update location if wifi disabled,"<p>Our app request update location with LocationClient and  IntentService.
Location doesn't update at all if user disable wifi in phone settings.</p>

<p>We tried to test app with PRIORITY_HIGH_ACCURACY and location updates when wifi disabled.</p>

<p>The same issue if user moving in the place where no wifi networks available.</p>

<p>I think correct behavior is use other phone sensors (like GPS) for update location if phone can not update location with wifi.</p>

<p>Steps to reproduce:</p>

<ol>
<li><p>Start update location with pending intent. With parameters</p>

<pre><code>LocationRequest request = LocationRequest.create()
        .setPriority(LocationRequest.PRIORITY_BALANCED_POWER_ACCURACY)
        .setInterval(5 * 60 * 1000)
        .setFastestInterval(60*1000)
        .setSmallestDisplacement(70);
</code></pre></li>
<li><p>Disable wifi in phone settings or go with phone in the country where no wifi networks available.</p></li>
</ol>

<p>Tested on Android 4.4, 4.3, 4.1, 4.0, 2.3.3. (Nexus7, Nexus4, Samsung GS2, HTC Wildfire and others)</p>

<pre><code>public class TrackerService extends IntentService {
    private void startUpdateLocation() {
        PendingIntent pendingIntent = PendingIntent.getService(getApplicationContext(),
            0, new Intent(ACTION_LOCATION_UPDATED), 0);
        LocationRequest request = LocationRequest.create()
            .setPriority(LocationRequest.PRIORITY_BALANCED_POWER_ACCURACY)
            .setInterval(5 * 60 * 1000)
            .setFastestInterval(60*1000)
            .setSmallestDisplacement(70);

        getLocationClient().requestLocationUpdates(request, pendingIntent);
        Log.d(Utils.getMethodName(), ""Location update started"");
    }

    private LocationClient getLocationClient() {
        if (mLocationClient != null &amp;&amp; mLocationClient.isConnected()) return mLocationClient;
        mLocationClient = new LocationClient(this,
            new GooglePlayServicesClient.ConnectionCallbacks() {
                @Override
                public void onConnected(Bundle bundle) {
                    Log.d(Utils.getMethodName(), ""Location client. Connected"");
                }

                @Override
                public void onDisconnected() {
                    Log.d(Utils.getMethodName(), ""Location client. Disconnected"");
                }
            },
            new GooglePlayServicesClient.OnConnectionFailedListener() {
                @Override
                public void onConnectionFailed(ConnectionResult connectionResult) {
                    throw new IllegalStateException(""Failed connection to location manager "" + connectionResult.toString());
                }
            }
        );
        mLocationClient.connect();
        try {
            while (mLocationClient.isConnecting()) {
                Thread.sleep(200);
            }
        } catch (InterruptedException e) {
            throw new IllegalStateException(""Thread interrupted"", e);
        }
        return mLocationClient;
    }
}
</code></pre>

<p>I tried to send bug report <a href=""https://code.google.com/p/android/issues/detail?id=63110"">https://code.google.com/p/android/issues/detail?id=63110</a></p>

<p>Developers of Android can't help.</p>

<p><strong>Where can I report about bugs in Google Play Services?</strong></p>

<p><strong>Is it a bug in Google Play Services?</strong></p>

<p><strong>What work around could you offer?</strong> </p>

<p>We don't want use PRIORITY_HIGH_ACCURACY because it drain phone battery. Our application tracking phone location and it shouldn't depends from wifi settings and wifi networks availability.</p>",android|location|google-play-services,1972679,asivura,yes
How to properly set a timer for a function that positions your elements based in a formula?,"<p>I have a function that positions elements of my page. For example:</p>

<pre><code>refresh_positions = function(){
    set_pos(arrow_div,mouse_x,mouse_y);
    set_pos(title_tiv,window_width/2,20);
};
</code></pre>

<p>This, obviously, must run continously, as fast as possible, in order for the elements to always be positioned correctly. But how? </p>

<p>If I set a fast timer like <code>setInterval(refresh_positions,10)</code>, slower computers will freeze. If I set a slower timer, faster computers will have a worse experience. I also have a concern with battery drainage in mobile devices. What's the right way of positioning elements based on a function?</p>",javascript|html|timer|positioning,1031791,MaiaVictor,no
Outstanding timer request on while WPF animation plays,"<p>any animation in WPF makes a request  a timer resolution of 1ms, lower than the 15.6ms default by Windows, which causes battery drain while any animation is running. I'm using .net 4.5 and running in Windows 10 but it's also happening in Windows 7 and 8.</p>

<p>This is my code:</p>

<pre><code>   &lt;Ellipse x:Name=""Dash1"" RenderTransformOrigin=""0.5,0.5"" Height=""100"" Width=""100"" StrokeDashArray=""10"" Stroke=""Black""&gt;
        &lt;Ellipse.Triggers&gt;
            &lt;EventTrigger RoutedEvent=""Rectangle.Loaded""&gt;
                &lt;BeginStoryboard&gt;
                    &lt;Storyboard RepeatBehavior=""Forever"" Timeline.DesiredFrameRate=""30""&gt;
                        &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=""(UIElement.RenderTransform).(TransformGroup.Children)[2].(RotateTransform.Angle)"" Storyboard.TargetName=""Dash1""&gt;
                            &lt;EasingDoubleKeyFrame KeyTime=""0:0:5"" Value=""360""/&gt;
                        &lt;/DoubleAnimationUsingKeyFrames&gt;
                    &lt;/Storyboard&gt;
                &lt;/BeginStoryboard&gt;
            &lt;/EventTrigger&gt;
        &lt;/Ellipse.Triggers&gt;
        &lt;Ellipse.RenderTransform&gt;
            &lt;TransformGroup&gt;
                &lt;ScaleTransform/&gt;
                &lt;SkewTransform/&gt;
                &lt;RotateTransform/&gt;
                &lt;TranslateTransform/&gt;
            &lt;/TransformGroup&gt;
        &lt;/Ellipse.RenderTransform&gt;
    &lt;/Ellipse&gt;
</code></pre>

<p>In order to check the timer resolution requested run the following command in a Command Prompt running as admin and check the results:</p>

<pre><code>powercfg /energy
</code></pre>

<p>Is there any way to overcome this issue or any workaround? Thanks.</p>

<p><strong>Update</strong></p>

<p>Sorry for the late reply. The windows timer resolution explanation is, by Microsoft: </p>

<blockquote>
  <p>The system timer resolution determines how frequently Windows performs two main actions: Update the timer tick count if a full tick has elapsed. Check whether a scheduled timer object has expired.</p>
</blockquote>

<p>By default Windows timer resolution is 15.6ms but any program can request to lower it, which cause a big hit impact in battery drain. For instance Chrome and vlc are known by lowering the timer resolution.</p>

<p>Recently I discover that any wpf animation playing lowers the timer resolution to 1ms, due to the internal clock it uses to synchronize the animation (I assume). When the animation stops the timer resolution comes back to its normal value but while playing the cpu consumption increases drastically. And the framerate you set on the animation has no influence on this either.</p>

<p>I was wondering if there was any way to prevent this to happen but I'm afraid this is a known issue in WPF and there's no way to solved it.</p>

<p>At the end I'm using my own programmatically animations with a dispatcher timer, which doesn't affect the timer resolution and surprisingly doesn't consume as much cpu but are not as smooth since they depend on the render thread workload.</p>

<p>You can find more reading about this here: </p>

<p><a href=""http://download.microsoft.com/download/3/0/2/3027d574-c433-412a-a8b6-5e0a75d5b237/timer-resolution.docx"" rel=""nofollow"">http://download.microsoft.com/download/3/0/2/3027d574-c433-412a-a8b6-5e0a75d5b237/timer-resolution.docx</a></p>

<p><a href=""https://randomascii.wordpress.com/2013/07/08/windows-timer-resolution-megawatts-wasted/"" rel=""nofollow"">https://randomascii.wordpress.com/2013/07/08/windows-timer-resolution-megawatts-wasted/</a></p>",wpf|windows|wpf-animation,3350604,Antonyo,no
iOS tool to measure battery drain,"<p>Is there a way of measuring battery drain of an iOS application?</p>

<p>I was looking for such things but I didn't find any satisfying results. Maybe more like <a href=""http://mobileenerlytics.com"" rel=""nofollow noreferrer"">http://mobileenerlytics.com</a> but it's not something that we can run with iOS I guess.</p>

<p>What I want to achieve:</p>

<ol>
<li>I want to somehow measure our current state of battery draining.</li>
<li>Profile / find some issues connected to battery draining.</li>
<li>Measure new state of battery draining and compare to the origin state.</li>
</ol>

<p>That would be perfect to have a clear information, that could be also applied into CI .
Thanks!</p>",ios|xcode|automation|battery,1508889,Łukasz Szpyrka,yes
"fresh install of Android Studio + emulator, emulator eating CPU + battery","<p>I've got a fresh Catalina install along with Android Studio. Turns out when I launch an emulator, the emulator process grabs a ton of CPU cycles. Looking at <code>top</code> in <code>adb shell</code>, I get a number of processes I don't understand.</p>

<p>This basically makes my dev environment unusable as I can watch my battery drain in seconds, and my laptop heats way up.</p>

<p>Suggestions ???</p>

<p><a href=""https://i.stack.imgur.com/DB9Yz.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/DB9Yz.png"" alt=""activity monitor""></a>
<a href=""https://i.stack.imgur.com/OWBTg.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/OWBTg.png"" alt=""top""></a></p>",android|macos|android-emulator|macos-catalina,1411030,ether_joe,yes
CLLocationManager didn't updated data properly,"<p>I've got the problem when I tried to experiment for LBS app. When tested in simulator, it seems to work. Then, I tried it in iPhone. It didn't work as expected. </p>

<p>When I start the app, it displayed all information such as my location latitude, longitude, distance, etc.However, those information haven't changed while I walked away. Either run app or my iPhone automatic shut up (then open app again), those data still unchanged. </p>

<p>While I switch off the app and restart it, it can display an update information.</p>

<p>Here is my code</p>

<p>I set up CLLocationManager in viewDidLoad</p>

<pre><code>- (void)viewDidLoad
{
    [super viewDidLoad];
    //setup locationManager
    locationManager =[[CLLocationManager alloc]init];
    locationManager.desiredAccuracy=kCLLocationAccuracyBest;
    locationManager.distanceFilter=kCLDistanceFilterNone;
    [locationManager setDelegate:self];
    [locationManager startUpdatingLocation];

}
</code></pre>

<p>Here is code for CLLocationManager Delegate </p>

<p>-(void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation{</p>

<pre><code>if (newLocation.horizontalAccuracy &lt; 0) return;

NSTimeInterval locationAge = -[newLocation.timestamp timeIntervalSinceNow];

if (locationAge &gt; 5.0) return;


 if (myLocation == nil || myLocation.horizontalAccuracy &gt; newLocation.horizontalAccuracy) {

    self.myLocation = newLocation;
    // NSLog(@""mylocation=%@"",self.myLocation);
    [self.mainTableView reloadData];
    [self sortedDistArray];//this method is to calculate distance and put it in array. It work...


    if (newLocation.horizontalAccuracy &lt;= locationManager.desiredAccuracy) {
        [self stopLocationManager];    
    }
}
</code></pre>

<p>}</p>

<ul>
<li>(void)stopLocationManager{
[locationManager stopUpdatingLocation];
locationManager.delegate = nil;
}</li>
</ul>

<p>Now, I have the below questions.</p>

<ol>
<li><p>What's wrong on my setting of CLLocationManager? Should I put below in appDelegate (under didFinishLaunchingWithOptions method) let it run it background? Will it drain battery power quickly? Or set it in ViewWillAppear instead of ViewDidLoad?</p></li>
<li><p>On the other hand, I put 'pull down to refresh' into program. I thought that updated data can be updated during refresh it. However, it won't work as well. Here is my code of refresh (I put EGOTableViewPullRefresh for refresh function).</p>

<ul>
<li><p>(void)reloadTableViewDataSource{</p>

<pre><code>    //  should be calling your tableviews data source model to reload
  //  put here just for demo

_reloading = YES;

 locationManager =[[CLLocationManager alloc]init];
 locationManager.desiredAccuracy=kCLLocationAccuracyBest;
 locationManager.distanceFilter=kCLDistanceFilterNone;
 [locationManager setDelegate:self];
 [locationManager startUpdatingLocation];

 [self sortedDistArray];
 [mainTableView reloadData];

 [self doneLoadingTableViewData];
</code></pre>

<p>}</p></li>
</ul></li>
</ol>

<p>What's my thought is CLLocationManager reset and start update location during users refresh it. However, it didn't work. What is my fault?</p>

<p>I'm sorry,I have so many questions. I would appreciate if someone give me advise.</p>",iphone|ios|cllocationmanager|cllocation,2252649,IOS beginner,yes
Sphero API - Access while charging in cradle?,"<p>Is there any way to access the sphero while it is charging in its cradle? I'm looking to pass information to it but still have it cradled and charging (ie, change colors throughout the day without draining the battery). Thanks!</p>",sphero-api,2348149,user2348149,no
Get Core Motion Updates when app is in background,"<p>I am building a location based app. But, when my app is in the background, location updates continue and it drains the battery. So I chose to use Core Motion to detect if user is in Automotive mode, and only use Core Location if that is the case, and not update locations otherwise. But the Core Motion chip sleeps in background mode and I don't get data.</p>

<p>How can I keep the Core Motion chip awake while my app is in the background?</p>",ios|objective-c|ios8|core-location|core-motion,1463083,Desert Rose,yes
Quantifying Battery Drain in Android,"<p>Currently, I am trying to quantify amount of battery (in percentage or mAh) drain by my App in background vs foreground mode. From:</p>

<p><a href=""https://stackoverflow.com/questions/22343774/how-can-we-calculate-to-know-how-much-battery-life-my-user-defined-application"">How can we calculate/ to know, how much battery life my user defined application utilising?</a></p>

<p>It looks like, we need to manually monitor the percentages in the Settings page to quantify. Is there a way/ open source android project to programmatically calculate the drain w.r.t to my app?</p>

<p>Any pointers would help!</p>",java|android|performance|battery|programmatically-created,376742,ssk,yes
What is the android standard or benchmark for battery drain by an application?,"<p>I was working on my phone-book application and recorded battery drain for 1 hour.
It drained to 5 % for 1 hour. I wanted to know what is the android standard or what is the android benchmark for battery drain for specific time of an application.</p>",power-management|battery,3522429,Shashank,no
Good Practices for running Android App in the Background,"<p>I have a VOIP app that I would like to always run in the background to make it responsive to incoming calls. Reading through some forums I found running the app in the background would cause a battery drain. </p>

<p>Are there good practices that I should follow so as to run the app in the background?</p>",android|background|android-activity,376742,ssk,yes
Do tvOS transmissions stay active since there is no drain on battery?,"<p>Two part question: </p>

<p>First, does the Apple TV run app activities in the background while it is asleep? I would assume this would be the case since the Apple TV isn't relying on battery. </p>

<p>Second, if this is not the case, how would I override this keep an app running and writing to my database?</p>

<p>I am building an app that connects to  Bluetooth LE, then writes to a database after connecting. I would like the Apple TV to be the ""hub"" for my device. So as long as the Apple TV can stay awake, unlike iOS, I should be fine. I could be looking at this the wrong way. Please feel free to correct me.</p>",tvos,6553331,temp_,yes
Running my application when another app is loaded,"<p><br />
It's a litle bit hard to explain, but i'll try..
<br />
There is my app, lets call it appA and another app (that I DIDN'T create, which already exist), lets call it appB.
I want that the moment appB is loaded, appA will load too.
<br />
I know it's basically possible by setting a service with an interval of seconds, but it obviously will drain battery.
<br />
Or I could somehow make a BroadcastReciever and implement a listener to appB, but I have no idea how to do this...
<br />
Is it possible in a less battery-draining way?
<br />
And if the second way I suggested is the best, how can I do this?
<br />
Thank you very much!</p>",java|android|service|broadcastreceiver|power-management,974485,RE6,yes
Android O : PHONE_STATE broadcast limitation,"<p>I have been trying to do something similar to truecaller app, where my app is supposed to show a screen after a call gets hung up. Was achieving this by registering <code>android.intent.action.PHONE_STATE</code> implicit broadcast in the <code>manifest</code> file. </p>

<p>But it is not working if I change the app to target Android O, because of the <a href=""https://developer.android.com/preview/features/background.html#broadcasts"" rel=""noreferrer"">Android O broadcast limitation</a>, and I'm trying to figure out an alternative solution to this use case. </p>

<p>Alternative solutions suggested in android docs: <code>Job scheduler</code> or register a <code>service</code> with <code>context</code>.</p>

<p><strong>Job scheduler:</strong> Because of the <code>Job scheduler</code> optimizations there will be some delay to receive the callback. So it will affect the user experience if our app screen is shown a few min after the phone call and polling to check for new call logs every few seconds causes battery drain issue.</p>

<p><strong>Register service with context in Java</strong>: I want the behavior to work even if the app is not active or alive. This will not work if the system kills the <code>Service</code>.</p>

<p><strong>Register a Foreground Service</strong>: This requires a notification to be shown to the user all the time, which would be spam the user, and running a service 24/7 consumes lots of resources which defeats the whole purpose of broadcast limitation.  </p>

<p>Please suggest an alternate solution so that the user experience remains the same. </p>

<p>Thanks in advance   </p>",android|performance|android-broadcast|android-broadcastreceiver|android-8.0-oreo,7690097,Praveen Kumar C,no
Android Studio profiling an app - is there a mapping somewhere for the adb commands it uses?,"<p>I am interested in battery usage and memory usage for testing an app. I plan on using the profiler to get a good sense of what it can do. But eventually want to automate it.</p>
<p>I know I can use <code>adb shell dumpsys battery stats | grep -A 1 &quot;Battery power use&quot;</code> - but other features like memory and cpu/network. Is there an easy guide to mapping of what profiler can do to common adb commands? Also what the values mean, for example:</p>
<pre><code>Estimated power use (mAh):
Capacity: 2390, 
Computed drain: 93.8, 
actual drain: 0.00000000
Screen: 52.5
Cell standby: 23.3
</code></pre>
<p>Is computed drain of 93.8 mAh and has used 93.8 / 2390?
How to get the PSS and TP90 values for memory for an app, and much more.</p>",android-studio|adb,6348278,user6348278,no
measuring battery drain rate of a mobile device,"<p>I am developing an application for a Nokia mobile device using J2ME. I am doing software testing now, my question is about is there any tool or methodology that enables me to measure battery drain rate of my application when it is running? i.e. how many hours or minutes the battery of the mobile device should stay when my application is running?. </p>",java-me|nokia|battery,1514564,mdawaina,no
DeviceUseTrigger doesn't result in long running background task,"<p>I'm using DeviceUseTrigger to get a ""near-permanent"" connection to the Microsoft Band. Explained in <a href=""http://www.codeproject.com/Tips/1036512/Achieveing-Indefinite-Background-Execution-with-th"" rel=""nofollow"">http://www.codeproject.com/Tips/1036512/Achieveing-Indefinite-Background-Execution-with-th</a></p>

<p>The method, described in the codeproject article, works perfectly in debug mode (without draining the battery). But running my app from the store results in a stopped backgroundtask; Windows 10 mobile stops the task due to some failing OS policy condition.</p>

<p>Does anybody found a workaround for this backgroundtask restrictions?</p>",windows-10-mobile|background-task|microsoft-band,6312383,Paul,no
React Native managing Socket connection,"<p>I have a chat app that drains a lot of battery. I guess this happens because I always keep the socket.io connection open.</p>
<p>I only use sockets in the chat page, and for showing some notifications in the home page of the app (new message etc.)</p>
<p>Should I disconnect the socket each time the user left the chat screen?</p>
<p>Does establishing a new connection every time the socket is used save more battery than keeping the connection on all time?</p>
<p>What would be the best practice for this?</p>",android|react-native|sockets|socket.io,18266827,boleirar,no
While loop cycle not satisfying requirements,"<p>I am measuring parameters on a battery (current, voltage, etc..) using an analogue to digital converter. The “While loop” cycle contains also the measurements functions which are not shown in this context because are not part of my question.</p>
<p>With the code here below, I am attempting to calculate Ampere/hours on each iteration of the cycle (Ahinst) simply multiplying the measured current by the elapsed time between two measurements. I am also summing up the Ah to get a cumulative value (TotAh) drained from the battery. This last value is shown only when the current (P2) is negative (battery not in charging mode). When the current (P2) reverse into charging mode I clear TotAh and just show 0.</p>
<pre><code>timeMeas=[]
currInst=[]
Ah=[]
TotAh=0

while(True):
    try:

 #measurements routines are also running here
    #......................

 #Ah() in development
     
     if (P2 &lt; 0):                #if current is negative (discharging)
        Tnow = datetime.now()    #get time_start reference to calculate elapsed time until next current measure  
        timeMeas.append (Tnow)   #save time_start
        currInst.append (P2)     #save current at time_start
                
    
     if (len(currInst) &gt;1):              #if current measurements are two
        elapsed=(timeMeas[1]-timeMeas[0]).total_seconds() #calculate time elapsed between two mesurements
        Ahinst=currInst[1]/3600*elapsed  #calculate Ah per time interval
        Ah.append(Ahinst)                #save Ah per time interval
        TotAh=round(sum(Ah),3)* -1       #update cumulative Ah
        timeMeas=[]                      #cleanup data in array
        currInst=[]                      #cleanup data in array
        
     elif (P2 &gt; 0):
            TotAh=0
            Ah=[]
            
            
            
            time.sleep(1)
except KeyboardInterrupt:
    break
</code></pre>
<p>The code is working but obviously is not giving me the correct result because in the second “if”condition I always clear the two arrays (timeMeas and CurrInst). Since the calculation requires at least two actual measurements “if (len(currInst)&gt;1) ” to work, clearing the two arrays cause to lose one measurement at every iteration of the cycle. I have considered shifting the values position from 0 to 1 in the arrays at every iteration, but this would cause calculation mistakes when the cycle is restarted after the value P2 is reversed to charging and then discharging mode again.</p>
<p>I am very rusty with coding and doing this for hobby. I am battling to find a solution to calculate “Ahinst” at every cycle with the actual values.
Any help is appreciated. Thanks</p>",python,2280374,FeliceM,yes
Google map real time location update from server,"<p>I am developing an android application where I need to share location in real time. I have MySql as a server to store user location. I need to fetch location from server and update on google map. I can do this by simply calling web services to store and retrieve location by timer task. But this cause rapid battery drain , and also this not happens in real time. I want to do all this in real time, I want to move marker on the map if the user is moving. Please help me I'll be very thankful.</p>",android|google-maps|location|real-time,5401140,Mehtab Ahmed,yes
Best way to benchmark iPhone app's battery usage?,"<p>What's the best way to benchmark an iPhone app's battery usage?</p>

<p>I'm working on an iPhone app that uses location services and runs in the background. It <em>seems</em> like the battery drains significantly faster with it running, but when I try to do some structured tests, the results are inconclusive.</p>

<p>The steps I'm taking are:</p>

<ol>
<li>charge the battery to 100%</li>
<li>remove the SIM (I need it for my other phone)</li>
<li>turn off push for mail/calendar/contacts</li>
<li>reinstall the app</li>
<li>restart the phone</li>
<li>start the app</li>
<li>return to SpringBoard (the app selection screen)</li>
</ol>

<p>I then wait for about 15 hours and see what the battery is at. The results so far are:</p>

<ul>
<li>App not running - 69% left</li>
<li>App running - 65% left</li>
<li>App running - 83% left</li>
</ul>",ios|ios5|benchmarking|power-management,276457,Dean,yes
Android FileObserver battery drain,"<p>I'm implementing a file observer in the main activity of a home replacement app. 
Does it drain battery?</p>

<p>Thanks</p>",android|fileobserver,997716,Apperside,no
"Android, GPS and Battery Consumption","<p>I have been handed an existing application that uses Location Services/GPS to track driving behaviour. I have been reading about the impact Location Services/GPS  can have on the battery but am coming across some seemingly contradictory information. I would like to know which of the following descriptions is more likely to be correct.</p>

<ol>
<li><p>Having Location Services/GPS enabled and registering for updates is not, in itself, that expensive on the battery and that Location Services/GPS sucks about 35mA/hour. However, if you are doing a lot of processing on the location updates (say once a second) that is a more significant battery drain - file I/O, database I/O, processing on the differences between current and previous location update etc. </p></li>
<li><p>Having Location Services/GPS enabled and registering for updates is keeping the device awake continually. Any additional processing (such as that described above) that you do while that device is awake will have minimal additional impact on battery drain...the mere fact that the device is continually awake is the main culprit.</p></li>
</ol>

<p>Most apps (aside from audio/movie playback) do not do continual I/O and processing for minutes/hours on end. An app that records driving behaviour could do this so there is a need to determine how battery expensive these operations are compared to the simply adding the updates to an array in memory. </p>

<p>I appreciate fully that the situation described in scenario 1 is probably not ideal and that you would probably not design an app to be doing extensive processing and I/O with every Location update. If you were designing an app from scratch you would probably hold the updates in memory and do batch updates periodically. </p>

<p>So, given that scenario 1 exists in the app I have been asked to maintain, I wanted to be know if a rewrite to migrate to a batched solution would have any significant impact on battery life.</p>

<p>Thanks</p>",android|gps|location|battery,5031932,WMcc,yes
Screen on/off toggle through code in Android,"<p>There are a few questions already on StackOverflow related to turning the screen on / off, however not a single solution has worked for me. </p>

<ol>
<li><p>I do not want to use a wakelock as it's no longer recommended. My app wakes up the screen using <code>WindowManager.LayoutParams.FLAG_TURN_SCREEN_ON</code>, which is far simpler and doesn't lead to a situation where one can drain the entire battery if you forget to release it.</p></li>
<li><p>Setting brightness to 0 like the following code also does not work. On my two test phones (Samsung Galaxy S2 and S3), this code only dims the screen, but does not turn it off.</p>

<pre><code>layoutParam.screenBrightness = 0;
layoutParam.flags |= LayoutParams.FLAG_KEEP_SCREEN_ON;
getWindow().setAttributes(layoutParam);
</code></pre></li>
</ol>

<p>My scenario - it's a VoIP app which turns on the screen for an incoming call, but then needs to switch off the screen (but keep the CPU running) if the user holds the phone up to their face. The proximity sensor code is running fine.</p>",android|screen|proximity|wakelock,2658755,Anuj Jain,yes
Is there a way for watch apps to support only new apple watches (4 and above)?,"<p>The title kind of says it all, I would like to develop an app only for new apple watches. The reason for this is that my app drains the battery of old apple watches really fast making it unusable and not meeting the energy efficiency requirement in appstore review.</p>",ios|apple-watch|watchos,1949494,Jelly,no
MyLocationOverlay or LocationManager for updating current location,"<p>I am using MapView to show current location of a user on a Map. To update the location while the user is on the move, I have to a choice:</p>

<ul>
<li>I can use MyLocationOverlay to draw the current location and extend it to allow tracking of the users location on the move and to have custom marker. The problem with MyLocationOverlay is that I cannot control the frequency with which the device requests the location from GPS. I am worried about the battery drain here.</li>
<li>I can use Location Manager and subscribe using requestLocationUpdates to get location from GPS. Here I have more control over the frequency with which the GPS is queried. I can hook up a LocationListener and write the code in there. </li>
</ul>

<p>But I have read here at SO that it might not be good approach to use Location Manager and MyLocationOverlay should be preferred over to this.</p>

<p>Also, consider that my app is a location based app the location of the user should be tracked as he moves.</p>

<p>Can people suggest which is the best approach to implement and has relatively less impact on battery.</p>

<p>Note that I am a beginner in Android, so pardon any obvious mistakes.</p>

<p>Thank you in advance,
andy</p>",android|google-maps|geolocation|mylocationoverlay|google-maps-mobile,769588,andy,no
How to find out if user is moving in a vehicle in iOS when there is no M7 Processor in iOS Device?,"<p>I know how to find out if user is moving in a vehicle in the following cases:</p>

<p><strong>1. CLLocationManager</strong>: </p>

<p>In this case, based on the speed in <code>locationManager:didUpdateLocations</code> method i can find out if user is moving in vehicle.</p>

<p><strong>2. If M7 Is available --> CMMotionActivityManager</strong>:</p>

<p>In this case, i can make use of <code>CMMotionActivity</code> in <code>startActivityUpdatesToQueue:withHandler</code> method and find out if user is moving in vehicle.</p>

<p>I'm stuck in the case where <strong>iOS Device doesn't have M7 Processor</strong>.</p>

<p>I can use <code>CLLocationManager</code> in this case, but it is draining device battery, So I'm not going to choose this option to achieve the functionality.</p>

<p>Please provide me guidelines to find out if user is moving in a vehicle <strong>If M7 Is not available</strong>.</p>

<p>I have referred the following links, But They didn't help me.</p>

<ul>
<li><a href=""https://stackoverflow.com/questions/17869659/detecting-if-a-user-is-moving-in-a-car"">Detecting if a user is moving in a car</a></li>
<li><a href=""https://stackoverflow.com/questions/19640151/utilizing-the-m7-chip-in-the-iphone5s"">Utilizing the M7 chip in the iPhone5S</a></li>
<li><a href=""https://stackoverflow.com/questions/19337307/use-similar-technology-as-cmmotionactivity-on-older-iphones"">Use similar technology as CMMotionActivity on older iPhones</a></li>
</ul>

<p>Thanks in Advance.</p>",ios|cllocationmanager|core-motion|cmmotionmanager,1996294,Ashok,no
refresh client webpage when data changes on server (php or javascript),"<p>I want to present data (which is on the server) on the client (mobilphone). Data is changed rarely (once a day) or frequently (more times in a hour). I dont want to client always asks server because battery of mobil would drain fast. But I want to see the changed data as soon as possible on the phone. Is there any way to do this?
I could use php on the server or php/js on the client. The data is a file and its modified time can be read by server.</p>",javascript|php|refresh|onchange,9802749,toncsi,yes
How to show Android Notification within a timeframe,"<p>I want to show a notification every 15 minutes only between 8:00 and 16:00. Here is the code:</p>

<pre><code>        Calendar calendar = Calendar.getInstance();
        Calendar calendarStartOfTheDay = Calendar.getInstance();
        Calendar calendarEndOfTheDay = Calendar.getInstance();

        calendarStartOfTheDay.set(Calendar.HOUR_OF_DAY, 8);
        calendarStartOfTheDay.set(Calendar.MINUTE, 0);
        calendarStartOfTheDay.set(Calendar.SECOND, 0);

        calendarEndOfTheDay.set(Calendar.HOUR_OF_DAY, 16);
        calendarEndOfTheDay.set(Calendar.MINUTE, 0);
        calendarEndOfTheDay.set(Calendar.SECOND, 0);

        AlarmManager alarmManager = (AlarmManager) context.getSystemService(ALARM_SERVICE);
        if (alarmManager != null &amp;&amp; calendar.getTimeInMillis() &gt; calendarStartOfTheDay.getTimeInMillis() &amp;&amp; calendar.getTimeInMillis() &lt; calendarEndOfTheDay.getTimeInMillis()) {
            alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis() + 15 * 60 * 1000, AlarmManager.INTERVAL_FIFTEEN_MINUTES, pendingIntent);
        }
</code></pre>

<p>Is there a solution except checking the current time before <code>notificationManager.notify()</code>
If this is the only solution, wouldn't it drain your battery too much during the night?</p>",android|job-scheduling,6812815,vadber,no
Frequently crashed message on Samsung devices caused by my app's background notifications,"<p>In my Xamarin app, I have implemented code to receive silent background notifications which is sent every 30 minutes. Everything works fine except on new Samsung devices (Galaxy S7, S10 etc.) the application receives the first notification and processes it, but the second notification and the other ones that is sent half an hour after the previous notification, are ignored by the device and a message is shown on the device saying the application is draining battery and has frequently crashed.</p>

<p>By checking the logs I can see the function which receives the incoming notifications is running for the first notification but is not running for the other incoming ones, which means the problem is not from the code itself.</p>

<p>Anyone knows what the problem is caused by?</p>

<p>Below I have given a short view of my function that receives the notification:</p>

<pre><code>  public async override void OnMessageReceived(RemoteMessage message)
    {

        Log(""This is logged only first time when app is in background"");

            //if the message does not contain a type then print out the message only
            if (String.IsNullOrEmpty(message.Data[""type""]))
            {
                SendNotification(message.Data[""message""], ""MyApp"");
                return;
            }

            string messageType = message.Data[""type""];

            switch (messageType)
            {
                case ""CheckUserGPS"":
                  //checks the users gps and updates the user in server
                  .....
                    break;
            }

    }
</code></pre>",android|xamarin|push-notification|samsung-mobile,12731609,DA_VDCT,no
Android - read all sensors every X minutes,"<p>I need to read all the device sensors in my app.
I've made an Android Service that implements the <code>SensorEventListener</code> interface.
Here is the code:</p>

<pre><code>    public class SensorService extends Service implements SensorEventListener {

    private static final String DEBUG_TAG = ""SensorService"";
    private SensorManager sensorManager = null;
    private Sensor sensor = null;




    @Override
    public IBinder onBind(Intent arg0) {
        return null;
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {


        sensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);

        List&lt;Sensor&gt; sensors = sensorManager.getSensorList(Sensor.TYPE_ALL);
        for (Sensor sensor : sensors)
        {

            sensorManager.registerListener(this, sensor, SensorManager.SENSOR_DELAY_NORMAL);
            }

        return START_STICKY;
    }

    @Override
    public void onDestroy() {
        super.onDestroy();  
    }

    @Override
    public void onAccuracyChanged(Sensor sensor, int accuracy) {
        // nothing

    }

    @Override
    public void onSensorChanged(SensorEvent event) {

                //do something with values
        ...

        // unregisterthe sensor
        sensorManager.unregisterListener(this,event.sensor);

                // stop the service
        stopSelf();

    }

    }

}
</code></pre>

<p>But the problem is that I only want to read the values every minute, beacuse of the drain of battery. So, I decided to call the
service using the <code>AlarmManager</code> from the activity, every minute:</p>

<pre><code>(My Activity)
...
    public void startService(View view) {

//Starts the service every minute

    AlarmManager scheduler = (AlarmManager) getSystemService(Context.ALARM_SERVICE);
    Intent intent = new Intent(getApplicationContext(), SensorService.class );
    PendingIntent scheduledIntent = PendingIntent.getService(getApplicationContext(), 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);
    scheduler.setInexactRepeating(AlarmManager.RTC_WAKEUP, System.currentTimeMillis(), 60000, scheduledIntent);

}
public void stopService(View view) {
    //Stops the servicee
    AlarmManager scheduler = (AlarmManager) getSystemService(Context.ALARM_SERVICE);
    Intent intent = new Intent(this,SensorService.class );
    PendingIntent scheduledIntent = PendingIntent.getService(getApplicationContext(), 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);
    scheduler.cancel(scheduledIntent);

}
...
</code></pre>

<p>I start the service with the <code>AlarmManager</code>, then I read the values and I call the stopSelf method ir order to stop the service.</p>

<p>The problem is the values read are old because the sensor doesn't changed because the service is stopped (I think so). 
The other problem is the stopSelf method is called every time a sensor is read, instead of being called once.</p>

<p>I don't know if there is a better way for doing this. I'd really appreciate your help.</p>

<p>Thank you.</p>",java|android|service|alarmmanager|sensors,1320113,RPallas,yes
does server call affects battrey life,"<p>I am Working on android  app, I wrote a Cron job on my server side and it send data to android app to every five minute, So my question is does this cron job drain battery of phone ?</p>

<p>Thank you in adavnce     </p>",android|cron,4065370,Ritesh,no
Run a TimerTask or a Handler ALWAYS correctly,"<p>I have a problem (that's why I'm here :P):</p>

<p>I am running a TimerTask and/or a Handler. They should do something every second, no matter if the screen is on or not (standby). The problem is, after some time (2 to 10 hours) this process becomes weird timed. Sometimes it takes 10 seconds, sometimes 4 hours etc.</p>

<p>Now, I've read that you can use a Partial Wake Lock to solve this issue. Tried it, but it has not solved my issue (Maybe you should know that another library is also using a WakeLock which gets released after some time, but mine never gets released by me).</p>

<p>Maybe you should also know that the task/runnable runs on an asynctask (so on it's own thread). The wakelock is created from outside.</p>

<hr>

<p>Edit:</p>

<p>Maybe it's good to know that it's a device owner app. Also, I know of the battery drain problem, but I still need it. The app really has to process this every second. I just need a solution for it, any, no matter which.</p>

<hr>

<p>Edit 2:</p>

<p>Here's my current WakeLock code, which is started when my custom application reaches onCreate. As I said, it is never released.:</p>

<pre><code>    PowerManager mgr = (PowerManager)getApplicationContext().getSystemService(Context.POWER_SERVICE);
    PowerManager.WakeLock wakeLock = mgr.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,""CustomWakeLock"");
    wakeLock.acquire();
</code></pre>",java|android|wakelock|android-wake-lock|standby,8667895,Antonio Vlasic,yes
Configuration changes in OpenGL Android app in API 15 and beyond,"<p>I'm writing an android game with OpenGL. Having dabbled a little bit with stuff before some time ago, I started tackling the problem of handling activity pausing/resuming and loss of OpenGL context knowing this is a tricky problem. Until now, if I hit the power button and then brought it back on, my app would restart and have all sorts of problems like empty textures. Since restoring the state of the app from scratch is just too much work in my case (there's a bunch of threads, complex AI states that I didn't design with this in mind, that sort of thing) I figured I would drop Gingerbread compatibility, start at Ice Cream Sandwich (API level 15), add </p>

<pre><code>android:configChanges=""orientation|screenSize""
</code></pre>

<p>in the manifest and just deal with restoring all things OpenGL. But just looking at how things behaved before pulling up my sleeves, I was surprised to see that everything worked flawlessly with no changes: textures, VBOs... Even the music picks up right where it left off. I've tested this for power off events and the home button. Now I've witnessed this on a Nexus 5 and Nexus 7 (2012) both running Android 4.4.2 and I can't help but feel a little suspicious...</p>

<p>So here are a few questions I was hoping some Android guru could answer:</p>

<ul>
<li>Is it OK to do this? Is my app hogging up GPU resources in the background and draining the battery or that kind of thing?</li>
<li>Can I expect this to also work on previous Android versions? (I have nothing below 4.4.2)</li>
<li>Can I add calls to the config changes (mcc, mnc &lt;- those are for calls, right?) and it's fine? (I have no way of testing this before a while)</li>
<li>Are there still cases where the GL context will be lost and I will have to recreate my GL stuff?</li>
</ul>

<p>Thanks and sorry for the not very broad appeal and unfocused nature of the question (expecting downvotes but this stuff is just so hard to investigate)</p>",android|opengl-es,2056116,schmop,no
High priority GCM message in Android with PHP?,"<p>My question is.. ¿How can I change my GCM priority like google said? I was reading <strong>Google Developers</strong> when I saw that;</p>
<blockquote>
<p>Setting the priority of a message</p>
<p>You have two options for assigning delivery priority to downstream messages: normal and high priority. Delivery of high and normal priority messages works like this:</p>
<p><strong>High priority:</strong> GCM attempts to deliver high priority messages immediately, allowing the GCM service to wake a sleeping device when possible and open a network connection to your app server. Apps with instant messaging, chat, or voice call alerts, for example, generally need to open a network connection and make sure GCM delivers the message to the device without delay. Set high priority only if the message is time-critical and requires the user’s immediate interaction, and beware that setting your messages to high priority contributes more to battery drain compared to normal priority messages.</p>
<p><strong>Normal priority:</strong> This is the default priority for message delivery. Normal priority messages won't open network connections on a sleeping device, and their delivery may be delayed to conserve battery. For less time-sensitive messages, such as notifications of new email or other data to sync, choose normal delivery priority.</p>
</blockquote>
<p>In my PHP when i want to send a notificacion I call this function:</p>
<pre><code>function send_notification($con,$registatoin_ids,$idDestino,$titulo, $message, $nombreOrigenNotificacion, $dia, $mes, $anio, $idCancha, $idOrigen, $esComplejo) { 
    $url = 'https://android.googleapis.com/gcm/send';
    
    $fields = array(
        'data' =&gt;array(&quot;idDestino&quot; =&gt; $idDestino,&quot;title&quot; =&gt; $titulo,&quot;message&quot; =&gt; $message,&quot;nombreOrigenNotificacion&quot; =&gt; $nombreOrigenNotificacion,&quot;dia&quot; =&gt; $dia,&quot;mes&quot; =&gt; $mes,&quot;anio&quot; =&gt; $anio,&quot;idCancha&quot; =&gt; $idCancha,&quot;idOrigen&quot; =&gt; $idOrigen,&quot;esComplejo&quot; =&gt; $esComplejo),
        'registration_ids' =&gt; $registatoin_ids
    );
    $headers = array(
        'Authorization: key=' . apiKey,
        'Content-Type: application/json'
    );
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($fields));
    $result = curl_exec($ch);
    if ($result === FALSE) {
        die('Curl failed: ' . curl_error($ch));
    }
    curl_close($ch);
    //echo $result;

  
}
</code></pre>
<p><strong>// EDIT:</strong>
The GCM notification is between Android Phones</p>
<p>So..<strong>How can I change the priority GCM message?</strong>
Thanks</p>",android|json|google-cloud-messaging,6421759,Faustino Gagneten,yes
What is a good approach to handle sync between phone and website?,"<p>I have a website where users can create lists and add items to these lists. I'm also developing a mobile app that communicates with the website. If the user has a web account in the phone and he/she creates a new list/item it should also be sent to the web. The phones lists/items should always stay the same as the web. Also, of course, if someone add/remove/edit lists or items those changes should be updated on the phone.</p>

<p>So, everything works good when using the phone, I just send the same info to the web as I save in my app. Easy.</p>

<p>But what is the best way to update the phones lists and items when there are changes on the web?</p>

<ol>
<li><p><strong>Automatic updates</strong> -
The app sends a request to the web server to look for changes each XX seconds and updates if necessary. </p></li>
<li><p><strong>User updates</strong> -
The user has to hit a ""refresh"" button of some kind to refresh.</p></li>
</ol>

<p>Is #1 a battery drainer?
Which is the preferred choice to take?</p>

<p>I'm developing with Titanium for both iOS and Android.</p>",android|ios|web-services|mobile,650711,Linus,no
Location based android application,"<p>I am developing a location based android application which requires to retrieve location continuously in background. </p>

<ul>
<li>I am using a LocationManager for fetching location updates.</li>
<li>I have written a service that implements the LocationListener and retrieves the location updates.</li>
<li>There is an option provided to user to either turn on/off notifications. If notifications are off, I am calling stopService() when my app goes in background otherwise service keeps on running and mLocManager.removeUpdates() is not called.</li>
</ul>

<p>This means if user keeps notification on, the service will go on requesting location updates. My biggest concern right now is battery drain. I know I must stop requesting updates at some point but my app needs receiving location continuously in background. Can anyone tell me how much average battery location updates may drain when I am using NETWORK_PROVIDER and requesting updates at an interval of 5 mins? </p>

<p>Also should I use LocationClient instead of LocationManager in order to improve performance? Or will it be ok if I continue with LocationManager.</p>

<p>It would really be great if someone could provide me a suggestion on how to efficiently receive location updates in app which continuously requires location data.</p>",android|locationmanager|location-client,2235057,Raeesaa,no
"Find already paired bluetooth devices automatically, when they are in range","<p>I am no Bluetooth specialist and wondering what possibilities are available to find already paired Bluetooth devices automatically when they are range of each other. </p>

<p><strong>Background</strong>:
In our case an Android application needs to connect to a dedicated accessory via Bluetooth (Rfcomm). Both devices are known to each other (they are paired). The Android application registers a broadcast receiver. During the startup of the application, the app initiates a discovery to find the dedicated accessory. If the accessory is in range everything works great. </p>

<p><strong>Problem</strong>:
The user starts the application outside the range of the dedicated accessory. The Android application tries to discover the accessory without success. Then the user goes into the range of the Bluetooth accessory. The broadcast receiver won’t get notified about the accessory that is in range now.</p>

<p><strong>Similar Thread / Possible Solutions</strong>
Similar questions were already asked on stackoverflow (e.g. <a href=""https://stackoverflow.com/questions/16204712/autoconnect-to-bluetooth-device-when-in-range"">autoconnect to bluetooth device when in range</a>). 
But continuously trying to discover Bluetooth devices in range isn't what I am looking for because this would cause too much battery drain of the Android device. </p>

<p>Another solution would be to try to connect to the paired device in the onResume method of the Activity. This would work but has the disadvantage that the application can’t run in the background. So the user had to bring the application at least once to the foreground to initiate the connection.</p>

<p>A third idea I thought about is to implement a server socket into the Android application too. When the android application is started and the discovery finished without success, the Android application could create server socket and to listen to incoming notifications of the accessory. This would help in some scenarios (e.g. the user starts his application, approaches the accessory, activates the accessory and the accessory notifies the application on startup that it is in range now). But this is still no 100% solution because both devices can start outside the range of each other. Also it would be mandatory to implement additional functionality (Bluetooth server socket in the Android device…). </p>

<p>So I am wondering if better solutions exist. I am looking for a solution where no additional ServerSockets are required and I always get the notification that the two already paired devices are in range of each other :-)</p>

<p>Thanks for any help!</p>",android|bluetooth|android-bluetooth,2607365,mheymel,yes
Start Service as Foreground or Not for Oreo Restriction,"<p>I want to show notification only if i am in background</p>

<p>Basically i want to avoid the notification as much as possible, Plus i want to make sure Notification is not creating much noise and irritation(vibration) to the user</p>

<p>Oreo hates me starting service in background and draining battery</p>",illegalstateexception,373257,Bipin,no
pjsip android unregister/register crash,"<p>I'm using pjsip for VOIP calling. In order to preserve battery life the strategy is to unregister and delete sip account whenever a call is finished. And incoming calls are notified by GCM, which will trigger registering of sip account.</p>

<p>This works but is unstable. Sometimes the app crashes down in the pjsip native layer (I'm suspecting because gc kicks in on the wrong thread?).</p>

<p>I carefully call .delete() on all things. But this doesn't help. Sometimes I can do 10-15 calls before a crash. But on other devices alot fewer.</p>

<p>Crashes I get just give me an unhelpful Fatal signal 11:</p>

<pre><code>10-27 22:53:23.045    1068-2014/com.funbers.app /System.out﹕ 22:53:23.204   pjsua_core.c  .RX 619 bytes Response msg 200/REGISTER/cseq=24488 (rdata0x613e2540) from TLS 162.209.100.164:5061:
10-27 22:53:23.200    1068-2014/com.funbers.app I/System.out﹕ SIP/2.0 200 OK
10-27 22:53:23.200    1068-2014/com.funbers.app I/System.out﹕ Via: SIP/2.0/TLS 85.225.249.21:46425;branch=z9hG4bKPjQ71QoAFam.OlO6FEvuVz2gM5PPu4DWmH;alias;received=85.225.249.21;rport=46425
10-27 22:53:23.200    1068-2014/com.funbers.app I/System.out﹕ From: ""12025999147"" &lt;sip:1112220002QQQ140431267693@devastus01.funbers.net&gt;;tag=XvzX1mdof0g94DVFNNaryzYNTCpwFwD0
10-27 22:53:23.200    1068-2014/com.funbers.app I/System.out﹕ To: ""12025999147"" &lt;sip:1112220002QQQ140431267693@devastus01.funbers.net&gt;;tag=as7431db35
10-27 22:53:23.200    1068-2014/com.funbers.app I/System.out﹕ Call-ID: naIKdyL6kahHCqtpDB9mKwGs3IVssYbq
10-27 22:53:23.200    1068-2014/com.funbers.app I/System.out﹕ CSeq: 24488 REGISTER
10-27 22:53:23.200    1068-2014/com.funbers.app I/System.out﹕ Server: Asterisk
10-27 22:53:23.200    1068-2014/com.funbers.app I/System.out﹕ Allow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER, SUBSCRIBE, NOTIFY, INFO, PUBLISH, MESSAGE
10-27 22:53:23.200    1068-2014/com.funbers.app I/System.out﹕ Supported: replaces, timer
10-27 22:53:23.200    1068-2014/com.funbers.app I/System.out﹕ Expires: 0
10-27 22:53:23.200    1068-2014/com.funbers.app I/System.out﹕ Date: Mon, 27 Oct 2014 21:53:26 GMT
10-27 22:53:23.200    1068-2014/com.funbers.app I/System.out﹕ Content-Length: 0
10-27 22:53:23.200    1068-2014/com.funbers.app I/System.out﹕ [ 10-27 22:53:23.200  1068: 2014 I/System.out ]
10-27 22:53:23.200    1068-2014/com.funbers.app I/System.out﹕ --end msg--
10-27 22:53:23.210    1068-2014/com.funbers.app I/System.out﹕ 22:53:23.214    pjsua_acc.c  ....""12025999147"" &lt;sip:1112220002QQQ140431267693@devastus01.funbers.net;transport=tls&gt;: unregistration success
10-27 22:53:23.210    1068-2014/com.funbers.app D/Funbers﹕ notifyRegState: code: 200, reason: OK, expiration: 0
10-27 22:53:23.215    1068-2014/com.funbers.app D/Funbers﹕ Delete account (notifyRegState)
10-27 22:53:23.220    1068-2014/com.funbers.app I/System.out﹕ 22:53:23.229    pjsua_acc.c  ....Deleting account 0..
10-27 22:53:23.225    1068-2014/com.funbers.app I/System.out﹕ 22:53:23.229    pjsua_acc.c  .....Account id 0 deleted
10-27 22:53:23.225    1068-2014/com.funbers.app A/libc﹕ Fatal signal 11 (SIGSEGV) at 0x24656369 (code=1), thread 2014 (com.funbers.app)
</code></pre>

<p>Now I wonder, is it even a good idea to unregister/delete account after a call. Or should sip account just be kept alive (and reregister itself every couple of minutes)? Will having sipservice alive in the background drain battery much?</p>

<p>Or could I have missed something in my register/unregister calls. Btw I do unregister by:</p>

<pre><code>account.setRegistration(false);
</code></pre>

<p>Then wait for registration change notification before doing:</p>

<pre><code>account.delete();
account = null;
</code></pre>",android|pjsip,2718034,Rasmus Höglund,no
Close activity on power disconnected,"<p>I wrote a small application for playing a single video in the loop. How can i realize, that the device wakes up and plays this video when power is connected and closes the activity again . After this also the screen should be turned off to avoid draining the battery.</p>

<p>The actual code looks like:</p>

<pre><code>package org.adem.receiver;

import android.app.Activity;
import android.app.ActivityManager;
import android.app.KeyguardManager;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.PowerManager;
import android.util.Log;
import org.adem.activities.AdvertiserActivity;
import org.adem.global.GlobalVariables;

public class AppReceiver extends BroadcastReceiver {

    private static final String TAG = AppReceiver.class.getSimpleName();

    @Override
    public void onReceive(Context context, Intent intent) {
        if (Intent.ACTION_POWER_CONNECTED.equals(intent.getAction())) {
            Log.d(TAG, ""##Receiver triggered with "" + intent.getAction());
            if (!checkForRunningActivity(context)) {
                initStart(context);
                Intent advertiserIntent = new Intent(context, AdvertiserActivity.class);
                advertiserIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                Log.d(TAG, ""##Activity started"" + advertiserIntent.getComponent().getShortClassName());
                context.startActivity(advertiserIntent);
            } else {
                Log.d(TAG, ""##"" + intent.getAction() + "" received but ignored. Activity still running."");
            }
        } else if (Intent.ACTION_POWER_DISCONNECTED.equals(intent.getAction())) {
            Log.d(TAG, ""##Receiver triggered with "" + intent.getAction());
            stopAllAndTurnOff(context);

            Log.d(TAG, ""##"" + intent.getAction() + "" received but ignored. Activity is not running."");
        }

    }

    private void initStart(Context context) {
        getWakeLock(context).acquire();
        GlobalVariables.DEVICE_READY = true;
        getKeyGuardLock(context).disableKeyguard();
        Log.d(TAG, ""##Wake Lock acquired"");
    }

    private void stopAllAndTurnOff(Context context) {
        GlobalVariables.DEVICE_READY = false;

        if (getWakeLock(context).isHeld()) {
            getWakeLock(context).release();
            Log.d(TAG, ""##Wake Lock released"");
        }
    }

    private KeyguardManager.KeyguardLock getKeyGuardLock(Context context) {
        if (GlobalVariables.getLock() == null) {
            KeyguardManager.KeyguardLock lock;
            KeyguardManager keyguardManager = (KeyguardManager) context.getSystemService(Activity.KEYGUARD_SERVICE);
            lock = keyguardManager.newKeyguardLock(Context.KEYGUARD_SERVICE);
            GlobalVariables.setLock(lock);
            Log.d(TAG, ""##New KeyGuard initialized"");
        }
        return GlobalVariables.getLock();
    }

    private PowerManager.WakeLock getWakeLock(Context context) {
        if (GlobalVariables.getWl() == null) {
            PowerManager.WakeLock wl;
            PowerManager pm = (PowerManager) context.getSystemService(Context.POWER_SERVICE);
            wl = pm.newWakeLock(PowerManager.SCREEN_BRIGHT_WAKE_LOCK | PowerManager.ACQUIRE_CAUSES_WAKEUP, TAG);
            GlobalVariables.setWl(wl);
            Log.d(TAG, ""##New Wake Lock initialized"");
        }
        return GlobalVariables.getWl();
    }

    private boolean checkForRunningActivity(Context context) {
        ActivityManager manager = (ActivityManager) context.getSystemService(Activity.ACTIVITY_SERVICE);
        for (ActivityManager.RunningTaskInfo task : manager.getRunningTasks(Integer.MAX_VALUE)) {
            Log.d(TAG, task.baseActivity.getClassName());
            if (task.baseActivity.getClassName().equals(""org.adem.activities.AdvertiserActivity"")
                    || task.baseActivity.getClassName().equals(""org.adem.activities.VideoViewActivity"")) {
                return true;
            }
        }
        return false;
    }
}
</code></pre>

<p>When I test this on a real device, it say every time, that the activity is still running. But why?</p>

<p>Thanks </p>

<p>Adem</p>",android|android-activity|broadcastreceiver,652689,AdemC,yes
Restarting an iPhone programmatically,"<p>I have an iPhone 3GS, which I am using for testing etc. Unfortunately its Power button (the one on top right) stopped working, thanks to my son's attempts at baseball pitching practice. Now, if I have to reboot the phone, all I can do is let the battery drain out and then reconnect power. Is it possible to do something programmatically (I will not, of course, submit this as an iPhone App!) without jailbreaking, so I can restart the iPhone when needed? I have an Apple membership so I can write and run these apps on the phone. Any suggestions are appreciated.</p>

<p>I am running iOS 5.1.1 on it currently.</p>",iphone|ios,1152743,LNI,yes
Android location aware notifications,"<p>I'm looking for best techniques for Location Aware notifications.</p>

<p>My first try was to use LocationManager's addProximityAlert but it requires ACCESS_FINE_LOCATION (COARSE_LOCATION gives me a SecurityException) and keeps the GPS always ON and active (at least on Jelly Bean), which drains the battery very quickly. It also doesn't seems to respect the check only once every 4 minutes when the screen is asleep (<a href=""https://developer.android.com/reference/android/location/LocationManager.html#addProximityAlert%28double,%20double,%20float,%20long,%20android.app.PendingIntent%29"" rel=""nofollow"">addProximityAlert</a>).</p>

<p>I'm thinking to work with the PASSIVE_PROVIDER to gather other applications location information, and maybe use a service to ask for COARSE_LOCATION every once in a while (like every 4 minutes when the screen is off, and more frequently when the screen is On and the device is plugged in).</p>

<p>The requirement is to when the user goes nearby some locations, the app will fire a notification.</p>

<p>Anyone have implemented or have suggestions to implement this in a effective and battery efficient way?</p>",android|notifications|location|battery,1012820,luciofm,no
Android cameraSource.stop() causing app to freeze,"<p>I am building an app that has a qr scanner using the google vision api. I am having trouble stopping the camera after the qr code is read. the flow is <code>MainActivity -&gt; QrActivity</code>
once the qr-code received a detection the app should return to the main activity.</p>

<p>If i do not call <code>cameraSource.release()</code> it works fine but the device heats up a lot and has a significant impact on battery drain. however if i release the camera source the mainActivity becomes un-responsive and the app will crash. </p>

<p>Why is it becoming unresponsive? and where is the correct place to release the camera source?</p>

<p><strong>QrActivity</strong></p>

<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
     super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_qr);
    cancelBtn = (Button) findViewById(R.id.cancel_button);
    cancelBtn.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            onBackPressed();
        }
    });

    new QrReader(this);
}
</code></pre>

<p><strong>QrReader Class</strong></p>

<pre><code>public class QrReader {

    private static final String TAG = ""QrReader"";

    private SurfaceView cameraView;
    private TextView barcodeInfo;
    private BarcodeDetector barcodeDetector;
    private CameraSource cameraSource;
    private Activity mActivity;
    private AccessPointCredentials barCodeData;

    public QrReader(Activity activity) {
        this.mActivity = activity;

        cameraView = (SurfaceView) mActivity.findViewById(R.id.camera_view);
        barcodeInfo = (TextView) mActivity.findViewById(R.id.code_info);

        barcodeDetector =
                new BarcodeDetector.Builder(mActivity)
                        .setBarcodeFormats(Barcode.QR_CODE)
                        .build();

        cameraSource = new CameraSource
                .Builder(mActivity, barcodeDetector)
                .setAutoFocusEnabled(true)
                .build();

        cameraView.getHolder().addCallback(new SurfaceHolder.Callback() {

            @Override
            public void surfaceCreated(SurfaceHolder holder) {

                cameraSource = new CameraSource
                        .Builder(mActivity, barcodeDetector)
                        .setAutoFocusEnabled(true)
                        .setFacing(0)
                        .build();
                try {                  
                    cameraSource.start(cameraView.getHolder());

                } catch (Exception ioe) {
                    ioe.printStackTrace();
                }
            }

            @Override
            public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) {
            }

            @Override
            public void surfaceDestroyed(SurfaceHolder holder) {
                  // Log.i(TAG, ""surfaceDestroyed: stopping camera Source"");

                  // cameraSource.release();
            }
        });

        barcodeDetector.setProcessor(new Detector.Processor&lt;Barcode&gt;() {
            @Override
            public void release() {
                Log.i(TAG, ""release: "");
            }

            @Override
            public void receiveDetections(Detector.Detections&lt;Barcode&gt; detections) {
                final SparseArray&lt;Barcode&gt; barCodes = detections.getDetectedItems();

                if (barCodes.size() != 0) {

                    Log.i(TAG, ""received a Barcode"");
                    barcodeInfo.post(new Runnable() {    // Use the post method of the TextView
                        public void run() {
                            barcodeInfo.setText(barCodes.valueAt(0).displayValue);

                        }
                    });
                    Gson g = new Gson();
                    try {
                        barCodeData = g.fromJson(barCodes.valueAt(0).rawValue, AccessPointCredentials.class);
                    } catch (Exception e) {
                        barCodeData = new AccessPointCredentials();
                        barCodeData.setSsid(barCodes.valueAt(0).rawValue);
                        barCodeData.setPass(null);
                        e.printStackTrace();
                    }

                    connectToWifi(barCodeData);

                    // CameraSource.release causes app to freeze

                    // cameraSource.release();
                }
            }
        });
    }

    private void connectToWifi(final AccessPointCredentials credentials) {

                //wificonnect code

    }

}
</code></pre>",java|android|qr-code|google-vision,1685748,Lonergan6275,yes
creating geofences in background service,"<p>I'm making an android application in which want to create a Geofence at LatLong coordinates specified at my server.</p>

<p>The coordinates are getting updated periodically in background from within a service. I'm reading these coordinates and wish to create a Geofence for it in background without user intervention. I tried doing so within a service but it's not working. I can get the coordinates from the server at regular intervals but I'm not able to create Geofence for it, getting a nullPointerException.</p>

<p>However, I'm able to create Geofences in an Activity on click of a button(hardcoding LatLong coordinates) but its not working in a service.</p>

<p>My service:</p>

<pre><code>public class GPSPollingService extends Service implements ResultCallback&lt;Status&gt;, GoogleApiClient.ConnectionCallbacks, GoogleApiClient.OnConnectionFailedListener, LocationListener {

private GoogleApiClient mGoogleApiClient;
private PowerManager.WakeLock mWakeLock;
private LocationRequest mLocationRequest;
// Flag that indicates if a request is underway.
private boolean mInProgress;
private final String TAG = ""GPSPollingService"";

private PendingIntent mGeofencePendingIntent;
String url = ""http://shielded.coolpage.biz/status_read.php"";
private static final int REQUEST_CODE_LOCATION = 2;
private Boolean servicesAvailable = false;
private Activity mActivity;

ArrayList&lt;Geofence&gt; mCurrentGeofences = new ArrayList&lt;Geofence&gt;();;
RequestQueue requestQueue;
Location mLocation;

public GPSPollingService(){}

public GPSPollingService(Activity mActivity){
    super();
    this.mActivity = mActivity;

}

@Nullable
@Override
public IBinder onBind(Intent intent) {
    return null;
}

@Override
public void onCreate() {
    super.onCreate();
    mInProgress = false;
    requestQueue = Volley.newRequestQueue(this);
    // Instantiate the current List of geofences
    mCurrentGeofences = new ArrayList&lt;Geofence&gt;();

    mGeofencePendingIntent = null;
    setUpLocationClientIfNeeded();
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    super.onStartCommand(intent, flags, startId);
    mGoogleApiClient.connect();
    Log.d(TAG,""onStartCommand: "");
    PowerManager mgr = (PowerManager)getSystemService(Context.POWER_SERVICE);
    /*
    WakeLock is reference counted so we don't want to create multiple WakeLocks. So do a check before initializing and acquiring.
    This will fix the ""java.lang.Exception: WakeLock finalized while still held: MyWakeLock"" error that you may find.
    */
    if (this.mWakeLock == null) { //**Added this
        this.mWakeLock = mgr.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, ""MyWakeLock"");
    }

    if (!this.mWakeLock.isHeld()) { //**Added this
        this.mWakeLock.acquire();
    }

    if(!servicesAvailable || mGoogleApiClient.isConnected() || mInProgress)
        return START_STICKY;

    setUpLocationClientIfNeeded();
    if(!mGoogleApiClient.isConnected() || !mGoogleApiClient.isConnecting() &amp;&amp; !mInProgress)
    {
        //appendLog(DateFormat.getDateTimeInstance().format(new Date()) + "": Started"", Constants.LOG_FILE);
        mInProgress = true;
        mGoogleApiClient.connect();
    }

    return START_STICKY;


}

private void setUpLocationClientIfNeeded()
{
    if(mGoogleApiClient == null)
        googleApiClientBuild();
}
protected synchronized void googleApiClientBuild(){
    mGoogleApiClient = new GoogleApiClient.Builder(this)
            .addApi(LocationServices.API)
            .addConnectionCallbacks(this)
            .addOnConnectionFailedListener(this)
            .build();
}


@Override
public void onConnected(@Nullable Bundle bundle) {

    mLocationRequest = LocationRequest.create();
    mLocationRequest.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);
    mLocationRequest.setInterval(120000); // Update location every 60 seconds

    Log.d(TAG,""in onConnected: "");

    if ( ContextCompat.checkSelfPermission( this, android.Manifest.permission.ACCESS_FINE_LOCATION ) != PackageManager.PERMISSION_GRANTED ) {

        ActivityCompat.requestPermissions( mActivity, new String[] {  android.Manifest.permission.ACCESS_COARSE_LOCATION  },
                REQUEST_CODE_LOCATION );
    }else {
        LocationServices.FusedLocationApi.requestLocationUpdates(mGoogleApiClient, mLocationRequest, this);
        //Location mLocation = LocationServices.FusedLocationApi.getLastLocation(mGoogleApiClient);
        //txtOutput.setText(mLocation.toString());
        Log.d(TAG, ""calling fusedLocationApi"");
    }

    continueAddGeofences();
}

@Override
public void onConnectionSuspended(int i) {

    // Turn off the request flag
    mInProgress = false;
    // Destroy the current location client
    mGoogleApiClient = null;
    Log.d(TAG, ""onConnectionSuspended "");
}

@Override
public void onLocationChanged(Location location) {
    mLocation = location;
    Log.d(TAG,""in onLocationChanged: "");
    Log.d(TAG, mLocation.toString());
    // save new location to db


    connectToDb();          // checking for status 1



}

@Override
public void onConnectionFailed(@NonNull ConnectionResult connectionResult) {

    mInProgress = false;

    Log.d(TAG, ""onConnectionFailed"");
    /*
     * Google Play services can resolve some errors it detects.
     * If the error has a resolution, try sending an Intent to
     * start a Google Play services activity that can resolve
     * error.
     */
    if (connectionResult.hasResolution()) {
        Log.d(TAG, ""google play services has solution"");

        // If no resolution is available, display an error dialog
    } else {

        Log.d(TAG, ""no solution for connection failure"");
    }
}

@Override
public void onDestroy() {
    // Turn off the request flag
    this.mInProgress = false;

    if (this.servicesAvailable &amp;&amp; this.mGoogleApiClient != null) {
        this.mGoogleApiClient.unregisterConnectionCallbacks(this);
        this.mGoogleApiClient.unregisterConnectionFailedListener(this);
        this.mGoogleApiClient.disconnect();
        // Destroy the current location client
        this.mGoogleApiClient = null;
    }
    // Display the connection status
    // Toast.makeText(this, DateFormat.getDateTimeInstance().format(new Date()) + "":
    // Disconnected. Please re-connect."", Toast.LENGTH_SHORT).show();

    if (this.mWakeLock != null) {
        this.mWakeLock.release();
        this.mWakeLock = null;
    }

    super.onDestroy();
}
public void connectToDb(){
    StringRequest stringRequest = new StringRequest(Request.Method.POST, url, new Response.Listener&lt;String&gt;() {
        @Override
        public void onResponse(String s) {
            Toast.makeText(getApplicationContext() , """"+s,Toast.LENGTH_LONG).show();
            Log.d(TAG, """"+s);
            try {
                JSONObject jsonObject = new JSONObject(s);
                JSONArray jsonArray = jsonObject.getJSONArray(""result"");
                if(jsonArray.length()!=0){
                    Log.d(TAG,""array length not 0"");
                    JSONObject personInDanger = jsonArray.getJSONObject(0);
                    setGeofence(Double.valueOf(personInDanger.getString(""latitude"")), Double.valueOf(personInDanger.getString(""longitude"")));
                }
        }catch (JSONException je) {
            // do something with it
            }
        }
    }, new Response.ErrorListener() {
        @Override
        public void onErrorResponse(VolleyError volleyError) {
            Toast.makeText(getApplicationContext(), """"+volleyError, Toast.LENGTH_LONG).show();

        }
    });

    requestQueue.add(stringRequest);
}

/**
 * Verify that Google Play services is available before making a request.
 *
 * @return true if Google Play services is available, otherwise false
 */
private boolean servicesConnected() {

    // Check that Google Play services is available
    int resultCode = GooglePlayServicesUtil.isGooglePlayServicesAvailable(this);

    // If Google Play services is available
    if (ConnectionResult.SUCCESS == resultCode) {

        // In debug mode, log the status
        Log.d(GeofenceUtils.APPTAG, getString(R.string.play_services_available));

        // Continue
        return true;

        // Google Play services was not available for some reason
    } else {

        // Display an error dialog
        Toast.makeText(getApplicationContext(), ""Google play services not available"", Toast.LENGTH_SHORT).show();
        //Dialog dialog = GooglePlayServicesUtil.getErrorDialog(resultCode, (Activity) getApplicationContext(), 0);
        //if (dialog != null) {
        //    ErrorDialogFragment errorFragment = new ErrorDialogFragment();
        //    errorFragment.setDialog(dialog);
        //    errorFragment.show(getSupportFragmentManager(), GeofenceUtils.APPTAG);
        }
        return false;
    }

public void setGeofence(Double latitude , Double longitude){

    Log.d(TAG, ""in setGeofence"");
    if (!servicesConnected()) {

        return;
    }

    SimpleGeofence newGeofence = new SimpleGeofence(
            ""1"",
            // Get latitude, longitude, and radius from the db
            latitude,
            longitude,
            Float.valueOf(""50.0""),
            // Set the expiration time
            Geofence.NEVER_EXPIRE,
            // Detect both entry and exit transitions
            Geofence.GEOFENCE_TRANSITION_ENTER
    );



    mCurrentGeofences.add(newGeofence.toGeofence());
    // Start the request. Fail if there's already a request in progress
    try {
        // Try to add geofences
        addGeofences(mCurrentGeofences);
    } catch (UnsupportedOperationException e) {
        // Notify user that previous request hasn't finished.
        Toast.makeText(this, R.string.add_geofences_already_requested_error,
                Toast.LENGTH_LONG).show();
    }

}

public void addGeofences(ArrayList&lt;Geofence&gt; geofences) throws UnsupportedOperationException {
    if (!mInProgress) {

        // Toggle the flag and continue
        mInProgress = true;

        // Request a connection to Location Services
        requestConnection();

        // If a request is in progress
    } else {

        // Throw an exception and stop the request
        throw new UnsupportedOperationException();
    }
}

private void requestConnection() {
    getLocationClient().connect();
}

private GoogleApiClient getLocationClient() {
    if (mGoogleApiClient == null) {

        mGoogleApiClient = new GoogleApiClient.Builder(mActivity)
                .addConnectionCallbacks(this)
                .addOnConnectionFailedListener(this)
                .addApi(LocationServices.API)
                .build();
    }
    return mGoogleApiClient;

}

private void continueAddGeofences() {

    // Get a PendingIntent that Location Services issues when a geofence transition occurs
    mGeofencePendingIntent = createRequestPendingIntent();
    if (!mGoogleApiClient.isConnected()) {
        Toast.makeText(mActivity, ""not connected"", Toast.LENGTH_SHORT).show();
        return;
    }

    try {
        LocationServices.GeofencingApi.addGeofences(
                mGoogleApiClient,
                // The GeofenceRequest object.
                mCurrentGeofences,
                // A pending intent that that is reused when calling removeGeofences(). This
                // pending intent is used to generate an intent when a matched geofence
                // transition is observed.
                mGeofencePendingIntent
        ).setResultCallback(this); // Result processed in onResult().
    } catch (SecurityException securityException) {
        // Catch exception generated if the app does not use ACCESS_FINE_LOCATION permission.
        logSecurityException(securityException);
    }

}

private void logSecurityException(SecurityException securityException) {
    Log.e(GeofenceUtils.APPTAG , ""Invalid location permission. "" +
            ""You need to use ACCESS_FINE_LOCATION with geofences"", securityException);
}

public void onResult(Status status) {
    Intent broadcastIntent = new Intent();

    // Temp storage for messages
    String msg;


    if (status.isSuccess()) {

        Toast.makeText(
                mActivity, ""Geofences added"",
                Toast.LENGTH_SHORT
        ).show();

        msg = mActivity.getString(R.string.add_geofences_result_success, status);

        // In debug mode, log the result
        Log.d(GeofenceUtils.APPTAG, msg);

        // Create an Intent to broadcast to the app
        broadcastIntent.setAction(GeofenceUtils.ACTION_GEOFENCES_ADDED)
                .addCategory(GeofenceUtils.CATEGORY_LOCATION_SERVICES)
                .putExtra(GeofenceUtils.EXTRA_GEOFENCE_STATUS, msg);
        // If adding the geofences failed
    } else {

        /*
         * Create a message containing the error code and the list
         * of geofence IDs you tried to add
         */
        msg = mActivity.getString(
                R.string.add_geofences_result_failure,
                status.getStatusCode(), status.getStatusMessage());

        // Log an error
        Log.e(GeofenceUtils.APPTAG, msg);

    }

}

private PendingIntent createRequestPendingIntent() {

    // If the PendingIntent already exists
    if (null != mGeofencePendingIntent) {

        // Return the existing intent
        return mGeofencePendingIntent;

        // If no PendingIntent exists
    } else {
        Intent intent = new Intent(""com.example.android.geofence.ACTION_RECEIVE_GEOFENCE"");
        return PendingIntent.getBroadcast(
                mActivity,
                0,
                intent,
                PendingIntent.FLAG_UPDATE_CURRENT);
    }
}
</code></pre>

<p>}</p>

<p>My logs:</p>

<pre><code>java.lang.NullPointerException: Attempt to invoke virtual method 'java.lang.String android.content.Context.getPackageName()' on a null object reference
                                                                                 at android.app.PendingIntent.getBroadcastAsUser(PendingIntent.java:506)
                                                                                 at android.app.PendingIntent.getBroadcast(PendingIntent.java:495)
                                                                                 at com.example.android.safetyalert.GPSPollingService.createRequestPendingIntent(GPSPollingService.java:449)
                                                                                 at com.example.android.safetyalert.GPSPollingService.continueAddGeofences(GPSPollingService.java:369)
                                                                                 at com.example.android.safetyalert.GPSPollingService.onConnected(GPSPollingService.java:163)
                                                                                 at com.google.android.gms.common.internal.zzl.zzm(Unknown Source)
                                                                                 at com.google.android.gms.internal.zzof.zzk(Unknown Source)
                                                                                 at com.google.android.gms.internal.zzod.zzsb(Unknown Source)
                                                                                 at com.google.android.gms.internal.zzod.onConnected(Unknown Source)
                                                                                 at com.google.android.gms.internal.zzoh.onConnected(Unknown Source)
                                                                                 at com.google.android.gms.internal.zznw.onConnected(Unknown Source)
                                                                                 at com.google.android.gms.common.internal.zzk$1.onConnected(Unknown Source)
                                                                                 at com.google.android.gms.common.internal.zzd$zzj.zztp(Unknown Source)
                                                                                 at com.google.android.gms.common.internal.zzd$zza.zzc(Unknown Source)
                                                                                 at com.google.android.gms.common.internal.zzd$zza.zzw(Unknown Source)
                                                                                 at com.google.android.gms.common.internal.zzd$zze.zztr(Unknown Source)
                                                                                 at com.google.android.gms.common.internal.zzd$zzd.handleMessage(Unknown Source)
                                                                                 at android.os.Handler.dispatchMessage(Handler.java:102)
                                                                                 at android.os.Looper.loop(Looper.java:135)
                                                                                 at android.app.ActivityThread.main(ActivityThread.java:5312)
                                                                                 at java.lang.reflect.Method.invoke(Native Method)
                                                                                 at java.lang.reflect.Method.invoke(Method.java:372)
                                                                                 at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:901)
                                                                                 at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:696)
</code></pre>

<p>I have tried everything I could think of. 
I'm polling the GPS in order to provide accurate location to the OS to increase the accuracy of geofencing. I know it will drain my battery but for now that's not a problem.</p>",android|service|android-context|geofencing|android-geofence,5779015,I.shL,yes
SyncAdapter - How to Periodic sync every second,"<p>I'm trying to force my application to perform a sync every second, or just every 4 or 5 second. However, the minimum period i can make the syncadapter sync is 30-60 seconds. How can archive such a behavior?</p>

<p>No matter what i set i the second parameter in addPeriodicSync(), it won't be below 30 seconds.
        ContentResolver.setMasterSyncAutomatically(true);
        ContentResolver.setIsSyncable(mAccount, AUTHORITY, 1);</p>

<pre><code>    ContentResolver.setSyncAutomatically(mAccount, AUTHORITY, true);
    ContentResolver.addPeriodicSync(
            mAccount,
            AUTHORITY,
            Bundle.EMPTY,
            4);
</code></pre>

<p>I am aware that this is a bad behavior for an application as it will drain the battery, and that GCM should have been used to create pushes from the server.
The application is for a university project presentation so i need to responsive and presentable.</p>

<p>Edit:</p>

<p>I am aware of the possibility of manual sync :):</p>

<p>Thanks in advance.</p>",android|long-polling|polling|android-syncadapter,1868569,user1868569,yes
How listen new messages in vk skd?,"<p>I am using vk sdk for my android app. The app can send and receive messages to another users. In order to get the list of messages I used <code>/method/messages.getHistory</code> but how to listen new messages event when another user send me a message? For example in firebase - since it is realtime db we can do it. But how get to know when new message was sent using vk sdk like in realtime? I have an idea to start Service which will check new messages every 5 sec, but I think it is bad solution since it will drain battery etc.</p>",android|android-service|real-time|vk-sdk,1462969,Waran-,yes
Why does my app restart by itself after crash,"<p>Ever since the first release of iOS 8 DP, I've seen strange behaviors of my app on all my testing devices running iOS 8. My app sometimes restarts itself automatically after crashes. In a particular case, the app kept crashing and restarting itself endlessly and drained the device battery rapidly which caught my attention. During the investigation of the battery consumption issue, I added some logic in the application delegate so that each time the app launches, it will append a time stamp to the NSUserDefaults, so that I can know exactly when the app launches. The experiments showed that the app did restart by itself when it crashed, however, it's not reproducible every time it crashes.</p>

<p>I've never read anything from any of Apple's documentations that says an app can restart by itself after a crash. I wonder if anyone have experienced similar issue in their apps. Most importantly, how to prevent the app from draining the battery if it keeps crashing and restarting by itself?</p>",crash|ios8|restart,2596030,utogaria,yes
android implement app work on battery restriction mode,"<p>The quesion is that is it possible to implement my app works on battery restriction mode. If user enable the mode in my settings i don`t use wake lock anymore and more draining battery works.I have read <a href=""https://developer.android.com/training/enterprise/app-restrictions.html"" rel=""nofollow"">this</a> article.</p>",android|battery|restrictions|battery-saver,1597841,nAkhmedov,no
Implement a real-time notification system for an HTML5 Django web app,"<p>I'm currently working on a HTML5 web-app served by Django/apache.</p>

<p>The app's goal is to monitor a couple of devices : all the client-side logic is written with Angular and all the data comes from JSON-based REST-like calls made to the backend (pretty common stuff I assume).</p>

<p>This is working rather well, so far. Now I'd like to implement a notification system: <em>something that would react to external events and would notify all the running web-app instances that something needs to be refreshed on the page</em>. I really don't want all instances to just poll the server because that seems sub-optimal. Especially on mobile devices where this would likely drain the battery quickly.</p>

<p>I have very little experience with this kind of stuff (I'm more of a backend developer, so this is all pretty new to me). I was first thinking of making a long-lived HTTP request from the Javascript side to the server: this request would only give a result after either a timeout period (in which case the client would have to retry and wait again, right away) or after something changed (it would then reply with some information about models that needs to be refreshed).</p>

<p>This seems like it could work in theory, but I figured I'd rather ask first because it seems so common, I would be surprised if no framework existed for this kind of task.</p>

<h3>So my question is: is there a de-facto standard/technology to use in such cases and/or what would you recommend to implement it ?</h3>

<p>The server is running in a VM over which I have a <strong>total control</strong>: meaning I can install whatever software I need to implement that. I'd like to avoid having to use several network ports as much as possible but if it makes things really easier, then it's fine.</p>",javascript|django|html|angularjs|notifications,279259,ereOn,no
Determine Android phone's proximity to known point while conserving power,"<p>I am trying to determine if an Android user has had a close proximity to a list of predetermined locations. I'd like to do this with the least amount of drain on the phone's battery. The two mechanisms I see for accomplishing this are <a href=""http://developer.android.com/reference/android/location/LocationManager.html#addProximityAlert"" rel=""nofollow noreferrer"">proximity alerts</a> and <a href=""http://developer.android.com/reference/android/location/LocationManager.html#requestLocationUpdates"" rel=""nofollow noreferrer"">requesting location updates</a>. What are the pros and cons of the two methods? Will one have less affect on the battery than the other? In either case I would guess the specific <a href=""https://stackoverflow.com/questions/2657766/how-can-reduce-power-usage-in-location-based-application-in-android-how-can-imple/2660337#2660337"">location manager used would have some affect power usage (existing Stack Overflow answer)</a>.</p>",android|battery|proximity|android-location,61654,ahsteele,yes
Android to update geofence regularly,"<p>I am reading through documentation from here. </p>

<p><a href=""https://developer.android.com/training/location/geofencing"" rel=""nofollow noreferrer"">https://developer.android.com/training/location/geofencing</a></p>

<p>It can update me location for my geofence when I run that service. Problem is I need to monitor continuously. So, I am thinking to do timer in my service and check my geofence regularly. But, I think it will definitely drain battery.</p>

<p>I don't want to monitor location and instead, I need android OS to update me whether user goes inside my geofence just like iOS. Is there any way to implement that ?</p>

<pre><code>public class GeofenceTransitionsIntentService extends IntentService {
    // ...
    protected void onHandleIntent(Intent intent) {
        GeofencingEvent geofencingEvent = GeofencingEvent.fromIntent(intent);
        if (geofencingEvent.hasError()) {
            String errorMessage = GeofenceErrorMessages.getErrorString(this,
                    geofencingEvent.getErrorCode());
            Log.e(TAG, errorMessage);
            return;
        }

        // Get the transition type.
        int geofenceTransition = geofencingEvent.getGeofenceTransition();

        // Test that the reported transition was of interest.
        if (geofenceTransition == Geofence.GEOFENCE_TRANSITION_ENTER ||
                geofenceTransition == Geofence.GEOFENCE_TRANSITION_EXIT) {

            // Get the geofences that were triggered. A single event can trigger
            // multiple geofences.
            List&lt;Geofence&gt; triggeringGeofences = geofencingEvent.getTriggeringGeofences();

            // Get the transition details as a String.
            String geofenceTransitionDetails = getGeofenceTransitionDetails(
                    this,
                    geofenceTransition,
                    triggeringGeofences
            );

            // Send notification and log the transition details.
            sendNotification(geofenceTransitionDetails);
            Log.i(TAG, geofenceTransitionDetails);
        } else {
            // Log the error.
            Log.e(TAG, getString(R.string.geofence_transition_invalid_type,
                    geofenceTransition));
        }
    }
</code></pre>",android|geolocation|android-location,1550974,Khant Thu Linn,no
What is the difference between LocationRequest priorities for Android's Fused Location Provider?,"<p>I'm writing an application where battery consumption and location accuracy are critical. I've spent some time researching the differences between the available priorities in the Fused Location Provider available in Google Play Services, but I have not been able to find concrete data on what each setting does exactly.</p>

<p>The <a href=""https://developer.android.com/reference/com/google/android/gms/location/LocationRequest.html"" rel=""nofollow"">LocationRequest API reference</a> provides a brief overview of the expected accuracy and power usage. <a href=""http://blog.lemberg.co.uk/fused-location-provider"" rel=""nofollow"">This website</a> references a <a href=""https://www.youtube.com/watch?v=URcVZybzMUI"" rel=""nofollow"">Google IO presentation</a> which mentions the data sources and an example of battery drain differences between priorities. I am look for more specific information.</p>

<p>Will Balanced never initialize the GPS, on any device, in any situation? Does High Accuracy always use GPS? What is the difference between Balanced and Low Power? If the device has both WiFi and cell network disabled, will Balanced or Low Power ever return a Location?</p>

<p>I have performed tests on multiple devices and compared results between different priorities and Location Providers and discovered some information, but I have no idea how consistent my results will be across phones. I'd like to see more information from Google. I have been unable to find any official information aside from the sources above.</p>

<p>Is there more official information on the differences between LocationRequest priorities?</p>",android|android-location,1472503,Steven Collins,yes
iOS: send heartbeat to the server while phone is locked and the app is on the background/suspended,"<p>I have the task.</p>

<ul>
<li>My iOS app must send heartbeat messages to the server once for every 10 minutes.</li>
<li>iOS app must do this always when the app is not killed (i.e. terminated i.e. removed from task manager) <strong>despite the screen is locked, the app in the background</strong>.</li>
</ul>

<p>I'm trying to do this using ""background location"". But if I use CLLocationUpdate in its' usual mode - I get my battery drained.</p>

<p>Could you help me?</p>",ios|background|location|heartbeat|locked,823048,nickolay,no
"CoreLocation ""significant location changes"" vs. ""region monitoring""","<p>Goal:</p>

<p>I want an app that will give the user a location notification when they are near a location of interest.  (For instance, ""you are within 100ft of XYZ"")</p>

<p>The Core Location documentation stresses that the low-battery-impact way of monitoring location is with <code>-[CLLocationManager startMonitoringSignificantLocationChanges]</code>.  This does not appear to require the app to run with <code>UIBackgroundModes</code>.  </p>

<p>Does the same thing apply for region monitoring?  I want to use <code>[CLLocationManager startMonitoringForRegion:]</code> -- I can't tell from the documentation whether the app has to run in the background to receive geofencing updates.  I want to have as little drain on the user's battery as possible.</p>

<p>Hopefully that makes sense.</p>",ios|core-location|geofencing,244374,Matt H.,no
Cordova/Phonegap wake up app on incoming webrtc phone call,"<p>I have written an audio/video call hybrid app written with cordova/phonegap. I used</p>

<p>1) webrtc for actual streaming of audio or video</p>

<p>2) server sent events (SSE) to listen for incoming calls. <a href=""https://apifriends.com/api-streaming/server-sent-events/"" rel=""noreferrer"">https://apifriends.com/api-streaming/server-sent-events/</a></p>

<p>3) simple-peer <a href=""https://github.com/feross/simple-peer"" rel=""noreferrer"">https://github.com/feross/simple-peer</a></p>

<p>When the app is open, everything goes great, i can receive incoming call signals etc and connect. The problem is that when the app is off. I cannot open app or get any kind of indication of call status.</p>

<p>I decided to do some digging quickly found out that this was not possible from within a webview. I tried some plugins like <a href=""https://github.com/katzer/cordova-plugin-background-mode"" rel=""noreferrer"">https://github.com/katzer/cordova-plugin-background-mode</a> which worked great for some time but would quickly drain the battery and your app may be rejected on appstore notices.</p>

<p>When my app is opened, incoming calls will be correctly captured. all i need is to open the app. I read about background push messages (silent) but failed to get these to open app. The push messages handlers were only called when app is in foreground. </p>

<p>So i finally fell on this doc and its the closest i got with this answer. There is no direct support for background service in Phonegap/Cordova apps.</p>

<blockquote>
  <p>The reason is that your hybrid app is written in JS, and your JS code
  runs in an Activity that has a webview. As soon as you exit your app,
  the app is suspended.</p>
  
  <p>If you really want to have background service in android, you can
  write your Android service in Java (native) and call your service from
  your JS code. (Native for background service &amp; JS for your app)</p>
</blockquote>

<p><a href=""https://forum.ionicframework.com/t/how-to-run-cordova-plugin-in-android-background-service/6677/3"" rel=""noreferrer"">https://forum.ionicframework.com/t/how-to-run-cordova-plugin-in-android-background-service/6677/3</a></p>

<p>From the above, i gather i would have to do the actual logic of detecting incoming calls from the java service and if i detect anything i can force my application to open. Below is simple logic i do once app is open. </p>

<pre><code>if (documentLoaded &amp;&amp; isLoggedIn)
{
//url returns json only if there is an incoming call otherwise empty

var source = new EventSource(""https://www.url.com/api/sse/incomingcall.php?userid="" + userid, {
        withCredentials: true
    });
source.addEventListener(""incomingcalls"", function (event) {
    var callSession = JSON.parse(event.data);
    // HandleIncomingCall();
}, false);
}
</code></pre>

<p>My issue is that i am not a java coder and havent written a plugin before. how would i create an android service that will listen to above url periodically and if detect any json open my app. </p>",javascript|java|cordova|webrtc|phonegap,384894,Sir Lojik,no
How can I download a batch of images using one thread only?,"<p>The app I'm working on, it has many table views and each cell has an image. Problem is that each image is done using a network request and a different thread, so the app ends up using many threads to asynchronously download all the images (in the cellForRowAtIndex method) which results in huge battery drain.</p>

<p>Is there a way I can download them using one thread only, perhaps one after the other? Is there a better way of handling this issue? </p>

<p>What about the framework Kingfisher?</p>",ios|swift|multithreading,7294871,Tarek,yes
Best practices for downloading images in a UITableView's cells? iOS/Swift,"<p>So I had this argument at work about what's better for downloading images in a UITableView's cells.</p>

<p>The two options are:
In the cellForRowAtIndex, I download the image asynchronously which leads to using multiple threads and multiple network requests which we suspect may be the issue for battery drain.</p>

<p>The other option is to download all the images at once using one thread and one network request, by looping through an array with all the images' URLs outside the cellForRowAtIndex of coarse, and then calling the the table view reload function.</p>

<p>There is also a slight modification for latter approach where we can set each image (perhaps by calling the reload function) as soon as each image is downloaded.</p>

<p>So I would love to know, what's the industry standard way of handling this? What are the pros and cons especially when it comes to performance? Are there any better ways?</p>",ios|swift|uitableview|concurrency|uiimageview,7294871,Tarek,no
Android get notification when a person enters or exits a region,"<p>I am new to Android and developing a background service that would track whether the person is inside or outside of certain radius of an area (fixed lat/long coordinates).</p>

<p>Battery is critical and I don't need actual location (coarse location). It is fine if the event is delivered few minutes after the actual entry/exit as I need just one notification for entry and one for exit</p>

<p>I don't want alarm manager to trigger every 10 minutes to check current location as this would drain battery.
Is there a way to achieve this with minimal battery drain and preferably without having the user to turn on GPS (consumes battery)?</p>",android|android-geofence,2107373,user2107373,yes
Android notification when BLE device discovered,"<p>We are working on an Android app that makes GATT connection to BLE devices and writes some characteristics. Our current approach is to scan for devices (startLEScan on Android 4.3 and 4.4. devices and startScan on Android 5.0+) every few seconds and connect to device when discovered. </p>

<p>This solution works but it drains a lot of battery because we need to keep wake locks (or trigger alarm manager every few seconds) for the scanning to work when the phone is in sleep. </p>

<p>Is there an way that Android can notify the app when the BLE device is discovered instead of continuously scanning for devices?</p>

<p>iOS app works great because iOS wakes the app in background when there is any BLE device nearby, which saves a lot of battery. 
Wondering it there is something similar on Android to keep the battery under acceptable limit.</p>

<p>Just for reference, we have also tried the <a href=""https://github.com/AltBeacon/android-beacon-library"" rel=""nofollow"">Alt-Beacon</a> library but found 
that it internally usages alarm manager and if we set alarm manager to trigger every 5 seconds, it consumes 7-8% battery every hour.</p>",android|bluetooth-lowenergy|gatt,2107373,user2107373,no
Wierd and very unexpected issue with location.getAccuracy(),"<p><strong>Problem:</strong> </p>

<hr>

<p>I have tried using the new <code>FusedLocationProviderClient</code> and the deprecated <code>FusedLocationApi</code> to receive location updates on my app using a <strong>Sony Xperia Z2</strong> and <strong>Huawei Honor 8</strong>. Everything works fine initialy. However it seems that after x amount of location requests the accuracy number  <strong>NEVER</strong> drops below 10.0 using <code>location.getAccuracy(); // 10.0</code></p>

<p><strong>What I have tried:</strong></p>

<hr>

<p>Uninstalling and reinstalling the app does no difference. Restarting the phone, same result. Yes I have <code>LocationRequest.PRIORITY_HIGH_ACCURACY</code>... no different result.</p>

<p><strong>What might have worked:</strong> </p>

<hr>

<p>Did a factory reset. Whooppaa suddenly I am now getting numbers below 10.0 as expected with clear conditions outside. But why??</p>

<p><strong>Question:</strong> </p>

<hr>

<p>I suspect the system is limiting my accuracy after x amount of location updates (to save battery???)... What do you guys think? What could possibly be the issue here?</p>

<p><strong>EDIT:</strong></p>

<hr>

<p>After doing a software reset on the phone i was getting accuracy numbers below 10 again initialy. But again after x amount of location updates the accuracy number is limited to 10.0m. I should say that my GPS is designed to run as foreground for up to maybe 3.5 hours at a time. And yes i know it is battery draining.</p>

<pre><code>public class GPSServiceNew extends Service{

    private FusedLocationProviderClient mFusedLocationClient;
    private LocationRequest mLocationRequest;
    private long UPDATE_INTERVAL = 10 * 1000;  /* 10 secs */
    private long FASTEST_INTERVAL = 2000; /* 2 sec */


    @Nullable
    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {

        String test = """";

        return super.onStartCommand(intent, flags, startId);
    }

    @Override
    public void onCreate() {
        super.onCreate();

        mFusedLocationClient = getFusedLocationProviderClient(this);
        startLocationUpdates();

        Intent notificationIntent = new Intent(this, MainActivity.class);

        PendingIntent pendingIntent = PendingIntent.getActivity(this, 0,
                notificationIntent, 0);

        Notification notification = new NotificationCompat.Builder(this)
                .setSmallIcon(R.mipmap.ic_launcher_round)
                .setContentTitle(""My Awesome App"")
                .setContentText(""Doing some work..."")
                .setContentIntent(pendingIntent).build();

        startForeground(100, notification);

    }

    // Trigger new location updates at interval
    @SuppressLint(""MissingPermission"")
    protected void startLocationUpdates() {

        // Create the location request to start receiving updates
        mLocationRequest = new LocationRequest();
        mLocationRequest.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);
        mLocationRequest.setInterval(UPDATE_INTERVAL);
        mLocationRequest.setFastestInterval(FASTEST_INTERVAL);

        // Create LocationSettingsRequest object using location request
        LocationSettingsRequest.Builder builder = new LocationSettingsRequest.Builder();
        builder.addLocationRequest(mLocationRequest);
        LocationSettingsRequest locationSettingsRequest = builder.build();

        // Check whether location settings are satisfied
        // https://developers.google.com/android/reference/com/google/android/gms/location/SettingsClient
        SettingsClient settingsClient = LocationServices.getSettingsClient(this);
        settingsClient.checkLocationSettings(locationSettingsRequest);

        // new Google API SDK v11 uses getFusedLocationProviderClient(this)
        getFusedLocationProviderClient(this).requestLocationUpdates(mLocationRequest, new LocationCallback() {
                    @Override
                    public void onLocationResult(LocationResult locationResult) {
                        // do work here
                        onLocationChanged(locationResult.getLastLocation());
                    }
                },
                Looper.myLooper());
    }

    public void onLocationChanged(Location location) {
        // New location has now been determined
        String msg = ""Updated Location: "" +
                String.valueOf(location.getAccuracy());
        Toast.makeText(this, msg, Toast.LENGTH_SHORT).show();
        // You can now create a LatLng Object for use with maps
        LatLng latLng = new LatLng(location.getLatitude(), location.getLongitude());

        Log.d(""GPS: "", String.valueOf(location.getAccuracy()));
    }

}
</code></pre>",android|android-location|fusedlocationproviderapi|fusedlocationproviderclient,7178053,thelastchief,yes
Marshmallow - iBeacon fine location battery drain,"<p>We are working on an app that needs to scan for iBeacons in background. We did a lot of optimizations and now it works well on Kitkat and Lollipop devices without consuming much battery.</p>

<p>On Marshmallow we require fine location permission to scan for iBeacons (coarse location has delays). This drains a lot of battery even if we have the same battery saving logic in place.</p>

<p>Is there a way that we can release fine location permission when the device is still (no movement) and acquire it when we see a movement? Since the user would have provided the runtime permission at app launch, re-acquiring that permission shouldn't bring the permission dialog again.</p>

<p>If there is way to achieve this, it would help us save the battery drain problem.</p>",android|android-6.0-marshmallow|ibeacon-android,2107373,user2107373,no
Android - update widget over service with data from network. Best approach?,"<p>I have a question regarding Android widgets and especially Android services. Here is what I want to do: On the phone the user should be able to add my widget to his homescreen. The widget gets its data from network.
After reading some tutrials about this, I found out that the best approach would be to create a service that gets the data from network (TCP sockets) and then updates the widget constantly. That is done with ScheduledExecutorService which executes a Runnable in a certain interval. 
The Runnable will connect to a server, get the data and should update the widget).</p>

<p>My problem is now, that the widget don't need to be updated when the screen is off and so the service should not run because of battery drain. My question is: How to do it the best way?</p>

<p><strong>I found 2 approaches which would more or less do what I want:</strong></p>

<ol>
<li><p>When the first instance of the widget is added to homescreen, it will register a Broadcast Receiver that receives the ACTION_SCREEN_ON and ACTION_SCREEN_OFF intent action from Android OS.
If ACTION_SCREEN_ON is fired, it will start the updater service, otherwise it will stop it. But I'm really unsure if that's a good approach because of the broadcast receiver lifetime.</p></li>
<li><p>In the updater service's Runnable, which is executed periodically by the ScheduledExecutorService and actually does the network stuff, I check via PowerManager.isScreenOn(), if the screen is on. If yes, I execute the network code, otherwise not. But what is when the device is in standby? Is this code executed then? What about battery drain here?</p></li>
</ol>

<p>Is there maybe a ""best practice"" approach for what I want to do? I've read alot about the AlarmManager and that it is a very powerful tool. Can you schedule tasks with this in the way, that they are only executed when the display is on?</p>

<p>Thanks for your help.</p>

<p>Best Regards
NiThDi</p>",android|networking|service|widget,547268,NiThDi,no
Battery drain issue with background location service,"<p>My app is used, amongst other features, for tracking drivers doing delivery work, so we need to track the driver's location constantly. For that, we use a Service that runs in the background and saves the coordinates internally before we send them to a server.</p>

<p>The problem is, as is expected, the more precise we need to get, the more the battery drain increases. To the point where Google Play Console Vitals is showing a way above the average number for wake ups like this:
<em>walarm</em>:com.google.android.location.ALARM_WAKEUP_LOCATOR*</p>

<p>I want to know if I'm doing something wrong or if the only way I can improve the code is by doing minor tweaks.</p>

<pre><code>public class LocationService extends Service implements LocationListener {

    private Integer gpsFreqInMillis = 1000 * 10; //10 seconds
    private Integer gpsFreqInDistance = 10; //10 meters
    ...

    public void startUpdatingLocation() {

        ...


        final LocationManager locationManager = (LocationManager) getSystemService(LOCATION_SERVICE);

        try {
            locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, gpsFreqInMillis, gpsFreqInDistance, this);
        } catch (java.lang.SecurityException ex) {
            Log.i(TAG, ""fail to request location update, ignore"", ex);
        } catch (IllegalArgumentException ex) {
            Log.d(TAG, ""gps provider does not exist "" + ex.getMessage());
        }

        try {
            locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, gpsFreqInMillis, gpsFreqInDistance, this);
        } catch (java.lang.SecurityException ex) {
            Log.i(TAG, ""fail to request location update, ignore"", ex);
        } catch (IllegalArgumentException ex) {
            Log.d(TAG, ""gps provider does not exist "" + ex.getMessage());
        }

    }

    ...

    @Override
    public void onLocationChanged(final Location newLocation) {
        //saves location in internal database
    }

}
</code></pre>

<p>Is there a way I can track a precise location without killing my user's battery? I know I can change the min distance and min time values, but 10m/10s is the most precise option we offer.</p>",android|geolocation|battery,7536450,Rafael Silva,no
How to check if Google Maps is running in the background?,"<p>I have Google Maps installed on my phone and it is usually fully stopped, because I don't want it to always run in the background, since I believe that it is draining the phone battery.</p>

<p><strong>My question is regarding the actual status of the Google Maps app or service.</strong></p>

<p>If you check an app's info there is a button ""Force stop"". I believe that it is only activated (meaning you can click it) when the app is somehow running.
I noticed that the Google Maps app seems to get started in some way from time to time in the background, because the button gets enabled regularly.</p>

<p>However there is no such entry in the ""Running"" section for the list of apps in the android settings.
Does someone know whether it is running or not if the button is enabled? Is there some way to check this by code? Is it supposed to be a service or an app?</p>

<p>I have tried using the getRunningAppProcesses and getRunningServices methods of the ActivityManager class, but can't find any entry that would correspond to the Google Maps app. So I guess it is hidden from the user?!</p>",android|google-maps,4090002,Marcell,no
android - Most effective way to inconspicuously waste battery,"<p>I was wondering, what is the best way to inconspicuously waste battery?</p>

<p><code>Vibration</code> - very conspicuous.<br>
<code>Brightess</code> - conspicuous, only drains battery well when the screen is turned on.<br>
<code>Background data</code> - do random things with background data, such as loading a map and constantly refreshing it in the background. Seems like a good, inconspicuous way.</p>

<p>My question is: What is the most effective and inconspicuous way to drain the user's battery? Currently, I feel that something like the <code>Background data</code> thing would be the best, but is there any very good way that I did not think of?</p>

<p>Thank you!</p>

<p><strong>Information:</strong> I do not actually plan on using this in an application. I am just curious.</p>",android|background-process|battery|batterylevel,4307878,MarkusWillson,yes
How should I approach updating my widget?,"<p>I just created my first ever widget and it all went well until I got to the part where I'm supposed to set when it updates. Here's my code to make my question clear:</p>

<p>Android Manifest:</p>

<pre><code>&lt;receiver android:name=""com.whizzapps.stpsurniki.widget.UrnikWidget""&gt;
        &lt;intent-filter&gt;
            &lt;action android:name=""android.appwidget.action.APPWIDGET_UPDATE"" /&gt;
        &lt;/intent-filter&gt;
        &lt;meta-data 
            android:name=""android.appwidget.provider""
            android:resource=""@xml/app_widget_info""/&gt;
    &lt;/receiver&gt;
</code></pre>

<p>App Widget Provider XML:</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;
&lt;appwidget-provider xmlns:android=""http://schemas.android.com/apk/res/android""
    android:minWidth=""80dp""
    android:minHeight=""40dp""
    android:updatePeriodMillis=""10""
    android:initialLayout=""@layout/app_widget""
    android:widgetCategory=""home_screen"" &gt;
&lt;/appwidget-provider&gt;
</code></pre>

<p>AppWidgetProvider class:</p>

<pre><code>public class UrnikWidget extends AppWidgetProvider {

@Override
public void onUpdate(Context context, AppWidgetManager appWidgetManager,
        int[] appWidgetIds) {
    super.onUpdate(context, appWidgetManager, appWidgetIds);

    Log.i(""TAG"", ""onUpdate"");
    }
}
</code></pre>

<p>I have created a simple widget with a TextView in it that displays a certain word, it has no logic at all yet since I'm still learning how to work with widgets. As you can see I made a log.i to see when onUpdate is actually called and my problem is that it is only called the first time I put the widget on my home screen.</p>

<p>I know that update interval of 10 milliseconds is too low and should not be used because of battery drain but I'M USING 10ms just for testing purposes. </p>

<p>Why does onUpdate only executes once instead of every 10ms? And what would be the best way for me to update widget if I need it updated at certain hours only? Let's say I only need my widget to be updated at 7AM, 8AM and 3PM. Is this possible? Thank you!</p>",android|android-widget|widget|onupdate,2454356,Guy,yes
"Http or TCP/IP socket, which is better for Android app?","<p>Before ask my question, I want to let you know what stage I am on. I have already implemented TCP/IP socket on my android app, it works fine(so far...).The connection between client(my android app) side and server side is <code>short connection</code> which is when a user submit information, a new thread will be created to send the message out, on the server side, once the server got the message, the server will respond ""RCVD"", after that the socket will be closed and then the connection is closed. My app has a lot of interactions between user side and server side, therefore it does many <code>connect</code> and <code>disconnect</code> between clients and server, so I always worry about the socket communications will drain phone battery and the performance will be affected.</p>

<p>Recently I find <code>OkHttp</code> on github and a lot of people suggest using it. Im not quite familiar with Http, only knows it is a higher level network protocol. </p>

<p>Can anyone tell me which way is better? which is more efficient for exchanging data(Object/Json/String) and media(Images)? Which is more faster and which use less battery?</p>

<p>Many thanks.  </p>",android|sockets|http,1735756,Haifeng Zhang,no
Device not fetch locations inside Closed Area,"<p>My Application requires to update locations to the Server Continuously so that it gets notifications of any nearby places. </p>

<p>I have written a background Service to run location services and update locations to server.  Everything works fine but the thing is when I am inside a Closed Area(example I am inside my home), It is unable to fetch location and location services running continuously which is draining device battery.</p>

<p>When I test it under sky, it works perfect. I will remove updates for sometime when I got a location update and start fetching again.</p>

<p>if anyone has come across this kind of issue, help me in this regard.</p>

<p>Thanks In Advance</p>",android|service|gps,1649309,TNR,yes
Google Cloud Messaging and less battery drain,"<p>I've heard that GCM provides less energy consumption.How does GCM provide higher battery life exactly? What is the difference with GCM?</p>

<p>It is said that server sends a message to app when there is something to get.So app doesnt have to check the server everytime. </p>

<p>But now, app is still have to check for that message?</p>",google-cloud-messaging,1624935,user1624935,no
Android start running JobScheduler at specific time,"<p>I want to start a JobScheduler at a specific time <strong>everyday</strong>, and finish it after 3 hours. </p>

<p>I have the part of triggering the job every 20 min, and for 3 hours, but in JobInfo.Builder class there's no option for starting the job at an exact time.</p>

<p>Going over the <a href=""https://developer.android.com/reference/android/app/job/JobInfo.Builder.html"" rel=""noreferrer"">JobInfo.Builder</a> class overview, there's nothing there that sets the time for starting a JobScheduler.</p>

<p>Obviously, i don't want to run it for the whole day, and check that the time matches, this will drain more battery than needed, and is bad programing.</p>

<p><strong>I was thinking of making an alarm to run at the time i specify and would trigger this job, but this seems to be a bit overkill.</strong> </p>

<pre><code> JobInfo.Builder builder = new JobInfo.Builder(NIGHT_SYNC_JOB_ID, 
 new ComponentName(context, NightSyncDataJobService.class));

 //Job starts at 11pm, and ends at 2am. Running every 20 minutes.
 builder.setPersisted(true); //Job scheduled to work after reboot
 builder.setPeriodic(Consts.ONE_MINUTE * 20);

 JobScheduler jobScheduler = (JobScheduler) context.getSystemService(Context.JOB_SCHEDULER_SERVICE);
 jobScheduler.schedule(builder.build());
</code></pre>

<p>If you have any other solution to the issue, beside AlarmManger that triggers this JobScheduler, will be much appreciated. </p>",android|android-alarms|android-jobscheduler,5130239,Dus,yes
App is running notification is displayed all the time,"<p>I am building an android application that always shows the ""App is running"" notification, which leads to battery drain. If I force quit the app or turn off notification from settings, I stop receiving any other notifications. </p>

<p>Any help on fixing this.</p>",android|performance,2400480,User am,yes
Efficient use of LocationManager in Android,"<p>I am trying to optimise an Android application which must achieve the following:</p>

<ul>
<li><p>Every hour, retrieve the GPS location and doSomeWork()</p></li>
<li><p>At any other time if the device moves more than @MINIMUM_DISTANCE, increase update frequency to something like 5 minutes to log the movement, when movement ends we can return to the hourly updates.</p></li>
</ul>

<p>Now, AlarmManager firing every hour works a treat for the first requirement. It's a fine battery efficient method of accomplishing this task. However I'm unsure how to best accomplish the second requirement.</p>

<p>Should I:</p>

<ul>
<li><p>Register an AlarmManager which fires every 5 minutes in tandem with the hourly timer? Register LocationManager each time and attempt to pull off a location, compare to previous location to determine whether movement has occurred.</p></li>
<li><p>Register a LocationManager after my hourly wakeup with a minimum distance parameter equal to my required minimum movement.</p></li>
<li><p>Something else?</p></li>
</ul>

<p>I can see pros and cons to each approach.</p>

<p>Using the LocationManager minimum distance parameter seems to me to be the more concise solution but I'm concerned about battery drain, will this keep the GPS running hot the whole time regardless of whether my application is receiving updates? I am also not sure where the best place to register the receiver would be, I understand it's poor practice (not to mention nigh impossible) to keep a service running 100% of the time.</p>

<p>Yes I am new to Android! About to go and test the behaviour of LocationManager.</p>

<p>Thanks in advance.</p>",android|gps|broadcastreceiver|locationmanager,279448,Dan Wray,yes
Keep active service VPN in background android Java,"<p>i have a VPN andrord app Code but when i lock the screen the app disconnects at 3 or 4 minutes after It.
I tried implementing a partial wakeLock and It works but drains much battery and it only works for few hours, i tried disabling optimization mode option but nothing... it only happens when i lock the screen. if i use the app all day it doesn't reconnect and works nice.</p>
<p>This is my start service intent</p>
<pre><code>public class TunnelManagerHelper{
    public static void startSocksHttp(Context context) {
        Intent startVPN = new Intent(context, SocksHttpService.class);
        
        if (startVPN != null) {
            TunnelUtils.restartRotateAndRandom();
            
            if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O)
            //noinspection NewApi
                context.startForegroundService(startVPN);
            else
                context.startService(startVPN);
        }
    }
    
    public static void stopSocksHttp(Context context) {
        Intent stopTunnel = new Intent(SocksHttpService.TUNNEL_SSH_STOP_SERVICE);
        LocalBroadcastManager.getInstance(context)
            .sendBroadcast(stopTunnel);
    }
}
</code></pre>
<p>My service Code is so extends so i can't post It here.</p>",java|android|vpn,17837064,Martin colm,yes
IOS Local Notification at specific time,"<p>Below is what I am trying to achieve.
Show local notification to the user about say sunrise/sunset time.
Say sunrise time is at 05:30AM and sunset time at 06:30PM.
Current time is 07:00PM, when the user enables the notification feature then every one hour show
sunrise notification with info time left for sunrise ( that is x hours and y mins left)
Once the time left for sunrise is less than 60 mins, then change the interval from one hour to say 10 mins. Finally when the time left for sunrise is less than 10 mins, then show notification for every minute. When the time for sunrise is reached repeat the same for sunset. This goes on till the user disable this feature via app settings.</p>
<p>Showing a countdown timer is also fine with in a notification if that doesn't drain the battery.</p>
<p>What I have achieved is fire a local notification at a specific time. Appreciate any guidance. I am new to IOS development.</p>
<pre><code>let center = UNUserNotificationCenter.current()
      let content = UNMutableNotificationContent()
      content.title = title
      content.body = body
      content.categoryIdentifier = &quot;sdf&quot;
      
      if let info = userInfo {
        content.userInfo = info
      }
      
      content.sound = UNNotificationSound.default()
      
      var comp = Calendar.current.dateComponents([.hour, .minute], from: date)
      comp.minute = comp.minute! + 2
      
      let trigger = UNCalendarNotificationTrigger(dateMatching: comp, repeats: false)
      
      //let request = UNNotificationRequest(identifier: UUID().uuidString, content: content, trigger: trigger)
      
      let request = UNNotificationRequest(identifier: &quot;test&quot;, content: content, trigger: trigger)
      
      center.add(request)
</code></pre>",ios|background|repeat|uilocalnotification|countdowntimer,7923782,tanni tanna,no
Compare performance of using LocalBroadcastManager and Otto,"<p>I'm trying to compare performance of using <code>LocalBroadcastManager</code> and <code>Otto</code> in Android. As I know, Otto is using annotation and Java reflection, so it may have some impacts on performance. Can someone suggest me something to do to measure performance of these two ways? Which drain the battery?</p>",android|otto|localbroadcastmanager,1728512,congtrungvnit,yes
Using temporary location when connection not available and/or power failure,"<p>I have an internal php web app that runs in browser and is simply a sort of todo/meeting notes recorder(the data may be used by different apps).</p>

<p>The app uses an background autosave feature (js/ajax/php), but that obviously works only with internet connection. Moreover I found myself in situation when my battery drained sooner than I could reach signal or a power socket. Then all data was lost :(</p>

<p>I am considering switching the backup feature to js/localStorage and check periodically for server availability and save online then(erase localStorage). I was googling for other options and only Google Filesystem API shows as an alternative, albeit probably being phased out?</p>

<p>My question is - since the data may contain sensitive information, would you consider storing the data using localStorage ""safe"" in regards to user access? The devices the app is used on are password+fingerprint protected, but since different OS and Browser combinations store the localStorage data in various locations, I am worried a different user could perhaps get to that data... (device theft/loss)</p>

<p>Or is encryption the only way?</p>

<p>thank you for your ideas.</p>

<p>Alexander</p>",javascript|php|local-storage,2462875,Alexander,no
Using WakeLock versus AlarmTimer in 10 hour background service,"<p>I have a background service that runs for a period of about 10 hours. During this period it acquires information from one of the phone's sensors (about 300 TIMES PER SECOND), processes the information, and uploads the processed information to a database file (about every 15 SECONDS).</p>

<p>I have already implemented foreground but the service still shuts down after a few hours.</p>

<p>Before I transferred this process to a service it was in an activity. I had to keep the screen on for 10 hours during the process and it worked with about a 50% drain on battery.</p>

<p>What would be best for performance and then for battery? Implementing WakeLock or AlarmTimer in the background service.</p>

<p>Please don't suggest things like use a power cable because it wouldn't fit the parameters of my app and I really dont need to if I only got a 50% drain on battery with the screen on.</p>

<p><strong>I just need to know what would be the best way to keep the CPU alive so the service doesn't get killed</strong></p>",android|service|wakelock|android-wake-lock|background-service,3211265,LousDColeman,yes
Locationservices dont stop even when app is killed,"<p>I have an app which is using CLLocationManager in background and in foreground Mapkit to show the users location. I have no BackgroundModes activated. So if my app goes in background I stop show user Location with [mapview setShowsUserLocation:NO]. And in appDelegate I start LocationManager and stop it every 30s with [locationManager startUpdatingLocation] and [locationManager stopUpdatingLocation] (no worries about battery drain in this moment) to get the user location in Background. So lets say the locationManager is 5seconds on and 25seconds off. This 25 seconds the location services indicator should be away, right? But it isn't. Even if I didn't tell the LocationManager to Start the indicator is there all the time. Killing the app doesn't help, only to turn location services off in the settings. But if I turn it back on then the indicator will be there again all the time.</p>

<p>I tried everything in different posts even in these: 
<a href=""https://stackoverflow.com/questions/4872055/locationservice-indicator-stays-on"">Locationservice Indicator stays &quot;on&quot;</a>
<a href=""https://stackoverflow.com/questions/7413066/location-services-dont-stop-when-application-is-terminated"">Location services don&#39;t stop when application is terminated</a></p>

<p>And I'll never call locationManager=nil or release it.
So crazy.. can everybody help me pls?</p>

<hr>

<p>Update: So this drives me really crazy. Stuck on this since couple of days. And only tested it on my real iPhone. Now I tried it with iPad and iPhone Simulator and on both devices it is as I expected to be: 5 seconds the indicator is on and 25 seconds the indicator is away, when app is in background. So is it a bug on my real phone or do anybody have some suggestions? I have 5.1.1 on it and a jailbreak but this should not affect it!?</p>

<p>Thanks for any help :)</p>",xcode|service|location|mapkit,1494178,mojo,yes
What to use for realtime data?,"<p>I am building an app in which I want to monitor sound loudness by using the SoundMeter. See <a href=""http://code.google.com/p/android-labs/source/browse/trunk/NoiseAlert/src/com/google/android/noisealert/SoundMeter.java"" rel=""nofollow"">link</a>.</p>

<p>But what the <code>getMaxAmplitude()</code> does is returns the amplitude value only when called.</p>

<p>Now I only need to get the value constantly in realtime(maybe a slight dealy. max 1s) and show it in a textview. But I am confused how to call the method properly.
Should I use :</p>

<ol>
<li>Timer task</li>
<li>Asynctask with timer</li>
<li>Service or IntentService</li>
<li>AlarmManager</li>
</ol>

<p>And please also mention how to call the method.</p>

<p>Please keep in mind that data gathering may run for a very long time. So I don't want to drain battery.</p>",android|service|timertask,5806666,0x5050,yes
Android FusedLocationProvider and battery life,"<p>I've found
<a href=""https://stackoverflow.com/questions/18768048/priority-low-power-vs-priority-balanced-power-accuracy-for-google-play-service-v"">several</a>
<a href=""https://stackoverflow.com/questions/26874080/android-fused-location-with-balanced-profile"">different</a>
<a href=""https://stackoverflow.com/questions/25797756/what-is-the-difference-between-locationrequest-priorities-for-androids-fused-lo"">SO</a>
<a href=""https://stackoverflow.com/questions/26210286/get-android-location-without-google-play-location-services-turned-on"">posts</a>
on conserving battery life with Android's
<a href=""https://developer.android.com/reference/com/google/android/gms/location/FusedLocationProviderApi.html"" rel=""nofollow"">FusedLocationProvider</a> API.</p>

<p>What I'm looking is a way to intelligently select the most location accurate provider, given the state of the host's battery and some knowledge of the power drain of each one (e.g. something like <a href=""http://blog.lemberg.co.uk/fused-location-provider"" rel=""nofollow"">this</a>). In other words, if the battery is nearly dead (for some predetermined value of ""nearly""), the service would ideally know to avoid GPS, since that burns a lot of power, and instead use either CellID or WiFi. But I don't see anything in the FusedLocationProvider documentation along these lines.</p>

<p>Is there a way to do something like this with an existing API call, or would I need to roll this myself? Thanks in advance for any pointers.</p>",android|performance|location|android-location|power-management,4322439,Jim,no
Android Background Service Limitation : FileObserver in Service or use Scheduler?,"<p>I need to implement fileObserver in background, so if new file arrives in observed directory, a notification will have to be triggered. Considering the background limitation implemented from Oreo, easiest option is just to launch fileObserver in foreground service (with notification) and keep listening. However this will keep my app in battery drainers list and I would prefer avoiding adding notification all the time.
Another solution is to implement scheduler in workmanager, but this will need me reading the whole directory very frequently ( in every minute or even less time) just to identify if any new file has arrived. This means I will avoid using fileObserver but will keep consuming precious resource unnecessarily every minute.</p>

<p>I am hoping if someone could suggest if there is any other more efficient way to implement the functionality of fileObserver guaranteeing the functionality but keeping the resource usage at the least.</p>",android|android-service|scheduler|android-workmanager|fileobserver,2757043,userabc55478,no
How to handle continuos recording of user geo-points in Android even with screen off?,"<p>I have an app which is recording the position of the user continuously. <em>The location updates are to be very frequent to get an exact mapping of the route the user has taken.</em> To keep the application recording the geo points when the phone falls asleep I use a wake lock which is released when the user stops the recording or in <code>onDestroy()</code>. </p>

<p>I now realize I am not removing the location listener from the location manager. This leads to the battery draining if the user forgets to press the ""stop recording route"" button before leacing the application. My initial thought was to remove it in <code>onPause()</code> but then I'm afraid <code>onPause()</code> might get called when the screen turns off although I have a wake lock (but not screen on).</p>

<p>My questions in this matter are:
When should I remove the location listener from the location manager?  Should I release the listener i <code>onDestroy()</code>? Or perhaps I do not need a wake lock at all as long as I am listening to the location manager? How should this be handled if so?</p>

<p>I've seen this discussed in other places like here:
<a href=""https://stackoverflow.com/questions/3814852/android-when-using-locationmanager-requestlocationupdates-do-i-need-a-wakeloc"">Android - When using LocationManager.requestLocationUpdates, do I need a WakeLock?</a></p>

<p>But there doesn't seem to be an absolute answer.</p>",android|android-location|android-wake-lock,1068167,span,yes
How to cleanly shut down an Android paho MQTT service?,"<p>I have an Android paho MQTT client that listens for sensor data and alerts the user in case of any threshold violation. 
I have the following in my app.gradle :</p>

<pre><code>implementation 'org.eclipse.paho:org.eclipse.paho.client.mqttv3:1.1.0'
implementation 'org.eclipse.paho:org.eclipse.paho.android.service:1.1.1'
</code></pre>

<p>I register it as a service in the manifest:</p>

<pre><code>&lt;service android:name=""org.eclipse.paho.android.service.MqttService"" /&gt;
</code></pre>

<p>The service receives MQTT messages even when the app is not in the foreground.</p>

<pre><code>MqttConnectOptions options = new MqttConnectOptions();
options.setAutomaticReconnect(true);
options.setCleanSession(false);
client.connect(options);
</code></pre>

<p>My worry is, the phone battery will drain fast due to constant background syncing with the MQTT broker. So I want to unsubscribe, and disconnect from the server at the end of the day. I would prefer to discard all the messages that were received during the night.</p>

<p>Can someone please point me to a tutorial on how to do this correctly ? Just calling <code>client.disconnect()</code>
results in multiple subscriptions and duplicate messages when I connect the next time. There must be a clean way to shut down and restart the service. Please suggest.</p>",android|mqtt|paho|disconnect,1952852,Raja,no
Android Live Wallpaper Animation,"<p>What's the best way to display an animation as a live wallpaper? Right now I have a gif split into 11 pngs (one per frame) and then I just am doing</p>

<pre><code>public Bitmap frame0;
ArrayList&lt;Bitmap&gt; frameArray = new ArrayList&lt;Bitmap&gt;();
frame0 = BitmapFactory.decodeResource(getResources(), R.drawable.nyancat0);
frame0 = Bitmap.createScaledBitmap(frame0, minWidth, minHeight, true);
frameArray.add(frame0);
</code></pre>

<p>Then I just use a For Loop to loop through the frames and draw them on a canvas</p>

<pre><code>canvas.drawBitmap(frameArray.get(indexnumber), 0, 0, mPaint);
</code></pre>

<p>and then I just change my indexnumber++ unless it's 11, then I go back to 1.
That works, but of course, storing that many Bitmaps is very memory inefficient. This stops me from doing multiple layers or other cool effects without lagging and battery drain. Is there a better way to display an animation on the Android Live wallpaper? I tried Movie for displaying the whole GIF but that's not supported for live wallpapers.</p>",android|live-wallpaper,1122490,NightmareApps,no
Firebase Cloud Messaging and battery draining on not-used apps,"<p>I have noticed that my apps do big battery drain (about 15% for example) sometime according to battery stats even if it was not used (0 foreground time and 0 background time). It happens even in doze when I sleep and background restrictions doesn't help. The common thing in those apps is FCM. </p>

<p>I have checked them with optimizer and every thing looks normal.
Is that possible that FCM drains battery or could it be system stats mistake?</p>

<p>I observed it with apps like 9gag, reddit too. I think they could use FCM.
Is that any way to see some detailed battery stats?
I use Pixel 3a - Android 10.</p>",android|firebase|firebase-cloud-messaging|android-background,1604309,Mateusz Kaflowski,yes
Is there anyway I can send SERIAL-USB data thru a HDMI port?,"<p>I have been working on a project where our Android tablet has only 1 microUSB port.</p>

<p><img src=""https://i.stack.imgur.com/8GD5G.jpg"" alt=""enter image description here""></p>

<p>Since we must communicate via serialUSB with an external device, it became a little fuzzy after we noticed that leaving the tablet powering the bus (Host Mode) drains it`s battery till death. Moreover, we still must supply enough energy to power the tablet.</p>

<p>After a lot of attempted fails, such as <code>using a OTG-Y cable</code>, modifying <code>Kernel Battery Config</code> and using a <code>USB Hub</code>, I need to discover a way to perform the communication and keep the tablet charging.</p>

<p>Thought about using the HDMI or even the audio/serial. Is there any solution I can look forward to solve this?</p>

<p>At this point, I'm getting out of ideas.</p>",android|usb|battery|usbserial|hdmi,1549700,Machado,yes
Core Bluetooth API Misuse When Scanning,"<p>I am currently getting an API misuse error when scanning - I know exactly why this happens because I need to wait to verify that the state of the central manager is powered on.</p>

<p>My question comes from when my application is terminated by the system to free up memory. I imitate this by running a SIGKILL command on my app, but I am getting the API Misuse error as I try to queue up a scan for the future. </p>

<p>What should I be doing? I don't want to set up a pending connect command either as that will drain the battery of my peripheral too quickly. I want it to scan and then connect if the user agrees (which I have set up using notifications).</p>

<p>Thanks.</p>",ios|bluetooth|core-bluetooth|cbperipheral,3854397,Eric Gao,no
Linux swapper (process 0) could drain battery?,"<p>I add some debug messages to find which process could lead the battery drain.</p>

<p>If current mode is flight mode , there are only few processes that could wake up the system.</p>

<p>On the other hand , there are a lot of rtc alarms triggered by swapper process to wake up the system and may drain battery , if current mode isn't flight mode.</p>

<p>Therefore , i am confused with swapper process. What situation can lead the swapper process to set a lot of wake up alarms ?</p>

<p>Thanks!</p>",android|linux-kernel|smartphone|battery-saver,3365407,user3365407,yes
Cordova iOS app using IndexedDB database size calculation without crashing app,"<p>I have a cordova app for iOS in which I'm using indexedDB to store significant amounts of data in separate stores in one database.</p>
<p>I want to inform the user of the amount of space being used by the app in this way, partly as the limit for indexedDB seems to be unclear/different on different devices, and I'd like to use it to see where the usage is at at point of failure, and also as a way to warn the user that they need to manage the data they're storing offline before it becomes a problem (although I know I can capture this is the transaction abort event - I just have no idea what the limit is!)</p>
<p>In development I've been using the function below in the browser (I have the browser platform added, just for development) which has worked well:</p>
<pre><code>function showIndexedDbSize(db_name) {
    &quot;use strict&quot;;
    var this_db;
    var storesizes = new Array();

    function openDatabase() {
        return new Promise(function(resolve, reject) {
            var request = window.indexedDB.open(db_name);
            request.onsuccess = function (event) {
                this_db = event.target.result;
                resolve(this_db.objectStoreNames);
            };      
        });
    }

    function getObjectStoreData(storename) {
        return new Promise(function(resolve, reject) {
            var trans = this_db.transaction(storename, IDBTransaction.READ_ONLY);
            var store = trans.objectStore(storename);
            var items = [];
            trans.oncomplete = function(evt) {
                var szBytes = toSize(items);
                var szMBytes = (szBytes / 1024 / 1024).toFixed(2);
                storesizes.push({'Store Name': storename, 'Items': items.length,  'Size': szMBytes + 'MB (' + szBytes + ' bytes)'});
                resolve();
            };

            var cursorRequest = store.openCursor();
            cursorRequest.onerror = function(error) {
                reject(error);
            };
            cursorRequest.onsuccess = function(evt) {                   
                var cursor = evt.target.result;
                if (cursor) {
                    items.push(cursor.value);
                    cursor.continue();
                }
            }
        });
    }

    function toSize(items) {
        var size = 0;
        for (var i = 0; i &lt; items.length; i++) {
            var objectSize = JSON.stringify(items[i]).length;
            size += objectSize * 2;
        }
        return size;
    }

    openDatabase().then(function(stores) {
        var PromiseArray = [];
        for (var i=0; i &lt; stores.length; i++) {
            PromiseArray.push(getObjectStoreData(stores[i]));    
        }
        Promise.all(PromiseArray).then(function() {
            this_db.close();
            console.table(storesizes);
        });
    });
};
</code></pre>
<p>It works well on the device too when the stores total &lt;150MB, or thereabouts (there isn't a clear threshold), but it uses JSON.stringify to serialize the objects in order to count the bytes, and the process of doing this as the database grows larger on the device forces the app to restart. I'm watching the memory usage in XCode and it doesn't peak at all. Nothing. It hovers between 25 and 30MB whatever you do, not just this, which seems ok to me. The CPU is also &lt;5%. The energy usage is high, but I'm not sure this would affect the app negatively, just drain the battery faster (unless I've misunderstood something). So I'm not sure why it's forcing an ugly restart. In my endless googling I've learnt that JSON.parse and JSON.stringify are very hungry processes, which is why I switched to indexedDB in the first place as it allows the storage of objects, avoiding these processes entirely.</p>
<p>My questions are as follows:</p>
<ol>
<li>Is there a way to amend the function to slow it down (it doesn't need to be fast, just reliable!) to prevent the restart?</li>
<li>Why would the app refresh if there is not discernible pressure on the memory in XCode? Or is this not a very good way of detecting this sort of thing? Is there some hidden garbage collection problem in the function (I'm a noob when it comes to GC generally, but there doesn't seem to be any leaks in the app)</li>
<li>Is there a better way to show the usage of the database that would avoid this problem? Everything I find always relies on these JSON processes and the navigator.storage Web API doesn't appear to be supported on the cordova iOS platform (which is a real shame as it works amazingly on the browser! Gah!)</li>
</ol>
<p>Any suggestions/thoughts massively appreciated!</p>",javascript|cordova|indexeddb,1170039,Helen Danger Burns,no
SignalR - client connection management manually by server,"<p>I'm using signalR for having alive connection between clients and webapis in the server. we have a lot of groups in which there are 3 types of clients. android app, web app and raspberry device (IoT) and they have to keep a specific status updated all the time (immediately after status changed in the database) and check server for get and post commands and responses.</p>
<p>But i think having alive connection (websocket) all the time will drain battery of raspberry. so i think if there is a solution for handle clients connections manually in an arbitrary time schedule.</p>
<p>So can i open and close connection of clients from server (hub) in the arbitrary time schedule and repeat it every day?</p>
<p>For example , i want open the connection of a group of clients from 3 to 5 (pm) and after that i want just open connection every 5 minutes and keep it alive for 1 second. and repeat it.</p>
<p>Maybe it seems stupid but i want signalR in scheduling time span. is there a better way?</p>",c#|websocket|connection|signalr,3142147,Bahar_Engineer,yes
BlueZ remote device presence,"<p>Using <a href=""http://www.bluez.org/"" rel=""nofollow noreferrer"">BlueZ</a>, which</p>

<blockquote>
  <p>is the official Linux Bluetooth stack</p>
</blockquote>

<p>I'd like to know which of the below two methods are better suited for detecting a device's presence in the nearby.
To be more exact, I want to periodically scan for a Bluetooth device (not BLE => no advertisement packets are sent).</p>

<p>I found two ways of detecting it:</p>

<p>1.) Using l2ping</p>

<pre><code># l2ping BTMAC
</code></pre>

<p>2.) Using hcitool</p>

<pre><code># hcitool name BTMAC
</code></pre>

<p>Both approaches working.</p>

<p>I'd like to know, which approach would drain more battery of the scanned device?</p>

<p>Looking at solution #1 (<a href=""https://github.com/pauloborges/bluez/blob/master/tools/l2ping.c"" rel=""nofollow noreferrer"">l2ping's source</a>):</p>

<p>It uses a standard socket <code>connect</code> call to connect to the remote device, then uses the <code>send</code> command to send data to it:</p>

<pre><code>send(sk, send_buf, L2CAP_CMD_HDR_SIZE + size, 0)
</code></pre>

<p>Now, <code>L2CAP_CMD_HDR_SIZE</code> is 4, and default <code>size</code> is 44, so altogether 48 bytes are sent, and received back with <code>L2CAP_ECHO_REQ</code>.</p>

<p>For hcitool I just have found the entrypoint: </p>

<pre><code>int hci_read_remote_name(int dd, const bdaddr_t *bdaddr, int len, char *name, int to);
</code></pre>

<p>My questions:</p>

<ul>
<li>which of these approaches are better (less power-consuming) for the remote device? If there is any difference at all.</li>
<li>shall I reduce the l2ping's size? What shall be the minimum?</li>
<li>is my assumption correct that <code>hci_read_remote_name</code> also connects to the remote device and sends some kind of request to it for getting back its name?</li>
</ul>",bluetooth|bluez,1446710,Daniel,no
Is it possible to detect the user's moving activity on the background?,"<p>I want to develop an app that detecting the user's moving way (walking, cycling, driving etc...) and send a specific <code>UILocalNotification</code> for each activity type.</p>

<p>My question is: is it possible to detect it on the background (when the app is completely closed) without draining the device's battery? What will be the best way to do it?</p>

<p>Thank you!</p>",ios|objective-c|swift|algorithm|cocoa-touch,6773245,FS.O6,yes
Read data from socket if new data arrives in Android,"<p>I have an application that communicates to server. I want my application to READ ONLY the socket's inputstream when NEW DATA is available for fetching.</p>

<p>Currently, I create a timer that scheduled for the reading of socket's inputstream every 20ms(polling) using SocketChannel class of java.nio.channels. This is not that good because it will end up of reading the socket even if there's no available data. And it drains the battery fast.</p>

<p>Is there an API for Android that will tell or send a flag to the connected client whenever a new data is available so that it is the only time I will read the inputstream?</p>",android|sockets|timer|inputstream,759684,Khushbu Shah,no
Will Google Firestore always write to the server immediately in a mobile app with frequent writes?,"<p>Is it possible to limit the speed at which Google Firestore pushes writes made in an app to the online database?</p>

<p>I'm investigating the feasibility of using Firestore to store a data stream from an IoT device via a mobile device/bluetooth. </p>

<p>The main concern is battery cost - receive a new data packet roughly two minutes, I'm concerned about the additional battery drain that an internet round-trip every two minutes, 24hrs a day, will cost.  I also would want to limit updates to wifi connections only.</p>

<p>It's not important for the data to be available online real-time. However it is possible for multiple sources to add to the same datastream in a 2-way sybc, (ie online DB and all devices have the merged data).</p>

<p>I'm currently handling that myself, but when I saw the offline capability of Datastore I hoped I could get all that functionality for free.</p>

<p>I know we can't directly control offline-mode in Firestore, but is there any way to prevent it from always and immediately pushing write changes online?</p>",firebase|google-cloud-firestore,1930712,FrozenKiwi,no
SCREEN_OFF Broadcast Receiver not firing inside of Service in separate process,"<p>Here is my stuff:</p>

<pre><code>public class NotificationSystem extends Service implements Runnable {

    private final Thread worker = new Thread(this);
    private boolean alreadyRunning = false;

    @Nullable
    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public void onCreate() {
        super.onCreate();
        IntentFilter filter = new IntentFilter();
        ScreenManager screenManager = new ScreenManager();
        filter.addAction(Intent.ACTION_SCREEN_OFF);
        registerReceiver(screenManager, filter);
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        if (!alreadyRunning) {
            worker.start();
            this.alreadyRunning = true;
        }
        return START_STICKY;
    }

    @Override
    public void run() {

        while(true) {

            System.out.println(""Thread doing stuff"");

            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }

    }

    private static class ScreenManager extends BroadcastReceiver {

        @Override
        public void onReceive(Context context, Intent intent) {
            System.out.println(""Screen is off"");
        }
    }

}
</code></pre>

<p>The broadcast receiver never fires when the screen toggles off, why?</p>

<p>Is there some problem if there is that broadcast receiver inside of a service? Do I need anything in the manifest for <code>SCREEN_OFF</code> to toggle?</p>

<p>Is it another magical decision that the Android core team did instead of me? Maybe firing a broadcast receiver drains battery, ey?</p>",android|broadcastreceiver,3855967,Gala,yes
How to find top most Activity launched in android?,"<p>I need a way to detect the active Activity without pooling. </p>

<p>The right way is to have a Service that listens for Activities launching in a continuous way.</p>

<p>BUT, I do not want to do pooling since it drains the battery.
I have tried <code>READ_LOGS</code> permission, but it seems that I have to have ROOT access, which I do not have/need.</p>

<p>I am thinking that I need a kind of Broadcast Receiver and listen for Apps changes like this:</p>

<pre><code>ActivityChangerBroadcast extends BroadcastReceiver{
    @Override
    public void onReceive(Context context, Intent intent) {
        try {

        } catch (Exception e) {

        }

    }
}
</code></pre>",android|android-activity|broadcastreceiver|intercept|pooling,843001,Duna,yes
Titanium - Not able to stop iOs background process,"<p>I already implement background service for my app. I am using it for getting user current location by using location services.</p>

<p>I will explain the way i implement this - ""XYZ.js"" - Screen where user distance display. Following code is added to set register background service -</p>

<pre><code>var iService = Ti.App.iOS.registerBackgroundService({
            url : 'BackgroundService.js'
        });
</code></pre>

<p>once app go to background, background service start and collect user locations. When app come is at foreground i fired following event -</p>

<pre><code>Ti.App.fireEvent('stopBackgroundService');
</code></pre>

<p>In ""BackgroundService.js"" - there is listener as -</p>

<pre><code>Ti.App.addEventListener('stopBackgroundService',function(){
    Ti.App.currentService.stop();
});
</code></pre>

<p>But after finishing this all location base work, when i move to other screen and taking app to background, location services start again. Due to Which device battery drains.</p>

<p>Any suggestions? Thanks in advance.</p>",ios|geolocation|titanium|titanium-mobile|background-process,411759,Vikas Sawant,no
Does Google offer an API that I can use to get the location of my phone?,"<p>My smartphone reports my location to Google (to G+ and to the Android Device Manager). I'd like to read that location from a website/program to plot my location.</p>

<p>I could use another app on my smartphone doing extra tracking but that tends to drain the battery quite a bit (having two apps do the tracking).</p>

<p>Since Latitude was deprecated I can't seem to find a replacement.</p>",android|geolocation|google-api|google-latitude,2065014,tante,yes
Effcient way to do scheduled background job in android,"<p>I need to fetch the device location and battery percentage for every 5 to 10 min . </p>

<p>I have tried some below mentioned methods such as</p>

<ol>
<li><p>Alaram Manager
It works fine in most of the devices  below the android 8.1 . In android 8.1 it works for few hours and the it stops working</p></li>
<li><p>Job scheduler &amp; work manager</p></li>
</ol>

<p>It works fine in most of device but they have restriction of minimum 15minutes. Also it not works in few mobiles(xiaomi,Oneplus...)
 after terminationg the app</p>

<p>Is there any better and effcient way to do scheduled background job for every 10 min </p>

<p>Note: [Also i didn't tried FCM because it may drain the battery percentage more compared to aboved listed way</p>",java|android,6008839,vivek.kingston,no
Destroying Polymer-element and re-create new one with other attributes...or?,"<p>I'm wondering what's the best approach to do the following: I have a <code>Polymer-element</code> (<code>PubNub</code> (which handled <code>Realtime Messaging</code>)) which is ""instantiated"" with a some attribute values (the elements properties (more precisely, which channel to listen to/join)). And since the user should be able to switch chat rooms (/channels), I'm not sure if it's such a great idea to ""instantiate"" 5 <code>PubNub-elements</code> and in turn have 5 active chats going on in the background (receiving messages), if nothing else it would drain more battery power(?).</p>

<p>So, should I instantiate one <code>PubNub-element</code> and then remove and replace it when a user swaps channel? And how is this done best in <code>Polymer</code>? </p>

<p>Or is there some other approach one should take when dealing with this kind of problem?</p>",javascript|html|polymer-1.0|pubnub,2422321,Whyser,no
How do Gimbal beacons have such a low expected time to arrival for background scanning?,"<p>I'm trying to understand how dependable / frequent background detection of beacons can be while our app is running in the background. If our app is running in the background, it is my understanding that iOS does BLE scan every 15 minutes, even with iOS 7.1 (<a href=""http://developer.radiusnetworks.com/2014/03/12/ios7-1-background-detection-times.html"" rel=""nofollow"">http://developer.radiusnetworks.com/2014/03/12/ios7-1-background-detection-times.html</a>). However, Gimbal is advertising (<a href=""https://gimbal.com/doc/proximity/ios.html#background_behavior"" rel=""nofollow"">https://gimbal.com/doc/proximity/ios.html#background_behavior</a>) that the expected time to arrival for iOS 7 is an average of 7 seconds for their series 20 beacons. These transmit every 100 milliseconds, just like what was used in the referenced link.</p>

<p>Is Gimbal's documentation accurate? If so, doesn't this mean that they're forcing a scan at a much more frequent interval which would drain battery life?</p>",ios|bluetooth-lowenergy|ibeacon|gimbal,3993902,BoilerJoe,no
Android - Set Location Mode Programmatically on Marshmallow,"<p>Ever since I've upgraded my device to Android 6.0.1 Marshmallow, Android automatically sets the location mode to <strong>High Accuracy</strong> when apps with the <code>android.permission.ACCESS_FINE_LOCATION</code> permission, try to access the location of my device. </p>

<p>Personally, I found it quite annoying as setting the location mode to <strong>High Accuracy</strong> drains my device's battery at a very high rate. So, I need to check every now and then if the location mode has been changed and manually need to change it back to <strong>Battery Saving</strong> mode. </p>

<p>So, I decided to make an app that'll deploy an <code>IntentService</code> in the background which'll check every 30 mins if the location mode has been changed to <strong>High Accuracy</strong> and will change it back to <strong>Battery Saving</strong>. </p>

<p>But, the problem the faced while doing that is finding a method that'll let me change the location mode programmatically. </p>

<p>I tried using the following code but without any use:</p>

<pre><code>public void ChangeLocationMode() {
    LocationRequest mLocationRequest = LocationRequest.create();
    mLocationRequest.setPriority(LocationRequest.PRIORITY_BALANCED_POWER_ACCURACY);

    mHandler.post(new Runnable() {
        @Override
        public void run() {
            Toast.makeText(SetLocationModeService.this, ""Location Mode Changed!"", Toast.LENGTH_LONG).show();
        }
    });
}
</code></pre>

<p>I've also added the following permissions in my <code>AndroidManifest.xml</code>:</p>

<pre><code>&lt;uses-permission android:name=""android.permission.LOCATION_HARDWARE""/&gt;
&lt;uses-permission android:name=""android.permission.ACCESS_LOCATION_EXTRA_COMMANDS""/&gt;
</code></pre>

<p>But, this method doesn't seem to work at all.</p>

<p>So, my question here is, </p>

<blockquote>
  <p>Is there any way at all to change the Location Mode programmatically in Android Marshmallow (or above)?</p>
</blockquote>

<p>If there is any tried and tested method of doing the same, please consider sharing it here.</p>",android|location|android-6.0-marshmallow|android-permissions|android-location,3025452,Swap,no
Proper way of implementing a periodic action,"<p>I have the need to send and take something from a server in Android on every 10 seconds. Here, on StackOverflow, and in the documentation I found literally dozens of ways to implement it (and everything I tried does the job), but it seems that everywhere someone says something is wrong with that way.</p>

<p>I tried with a looping <code>AsyncTask</code> until it is canceled (that is untill the activity is killed), and I found out that it's not a good solution. Before that I tried with regular <code>Threads</code>, then I found out that it drains the battery a lot. </p>

<p>Now I've done it with a <code>Runnable</code> and and the ScheduledExecutorService's <code>scheduleAtFixedRate</code> function, similar to the code proposed here:
<a href=""https://stackoverflow.com/questions/6207362/how-to-run-an-async-task-afor-every-x-mins-in-android"">How to run an async task for every x mins in android?</a> . Needless to say, it works. But will it work if my Activity is in the background, for example the user is answering an incoming call? </p>

<p>In the end, I don't know anymore what is the most proper way of doing it on an Android phone.</p>

<p>Tnx in advance.</p>",java|android|service|scheduled-tasks|task,794967,Aleksandar Stojadinovic,yes
Using Smack API for Instant Messaging in Android,"<p>I want to make an instant messaging app for android. I have the option of using GCM, but I do not want to use it since there may be other platforms that may communicating (web, other mobile platforms etc) with the app. </p>

<p>So, instead of using GCM , I want to use the Smack API (an xmpp library written in java), which uses sockets. </p>

<p>Now, I have a few doubts about it: </p>

<ul>
<li><strong>How smack handles connection drops/reconnects etc</strong>. Is it as 'simple' as GCM? in case of an internet loss, will it automatically reconnect when its available</li>
<li><strong>Is it battery efficient ?</strong> Since its listening from its own socket, I would like to know if there will be a massive battery drain or not (it should be listening for messages 24/7 from a background service, and not only while the user is in the app) </li>
</ul>

<p>Aside of these concerns, I would like to know if there are other (better) ways to have instant messaging. I cannot do sockets from scratch, and would like multiple platforms (thats my I am not a fan of GCM)</p>",java|android|sockets|xmpp|smack,2670775,harveyslash,no
Pattern for using websockets (via socket.io) only on demand for mobile application,"<p>I'm working on a mobile application that will <em>sometimes</em> need near real time updates, so I'm looking to use websockets when necessary.  Some early testing seems to show that maintaining a using a websocket all the time keeps the data connection on my phone open constantly, causing faster batter drain.</p>

<p>So I'm thinking it will be more battery efficient to use regular ajax style requests most of the time and only use websockets when necessary.</p>

<p>I'm new to socket.io - does it provide any means to manually ""downgrade"" connections?  If not I will want a communication layer on top of it - can anyone suggest a layer on top of socket.io that would allow me to manually switch between websocket and regular ajax connections?</p>",node.js|socket.io,262298,Aerik,yes
Implementing instant messaging in my android application,"<p>everyone I know discussion questions aren't welcomes here, so I'm trying to make this as programmatic as possible. In a nutshell I'm asking for better ways to do this, or ways to optimize my existing code. My application was created through the use of the <code>Unity3D</code> game engine, however it's not a game. I just find the engine really easy to use, because of this I am using a service website called <a href=""http://onesignal.com"" rel=""nofollow"">OneSignal</a>. Enough of the rambling, any more and it becomes irrelevant to the question.</p>

<p>This is my first attempt creating an instant messaging application that does not make use of <code>Sockets</code>. So my over-all design is sloppy at best. However, here's my setup:</p>

<p>Currently I'm making use of the HTTProtocol in which I store all of my logic on my webserver using PHP. Basically what I'm doing is returning database results in a <code>JSON</code> format to be parsed in C# using <code>SimpleJSON</code> and then handled by the application to show new messages, etc. (Based on the ""has read"" state in the application / on the server.)</p>

<p>Here's where it becomes problematic in my eyes. While I can send a push notification to the user when the receive a new message, how would I pull all of these messages from the server? The only logical way that I've thought of to do this was to constantly poll the web-server every 5-10 seconds and check to see if there's any new messages. If there are, then add them to the appropriate message list and apply the ""unread message"" attribute. </p>

<p>So should the phone store all of the users previous messages in memory? or should I pull all of the messages from the database each time? The second option seems like it would cost much more bandwidth than required for a simple chat feature. However it seems like a bunch of messages stored on a device would cause device clutter, and reading from the flat-file storage containing the messages every time you opened the message would (In my opinion) use quite a bit of disk I/O. So should the messages be stored in memory? Then you run into the device constantly running low on memory, as androids use quite a bit and it'd never be collected by the GC unless the message (thread) was deleted. </p>

<p>I was told by a friend that I should just deliver the messages through push notifications and handle them on the device as they're received, but an issue with that is that push notifications aren't always received and then we'd end up with a lot of lost messages. </p>

<p>If we poll the database constantly then we'd be draining the users battery.</p>

<p>I'm at a complete loss for what to do here, and would like some guidance. This is my first android application and while it's coming along very, very nicely, the feature I put off to the end because I figured it would be simple (Messaging) has turned out to be the most difficult.  </p>

<p>If this is the incorrect place to ask a question like this, could you please (Accompanied by your immediate down-vote) post in the comments where this belongs. </p>",c#|android|unity3d|onesignal,4111710,Hobbyist,yes
How can I test app on my phone without usb connection with my laptop?,"<p>Is there any way I can test my apps on phone without it being connected with usb cable ? I want that because when i plug my phone in laptop it starts charging and draining laptops battery, so I would like to be able to test app on real phone without it being connected to laptop.</p>",java|android|android-studio|adb,4751730,Alen,no
Battery usage considerations in an iOS app that makes heavy use of ARKit,"<p>We need to develop an iOS app that will make heavy use of <code>ARSession</code>s with <code>ARFaceTrackingConfiguration</code>, in more or less 100% of the screens. Our main concern is related to battery usage. We're in discovery phase, so I'm trying to find/research all possible risks related to it.</p>
<p>For now, what I found is:</p>
<ol>
<li><code>ARKit</code> sessions don't &quot;drain&quot; the battery (I did some testing with my phone), they just consume more that common apps (more or less the same amount of battery than having the iPhone camera open for a long period of time, with the addition that <code>ARSession</code> is continually creating frames in order to track the face -real time video processing).</li>
<li>I'm aware of <code>run(_:options:)</code> and <code>pause()</code> methods on <code>ARSession</code>, in order to pause the tracking functionality when it's not necessary.</li>
<li>I'm aware about <code>lowPowerModeEnabled</code> and we can react to changes in that property.</li>
</ol>
<p>I searched Apple Developer for some official article that provides general considerations about battery usage in an ARKit session, but I couldn't find anything dedicated to the topic. I'm wondering if there is a really important thing that I should be aware and I'm missing when implementing the feature. It's the first time I'll work with <code>ARKit</code> and it's critical for the project.</p>
<p>Thanks in advance!</p>",ios|swift|arkit,6938899,Juan Manuel Gentili,no
Android running thread every 1 Second to Increment Unix Timestamp,"<p>I need to running thread every one second. But when application killed, the <strong>thread must be still alive</strong>. </p>

<p>My thread task is used for increment Unix Timestamp (that synchronized when the first time application running from our server time) by one every second. I need to create this task because in some device, date time can changed unpredictable (maybe low on battery, hard reset, dropped or something else).</p>

<p>My Activity must be get that Unix Timestamp value when it needed.</p>

<p>From SO, <a href=""https://stackoverflow.com/a/12582999/1533670"">Alarm Manager is not a good choice</a>, </p>

<p><code>I would recommend you not to use an AlarmManager for 30 seconds, as some have suggested. Because 30 seconds is too short. it will drain the battery. For AlarmManager use a minimum 1 minute with RTC.
</code></p>

<p>Other people suggest using Timer Task or ScheduledExecutorService, what the best thread to fit my need?</p>

<p>Thanks.</p>",java|android|multithreading,1533670,Yohanim,no
What is the best way keep your app updated with server?,"<p>My app consists of login based user system in which the user will receive his tasks. User's list of task need to be regularly synced with the server so that any new task would reflect immediately on the app. I have done this kind of sync stuff before in other apps but i would like to know the best approach to do it. I have two approaches in my mind please let me know which one is better or if you have any another idea then please tell me.</p>

<p><strong>APPROACH 1</strong></p>

<p>I can use <a href=""https://developer.android.com/reference/android/app/IntentService.html"" rel=""nofollow noreferrer"">IntentService</a> and <a href=""https://developer.android.com/reference/android/app/AlarmManager.html"" rel=""nofollow noreferrer"">AlarmManager</a> to to run background service at fixed interval of time and check for any change on sever through a http request (i.e. app to server request).</p>

<p><strong>APPROACH 2</strong></p>

<p>I can host a small TCP server through my app using <a href=""https://github.com/NanoHttpd/nanohttpd"" rel=""nofollow noreferrer"">NanoHTTPD</a> library and after every new entry on server i can make request from the server to this small TCP host informing about these changes (i.e. server to app request).</p>

<p>I have used <strong>APPROACH1</strong> before but i am interested in <strong>APPROACH2</strong> more( i think this will drain less battery). So please let me know which one is better way(i.e. more efficient, secure, etc) to do it. If you have any other idea then please feel free to share it.</p>",java|android|performance|intentservice|nanohttpd,9020490,Piyush Kumar,no
tcp_keepalive_time less than 2 hours,"<p>The RFC says:</p>

<p>Keep-alive packets MUST only be sent when no data or acknowledgement packets have been received for the connection within an interval.  <code>This interval MUST be configurable and MUST default to no less than two hours(7200 seconds)</code></p>

<p>What happens if keepalive interval set to something less than 2 hours? for an instance 60 seconds(1 minute). It will detect the remote peer dead/closed after <code>60 + tcp_keepalive_intvl * tcp_keepalive_probes</code> seconds. But will that causes resource drain(for an instance battery drain on mobile device)</p>",linux|networking|amazon-ec2|tcp|akka,2477137,eranga,no
Android: battery stats show usage even after deactivating the GPS location provider,"<p>I'm creating an app that uses the <code>LocationManager</code> in a sticky <code>Service</code> to listen for location events.</p>

<p>If I use the start/stop functionality from my app's activity, everything is working as expected.</p>

<p>However, if I disable the GPS provider (from the Android settings), battery stats shows my app as still draining battery (GPS usage time counter increases).</p>

<p>Here's what I do in my app for start/stop:</p>

<pre><code>private void doStart() {
    Intent i = new Intent(getApplicationContext(), LocationService.class);

    getApplicationContext().startService(i);
}

private void doStop() {
    Intent i = new Intent(getApplicationContext(), LocationService.class);

    getApplicationContext().stopService(i);
}
</code></pre>

<p>This is the <code>onDestroy()</code> logic:</p>

<pre><code>@Override
public void onDestroy() {
    locationManager.removeUpdates(this);
    locationManager = null;

    super.onDestroy();
}
</code></pre>

<p>And this is where I handle the provider being disabled:</p>

<pre><code>@Override
public void onProviderDisabled(String provider) {
    String ourProvider = Utils.getCurrentLocationProvider(this);

    if (provider.equalsIgnoreCase(ourProvider)) {
        Utils.debug(TAG, String.format(""'%s' == '%s', stopping self"", provider, ourProvider));

        stopSelf();
    }
}
</code></pre>

<p>logcat shows that the service stops itself and <code>onDestroy()</code> is called.</p>

<p>I've even tried setting the <code>Service</code> to <code>START_NOT_STICKY</code> just in case, but still no luck.</p>

<p>What am I doing wrong?</p>

<p><strong>EDIT:</strong> Looks like it's not an issue with my app after all, I've managed to reproduce this issue with Google Maps.</p>

<p>I am using the Power Control widget btw.</p>",android|gps|locationmanager|battery,1075653,Emil Burzo,yes
"Activity, service or fragment?","<p>I am writing an app which needs to monitor the current battery level, after every 15 minutes or so, continuously. </p>

<p>To try and make it relatively efficient, currently, I am using AlarmManager.RTC, with PowerManager.PARTIAL_WAKE_LOCK, and an setInexactRepeating of 15 minutes.</p>

<p>This will be a sort of battery drain % monitor app, so I need this app to be always logging what it finds every 15 minutes, even after boot. It checks for battery level, if the phone is charging and some other things such as if wifi is enabled, if screen is on etc. and then writes these values in sqllite for later analysis.</p>

<p>So which one would be the best way to go about it:</p>

<ol>
<li>AlarmManager on an activity in a BroadcastReceiver in the
activity</li>
<li>AlarmManager and a service</li>
<li>Headless fragment</li>
</ol>

<p>Or a better option is suited?</p>",android|performance|android-intent|android-fragments|alarmmanager,341791,Saurabh Kumar,yes
Android kills my application after an hour,"<p>I'm writing an application that has a Foreground service that use GPS periodically to get the user location. The fore ground is working all the time and the application doesn't drain the battery because i don't use the GPS all the time. My problem is that after one hour while the application is in the background(more or less) Android kills my application while the foreground service is still running. 
It seems like it's because of memory usage but i'm checking my application and it doesn't consume a lot of memory, not more than application like facebook that stays open all night without getting closed.</p>

<p>any suggestion how to keep the application alive or maybe to find out why Android kills my application? </p>

<p>i also check and saw that the average usage if RAM memory is 25M . is that a lot? could this be the reason ? </p>",android|background,958880,user958880,yes
"Keep SensorEventListener during ""standby""","<p>I'm building an app that needs to listen to the accelerometer all the time, even when the application is not in foreground.
(At this point, I want to clarify that this is not an app for Play Store. This is an app with a specific purpose for internal usage where battery drain is not much of a problem - Also, if anyone knows another way to check if the user is walking, please let me know either)</p>

<p>To achieve this, I created a <code>BroadcastReceiver</code> that listens to <code>android.intent.action.BOOT_COMPLETED</code> and starts a service that registers the <code>SensorEventListener</code>. The service acquires a <code>PARTIAL_WAKE_LOCK</code> and I was hoping that with this lock the <code>SensorEventListener</code> would still receive the <code>onChange()</code> callback, but that is not happening. However, with the <code>FULL_WAKE_LOCK</code> it works - but i do not want to keep the screen on and the user may also press the standby button...
In my debug sessions, I never saw the service being destroyed, therefore, the wake lock should never be released.</p>

<p>Here's the <code>Service</code> class that acquires the lock and registers the sensor:</p>

<pre><code>public class WalkingDetectorService extends Service {

    private static PowerManager.WakeLock wakeLock = null;
    private static final String LOCK_TAG = ""WALKING_DETECTOR"";

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public void onCreate() {
        super.onCreate();
        acquireLock(this);
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
            // started on boot from a BroadcastReceiver
        startMotionDetector(getApplication());
        return START_STICKY;
    }

    @Override
    public void onDestroy() {
        releaseLock();
        super.onDestroy();
    }

    private void startMotionDetector(Application application) {

        int sensitivityIdx = SettingsManager.getInt(application, SettingsManager.SETTING_SENSOR_SENSITIVITY);

        if (sensitivityIdx == -1) {
            sensitivityIdx = MotionSensor.DEFAULT_SENSITITY_IDX;
        }

        float fSens = MotionSensor.getSensivity(sensitivityIdx);

        //SensorEventListener is registered here. It is properly done. Only stops listen when screen goes off (by timeout or user pressing the standby button)
            MotionSensor.startMotionSensor(application, fSens);

    }

    public static synchronized void acquireLock(Context ctx) {
        if (wakeLock == null) {
            PowerManager mgr = (PowerManager) ctx.getSystemService(Context.POWER_SERVICE);
            wakeLock = mgr.newWakeLock(PowerManager.FULL_WAKE_LOCK, LOCK_TAG);
            wakeLock.setReferenceCounted(true);
        }
        wakeLock.acquire();
    }

    public static synchronized void releaseLock() {
        if (wakeLock != null) {
            if (wakeLock.isHeld())
            {
                wakeLock.release();
            }
        }
    }
}
</code></pre>

<p>I think I provided all the information needed to get some help from you.
If you feel like there's some piece of code that would be useful, I'll be happy to colaborate! Thank you</p>",android|accelerometer|android-sensors|wakelock|standby,320586,Miguel Ribeiro,yes
What happens to a WatchKit app when iPhone is turned off?,"<p>Let's say I want to create a WatchKit app that shows the seconds for the current time.</p>

<p><strong>What happens if iPhone gets turned off</strong> (e.g. battery drained), then user starts the app on the Watch device?</p>

<p>As far as I know, every (!) code runs on the iPhone (extension app), so my method that ""fetches"" seconds probably won't respond either. It is hard to imagine, but seems that I cannot get / display the current time on the Apple Watch if iPhone is turned off. </p>

<p>Any experiences on this?</p>",ios|iphone|watchkit|apple-watch,215282,Geri Borbás,yes
iOS - Region monitoring when device/user into new city?,"<p>As per iOS CLLocationManager API <code>startmonitoringsignificantlocationchanges</code> will inform my app when there is significant change e.g. 500 mtrs or more. </p>

<p>But i want in my app like my app will get notified only when user/device enters into new city. App should automatically open if its in closed state. </p>

<p>NOTE: its not map/navigation application, so i don't want to my app keep monitoring user's location data and at the end drain device's battery. </p>

<p>Please suggest some solution.</p>",ios|geolocation|clregion,583170,harshit2811,yes
Why does my Android application drain battery?,"<p>I've written a simple application that displays some text and a little bit of graphics on screen. I'm using a Nexus 7, this is for an installation, and as such needs to be on continuously as much as 12 hours a day.  However, despite being plugged in and charging, my application drains the battery completely in about 8 hours (10-15% / hour).</p>

<p>Apart from the infrequently-changing text and graphics, my application does two things:</p>

<p>It keeps the screen on, at full brightness (via <code>WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON</code>); and</p>

<p>It opens two <code>DatagramSockets</code>, one to act as a UDP client, and one to act as a UDP server.  These sockets are both opened automatically and managed by the library I'm using, <a href=""http://www.sojamo.de/libraries/oscP5/"" rel=""nofollow"">OSCP5</a>.  It's open source, so I can hack it as needed, though the less the better.  (<a href=""http://en.wikipedia.org/wiki/KISS_principle"" rel=""nofollow"">KISS</a>.)</p>

<p>I've tested the Nexus 7 battery life with no apps running, screen at full brightness, with a tickle every 29 minutes to keep it from sleeping, for a few hours with no battery drain at all.  So, signs seem to point to the sockets.  I don't have frequent communication on those sockets, they receive approximately a few KB every minute (based on user interaction with another part of the installation).</p>

<p>Is there anything I can do, specifically with the sockets, or any other general testing, to minimize or eliminate the battery drain?  I only need to get through 12 hours, but keeping full charge while plugged in doesn't seem like it should be such a tall order...</p>",android|sockets|battery|screen-brightness,222356,ericsoco,no
Android Bluetooth LE disabling notification callback drain battery?,"<p>I'm developing an application that connects to a Bluetooth Low Energy Device. The architecture of the program requires it to collect data from this device in bursts. Example: Collect data for 30 seconds once every 3 minutes.
It is very important for this to be battery efficient.</p>

<p>For this device I have subscribed to notifications from a BluetoothGattCharacteristic. Unfortunately read permission is not given on this characteristic, so notifications must be used.</p>

<pre><code>descriptor.setValue(BluetoothGattDescriptor.ENABLE_NOTIFICATION_VALUE);     
mBluetoothGatt.writeDescriptor(descriptor);
</code></pre>

<p>and</p>

<pre><code>mBluetoothGatt.setCharacteristicNotification(characteristic, true);
</code></pre>

<p>My first idea is to simply set</p>

<pre><code>mBluetoothGatt.setCharacteristicNotification(characteristic, false);
</code></pre>

<p>when not scanning for data. Will this still consume lots of battery life? I assume the callbacks are still listening. Would I be required to change the descriptor back to its non-notification state?</p>

<p>Another idea would be to connect only when reading data from sensors, and disconnect when done. This would mean reconnecting ~20 times an hour.</p>",java|android|bluetooth-lowenergy|battery|battery-saver,2471482,DeeCeptor,no
Pop OS / Dell XPS 9310 -- battery drained overnight on suspend,"<p>My laptop is suspending on lid close successfully, but if I don't have it plugged in overnight, the battery is drained by the morning.</p>
<p>I'm including logs from a short suspend I ran just now. I can suspend it overnight and look at the logs afterward, but is there anything immediately suspicious here? I validated that all suspend-related targets are loaded via <code>sudo systemctl status sleep.target suspend.target hibernate.target hybrid-sleep.target</code></p>
<pre><code>Apr 11 22:09:29 pop-os systemd[1]: Reached target Sleep.
Apr 11 22:09:29 pop-os systemd[1]: Starting Suspend...
Apr 11 22:09:29 pop-os kernel: [   44.986190] PM: suspend entry (s2idle)
Apr 11 22:09:29 pop-os systemd-sleep[3730]: Suspending system...
Apr 11 22:09:29 pop-os kernel: [   44.991600] Filesystems sync: 0.005 seconds
Apr 11 22:09:57 pop-os kernel: [   44.994638] Freezing user space processes ... (elapsed 0.002 seconds) done.
Apr 11 22:09:57 pop-os kernel: [   44.996920] OOM killer disabled.
Apr 11 22:09:57 pop-os kernel: [   44.996921] Freezing remaining freezable tasks ... (elapsed 0.001 seconds) done.
Apr 11 22:09:57 pop-os kernel: [   44.998055] printk: Suspending console(s) (use no_console_suspend to debug)
Apr 11 22:09:57 pop-os kernel: [   45.315954] psmouse serio1: Failed to disable mouse on isa0060/serio1
Apr 11 22:09:57 pop-os kernel: [   46.377203] ACPI: EC: interrupt blocked
Apr 11 22:09:57 pop-os kernel: [   72.605807] ACPI: EC: interrupt unblocked
Apr 11 22:09:57 pop-os kernel: [   73.107660] pcieport 10000:e0:06.0: can't derive routing for PCI INT A
Apr 11 22:09:57 pop-os kernel: [   73.107666] nvme 10000:e1:00.0: PCI INT A: no GSI
Apr 11 22:09:57 pop-os kernel: [   73.114494] nvme nvme0: 8/0/0 default/read/poll queues
Apr 11 22:09:57 pop-os kernel: [   73.363725] OOM killer enabled.
Apr 11 22:09:57 pop-os kernel: [   73.363728] Restarting tasks ... 
Apr 11 22:09:57 pop-os kernel: [   73.364154] mei_hdcp 0000:00:16.0-b638ab7e-94e2-4ea2-a552-d1c54b627f04: bound 0000:00:02.0 (ops i915_hdcp_component_ops [i915])
Apr 11 22:09:57 pop-os kernel: [   73.367166] done.
Apr 11 22:09:57 pop-os touchegg[1000]: libinput error: event0  - Lid Switch: client bug: event processing lagging behind by 1279ms, your system is too slow
Apr 11 22:09:57 pop-os /usr/libexec/gdm-x-session[1823]: (II) modeset(0): EDID vendor &quot;SHP&quot;, prod id 5370
Apr 11 22:09:57 pop-os /usr/libexec/gdm-x-session[1823]: (II) modeset(0): Printing DDC gathered Modelines:
Apr 11 22:09:57 pop-os /usr/libexec/gdm-x-session[1823]: (II) modeset(0): Modeline &quot;3840x2400&quot;x0.0  592.50  3840 3888 3920 4000  2400 2403 2409 2469 -hsync -vsync (148.1 kHz eP)
Apr 11 22:09:57 pop-os /usr/libexec/gdm-x-session[1823]: (II) modeset(0): Modeline &quot;3840x2400&quot;x0.0  474.00  3840 3888 3920 4000  2400 2403 2409 2469 -hsync -vsync (118.5 kHz e)
Apr 11 22:09:57 pop-os systemd-sleep[3730]: System resumed.
Apr 11 22:09:57 pop-os bluetoothd[961]: Controller resume with wake event 0x0
Apr 11 22:09:57 pop-os kernel: [   73.413202] PM: suspend exit
Apr 11 22:09:57 pop-os systemd[1]: systemd-suspend.service: Succeeded.
Apr 11 22:09:57 pop-os systemd[1]: Finished Suspend.
Apr 11 22:09:57 pop-os systemd[1]: Stopped target Sleep.
Apr 11 22:09:57 pop-os systemd[1]: Reached target Suspend.
Apr 11 22:09:57 pop-os systemd[1]: Stopped target Suspend.
Apr 11 22:09:57 pop-os NetworkManager[968]: &lt;info&gt;  [1649729397.3461] manager: sleep: wake requested (sleeping: yes  enabled: yes)
Apr 11 22:09:57 pop-os NetworkManager[968]: &lt;info&gt;  [1649729397.3461] device (wlp113s0): state change: unmanaged -&gt; unavailable (reason 'managed', sys-iface-state: 'external')
Apr 11 22:09:57 pop-os ModemManager[1079]: &lt;info&gt;  [sleep-monitor] system is resuming
Apr 11 22:09:57 pop-os NetworkManager[968]: &lt;info&gt;  [1649729397.4258] manager: NetworkManager state is now DISCONNECTED
</code></pre>",linux|linux-kernel|suspend,18777990,larnett,yes
Java Socket: Has a connection been remotely closed,"<p>I am currently writing a program that requires a client-server communication, the server is a machine in an office and the clients will be Android devices.  The clients will connect to the server and wait for data to be sent to them.  The clients will be running for hours at a time and a constant connection is required.  From research I have found that an open connection will not keep the radio at full power so I'm happy to keep this connection open. All this I have done and works fine. My issue is when the server is switched off / lost network connection etc. The Android clients do not know when the connection has been closed.</p>

<p>In my research I have found that the Java Socket API does not know when a connection has been closed /lost connection by the server (see <a href=""https://stackoverflow.com/questions/10240694/java-socket-api-how-to-tell-if-a-connection-has-been-closed"">Java socket API: How to tell if a connection has been closed?</a>) for info. As suggested in some of the replies (and other sources I have seen), it is advised to use a heartbeat to ""test"" the connection. This poses an issue with Android as the heartbeat method may result in extra battery useage with is obviously something to avoid.</p>

<p>Before I started to write any code I researched Google Cloud Messaging but due to the requirements for the software I am writing, Cloud Messaging is not appropriate (due to Throttling).</p>

<p>Due to the requirements of the software and the eventual users of the app I know that most of the time the Android devices will be connected to a power source so the battery drain issue could be considered mute! However I would rather keep to best practices in regards to battery conservation.</p>

<p>In this regard, does anyone know of a way to tell if the connection is still open, other than the heartbeat approach of course?</p>

<p>Cheers guys.</p>",android|sockets|networking|client-server,1836447,Splodge,no
Significant-Location change notification in iPod,"<p>My application uses location service in background. To reduce the battery drainage, i found that it is better to register for significant-location change notification. It says to get this notification device need cell radio. Now my doubt is that whether i can get significant location change notification in iPod....I searched a lot but couldn't get an exact answer..any help is greatly appreciated...</p>",iphone|ios|objective-c|core-location,1323646,Ab'initio,yes
Bouncing Particles are unexpectedly overlapping,"<p>I've been generating a set of bouncing orbs within <strong>D3</strong>. I've managed to get the system working according to the following rules:</p>

<ul>
<li>Orbs should slowly drift around</li>
<li>Orbs should bounce off each other taking into account mass &amp; momentum when doing so</li>
<li>Orbs should not be able to leave the SVG area and should therefore bounce off the edges</li>
</ul>

<p>I've managed to find a problem however and I can't figure out what could be causing it, every now and again the Orbs seem to get stuck - one node will get stuck to another, following it along rather than bouncing away and sometimes end up underneath, or over the top of another orb, which I thought should be impossible. </p>

<p>The overlapping logic is fairly simple, if the distance between the centers of 2 orbs is less than their combined radius they need to bounce:</p>

<pre><code>// Calculate the distance between the centres of 
// two nodes, we don't have take the square root
// as we don't need it, and it's an expensive operation
var x = d.x - quad.point.x;
var y = d.y - quad.point.y;
var distance = x * x + y * y;

// Calculate the radius of each to determine how
// close they need to be to be considered touching
var radii = getSize(d) + getSize(quad.point);

// If the nodes appear to be touching then we need to move the points
if (distance &lt; (radii * radii)) {
    // Overlapping
}
</code></pre>

<p>And if they bounce I calculate the angles and speeds at which they should bounce off, conserving the momentum which is a documented algorithm. I therefore can't figure out how two orbs could ever follow each other along?</p>

<pre><code>function bounce_vectors(d1, d2) {

    // Calculate the angle at which the balls collide
    var dx = d1.x - d2.x;
    var dy = (d1.y - d2.y) * -1;
    var collisionAngle = Math.atan2(dy, dx);

    // Calculate the speed of d1/d2
    var speed1 = Math.sqrt((d1.speedX * d1.speedX) + (d1.speedY * d1.speedY));
    var speed2 = Math.sqrt((d2.speedX * d2.speedX) + (d2.speedY * d2.speedY));

    // Get angles (in radians) for each ball, given current velocities
    var direction1 = Math.atan2(d1.speedY, d1.speedX);
    var direction2 = Math.atan2(d2.speedY, d2.speedX);

    // Rotate velocity vectors so we can plug into equation for conservation of momentum
    var rotatedVelocityX1 = speed1 * Math.cos(direction1 - collisionAngle);
    var rotatedVelocityY1 = speed1 * Math.sin(direction1 - collisionAngle);
    var rotatedVelocityX2 = speed2 * Math.cos(direction2 - collisionAngle);
    var rotatedVelocityY2 = speed2 * Math.sin(direction2 - collisionAngle);        

  // Update actual velocities using conservation of momentum
    var finalVelocityX1 = ((d1.size - d2.size) * rotatedVelocityX1 + (d2.size + d2.size) * rotatedVelocityX2) / (d1.size + d2.size);
    var finalVelocityX2 = ((d1.size + d1.size) * rotatedVelocityX1 + (d2.size - d1.size) * rotatedVelocityX2) / (d1.size + d2.size);

    // Y velocities remain constant
    var finalVelocityY1 = rotatedVelocityY1;
    var finalVelocityY2 = rotatedVelocityY2;

    // Rotate angles back again so the collision angle is preserved
    d1.speedX = Math.cos(collisionAngle) * finalVelocityX1 + Math.cos(collisionAngle + Math.PI/2) * finalVelocityY1;
    d1.speedY = Math.sin(collisionAngle) * finalVelocityX1 + Math.sin(collisionAngle + Math.PI/2) * finalVelocityY1;
    d2.speedX = Math.cos(collisionAngle) * finalVelocityX2 + Math.cos(collisionAngle + Math.PI/2) * finalVelocityY2;
    d2.speedY = Math.sin(collisionAngle) * finalVelocityX2 + Math.sin(collisionAngle + Math.PI/2) * finalVelocityY2;
};
</code></pre>

<p><div class=""snippet"" data-lang=""js"" data-hide=""true"">
<div class=""snippet-code snippet-currently-hidden"">
<pre class=""snippet-code-js lang-js prettyprint-override""><code>// Add an additional function to the string prototype
if (!String.prototype.format) {
    String.prototype.format = function () {
        var args = arguments;
        return this.replace(/{(\d+)}/g, function (match, number) {
            return typeof args[number] != 'undefined'
              ? args[number]
              : match
            ;
        });
    };
}

d3.Orbs = function() {
   
 var width = 500;
 var height = 500;
 var maxSpeed = 10;
    var alpha = 0.026;

 var nodes = [
  { id: 1, name: ""Software"", size: 5, children: [
    { id: 4, name: ""Bug"" },
    { id: 5, name: ""Feature"" },
    { id: 6, name: ""Build"" }] 
  },
  { id: 2, name: ""Scrum"", size: 8, children: [
    { id: 7, name: ""Sprint"" },
    { id: 8, name: ""Story"" },
    { id: 9, name: ""Story Point"" }] 
  },
  { id: 3, name: ""Resource"", size: 12, children: [
    { id: 10, name: ""Location"" },
    { id: 11, name: ""Team"" },
    { id: 12, name: ""Members"" }] 
  },
        { id: 13, name: ""A"", size: 12 },
        { id: 14, name: ""B"", size: 9 },
        { id: 15, name: ""C"", size: 3 }
 ];

    /**
     * Initialize each of the nodes in the dataset to ensure
     * that the required positions and speeds exist in the data
     * for collision avoidance and applying gravity
     * @param {array} The collection of nodes from the raw data
     * @param {object} A bounding rectangle to restrict where the nodes can be placed
     */
    function initialize_nodes(nodes, bounds) {
        // Ensure each node has a random start location and speed
        nodes.forEach(function(d) { 
            d.x = Math.random() * bounds.right;
            d.y = Math.random() * bounds.bottom;
            d.speedX = (Math.random() - 0.5) * 2 * maxSpeed;
            d.speedY = (Math.random() - 0.5) * 2 * maxSpeed;
        });
        
        /*nodes[0].x = 100;
        nodes[0].y = 100;
        nodes[0].speedX = 10;
        nodes[0].speedY = -10;
        nodes[0].size = 10;
        nodes[0].fill = 'red';
        
        nodes[1].x = 200;
        nodes[1].y = 400;
        nodes[1].speedX = -10;
        nodes[1].speedY = 40;
        nodes[1].size = 20;
        nodes[1].fill = 'steelblue';*/
    };
  
    // Initialize the nodes now
    initialize_nodes(nodes, {left: 0, top: 0, bottom: height, right: width});
        
 

 var force = d3.layout.force()
                        .alpha(alpha)
       .gravity(0)
       .charge(0)
       .nodes(nodes)
       .size([width, height])
       .on(""tick"", tick);

 var svg = d3.select(""body"")
    .append(""svg"")
    .attr(""width"", 500)
    .attr(""height"", 500);

 var node = svg.selectAll("".node"")
       .data(nodes)
       .enter()
       .append(""circle"")
         .attr(""class"", ""node"")
                        .style('fill', function(d) { return d.fill; })
         .attr(""cx"", function(d) { return d.x; })
      .attr(""cy"", function(d) { return d.y; })
      .attr(""r"", function(d) { return getSize(d); });
 
 function getSize(node) {
  return 5 * node.size;
 }

/**
 * Return a function that applies gravity to an individual node
 * @param {number} The alpha or kinetic energy currently in the system
 * @returns {function} The funtion that applies gravity to each individual node
 */
function gravity(alpha) {
    
    /**
     * Update the position and speed of the node based upon it's current location
     * @param {Object} The data node that is being moved
     */
    return function(d) {
     var radius = getSize(d);
        
        // If the node is attempting to move off screen then invert the speed
        // on that axis to bring it back into scope
        if ((d.x - radius) &lt; 0) d.speedX = Math.abs(d.speedX);
        if ((d.x + radius) &gt; width) d.speedX = -1 * Math.abs(d.speedX);
        if ((d.y - radius) &lt; 0) d.speedY = -1 * Math.abs(d.speedY);
        if ((d.y + radius) &gt; height) d.speedY = Math.abs(d.speedY);
        
        // Set the current position of the node
        d.x = d.x + (d.speedX * alpha);
        d.y = d.y + (-1 * d.speedY * alpha);
        
        // Apply some extra protection - if the node has moved off the screen
        // then get it back again rather than waiting for it's speed
        d.x = Math.min(Math.max(d.x, 0 + radius), width - radius);
        d.y = Math.min(Math.max(d.y, 0 + radius), height - radius);
    };
}

/**
 * Update the positions of nodes whenever we recieved a tick notification
 * from the force layout algorithm
 * @param {object} D3 tick event args
 */
function tick(e) {
 // Ensure that the Alpha never drops to 0
    // Note that on mobile devices this could be a big battery drain
    force.alpha(alpha);
      
    // Update the position of each node by applying a gravity function
    // and preventing any collisions of the nodes
    node.each(gravity(.51 * e.alpha))
        .each(function(d) { d.color = '#2B301C';})
        .each(function(d) { d.bounced = d.bounced || []; })
        .each(resolve_collisions(0.5))
  .attr(""cx"", function(d) { return d.x; })
  .attr(""cy"", function(d) { return d.y; })
        .style(""stroke"", function(d) { return d.color || '#2B301C'; });
};
    
function resolve_collisions(alpha) {
    
    // Build a quad tree from the nodes
    var quadtree = d3.geom.quadtree(nodes);
   
    // http://www.exeneva.com/2012/06/multiple-balls-bouncing-and-colliding-example/
    function bounce_vectors(d1, d2) {
        
        // Calculate the angle at which the balls collide
        var dx = d1.x - d2.x;
        var dy = (d1.y - d2.y) * -1;
        var collisionAngle = Math.atan2(dy, dx);
        
        // Calculate the speed of d1/d2
        var speed1 = Math.sqrt((d1.speedX * d1.speedX) + (d1.speedY * d1.speedY));
        var speed2 = Math.sqrt((d2.speedX * d2.speedX) + (d2.speedY * d2.speedY));
          
        // Get angles (in radians) for each ball, given current velocities
        var direction1 = Math.atan2(d1.speedY, d1.speedX);
        var direction2 = Math.atan2(d2.speedY, d2.speedX);
       
        // Rotate velocity vectors so we can plug into equation for conservation of momentum
        var rotatedVelocityX1 = speed1 * Math.cos(direction1 - collisionAngle);
        var rotatedVelocityY1 = speed1 * Math.sin(direction1 - collisionAngle);
        var rotatedVelocityX2 = speed2 * Math.cos(direction2 - collisionAngle);
        var rotatedVelocityY2 = speed2 * Math.sin(direction2 - collisionAngle);        
        
      // Update actual velocities using conservation of momentum
        var finalVelocityX1 = ((d1.size - d2.size) * rotatedVelocityX1 + (d2.size + d2.size) * rotatedVelocityX2) / (d1.size + d2.size);
        var finalVelocityX2 = ((d1.size + d1.size) * rotatedVelocityX1 + (d2.size - d1.size) * rotatedVelocityX2) / (d1.size + d2.size);
        
        // Y velocities remain constant
        var finalVelocityY1 = rotatedVelocityY1;
        var finalVelocityY2 = rotatedVelocityY2;
        
        // Rotate angles back again so the collision angle is preserved
        d1.speedX = Math.cos(collisionAngle) * finalVelocityX1 + Math.cos(collisionAngle + Math.PI/2) * finalVelocityY1;
        d1.speedY = Math.sin(collisionAngle) * finalVelocityX1 + Math.sin(collisionAngle + Math.PI/2) * finalVelocityY1;
        d2.speedX = Math.cos(collisionAngle) * finalVelocityX2 + Math.cos(collisionAngle + Math.PI/2) * finalVelocityY2;
        d2.speedY = Math.sin(collisionAngle) * finalVelocityX2 + Math.sin(collisionAngle + Math.PI/2) * finalVelocityY2;
    };
    
    return function(d, i) {
       
       
        

        
        // Using a quad tree to speed things up visit each pair of nodes
        quadtree.visit(function(quad, x1, y1, x2, y2) {
                     
            // Compare points together - but don't compare the
            // current point to itself
            if (quad.point &amp;&amp; (quad.point !== d)) {
                                     
                // Calculate the distance between the centres of 
                // two nodes, we don't have take the square root
                // as we don't need it, and it's an expensive operation
                var x = d.x - quad.point.x;
                var y = d.y - quad.point.y;
                var distance = x * x + y * y;
            
                // Calculate the radius of each to determine how
                // close they need to be to be considered touching
                var radii = getSize(d) + getSize(quad.point);

                // If the nodes appear to be touching then we need to move the points
                if (distance &lt; (radii * radii)) {
                    
                    // If these items have already bounced then continue
                    if(d.bounced.indexOf(quad.point) !== -1) {
                        return;
                    }
                    
                    d.bounced.push(quad.point);
                    quad.point.bounced.push(d);
                    setTimeout(function() {
                        var index = d.bounced.indexOf(quad.point);
                        d.bounced.splice(index, 1);
                        index = quad.point.bounced.indexOf(d);
                        quad.point.bounced.splice(index);
                    }, 5250);
                    
                    d.color = 'red';
                    quad.point.color = 'red';
                    bounce_vectors(d, quad.point);
            }
      }
    });
  };
}



 force.start();       

};

d3.Orbs();</code></pre>
<pre class=""snippet-code-css lang-css prettyprint-override""><code>.node {
    fill: #77B72B;
    stroke: #2B301C;
    stroke-width: 3px;
}
svg {
    background: #222;
}</code></pre>
<pre class=""snippet-code-html lang-html prettyprint-override""><code>&lt;script src=""https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js""&gt;&lt;/script&gt;</code></pre>
</div>
</div>
</p>",javascript|d3.js,21061,Ian,yes
iBeacon detection time in background (Home automation use case),"<p>I know this has been asked in many varieties but I have yet to see a full answer for this. I just get a lot of conflicting information.</p>

<p>I'm trying to use iBeacon for a home automation use case. For example, if I walk into a room with an iBeacon I turn on the lights in that room. As you can imagine, I need this to be pretty prompt (within a couple of seconds of walking in the room). When I have my app in the foreground, this works great - the timing is prompt for both entering and exiting the region. However, if the app is in the background it's more unreliable. If I call [self.locationManager startUpdatingLocation] and never stop updating location, the iBeacon detection works the same as if the app is in the foreground. However, I assume this is not the intended use case as that will probably drain your battery after a while. My questions are:</p>

<ol>
<li>What is the expected time for monitoring iBeacons (just getting entry / exit callbacks) in the background vs the foreground?</li>
<li>Is there a way to have iBeacons in the background work as quickly as the foreground without calling [self.locationManager startUpdatingLocation]? Once the location arrow turns from active location monitoring to the arrow with the geofence outline, I immediately stop getting iBeacon notifications.</li>
</ol>",ios|core-location|ibeacon,3091519,user3091519,yes
How to optimise battery with FUSED LOCATION API - Android,"<p>Hi I am facing below issue/problem with location API in android</p>

<ul>
<li><p><strong>Battery consumption is high as 30% - 40%, which is causing lot of battery drain.</strong></p></li>
<li><p><strong>Location icon in status bar is always ON even when app is closed and when app is uninstalled it goes off automatically.</strong></p></li>
</ul>

<p>Requirement:</p>

<ul>
<li>Need user location when app is opened.</li>
<li>I need to have users location even when app is not opened or not in use based on distance - need user location in background. </li>
</ul>

<p>Approach:</p>

<ol>
<li><p>with GPS </p></li>
<li><p>API used FUSED LOCATION API with pending intent.</p></li>
<li><p>LocationManager - to check state of GPS On/Off. </p></li>
</ol>

<p>Code walkthru:</p>

<ol>
<li><p>in OnCreate i m getting location manager instance - getting instance of location manager.</p></li>
<li><p>checking is GPS enabled or is network state available else show dialog to enable location: CODE: -</p>

<pre><code>// get GPS state.
    locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);


    if (isGPSLocationEnabled(locationManager)) {
        buildGooleLocationApiClient();
    } else if (isNetworkLocationEnabled(locationManager)) {
        buildGooleLocationApiClient();
    } else {
        showAlert();
    }
</code></pre></li>
</ol>

<p>Code for goolgeLocationAPiClient: In this method I am checking android version, requesting permission and enabling services</p>

<pre><code>private void buildGooleLocationApiClient() {

        if (Build.VERSION.SDK_INT &gt;= 23) {

            int isFineLocationPermission = ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION);
            int isCoarseLocationPermission = ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_COARSE_LOCATION);

            if (isFineLocationPermission == PackageManager.PERMISSION_DENIED || isCoarseLocationPermission == PackageManager.PERMISSION_DENIED) {
                requestPermission();
            } else {
                checkGoogleLocationApiClient();
            }

        } else {
            checkGoogleLocationApiClient();
        }
    }
</code></pre>

<p>Building GoogleAPI Client:</p>

<pre><code>private void checkGoogleLocationApiClient() {
        try {
            if (mGoogleApiClient != null) {
                if (mGoogleApiClient.isConnected()) {
                    getMyLocationCampaigns();
                } else {
                    mGoogleApiClient.connect();
                }
            } else {
                buildGoogleApiClient();
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private void getMyLocationCampaigns() {
        if (mCurrentLocation != null) {
            getData(mCurrentLocation.getLatitude()+"""",mCurrentLocation.getLongitude()+"""");
        } else {
            try {
                mCurrentLocation = LocationServices.FusedLocationApi.getLastLocation(mGoogleApiClient);
                getData(mCurrentLocation.getLatitude()+"""",mCurrentLocation.getLongitude()+"""");
            } catch (SecurityException ex) {
                ex.printStackTrace();
                getData("""","""");
            }
        }
    }

private synchronized void buildGoogleApiClient() {
        try {
            Log.i(TAG, ""activity Building GoogleApiClient==="");
            mGoogleApiClient = new GoogleApiClient.Builder(this)
                    .addConnectionCallbacks(this)
                    .addOnConnectionFailedListener(this)
                    .addApi(LocationServices.API)
                    .build();

            createLocationRequest();
        } catch (Exception e) {
            e.printStackTrace();
            getData("""","""");
        }
    }


    private void createLocationRequest() {
        mLocationRequest = new LocationRequest();
        mLocationRequest.setInterval(60 * 60 * 1000);
        mLocationRequest.setFastestInterval(60 * 1000);
        mLocationRequest.setPriority(LocationRequest.PRIORITY_BALANCED_POWER_ACCURACY);
        mLocationRequest.setSmallestDisplacement(100);

        connectGoogleApiClient();
    }


private void connectGoogleApiClient() {
        if (mGoogleApiClient != null) {
            if (!mGoogleApiClient.isConnected())
                mGoogleApiClient.connect();
        }
    }


@Override
    public void onLocationChanged(Location location) {
        mCurrentLocation = location;
    }

    @Override
    public void onConnected(@Nullable Bundle bundle) {

        if (mCurrentLocation == null) {
            try {
                mCurrentLocation = LocationServices.FusedLocationApi.getLastLocation(mGoogleApiClient);
                if (mCurrentLocation != null) {
// MyAPICALL                    getData(mCurrentLocation.getLatitude()+"""",mCurrentLocation.getLongitude()+"""");
                } else {
                    LocationServices.FusedLocationApi.requestLocationUpdates(mGoogleApiClient,mLocationRequest, this);
                    mCurrentLocation = LocationServices.FusedLocationApi.getLastLocation(mGoogleApiClient);
                    if (mCurrentLocation == null) {
                        if (locationManager != null) {
                            String provider = Utils.getUserLastLocation(locationManager);
                            if (provider != null) {
                                try {
                                    Location location = locationManager.getLastKnownLocation(provider);
                                    if (location != null) {
                                        getData(location.getLatitude() + """", location.getLongitude() + """");
                                    } else {
                                        getData("""", """");
                                    }
                                } catch (SecurityException e) {
                                    e.printStackTrace();
                                }
                            }
                        }
                    } else {
                        getData(mCurrentLocation.getLatitude()+"""",mCurrentLocation.getLongitude()+"""");
                    }
                }
            } catch (SecurityException ex) {
                ex.printStackTrace();
            } catch (Exception e) {
                e.printStackTrace();
                getData("""","""");
            }
        }
    }
</code></pre>

<p>Method to getlocation in background with pending intent</p>

<pre><code>private void startLocationUpdates() {
        try {


            Intent receiverIntentService = new Intent(this, LocationIntentService.class);
            PendingIntent pendingIntent = PendingIntent.getService(this, 1, receiverIntentService, 0);

            if (mGoogleApiClient != null) {
                if (mGoogleApiClient.isConnected()) {
                    LocationServices.FusedLocationApi.requestLocationUpdates(
                            mGoogleApiClient, mLocationRequest, pendingIntent);
                }

            }
        } catch (SecurityException se) {
            se.printStackTrace();
        }
    }
</code></pre>

<p>BroadCastReceiver: In case if device is restarted:</p>

<pre><code>public class LocationBroadcastReceiver extends BroadcastReceiver implements
        GoogleApiClient.ConnectionCallbacks,GoogleApiClient.OnConnectionFailedListener, LocationListener {


    Context context;
    protected GoogleApiClient mGoogleApiClient;
    protected LocationRequest mLocationRequest;
    protected Location mCurrentLocation;
    public static Boolean mRequestingLocationUpdates = false;

    SharedPreferences checkUserStatus;

    public LocationBroadcastReceiver() {
    }

    @Override
    public void onReceive(Context context, Intent intent) {
        // TODO: This method is called when the BroadcastReceiver is receiving
        // an Intent broadcast.
        try {
            this.context = context;

            checkUserStatus = context.getSharedPreferences(Params.LOGIN_DETAILS_PREFERENCE, 0);
            String isUserLogedIn = checkUserStatus.getString(Params.TOKEN,"""");

// if user is still logged in then only trigger background service
            if (!isUserLogedIn.equals("""")) {
                buildGoogleApiClient();
                if (mGoogleApiClient != null) {
                    if (mGoogleApiClient.isConnected() &amp;&amp; mRequestingLocationUpdates) {
                        startLocationUpdates();
                    } else {
                        buildGoogleApiClient();
                    }
                } else {
                    buildGoogleApiClient();
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }


    @Override
    public void onConnected(Bundle bundle) {
        startLocationUpdates();
    }

    @Override
    public void onConnectionSuspended(int i) {
        mGoogleApiClient.connect();
    }


    @Override
    public void onConnectionFailed(ConnectionResult connectionResult) {
        Log.i(""Broadcast receiver"", ""Connection failed: ConnectionResult.getErrorCode() = "" + connectionResult.getErrorCode());
    }


    @Override
    public void onLocationChanged(Location location) {
        mCurrentLocation = location;
    }


    protected synchronized void buildGoogleApiClient() {
        mGoogleApiClient = new GoogleApiClient.Builder(context)
                .addConnectionCallbacks(this)
                .addOnConnectionFailedListener(this)
                .addApi(LocationServices.API)
                .build();

        createLocationRequest();
    }



    protected void createLocationRequest() {
        mLocationRequest = new LocationRequest();
        mLocationRequest.setInterval(60 * 60 * 1000);
        mLocationRequest.setFastestInterval(60 * 1000);
        mLocationRequest.setPriority(LocationRequest.PRIORITY_BALANCED_POWER_ACCURACY);
        mLocationRequest.setSmallestDisplacement(100);

    }

    protected void startLocationUpdates() {
        try {


            Intent receiverIntentService = new Intent(context,LocationIntentService.class);
            PendingIntent pendingIntent = PendingIntent.getService(context,1,receiverIntentService,0);

            LocationServices.FusedLocationApi.requestLocationUpdates(
                    mGoogleApiClient, mLocationRequest, pendingIntent);


        }catch (SecurityException se) {
            se.printStackTrace();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre>

<p>My intent service class: to get user updated location and make an API call</p>

<pre><code>public class LocationIntentService extends IntentService {

    Context context;
    Bitmap myBitmap;

    URL url;

    SharedPreferences.Editor mMyLastLocationHolder;
    SharedPreferences mMyLastLocation;

    SharedPreferences checkUserStatus;


    public LocationIntentService() {
        super(""LocationIntentService"");
    }

    @Override
    protected void onHandleIntent(Intent intent) {

        if (intent != null) {
            Bundle bundle = intent.getExtras();
            if (bundle != null) {
                Location location = bundle.getParcelable(""com.google.android.location.LOCATION"");
                if (location != null) {
                    context = getApplicationContext();
// API call to server
                    updateAPI(location.getLatitude()+"""",location.getLongitude()+"""");

                    Log.v(""TAG LOCATION "", "" ==== "" + location.getLatitude() + "" - "" + location.getLongitude() + "" ==== "");
                    Log.v(""TAG LOCATION "", "" ==== calling my-campaigns near me ========"");
                }
            }
        }

    }




    /**
     * Handle action Foo in the provided background thread with the provided
     * parameters.
     */
    private void handleActionFoo(String param1, String param2) {
        // TODO: Handle action Foo
        throw new UnsupportedOperationException(""Not yet implemented"");
    }

    /**
     * Handle action Baz in the provided background thread with the provided
     * parameters.
     */
    private void handleActionBaz(String param1, String param2) {
        // TODO: Handle action Baz
        throw new UnsupportedOperationException(""Not yet implemented"");
    }



}
</code></pre>",android|android-intent|gps|android-location|android-fusedlocation,3485314,MobDev,no
How to find what crashes a Cordova App in Android?,"<p>I have written a hybrid game using Cordova for iOS and Android. The game ran perfectly on both iOS and Android and I was almost ready to publish it but I only needed to make a few splash screens. When that was done, I did one final test on both platforms only to find out the game crashes on Android after a few minutes of play! It has never done that before and I have no idea what is causing it. What's also new is that my phone gets so hot when playing the game, you can hardly hold it anymore after a while (I measured 126F).</p>

<p>I'm only using two plugins: cordova-plugin-admob-free and cordova-plugin-splashscreen. For testing purposes, I removed both to see if they were causing the crashes, but the crashes were still there.</p>

<p>The game crashes when built with Cordova (cordova run android --devices) and also if I build it on PhoneGab Build and install the apk manually.</p>

<p>I've tried debugging with chrome://inspect but I don't see any errors appearing on the console.  I've also run</p>

<pre><code>adb logcat
</code></pre>

<p>but the log is too complicated for me to understand what is causing the crash. If anyone wants to take a look at it, I've uploaded a copy of the log <a href=""http://www.whutever.com/privatefiles/logcat.txt"" rel=""noreferrer"">here</a>. The name of the game is ""mygame"" (that's not really its name, but I changed it to that in the log file).</p>

<p>I have no idea how to find out what is causing this crash. On iOS, everything works perfectly fine. It's only Android that is causing this problem. If you need more information or if I need to be more specific, please let me know what more information you need and I will add it to this post.</p>

<p><strong>EDIT August 24th 2018:</strong>
I've been able to test it on another Android phone and on the simulator and it didn't crash there. I still need to figure out what is causing the crash since it's the only app that crashes on <strong>my</strong> phone. I would also like to know what is causing the tremendous battery drain when I run it. This too is new.</p>

<p><strong>EDIT August 26th 2018:</strong>
Well, more Android devices are experiencing the crash. I've done a few tests on my device. I removed the two Cordova plugins (AdMob en SplashScreen) en started the game. I let it sit at the opening screen so at that point, no game objects have been created yet and all it does are a few simple calculations and a few <strong>context.drawImage()</strong> calls. And still the phone gets hot and crashes after a while. Could it be that the context.drawImage() has a memory leak?</p>

<p><strong>EDIT August 27th 2018:</strong>
I stripped the app so that in the game's main loop only two drawImage() (and a requestAnimatonFrame()) were left. One drawImage() had a canvas as source, the other an img object. It still crashed after a while. Then I removed the drawImage() with an img object as source and it still hadn't crashed after an hour of testing. I then added a few more drawImage() all with a canvas as source - and no crash. I then replaced the canvas with an img object as source and it crashed after a few minutes. So I think it's safe to assume that a drawImage() with an img object as source is causing the crashes?</p>

<p><strong>EDIT August 29th 2018:</strong>
I changed all drawImages() in my code to use a canvas as source. The canvas is only filled once with an image. The first time I ran the game aferwards, it didn't crash! I thought I had solved the problem but after some more testing I found out it <strong>does</strong> crash but it takes a lot longer for the game to crash. So even though this is a good step towards a solution, it still isn't <strong><em>the</em></strong> solution.</p>

<p><strong>EDIT August 30th 2018:</strong>
I was able to run the game through Android Studio and when it crashed, the debug console showed this:</p>

<pre><code>E/chromium: [ERROR:gl_fence_egl.cc(55)] Failed to get EGLSync attribute. error code:12300
W/google-breakpad: ### ### ### ### ### ### ### ### ### ### ### ### ###
                   Chrome build fingerprint:
                   68.0.3440.91
                   344009152
                   ### ### ### ### ### ### ### ### ### ### ### ### ###
A/libc: Fatal signal 11 (SIGSEGV), code 1, fault addr 0x0 in tid 13865 (Chrome_InProcGp)
</code></pre>

<p>Can anyone please help me debug this?</p>",javascript|android|cordova|hybrid-mobile-app|phonegap,3272110,Zippy1970,yes
watchPosition vs getCurrentPosition in geolocation,"<p>I'm interested to find out what is the battery consumption of watchPosition method compared to getCurrentPosition method of the official geolocation API.</p>

<p>Thing is, I could call getCurrentPosition like every 2min, and it would be good enough for me probably. As far as I know/assume, getCurrentPosition uses GPS only once kind of, so the battery consumption of that method is low. But what about watchPosition? I assume that when you call watchPosition, then GPS will basically try to get a new location constantly all the time (that is, until you clear the watch). I know that the watchPosition callback will only be invoked when the position changes. <strong>But the callback is not the thing consuming the battery, GPS trying to locate the device is.</strong> And even if your position doesn't change, GPS is still constantly recalculating (and capturing GPS signals) your position all the time. And this is why watchPosition drains so much battery. <strong>Am I correct with these assumptions?</strong></p>

<p>If those assumptions are correct, then one could be better of with just getCurrentPosition. As like I said, it uses GPS only once per method call. Though I have heard watchPosition gives better accuracy.</p>",javascript|android|geolocation|gps,4662347,Ville Miekk-oja,no
Does reloading a WebView cancel former calls to setInterval()?,"<p>This might be a stupid question, I cannot find the answer though:</p>

<p>I am animating some shapes in a HTML/JS page displayed by an Android <code>WebView</code>. To do so I use the Javascript <code>setInterval()</code> method:</p>

<pre><code>var animateThreadHandler;

function animateThread() {
   // animate some stuff here...
}

// This function is called from the HTML page: &lt;body onload=""onBodyLoaded()""&gt;
function onBodyLoaded() {
    animateThreadHandler = setInterval(animateThread, 200);
}
</code></pre>

<p>Later, in the code of my Android <code>Activity</code> this time, I switch from this HTML page to another one, keeping the same <code>WebView</code>:</p>

<pre><code>mWebview.loadDataWithBaseURL(baseUrl, htmlContent, HTML_CONTENT_TYPE, HTML_ENCODING, null);
</code></pre>

<p>But I never call <code>clearInterval(animateThreadHandler)</code> from the Javascript. Even though this works well, I wouldn't like to drain the user's battery by doing useless Javascript function calls that would end up in errors that I couldn't see.</p>

<p>I monitored the behaviour of the JS <code>animateThread()</code> function by making it to produce logs (see comments), and the logging stops once the <code>WebView</code> is reloaded. But this doesn't prove the scheduler is cleared: calls to <code>animateThread()</code> may keep occurring - and silentely failing as the JS code was unloaded at <code>Webview</code> reload time.</p>

<p>The rationales behind this doubt reside in what the <a href=""http://www.w3schools.com/jsref/met_win_setinterval.asp"" rel=""nofollow"">W3School says</a>: </p>

<blockquote>
  <p>The setInterval() method will continue calling the function until
  clearInterval() is called, or the window is closed.</p>
</blockquote>

<p>I neither call <code>clearInterval()</code> nor I ""close"" the window (I'm just reloading it), so I am really not sure of the underlying behaviour of my code. Any idea?</p>",javascript|android|battery,840960,Shlublu,no
Windows Store Javascript background audio tassk close() method?,"<p>I have created a simple Windows 8.1 store app for just playing internet streaming radio. It looks and works good, but I can't upload my app to Windows Store! After validation a get the message like: </p>

<p>WinJS background task </p>

<ul>
<li><p>Error Found: 
The WinJS background tasks test encountered the
following errors: 
<p>App Radio Skovoroda did not call close() in the
background task JavaScript code found in file default.html.  
<p>Impact if not fixed: Apps with background tasks that do not call close() can result in draining the battery.  
<p>How to fix: Update the background
task to call close().</li>
</ul>

<p>The point is I do not need to call close(), because it is a radio player, so, it must play in background for a long time! Any ideas? How to do my app pass the validator? 
My script code:</p>

<pre><code>    (function () {
        ""use strict"";

        var app = WinJS.Application;
        var activation = Windows.ApplicationModel.Activation;

        app.onactivated = function (args) {
            if (args.detail.kind === activation.ActivationKind.launch) {
                if (args.detail.previousExecutionState !== activation.ApplicationExecutionState.terminated) {
                    // TODO: This application has been newly launched. Initialize
                    // your application here.
                } else {
                    // TODO: This application was suspended and then terminated.
                    // To create a smooth user experience, restore application state here so that it looks like the app never stopped running.
                }
                args.setPromise(WinJS.UI.processAll());


                var buttonMediaControl = document.getElementById(""mediaControlButton"");
                buttonMediaControl.addEventListener(""click"", playAndStop, false);


                //add variables for social buttons
                //Facebook
                var fbButton = document.getElementById(""fbButton"");
                fbButton.addEventListener(""click"", goToFbPage, false);
                //VKotakte
                var vkButton = document.getElementById(""vkButton"");
                vkButton.addEventListener(""click"", goToVkPage, false);
                //Twitter
                var twButton = document.getElementById(""twButton"");
                twButton.addEventListener(""click"", goToTwPage, false);
                //Instagram
                var igButton = document.getElementById(""igButton"");
                igButton.addEventListener(""click"", goToIgPage, false);
                //YouTube
                var ytButton = document.getElementById(""ytButton"");
                ytButton.addEventListener(""click"", goToYtPage, false);
                //TuneIn
                var tiButton = document.getElementById(""tiButton"");
                tiButton.addEventListener(""click"", goToTiPage, false)

                // Assign the button object to MediaControls
                var systemMediaControls = Windows.Media.SystemMediaTransportControls.getForCurrentView();

                systemMediaControls.addEventListener(""buttonpressed"", systemMediaControlsButtonPressed, false);

                systemMediaControls.isPlayEnabled = true;
                systemMediaControls.isPauseEnabled = true;
                systemMediaControls.isStopEnabled = true;


                systemMediaControls.playbackStatus = Windows.Media.MediaPlaybackStatus.closed;
                }    
        };
       app.oncheckpoint = function (args) {
            };


        // Plays the media.
        function playMedia() {
            var media = document.getElementById(""skovorodaStreamingAudio"");
            media.play();
            var statusIcon = document.getElementById(""playStopImage"");
            statusIcon.src = ""images/skovoroda_stop_button.png"";
            var systemMediaControls = Windows.Media.SystemMediaTransportControls.getForCurrentView();
            systemMediaControls.playbackStatus = Windows.Media.MediaPlaybackStatus.playing;

        }

        // Pauses the media.
        function pauseMedia() {
            var media = document.getElementById(""skovorodaStreamingAudio"");
            media.pause();
            var statusIcon = document.getElementById(""playStopImage"");
            statusIcon.src = ""images/skovoroda_play_button.png"";
            var systemMediaControls = Windows.Media.SystemMediaTransportControls.getForCurrentView();
            systemMediaControls.playbackStatus = Windows.Media.MediaPlaybackStatus.paused;


        }

        // Stops the media.
        function stopMedia() {
            var media = document.getElementById(""skovorodaStreamingAudio"");
            media.pause();
            media.currentTime = 0;

        }

   function playAndStop() {
            var myAudio = document.getElementById(""skovorodaStreamingAudio"");
            var statusIcon = document.getElementById(""playStopImage"");
            if (myAudio.paused) {
                var systemMediaControls = Windows.Media.SystemMediaTransportControls.getForCurrentView();
                systemMediaControls.playbackStatus = Windows.Media.MediaPlaybackStatus.playing;
                myAudio.play();
                statusIcon.src = ""images/skovoroda_stop_button.png"";
                } else {
                var systemMediaControls = Windows.Media.SystemMediaTransportControls.getForCurrentView();
                systemMediaControls.playbackStatus = Windows.Media.MediaPlaybackStatus.paused;
                myAudio.pause();
                statusIcon.src = ""images/skovoroda_play_button.png"";

            } 
        }


        // The media Play event handler.
        function mediaPlaying() {
            // Update the SystemMediaTransportControl state.
            systemMediaControls.playbackStatus = Windows.Media.MediaPlaybackStatus.playing;
        }

        // The media Pause event handler.
        function mediaPaused() {
            // Update the SystemMediaTransportControl state.
            systemMediaControls.playbackStatus = Windows.Media.MediaPlaybackStatus.paused;
        }

        // The media Ended event handler.
        function mediaEnded() {
            // Update the SystemMediaTransportControl state.
            systemMediaControls.playbackStatus = Windows.Media.MediaPlaybackStatus.stopped;

        }


        function goToFbPage() {
            window.open(""https://www.facebook.com/radioskovoroda?__mref=message_bubble"");
        }
        function goToVkPage() {
            window.open(""https://vk.com/radioskovoroda"");
        }
        function goToTwPage() {
            window.open(""https://twitter.com/RadioSkovoroda"");
        }
        function goToIgPage() {
            window.open(""https://instagram.com/radioskovoroda"");
        }
        function goToYtPage() {
            window.open(""https://www.youtube.com/channel/UCSgkIdg5MztN_2z9q_8u3Nw"")
        }
        function goToTiPage() {
            window.open(""http://tunein.com/radio/radio-skovoroda-s248591/"")
        }
        // Event handler for SystemMediaTransportControls' buttonpressed event
        function systemMediaControlsButtonPressed() {

            if (Windows.Media.MediaControl.isPlaying === true) {
                pauseMedia();

            } else {
                playMedia();

            }
        }


        app.start();

    })();
</code></pre>",javascript|html|css|windows|windows-runtime,5606045,Vasyl,no
"In iOS 9 the uitableview footer text alignment/spacing changed, what can I do?","<p>Hei.</p>

<p>These two pictures below show what changed. Here's my code for it and the code didn't change.</p>

<pre><code>- (NSString *)tableView:(UITableView *)tableView titleForFooterInSection:(NSInteger)section
{
  if (section == 0) {
    return @""If enabled, closing apps via the app switcher won't actually close the app itself.\n\nThis option is perfect to use with Fast Freeze."";
  }

  NSString *offDescription = @""OFF\nDisables the backgrounding capability completely. The app has to restart every time you close it."";
  NSString *fastFreezeDescription = @""FAST FREEZE\nThis mode is similar to what 'Smart Close' by rpetrich did. Usually an app has up to 10 minutes to perform tasks in the background before it gets suspended in memory. Since this can be an unnecessary battery drain, Fast Freeze will suspend the app right after you close it."";
  NSString *nativeDescription = @""NATIVE\nThis is Apple's built in way of backgrounding."";
  NSString *unlimitedNativeDescription = @""UNLIMITED NATIVE\nThis background mode allows apps to execute background tasks for an unlimited period of time, so the app won't get suspended in memory after 10 minutes."";
  NSString *foregroundDescription = @""FOREGROUND\nForeground tricks the system into thinking that the app wasn't closed and is still running in foreground. This is the perfect way to continue to listen to internet streams or videos while using another app."";

  return [NSString stringWithFormat:@""\n%@\n\n%@\n\n%@\n\n%@\n\n%@"", offDescription, fastFreezeDescription, nativeDescription, unlimitedNativeDescription, foregroundDescription];
}
</code></pre>

<p>Here are the screenshots:</p>

<p><a href=""https://i.stack.imgur.com/soycZ.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/soycZ.jpg"" alt=""before""></a></p>

<p>This is the view before (iOS 8), notice that ""\nOFF\nDisables ..."" has the gap to the last UITableViewCell like it should be.</p>

<p><a href=""https://i.stack.imgur.com/btSdK.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/btSdK.jpg"" alt=""after""></a></p>

<p>This is the view after (iOS 9), the gap is off. Too much space there.</p>

<p>So, does anyone know why this happens? If anyone has an fix or something, please tell me!</p>

<p>Thanks in advance!</p>",objective-c|xcode|uitableview|ios9|footer,3083408,user3083408,no
Android location tradeoff between accuracy and battery consumption,<p>Is there any model to determine the battery drainage in android due to gps? I am actually trying to find an optimum tradeoff between accuracy and battery consumption due to gps and mobile networks for location access.</p>,android|gps|location|wifi|battery,4158663,Bhaskar Gurram,no
Battery consumption while TCP is open for ADB via wifi can connect,"<p>My question is related to ADB over Wifi. I've found an article:
<a href=""http://stuffandtech.blogspot.de/2012/03/android-quick-tip-adb-over-wifi.html"" rel=""noreferrer"">http://stuffandtech.blogspot.de/2012/03/android-quick-tip-adb-over-wifi.html</a>
and that works for me, but I would like to know if keeping TCP open all the time actually will cause any significant battery drain. Of course I am talking about opened, but not used.</p>

<p>After some time connection seems to die by timeout: device, that used to be connected remotely  </p>

<pre><code>#adb devices
List of devices attached 
192.168.2.2:5555    device
</code></pre>

<p>disappears from adb devices:   </p>

<pre><code>#adb devices
List of devices attached 
</code></pre>

<p>, so new</p>

<pre><code>#adb connect &lt;ip&gt;:&lt;port&gt;
</code></pre>

<p>is needed. On the other hand, if I scan with nmap, I still see this TCP open (naturally, how else new adb connect would work!):</p>

<pre><code>Nmap scan report for 192.168.2.2
Host is up (0.017s latency).
Not shown: 999 closed ports
PORT     STATE SERVICE
5555/tcp open  freeciv
</code></pre>

<p>So, again, the question is: does keeping this TCP open forever will consume battery if adb is not actually connected?</p>

<p>Thanks</p>",android|tcp|wifi|adb|battery,3527830,Andrew Kuch,yes
Does recording audio in the background on Android drain a devices battery?,"<p>If I have a service analyze audio in the background, will the battery die quickly?</p>",android|power-management,553508,Nick Anderegg,no
android 4.0 - Disabling apps on the device,"<p>One of the 4.0 features is Disabling Apps</p>

<p>Android Ice Cream Sandwich has a new feature that lets users disable practically any application they may want to, including those pesky carrier pre-installed apps that can strain device resources and drain battery even if you choose not to use them</p>

<p>I dont see this in the emulator and neither do i see any API for the same.</p>

<p>Can anyone help me here?</p>",android|android-4.0-ice-cream-sandwich,327842,Avinash,yes
Possible impact of changing the IQ stanza timeout to 5 seconds on the XMPP server,"<p>I've been working with mod_ping on ejabberd, and could observe this:</p>

<ul>
<li><p><code>ping_interval</code>: Seconds<br>
How often to send pings to connected clients, if the previous option is enabled. If a client connection does not send or receive any stanza in this interval, a ping request is sent to the client. The default value is 60 seconds. </p></li>
<li><p><code>timeout_action</code>: <code>none</code>|<code>kill</code><br>
What to do when a client does not answer to a server ping request in less than 32 seconds. The default is to do nothing.</p></li>
</ul>

<p>For now, I have the ping interval as 15 seconds. A smaller value would drain the battery of mobile clients, as has been observed.</p>

<p>So, gauging a bit I changed the <strong>IQ_TIMEOUT value from 32 seconds to 5 seconds</strong> (a smaller value). This closes my connection with a relatively smaller wait now. This is a change in the wait time for receiving acknowledgement from the connected peer i.e. if the ack is not received within 5 seconds, the socket is closed by ejabberd now.</p>

<p>I am anxious if this impacts any other functionality of ejabberd?</p>

<p>What are the drawbacks of setting up a small value such as 5 seconds in my case?</p>",erlang|xmpp|ejabberd,3580641,bit_by_bit,no
battery draining issue when widget is created for my app,"<p>In my application I used the widget creation code for displaying alerts every 10 minutes.
For updating the widget I need <code>WIFI</code>.
But when I run the application, it frequently gives the error time battery draining issue. Any suggestions?</p>",android|android-widget,479027,Pinki,yes
Prevent iphone from sleeping but allow screen lock,"<p>using iphone SDk3.0, how does one prevent the iphone from sleeping so wifi remains
on but still allow the screen to be dimmed(locked).</p>

<p>Disabling the idle timer is no good as that prevents screen lock and drains the battery really quick.</p>

<p>Thanks</p>",iphone,261157,tech74,no
iBeacon Technology (iOS Development),"<p>I need support for iBeacon Technology.  In our case, I want one feature of continuously scanning (Ranging) of iBeacons weather our app is in foreground or background. We know its possible with CLLocationManager standard update location methods. But we don’t want to go with standard Location Updates (As we don’t want to take risk of battery drain). Is there any other option to start continuous Ranging of CLBeaconRegion without using CLLocationManager?</p>",ios|cllocationmanager|ibeacon|ios-bluetooth,4390722,navjot mehra,no
Motion detection versus conserving battery,"<p>In my app, I have a service that is constantly running in the background, in time ranges the user determines.</p>

<p>In theory, I need to constantly know the user's distance from some destination. So for optimizations, I'm implementing my own proximity alert, which sleeps for time frames according to the current distance.</p>

<p>Moreover, if the user is not in motion at all, I could stop the locations updates, since I know it's not moving. For this I used a listener to the acceleration sensor. But leaving it on for long ranges of time is draining the battery, since minor updates arrive constantly.</p>

<p>I know I could increase the time frames of the locationing (I read the great article in Android Developers..), but it's highly risky for the correctness.</p>

<p>Did any one ever face a similar problem? Could you suggest a different designing?</p>

<p>Thanks for any help</p>",android|location|accelerometer|android-sensors|motion-detection,1236401,Mugen,yes
Check if started service is already running,"<p>I have a <strong>service</strong> that is being started every time I start my application or the device reboots, but i recently noticed that the service can run multiple times at once, so every time its being called, it just stacks up and eventually the battery draining becomes insane.</p>

<p>Does anyone know  how to check if a service is already running?</p>

<p>Here is the code for starting the service:</p>

<pre><code>intent = new Intent(Application.Context, typeof(NotificationService));
Application.Context.StartService(intent);
</code></pre>

<p>Its in the <strong>MainActivity</strong> class in the <strong>OnCreate</strong> function, called after all the other code inside the function is done.</p>

<p>The service class is as follows:</p>

<pre><code>[Service (Label = ""ITMNotificationService"")]
class NotificationService : Service
{
    ...

    public override StartCommandResult OnStartCommand(Intent intent, StartCommandFlags flags, int startId)
    {
        base.OnStartCommand(intent, flags, startId);

        ...

        UpdateNotification();

        return StartCommandResult.Sticky;
    }

    public override IBinder OnBind(Intent intent)
    {
        // This is a started service, not a bound service, so we just return null.
        return null;
    }
}
</code></pre>

<p>Inside is a Task that i got running every X time:</p>

<pre><code>    private void UpdateNotification()
    {
        Task.Delay(updateTimer).ContinueWith(t =&gt;
        {
            ...

            UpdateNotification();

        }, TaskScheduler.FromCurrentSynchronizationContext());
    }
</code></pre>

<p>I want to have only one instance of the service, since there is no reason to have multiple ones and its just hogging the battery.</p>

<p>Everything I think that is relevant for the service I have added here, if there is something im missing please inform me.</p>",c#|android|xamarin|service,8554454,Nevaran,no
Read logs from Logcat without killing the tablet,"<p>I have to read the logs from Logcat and send them to a server through UDP.</p>

<p>For this task I have used this code: <a href=""https://github.com/chemik/logcatudp"" rel=""nofollow"">https://github.com/chemik/logcatudp</a></p>

<p>The main problem of that code is that the async Thread that is launched enters a while(true) loop that drains the tablet's battery on the long run.</p>

<p>Is there a way to get the logs in real time but without using a busy wait like that? Hopefully without adding some sleep(some_milliseconds) to reduce the problem?</p>

<p>It would be great to use some sort of event listener but I haven't found one. I have searched in every similar library but without any success.</p>

<p>The code is the following:</p>

<pre><code>while (true) {
    String sendingLine = """";
    // assume that log writes whole lines
    if (bufferedReader.ready()) {
        logLine = bufferedReader.readLine();
        sendingLine += logLine + System.getProperty(""line.separator"");
        DatagramPacket packet = new DatagramPacket(sendingLine.getBytes(), sendingLine.length(),
                        InetAddress.getByName(mConfig.mDestServer), mConfig.mDestPort);
        try {
            mSocket.send(packet);
            ...
</code></pre>

<p>Any idea? Thanks.</p>",android|udp|logcat,1888593,Filnik,no
Fatal exception and Disconnects WiFi Every 3 Hours or Less While Reading or Writing UART Data,"<p>I developed with ESPHOME and WEMOS D1 Mini to get my data from the RS232 port of my UPS device. Although currently working fine, my device loses wifi connection at intervals of 3 hours or less. I should also mention that my other ESP8266 devices connected to the same wifi network are connected for days and I do not have any connection problems.</p>
<p>In my research on the internet, there is information that it is caused by the general wifi settings and the problem will be fixed when the wifi settings are changed, but the issues are not closed as resolved and I have encountered many similar issues.</p>
<p>In the AP logs, information appears as “device disconnected or terminated”.</p>
<p>The codes I wrote below are available.
I look forward to your comments and suggestions for solutions to my problem.</p>
<p><a href=""https://www.f1depo.com/urun/wemos-d1-mini-nodemcu-esp8266?gclid=CjwKCAiA9aKQBhBREiwAyGP5lVq4cfgrPK0ciQ_wSDTqKtSwRTPDU7B1O9OBXIMy7DV51jPIEe5JARoCZU0QAvD_BwE"" rel=""nofollow noreferrer"">Wemos D1 Mini Nodemcu Esp8266</a></p>
<p><a href=""https://www.robitshop.com/urun/ttl-cevirici-kart-rs232?gclid=CjwKCAiA9aKQBhBREiwAyGP5lXnDb5y4PTEuwnV1NQunKOuCm4iJQWIJ5MB-O1Guubihd_iT7OZ6iRoC0mMQAvD_BwE"" rel=""nofollow noreferrer"">RS232 to TTL</a></p>
<p><a href=""https://www.makelsan.com.tr/ups/urundetay/powerpack-se-serisi-1-2-3-kva/index-81.html"" rel=""nofollow noreferrer"">Makelsan POWERPACK SE SERİSİ 1 kVA</a></p>
<p><a href=""https://www.falconups.com/SG%20PROTOCOL%20FALCON.pdf"" rel=""nofollow noreferrer"">UPS Data Read and Parse</a></p>
<p><a href=""https://i.stack.imgur.com/yRxwu.png"" rel=""nofollow noreferrer"">Home Assistant Screenshot</a></p>
<p>UPS-Makelsan.h</p>
<p><div class=""snippet"" data-lang=""js"" data-hide=""false"" data-console=""true"" data-babel=""false"">
<div class=""snippet-code"">
<pre class=""snippet-code-html lang-html prettyprint-override""><code>#include ""esphome.h""

class Get
{
public:
    static int readline(int readch, char* buffer, int len)
    {
        static int pos = 0;
        int rpos;

        if (readch &gt; 0)
        {
            switch (readch)
            {
            case 40: //'(': // RS232 Data is ""(216.5 000.0 219.6 027 50.0 2.26 40.00 00110000"". Clear ""("".
            case 35: //'#': // RS232 Data is ""#220.0 005 024.0 50.0"". Clear ""#"".
                break;
            case 13: //'\r': // Return on CR
                rpos = pos;
                pos = 0; // Reset position index ready for next time
                return rpos;
            default:
                if (pos &lt; len - 1)
                {
                    buffer[pos++] = readch;
                    buffer[pos] = 0;
                }
            }
        }
        // No end of line has been found, so return -1.
        return -1;
    }
    static float battery_capacity(float value)
    {
        return (value * 43.66812227074236);
    }
    static bool optionsValue(char value)
    {
        return (value == 48 ? false : (value == 49 ? true : false));
    }
};

class Update
{
public:
    static void binarySensor(BinarySensor* sensor, bool value)
    {
        //if (sensor-&gt;state != value)
        //{
        sensor-&gt;publish_state(value);
        //}
    }
    static void sensor(Sensor* sensor, float value)
    {
        //if (sensor-&gt;state != value)
        //{
        sensor-&gt;publish_state(value);
        //}
    }
    static void textSensor(TextSensor* sensor, char* value)
    {
        //if (sensor-&gt;state != value)
        //{
        sensor-&gt;publish_state(value);
        //}
    }
};

class MakelsanUPS : public Component, public UARTDevice, public BinarySensor, public Sensor, public TextSensor
{
public:
    BinarySensor* battery_low = new BinarySensor();
    BinarySensor* beeper_on = new BinarySensor();
    BinarySensor* eco_mode = new BinarySensor();
    BinarySensor* power_status = new BinarySensor();
    BinarySensor* shutdown_active = new BinarySensor();
    BinarySensor* test_in_progress = new BinarySensor();
    BinarySensor* ups_failed = new BinarySensor();
    BinarySensor* ups_type_is_standby = new BinarySensor();
    BinarySensor* utility_fail = new BinarySensor();
    Sensor* battery_capacity = new Sensor();
    Sensor* battery_voltage = new Sensor();
    Sensor* battery_voltage_current = new Sensor();
    Sensor* internal_tempeture = new Sensor();
    Sensor* output_current = new Sensor();
    Sensor* output_power = new Sensor();
    Sensor* raiting_current = new Sensor();
    Sensor* raiting_voltage = new Sensor();
    Sensor* voltage_frequency = new Sensor();
    Sensor* voltage_input = new Sensor();
    Sensor* voltage_input_fault = new Sensor();
    Sensor* voltage_input_frequency = new Sensor();
    Sensor* voltage_output = new Sensor();
    TextSensor* power_type = new TextSensor();
    TextSensor* ups_type = new TextSensor();
    MakelsanUPS(UARTComponent* parent) : UARTDevice(parent) {}
    //float get_setup_priority() const override { return esphome::setup_priority::DATA; }

    void setup() override
    {
        // nothing to do here
    }

    void loop() override
    {
        static char buffer[50];
        while (available())
        {
            if (Get::readline(read(), buffer, sizeof(buffer)) &gt; 0)
            {
                const char* delimiter = "" "";
                switch (strlen(buffer))
                {
                case 20: //""220.0 005 024.0 50.0""
                    Update::sensor(raiting_voltage, atof(strtok(buffer, delimiter)));
                    Update::sensor(raiting_current, atof(strtok(NULL, delimiter)));
                    Update::sensor(battery_voltage, atof(strtok(NULL, delimiter)));
                    Update::sensor(voltage_frequency, atof(strtok(NULL, delimiter)));
                    break;
                case 45: //""216.5 000.0 219.6 027 50.0 2.26 40.00 00110000""
                    Update::sensor(voltage_input, atof(strtok(buffer, delimiter)));
                    Update::sensor(voltage_input_fault, atof(strtok(NULL, delimiter)));
                    Update::sensor(voltage_output, atof(strtok(NULL, delimiter)));
                    Update::sensor(output_current, atof(strtok(NULL, delimiter)));
                    Update::sensor(voltage_input_frequency, atof(strtok(NULL, delimiter)));
                    const float battery_voltage_float = atof(strtok(NULL, delimiter));
                    Update::sensor(internal_tempeture, atof(strtok(NULL, delimiter)));
                    char other_values[9]{};
                    strcpy(other_values, strtok(NULL, delimiter));
                    Update::binarySensor(battery_low, Get::optionsValue(other_values[1]));
                    Update::binarySensor(beeper_on, Get::optionsValue(other_values[7]));
                    Update::binarySensor(eco_mode, Get::optionsValue(other_values[2]));
                    Update::binarySensor(utility_fail, Get::optionsValue(other_values[0]));
                    Update::binarySensor(shutdown_active, Get::optionsValue(other_values[6]));
                    Update::binarySensor(test_in_progress, Get::optionsValue(other_values[5]));
                    Update::binarySensor(ups_failed, Get::optionsValue(other_values[3]));
                    Update::binarySensor(ups_type_is_standby, Get::optionsValue(other_values[4]));
                    Update::sensor(battery_capacity, Get::battery_capacity(battery_voltage_float));
                    Update::sensor(battery_voltage_current, battery_voltage_float);

                    Update::binarySensor(power_status, (voltage_input-&gt;state == 0 ? false : true));
                    Update::sensor(output_power, (output_current-&gt;state * 6.111111));
                    Update::textSensor(power_type, (char*)(voltage_input-&gt;state == 0 ? ""Battery Power"" : ""AC Utility Power""));
                    Update::textSensor(ups_type, (char*)(voltage_input-&gt;state == 0 ? ""Normal"" : ""On-Line""));
                    break;
                }
            }
        }
    }
};</code></pre>
</div>
</div>
</p>
<p>ha-ups-makelsan.yaml validate export</p>
<p><div class=""snippet"" data-lang=""js"" data-hide=""false"" data-console=""true"" data-babel=""false"">
<div class=""snippet-code"">
<pre class=""snippet-code-html lang-html prettyprint-override""><code>substitutions:
  platform: ESP8266
  board: d1_mini
  deviceName: ha-ups-makelsan
  deviceNameId: ha_ups_makelsan
  deviceFriendlyName: HA Makelsan UPS
esphome:
  name: ha-ups-makelsan
  includes:
  - common/scripts/uart/UPS-Makelsan.h
  build_path: .esphome/build/ha-ups-makelsan
  platformio_options: {}
  libraries: []
  name_add_mac_suffix: false
esp8266:
  board: d1_mini
  framework:
    version: 3.0.2
    source: ~3.30002.0
    platform_version: platformio/espressif8266 @ 3.2.0
  restore_from_flash: false
  board_flash_mode: dout
wifi:
  ap:
    ssid: HA Makelsan UPS Hotspot
    password: ha_ups_makelsan_ML080wxvFS8z_ha_ups_makelsan
    ap_timeout: 1min
  domain: !secret 'wifi_domainname'
  fast_connect: true
  power_save_mode: NONE
  reboot_timeout: 15min
  output_power: 20.0
  networks:
  - ssid: !secret 'wifi_1_ssid'
    password: !secret 'wifi_1_password'
    priority: 0.0
  use_address: ha-ups-makelsan.local
captive_portal: {}
web_server:
  port: 80
  auth:
    username: !secret 'web_server_username'
    password: !secret 'web_server_password'
  css_url: https://esphome.io/_static/webserver-v1.min.css
  js_url: https://esphome.io/_static/webserver-v1.min.js
  include_internal: false
  ota: true
text_sensor:
- platform: wifi_info
  ip_address:
    name: WiFi IP Address
    icon: mdi:ip-network
    id: ha_ups_makelsan_wifi_ip_address
    disabled_by_default: false
    entity_category: diagnostic
    update_interval: 1s
  ssid:
    name: WiFi SSID
    icon: mdi:router-wireless
    id: ha_ups_makelsan_wifi_ssid
    disabled_by_default: false
    entity_category: diagnostic
    update_interval: 1s
  bssid:
    name: WiFi BSSID
    icon: mdi:router-wireless-settings
    id: ha_ups_makelsan_wifi_bssid
    disabled_by_default: false
    entity_category: diagnostic
    update_interval: 1s
  mac_address:
    name: Wifi MAC Address
    icon: mdi:fingerprint
    id: ha_ups_makelsan_wifi_mac_address
    disabled_by_default: false
    entity_category: diagnostic
- platform: custom
  lambda: !lambda |-
    auto ups_text_sensor = (MakelsanUPS*) id(ha_ups_makelsan_uart_data_ups);
    App.register_component(ups_text_sensor);
    return {
        ups_text_sensor-&gt;power_type
        ,ups_text_sensor-&gt;ups_type
    };
  text_sensors:
  - name: Power Type
    id: ha_ups_makelsan_power_type
    icon: mdi:power-socket-eu
    disabled_by_default: false
  - name: UPS Type
    id: ha_ups_makelsan_ups_type
    icon: mdi:car-battery
    disabled_by_default: false
sensor:
- platform: wifi_signal
  name: WiFi Signal
  id: ha_ups_makelsan_wifi_signal
  disabled_by_default: false
  force_update: false
  unit_of_measurement: dBm
  accuracy_decimals: 0
  device_class: signal_strength
  state_class: measurement
  entity_category: diagnostic
  update_interval: 60s
- platform: total_daily_energy
  name: Daily Energy
  id: ha_ups_makelsan_daily_energy
  power_id: ha_ups_makelsan_output_power
  unit_of_measurement: kWh
  filters:
  - multiply: 0.001
  disabled_by_default: false
  force_update: false
  device_class: energy
  state_class: total_increasing
  restore: true
  min_save_interval: 0s
  method: right
  accuracy_decimals: 2
- platform: custom
  lambda: !lambda |-
    auto ups_sensor = (MakelsanUPS*) id(ha_ups_makelsan_uart_data_ups);
    App.register_component(ups_sensor);
    return {
        ups_sensor-&gt;battery_capacity
        ,ups_sensor-&gt;battery_voltage
        ,ups_sensor-&gt;battery_voltage_current
        ,ups_sensor-&gt;internal_tempeture
        ,ups_sensor-&gt;output_current
        ,ups_sensor-&gt;output_power
        ,ups_sensor-&gt;raiting_current
        ,ups_sensor-&gt;raiting_voltage
        ,ups_sensor-&gt;voltage_frequency
        ,ups_sensor-&gt;voltage_input
        ,ups_sensor-&gt;voltage_input_fault
        ,ups_sensor-&gt;voltage_input_frequency
        ,ups_sensor-&gt;voltage_output
    };
  sensors:
  - name: Battery Capacity
    id: ha_ups_makelsan_battery_capacity
    device_class: battery
    unit_of_measurement: '%'
    accuracy_decimals: 1
    disabled_by_default: false
    force_update: false
  - name: Battery Voltage
    id: ha_ups_makelsan_battery_voltage
    unit_of_measurement: V
    device_class: voltage
    accuracy_decimals: 1
    disabled_by_default: false
    force_update: false
  - name: Battery Voltage Current
    id: ha_ups_makelsan_battery_voltage_current
    unit_of_measurement: V
    device_class: current
    accuracy_decimals: 1
    disabled_by_default: false
    force_update: false
  - name: Internal Tempeture
    id: ha_ups_makelsan_internal_tempeture
    unit_of_measurement: °C
    device_class: temperature
    accuracy_decimals: 0
    disabled_by_default: false
    force_update: false
  - name: Output Current
    id: ha_ups_makelsan_output_current
    device_class: power_factor
    unit_of_measurement: '%'
    accuracy_decimals: 0
    disabled_by_default: false
    force_update: false
  - name: Output Power
    id: ha_ups_makelsan_output_power
    device_class: power
    unit_of_measurement: W
    accuracy_decimals: 0
    disabled_by_default: false
    force_update: false
  - name: Raiting Current
    id: ha_ups_makelsan_raiting_current
    unit_of_measurement: V
    device_class: current
    accuracy_decimals: 1
    disabled_by_default: false
    force_update: false
  - name: Raiting Voltage
    id: ha_ups_makelsan_raiting_voltage
    unit_of_measurement: V
    device_class: voltage
    accuracy_decimals: 1
    disabled_by_default: false
    force_update: false
  - name: Voltage Frequency
    id: ha_ups_makelsan_voltage_frequency
    icon: mdi:cosine-wave
    unit_of_measurement: Hz
    accuracy_decimals: 1
    disabled_by_default: false
    force_update: false
  - name: Voltage Input
    id: ha_ups_makelsan_voltage_input
    unit_of_measurement: VAC
    device_class: voltage
    accuracy_decimals: 1
    disabled_by_default: false
    force_update: false
  - name: Voltage Input Fault
    id: ha_ups_makelsan_voltage_input_fault
    unit_of_measurement: OV
    device_class: voltage
    accuracy_decimals: 1
    disabled_by_default: false
    force_update: false
  - name: Voltage Input Frequency
    icon: mdi:cosine-wave
    id: ha_ups_makelsan_voltage_input_frequency
    unit_of_measurement: Hz
    accuracy_decimals: 1
    disabled_by_default: false
    force_update: false
  - name: Voltage Output
    id: ha_ups_makelsan_voltage_output
    unit_of_measurement: VAC
    device_class: voltage
    accuracy_decimals: 1
    disabled_by_default: false
    force_update: false
ota:
  password: !secret 'esphome_api_password'
  safe_mode: true
  port: 8266
  reboot_timeout: 5min
  num_attempts: 10
logger:
  level: WARN
  baud_rate: 0
  tx_buffer_size: 512
  deassert_rts_dtr: false
  hardware_uart: UART0
  logs: {}
  esp8266_store_log_strings_in_flash: true
api:
  password: !secret 'esphome_api_password'
  port: 6053
  reboot_timeout: 15min
uart:
- id: ha_ups_makelsan_bus
  tx_pin:
    number: 2
    mode:
      output: true
      analog: false
      input: false
      open_drain: false
      pullup: false
      pulldown: false
    inverted: false
  rx_pin:
    number: 0
    mode:
      input: true
      analog: false
      output: false
      open_drain: false
      pullup: false
      pulldown: false
    inverted: false
  baud_rate: 2400
  data_bits: 8
  stop_bits: 1
  parity: NONE
  rx_buffer_size: 50
globals:
- id: ha_ups_makelsan_uart_data_queue_value
  type: bool
  restore_value: false
  initial_value: 'true'
interval:
- interval: 1s
  then:
  - if:
      condition:
        wifi.connected: {}
      then:
      - if:
          condition:
            and:
            - lambda: !lambda |-
                return id(ha_ups_makelsan_uart_data_queue_value);
          then:
          - uart.write:
              id: ha_ups_makelsan_bus
              data:
              - 0x46
              - 0x0D
          - globals.set:
              id: ha_ups_makelsan_uart_data_queue_value
              value: 'false'
          else:
          - uart.write:
              id: ha_ups_makelsan_bus
              data:
              - 0x51
              - 0x31
              - 0x0D
          - globals.set:
              id: ha_ups_makelsan_uart_data_queue_value
              value: 'true'
custom_component:
- lambda: !lambda |-
    auto uart_data_ups = new MakelsanUPS(id(ha_ups_makelsan_bus));
    return {uart_data_ups};
  components:
  - id: ha_ups_makelsan_uart_data_ups
binary_sensor:
- platform: custom
  lambda: !lambda |-
    auto ups_binary_sensor = (MakelsanUPS*) id(ha_ups_makelsan_uart_data_ups);
    App.register_component(ups_binary_sensor);
    return {
        ups_binary_sensor-&gt;battery_low
        ,ups_binary_sensor-&gt;beeper_on
        ,ups_binary_sensor-&gt;eco_mode
        ,ups_binary_sensor-&gt;power_status
        ,ups_binary_sensor-&gt;shutdown_active
        ,ups_binary_sensor-&gt;test_in_progress
        ,ups_binary_sensor-&gt;ups_failed
        ,ups_binary_sensor-&gt;ups_type_is_standby
        ,ups_binary_sensor-&gt;utility_fail
    };
  binary_sensors:
  - name: Battery Low
    id: ha_ups_makelsan_battery_low
    device_class: battery
    disabled_by_default: false
  - name: Beeper
    id: ha_ups_makelsan_beeper_on
    icon: mdi:bell-ring
    disabled_by_default: false
  - name: Eco Mode
    id: ha_ups_makelsan_eco_mode
    icon: mdi:leaf-circle
    disabled_by_default: false
  - name: Power Status
    id: ha_ups_makelsan_power_status
    device_class: plug
    disabled_by_default: false
  - name: Shutdown Active
    id: ha_ups_makelsan_shutdown_active
    icon: mdi:power
    disabled_by_default: false
  - name: Test in Progress
    id: ha_ups_makelsan_test_in_progress
    icon: mdi:test-tube
    disabled_by_default: false
  - name: UPS Failed
    id: ha_ups_makelsan_ups_failed
    icon: mdi:battery-alert
    disabled_by_default: false
  - name: UPS Type is Standby
    id: ha_ups_makelsan_ups_type_is_standby
    icon: mdi:power-standby
    disabled_by_default: false
  - name: Utility Fail
    id: ha_ups_makelsan_utility_fail
    icon: mdi:alert
    disabled_by_default: false
switch:
- platform: uart
  name: Beeper Toggle On/Off
  icon: mdi:bell-ring
  id: ha_ups_makelsan_beeper_toggle_onoff
  data:
  - 0x51
  - 0x0D
  disabled_by_default: false
- platform: uart
  name: Test
  icon: mdi:test-tube
  id: ha_ups_makelsan_test
  data:
  - 0x54
  - 0x0D
  disabled_by_default: false
- platform: uart
  name: Test - Cancel
  icon: mdi:test-tube-off
  id: ha_ups_makelsan_test_cancel
  data:
  - 0x43
  - 0x54
  - 0x0D
  disabled_by_default: false
- platform: uart
  name: Test - For Specified Time Period(Minutes 30)
  icon: mdi:test-tube
  id: ha_ups_makelsan_test_for_specified_time_period_30
  data:
  - 0x54
  - 0x33
  - 0x30
  - 0x0D
  disabled_by_default: false
- platform: uart
  name: Test - Until Battery Low
  icon: mdi:test-tube
  id: ha_ups_makelsan_test_until_battery_low
  data:
  - 0x54
  - 0x4C
  - 0x0D
  disabled_by_default: false
- platform: uart
  name: Shutdown 5 Minutes Later
  id: ha_ups_makelsan_shutdown
  icon: mdi:power
  data:
  - 0x53
  - 0x30
  - 0x35
  - 0x0D
  disabled_by_default: false
- platform: uart
  name: Shutdown 5 Minutes Later and Restore 1 Minute Later
  id: ha_ups_makelsan_shutdown_restore
  icon: mdi:power
  data:
  - 0x53
  - 0x30
  - 0x35
  - 0x52
  - 0x30
  - 0x31
  - 0x0D
  disabled_by_default: false
- platform: uart
  name: Shutdown Cancel
  id: ha_ups_makelsan_shutdown_cancel
  icon: mdi:alert-octagon-outline
  data:
  - 0x43
  - 0x0D
  disabled_by_default: false
time:
- platform: homeassistant
  id: homeassistant_time
  timezone: &lt;+03&gt;-3
  update_interval: 15min</code></pre>
</div>
</div>
</p>
<p><a href=""https://i.stack.imgur.com/Cbk7Q.png"" rel=""nofollow noreferrer"">I caught this log.</a></p>
<p>Thanks in advance for your help.</p>",serial-port|ttl|esphome,11191766,Ahmet Büyükgaga,no
How do I get a background location update every n minutes in ios7,"<p>My approach:</p>

<ol>
<li>Start app in foreground and activate location manager </li>
<li>go to background: Stop location manager AND start a timer with e.g. call method every 10mins. </li>
<li>After 10min wake up start location manager and get new gps data</li>
</ol>

<p>Without stopping the location manager bevor going to background it works!
But when not stopping location services it is constantly enabled (battery draining), I want to enable the location service every n minutes and immediately disable it.</p>

<p>Any hints/code what I have to call in applicationDidEnterBackground, to get awake e.g every 10mins.
I have the background modes location updates and BG fetch enabled.
There a lot of questions here with the same topic but in ios7 it seems to be different.</p>",objective-c|ios7|core-location|cllocationmanager|background-process,2974818,user2974818,yes
"Does react-native-firebase package handle the ""Setting a timer for a long period of time is a performance and correctness issue"" warning?","<p>I have been getting a lot of these yellow warnings in my app. Especially in parts of the code where I use firebase/firestore SDK: </p>

<p><strong>Setting a timer for a long period of time, i.e. multiple minutes, is a performance and correctness issue on Android as it keeps the timer module awake, and timers can only be called when the app is in the foreground. See <a href=""https://github.com/facebook/react-native/issues/12981"" rel=""noreferrer"">https://github.com/facebook/react-native/issues/12981</a> for more info. (Saw setTimeout with duration 529480ms)</strong> </p>

<p>I have read a couple of threads on the subject:</p>

<p><a href=""https://stackoverflow.com/questions/46513408/react-native-warning-setting-a-timer-for-a-long-period-of-time-how-to-loc?rq=1"">React Native Warning: &quot;Setting a timer for a long period of time...&quot;. How to locate cause?</a></p>

<p><a href=""https://stackoverflow.com/questions/44603362/setting-a-timer-for-a-long-period-of-time-i-e-multiple-minutes"">Setting a timer for a long period of time, i.e. multiple minutes</a></p>

<p><a href=""https://github.com/facebook/react-native/issues/12981"" rel=""noreferrer"">https://github.com/facebook/react-native/issues/12981</a></p>

<p>Some say it is nothing, just suppress the warning. Some say it is very important and should be handled.</p>

<p>In some of these threads, some people mention that this package: <a href=""https://www.npmjs.com/package/react-native-firebase"" rel=""noreferrer"">https://www.npmjs.com/package/react-native-firebase</a> actually can solve the problem. </p>

<p>1- What type of problems will these timers cause if I just suppress them and do nothing?</p>

<p>2- What is the exact problem here? Battery drainage of my mobile react-native app?</p>

<p>3- Message says ""<em>it keeps the timer module awake, and timers can only be called when the app is in the foreground</em>"" what is the problem indicated here? So the app keeps the timer module awake even if it is in the background? And there is no use to keep it awake since timers can't be called when the app is in the background? And this awake timer module drains the battery?</p>

<p>4- What size of a performance/battery drainage effect are we talking about here?</p>

<p>5- Would that be possible to turn off/on these timers manually in the code as the app is backgrounded/foregrounded? And that would be an actual solution to this?</p>

<p>6- Do you think/know if this react-native-firebase package really handles this situation?</p>

<p>Thanks a lot.</p>",firebase|react-native|google-cloud-firestore,1680793,honor,no
"iPhone, No Garbage Collection: What About MonoTouch?","<p>It's well known that <a href=""https://stackoverflow.com/questions/416108/is-garbage-collection-supported-for-iphone-applications"">Apple does not provide automatic garbage collection on the iPhone to prolong battery life</a>. Yet MonoTouch apps, which reportedly run perfectly on the iPhone (and many are sold through the AppStore, therefore are approved by Apple), do have automatic garbage collection.</p>

<ol>
<li>Is this automatic garbage collection, or does MonoTouch just manage all the <code>retain/release</code> stuff for you?</li>
<li>If it is automatic garbage collection, wouldn't that be a drain on battery?</li>
</ol>

<p><strong>Edit:</strong> If your answer to #1 is ""yes"" and your answer to #2 is ""no,"" <strong>why?</strong></p>

<p><strong>Historical Edit:</strong> It should be noted that Apple has decided to go a different route for iOS 5.0 and implement ARC (also allowing code compiled against the same SDK to work on iOS 4.x as well). </p>",iphone|garbage-collection|xamarin.ios,8047,Dan Rosenstark,yes
Android App Google Play Services Battery Drain,"<p>When using Google Play services API for location and In App Billing request, does the associated Battery/CPU/Wifi/Network usage show up under battery stats under Google Play Services or under the App's Name ?</p>

<p>To my experience OS always shows usage under the associated app's name.</p>

<p>However I have a user claiming that my app causes Google Play Services battery drain with 8-10% on his Nexus 6P when my app does not even show up on his battery stats at all.</p>

<p>Is this somehow possible ?</p>",android|google-play-services|battery,980917,AlexVPerl,no
"Log some power statistics (temp., cpu usage, cpu speed etc.). Bash script for cron","<p>I'm looking for some bash script which can log all the stuff possible to be useuful for getting to know what makes my laptop's battery drain so fast.</p>

<p>Pointless to ask what can cause my laptop being so no-power efficent, I've been looking for this for some time now.</p>

<p>So, I think I can find something useful if do measure for:
 - CPU temp.,
 - CPU usage,(average?)
 - CPU current speed, (average?)
 - Battery status,
 - DPM power state (cat /sys/class/drm/card0/device/power_dpm_state)</p>

<p>There are propably more usefull things to record, but these are ma first shot. Can anyone help me with writing this down as a script resulting with one line per measure log file.</p>

<p>Regards!</p>",bash|file|logging|battery|measure,4403519,user147629,yes
adding an app to battery saver programmatically when the app is installed,"<p>i developed an Android application, it contains so much background services and it uses Medias unfortunately this app is draining the battery life fast
i search the web but i didn't reach a good solution, i'm asking if possible how to put the app programmatically in battery saver 
it's a solution at least but i want that programmatically
when the app is installed.</p>

<p>please give me some suggestions </p>

<p><a href=""https://i.stack.imgur.com/AL1th.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/AL1th.png"" alt=""enter image description here""></a></p>",android|battery|battery-saver,5550974,evalboy,yes
Is findViewByID time or resource consuming,"<p>In my application of tabs, everytime the tab is changed, I use the findViewByIDs of the  views/elements of that tab (16 items). I was wondering is it slow, battery drainer or time consuming to use this method? Or should I store all the 16 values * 4 tabs as class variables and just use them when I need them?</p>

<p>Whats you design experience. Thank you</p>",android|android-layout,1217820,Snake,yes
Reducing traffic and server pay load when polling .NET web service,"<p>I have an Android (business) application which should create a <strong>notification</strong> and later update its content as soon as possible specific data changes on the server side. The data is accessed through a .NET REST style web service hosted in IIS, which serves maximal 1000 users.</p>

<p>I read about GCM services for push notifications which would have a lot of benefits. The reasons why I think I can not use it are:</p>

<ul>
<li>The devices need to have set up a google account which is an additional deployment cost</li>
<li>The devices are not bound to a single person, but the content is. The users log in via application.</li>
</ul>

<p><strong>So i think i need to poll in a specific interval</strong>, where i will consider techniques not to drain the battery. It would be great, if the delay between data change and notification is less than a minute.</p>

<p>To make some approximated and estimated calculations:</p>

<ul>
<li>Traffic / for a minute interval / per day / per device: ~500bytes for a HTTP GET request * 60 * 24 = ~700kb</li>
<li>Pay load / per minute / for 1000 users: 1000 database Guid lookups on an indexed column ~3s</li>
</ul>

<p><strong>I would like to reduce traffic and pay load to the lowest.</strong> So i need a technique which allows me to send less requests which does not affect the delay between change and notification which the users really consumes in the meaning of giving attention to.</p>

<p>Edit:
Ok, I got a little deeper into the topic. A keyword is Comet. The right way to go for me seems to be long-polling techniques. Other keywords in the context of web development are server-sent events and web sockets, both require HTML5 which is anyway not touched here. Right know i am looking for a way not being forced to set up a messaging infrastructure. I'd like to use to integrate that notification feature in the existing web service. I'll update if i find an answer.</p>

<p><strong>How would you reduce traffic and pay load?</strong>
Maybe interesting. How does GCM do this? They can not really notify the device. They need to poll as well. They need to deal with a lot of requests as well. They care about traffic as well i guess. Edit:(Ok, they are using an xmpp infrastructure for that api functionality in the app engine api, so i guess it will be similar in gcm)</p>

<p>Thanks for your opinions.</p>",android|web-services|google-cloud-messaging|long-polling,715223,Diego Frehner,yes
Upload via git-ftp was interrupted and stopped half way. Any idea on how to continue?,"<p>I was uploading to my remote server using git ftp init.</p>

<p>Due to battery drainage the system went off while the upload was half way. Now i have partial file in the remote server.</p>

<p>Is there any way I can continue the upload and harmonize the files between the local and remote server?</p>

<p>Do you know any git ftp command that can handle it automatically or continue from where the upload stopped?</p>",git|ftp|git-ftp,3551755,Wisdom,yes
How long does it take on average to deliver high priority GCM message IRL?,"<p><strong>Intro:</strong></p>

<p>I have an Android app that is notified by my server when security related event happens. Currently I am using pull, i.e. the app constantly ""pings"" th server in order to check for new messages. The problem is that (as expected) it drains the battery. For some users timely notification is more important than the battery life but for others it is quite the opposite and I will implement GCM in order to avoid pinging the server.</p>

<p><strong>My question is:</strong></p>

<p>Did someone gathered statistics from the real life how long it takes on average to deliver a push notification to the phone  (Android) (in different phone modes as screen on/off/sleep)?</p>

<p>If you don't have statistics what is roughly your experience? Is it 1 minute / 2 minutes / 5 / 10 minutes? Probably a range will be more usable.</p>

<p>P.S. I've read the docs saying ""High priority. This is the default priority for notification messages. GCM attempts to deliver high priority messages immediately"". This simply does not provide enough info.</p>",android|google-cloud-messaging,425183,Ognyan,no
"How to detect that user removed my app from ""Not optimized"" list in battery optimization?","<p>I have an app that needs to ignore doze mode and it asks the user to add it to not optimized apps list the usual way with:</p>

<pre><code>    Intent intent = new Intent();
    String packageName = getPackageName();
    intent.setAction(Settings.ACTION_REQUEST_IGNORE_BATTERY_OPTIMIZATIONS);
    intent.setData(Uri.parse(""package:"" + packageName));
    startActivityForResult(intent, BATTERY_OPTIMIZATION_REQUEST);
</code></pre>

<p>In <code>onActivityResult()</code> I check if he really added it to ""Not optimized"" list. So far so so good. My app starts its service which gets and holds a WAKE_LOCK and works permanently (Yes, I know that this drains the battery but my use case requires it).</p>

<p>My problem is that later the user may decide to remove the app from the ""Not optimized"" list.</p>

<p>My question(s):</p>

<ol>
<li><p>Is there a broadcast which I can register for to get notified that battery optimization settings changed?</p></li>
<li><p>If not, is there another way to detect that battery optimization setting for my app changed than periodically check its state with <code>isIgnoringBatteryOptimizations()</code></p></li>
</ol>

<p>Initially I thought that in this case the app will be stopped (as when permission is removed) but that is not the case.</p>",android|broadcastreceiver|battery|android-powermanager,425183,Ognyan,yes
Android - create a service that runs once a day,<p>I'd like to create a service for Android that performs an operation once a day at a given time.  What's an efficient way to accomplish this - I want to make sure I'm not draining the device battery since this service is idle 99% of the time.</p>,java|android|service,82017,James Cadd,no
automatic dimming keyboard backlight in linux,"<p>I'd like to automate keyboard backlight on my Thinkpad X1, like I was used in my old XPS13. At any key press the backlight should switch on, and after a certain idle time (here 30 s) backlight should switch off.
I've written this basic bash script, which works fine although it polls every second through <code>xprintidle</code>, and it may drain some battery:</p>

<pre><code>#!/bin/bash

function switch {
  echo $1 &gt; /sys/devices/platform/thinkpad_acpi/leds/tpacpi\:\:kbd_backlight/brightness
}

while (true); do

  sleep 1
  last=`xprintidle`
  status=`cat /sys/devices/platform/thinkpad_acpi/leds/tpacpi\:\:kbd_backlight/brightness`
  [ $last -lt 20000 -a $status -lt 2 ] &amp;&amp; switch 2 &amp;&amp; continue
  [ $last -ge 20000 -a $status -eq 2 ] &amp;&amp; switch 1 &amp;&amp; continue
  [ $last -ge 30000 -a $status -ge 1 ] &amp;&amp; switch 0 &amp;&amp; continue

done
</code></pre>

<p>I was wondering if some non-polling way could be done, such as through systemd or dbus.</p>

<p>Thank you in advance</p>",linux|bash|systemd|dbus,3049469,cipper,yes
How to send FCM notification to rarely used app,"<p>I have a Cordova app that receives secure messages from a service provider, through our servers, to an app installed on a phone by the user. However, the app may be rarely used (in the order of 12 months or so). In the event that the provider needs to contact the user we currently send an FCM notification. The problem is that because we don't want to place any drain on the user's battery for a service that they rarely use (although is extremely valuable) then we don't try and run anything in the background - which means that according to the firebase document <a href=""https://firebase.google.com/docs/cloud-messaging/concept-options#lifetime"" rel=""nofollow noreferrer"">Lifetime of a message</a> the message will be discarded if the user doesn't open the app for one month.
The referenced doc states:</p>

<blockquote>
  <p>If the device has not connected to FCM for more than one month, FCM still accepts the message but immediately discards it. If the device connects within four weeks of the last data message you sent to it, your client receives the onDeletedMessages() callback. The app can then handle the situation properly, typically by requesting a full sync from the app server.</p>
</blockquote>

<p>How are we supposed to inform the user that there is a message for them?</p>

<p>I understand why such a precaution <em>can</em> make sense, but what options exist to allow us to receive the notification causing minimal impact on the users' device?</p>",android|ios|firebase|firebase-cloud-messaging|cordova-plugin-fcm,1767875,MarkH,yes
"swift iOS , location manager startUpdatingLocation in background when didEnterRegion","<p>I would like to start updating the location (didUpdateLocations should be called every meter or so) after a geo fence enter event (didEnterRegion) for a certain time. That all in the background so I do have:
locationManager.allowsBackgroundLocationUpdates = true</p>

<p>But for some reason didUpdateLocations is only called for about 10 seconds after the didEnterRegion event.
When I start my app with startUpdatingLocation and allowsBackgroundLocationUpdates = true, didUpdateLocations is called every meter or so for unlimited time. But obviously I can´t have it running in the background all time since it will drain the battery in no time.</p>

<p>Any ideas?
Many Thanks
Stephan</p>",ios|swift|location,6714661,StephanD,yes
Running tasks at regular intervals in android,"<p>I have an app which has tasks that run on regular intervals.</p>

<p>Instead of using timers I use <a href=""http://developer.android.com/reference/android/os/Handler.html#sendMessageDelayed(android.os.Message,%20long)"" rel=""nofollow""><code>Handler.sendMessageDelayed(Message, long)</code></a>.</p>

<p>My service starts a <a href=""http://developer.android.com/reference/java/lang/Thread.html"" rel=""nofollow""><code>Thread</code></a> which, when done, sends a message to the service's handler which in turn sends a message with a delay to itself saying it should start the task again.</p>

<p>This works fine, at a start.<br>
As a test I set the delay to 10 seconds and left the phone for an hour or so expecting to see a log entry every 10 seconds (plus a few milliseconds for execution) and at a start that is what happened but as soon as I close the screen this happens:</p>

<pre>
06-15 23:19:46.237: INFO/Service(12932): Starting
06-15 23:19:46.667: VERBOSE/DebugTask(12932): Fire
06-15 23:19:56.687: VERBOSE/DebugTask(12932): Fire
06-15 23:20:04.237: DEBUG/dalvikvm(12932): Debugger has detached; object registry had 1 entries
06-15 23:25:34.788: VERBOSE/DebugTask(12932): Fire
06-15 23:27:11.338: VERBOSE/DebugTask(12932): Fire &lt;- Screen on
06-15 23:27:21.348: VERBOSE/DebugTask(12932): Fire
06-15 23:27:31.368: VERBOSE/DebugTask(12932): Fire
06-15 23:27:41.378: VERBOSE/DebugTask(12932): Fire
06-15 23:27:51.388: VERBOSE/DebugTask(12932): Fire
06-15 23:27:55.158: DEBUG/dalvikvm(12932): GC_EXTERNAL_ALLOC freed 127K, 47% free 2891K/5447K, external 2114K/2137K, paused 94ms
06-15 23:27:56.788: INFO/Service(12932): Shutting down
06-15 23:27:56.808: INFO/Service(12932): Service has stopped
</pre>

<p>It only seems to happen when the screen is off. Could this be a priority issue? Could service get paused while other stuff is running?</p>

<p>In this case would changing it to timers make a difference?<br>
I'd rather not use timer due to threading issues, handlers solve this nicely for me.</p>

<p>Below I've attached relevant code for the app, I'd be happy to provide anything else that you might require.</p>

<p>My service's handler handles other messages than starting tasks but none of the other types of messages are long running, they involve showing notifications and delegating messages to other handlers so I don't believe that the service thread is busy with other messages.<br>
The service might be busy with other stuff however, I'm not sure what calls a service might get during it's lifetime.</p>

<p><b>Service.java:</b></p>

<pre><code>private void startTask(Class&lt;? extends Task&gt; taskClass) {
    Task task = null;
    try {
        Constructor&lt;? extends Task&gt; c = taskClass.getConstructor();
        task = c.newInstance();
    } catch (Exception e) {
        Log.e(""Service"", ""Failed to create class of type "" + taskClass.getName(), e);
    }

    if(task != null) {          
        runningTasks.put(taskClass, task);
        task.start();
    }
}

private void taskDone(Class&lt;? extends Task&gt; taskClass) {
    runningTasks.remove(taskClass);

    SharedPreferences prefs = getPreferences();

    try {
        long interval = (Long)taskClass.getDeclaredMethod(""getInterval"", SharedPreferences.class).invoke(null, prefs);

        if(interval &lt; 0)
            return;
        else {
            Message msgTmp = handler.obtainMessage(ServiceHandler.START_TASK, taskClass);
            handler.sendMessageDelayed(msgTmp, interval*1000);
        }

    }
    catch(NoSuchMethodException e) {
        Log.w(""Service"", String.format(""Task %s does not implement method getInterval"", taskClass.getSimpleName()));
    } catch (Exception e) {
        Log.w(""Service"", String.format(""Could not call getInterval on task %s"", taskClass.getSimpleName()), e);
    }
}

public class ServiceHandler extends Handler {
    /* Constants */
    public static final int TASK_DONE = 1; // obj contains the class
    public static final int START_TASK = 2; // obj contains the class

    @SuppressWarnings(""unchecked"")
    public void handleMessage(Message msg) {
        if(msg.what == TASK_DONE)
            taskDone((Class&lt;? extends Task&gt;)msg.obj);

        else if(msg.what == START_TASK)
            startTask((Class&lt;? extends Task&gt;) msg.obj);
    };
};
</code></pre>

<p><b>Task.java:</b></p>

<pre><code>public abstract class Task extends Thread {
    @Override
    public final void run() {
        preRunTask();
        runTask();
        postRunTask();
        sendFinish();
    }

    private synchronized void sendFinish() {
        if(serviceHandler == null)
            return;
        Message m = serviceHandler.obtainMessage(ServiceHandler.TASK_DONE, getClass());
        serviceHandler.sendMessage(m);
    }
}
</code></pre>

<p><b>DebugTask.java:</b></p>

<pre><code>public DebugTask extends Task {
    public static long getInterval(SharedPreferences prefs) {
        return Long.parseLong(prefs.getString(FREQUENCY_KEY, ""-1""));
    }

    @Override
    protected void runTask() {
        Log.v(""DebugTask"", ""Fire"");
    }
}
</code></pre>

<hr>

<h2>Update 1</h2>

<p>I tried calling <a href=""http://developer.android.com/reference/android/app/Service.html#startForeground(int,%20android.app.Notification)"" rel=""nofollow""><code>Service.startForeground(int, Notification)</code></a> but it made no difference.</p>

<hr>

<h2>Update 2</h2>

<p>After a lot of digging it turns out I basically need to acquire a <a href=""http://developer.android.com/reference/android/os/PowerManager.html"" rel=""nofollow"">partial wakelock</a> in order for my service to run when the screen is shut down.</p>

<p>This of course will drain the battery of the phone which is not really desired.<br>
Is there any way to run my tasks at a certain interval without having a constant wakelock?</p>

<p>I basically want my app to sleep when there isn't any work to be done and wake up when a task to run, run that task and then go back to sleep, is that possible?</p>

<p>I know there is <a href=""http://developer.android.com/reference/android/app/AlarmManager.html"" rel=""nofollow""><code>AlarmManager</code></a> which I could potentially use but that will be very hard to implement since that will run my service at a regular intervals when in reality I have multiple threads which all needs to run a different intervals.</p>

<hr>

<h2>Update 3</h2>

<p>I'm working on a fairly complex solution using partial wake locks and the alarm manager, I'll post back when I succeed/fail.</p>

<hr>

<h2>Final update</h2>

<p>As I wrote in update 3 my final solution skips sendDelayed completely and use the alarm manager instead, while each task is running a partial wakelock is acquired and it's released when the task is done.</p>",android|multithreading,699304,Nicklas A.,yes
Get New Location when App Enters Foreground,"<p>I am having difficulty implementing what I think should be a pretty simple capability. I have an button that compares the user's location to another set of lat/lon coordinates and displays an alert telling the user if they are ""nearby"" or ""far away"" from the location. This works well if the app remains in the foreground.</p>

<p>However, if the app gets sent to the background, the locationManager stops updating the user's location. If this happens, when the user brings the app back up and presses the ""compare location button"", the app doesn't seem to be able to get the user's new coordinates correctly.</p>

<p>Adding receive location updates to the background modes seems to work, but I know this will drain battery an may be rejected by Apple.</p>

<p>All I really want is to be able to have the button wait for an accurate set of lat/lon coordinates before trying to calculate the distance between the user and the other set lat/lon coordinates. Here is what I have so far:</p>

<p><strong>The Location Button Does This:</strong></p>

<pre><code>-(void) locationButton { 
    NSString *userLatitude =[(PDCAppDelegate *)[UIApplication sharedApplication].delegate 
    getUserLatitude];

    NSString *userLongitude =[(PDCAppDelegate *)[UIApplication sharedApplication].delegate 
    getUserLongitude];

    NSString *placeLatitude = [[NSUserDefaults standardUserDefaults]
                               stringForKey:@""savedLatitude""];
    NSString *placeLongitude = [[NSUserDefaults standardUserDefaults]
                                stringForKey:@""savedLongitude""];
    NSString *distanceURL = [NSString stringWithFormat:@""http://www.website.com/page.php?
    lat1=%@&amp;lon1=%@&amp;lat2=%@&amp;lon2=%@"",userLatitude, userLongitude, placeLatitude, 
    placeLongitude];

    NSData *distanceURLResult = [NSData dataWithContentsOfURL:[NSURL 
    URLWithString:distanceURL]];  
    NSString *distanceInFeet = [[NSString alloc] initWithData:distanceURLResult 
    encoding:NSUTF8StringEncoding];

    if ([distanceInFeet isEqualToString:@""1""]) {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@""You're Near!"" 
        message:@"""" delegate:self cancelButtonTitle:@""OK"" otherButtonTitles:nil, nil];
        [alert show];
        return;   
    }
    if ([distanceInFeet isEqualToString:@""0""]) {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@""You're Far!"" message:@"""" 
        delegate:self cancelButtonTitle:@""OK"" otherButtonTitles:nil, nil];
        [alert show];
        return;
    }   
}
</code></pre>

<p><strong>The first few lines of the locationButton method get the userLatitude and userLongitude from my App Delegate:</strong></p>

<pre><code>- (NSString *)getUserCoordinates {
    NSString *userCoordinates = [NSString stringWithFormat:@""latitude: %f longitude: %f"", 
    locationManager.location.coordinate.latitude, 
    locationManager.location.coordinate.longitude];
    locationManager = [[CLLocationManager alloc] init];
    locationManager.distanceFilter = kCLDistanceFilterNone; // whenever we move
    locationManager.desiredAccuracy = kCLLocationAccuracyHundredMeters; // 100 m
    [locationManager startUpdatingLocation];
    return userCoordinates;
}

- (NSString *)getUserLatitude {
    NSString *userLatitude = [NSString stringWithFormat:@""%f"", 
    locationManager.location.coordinate.latitude];
    return userLatitude;
}

- (NSString *)getUserLongitude {
    NSString *userLongitude = [NSString stringWithFormat:@""%f"", 
    locationManager.location.coordinate.longitude];
    return userLongitude;
}
</code></pre>",iphone|ios|objective-c|cllocationmanager,810984,Brandon,yes
Getting Accurate Coordinates when App Brought to Foreground,"<p>I need my app to display very accurate latitude and longitude coordinates when it is brought from the background to the foreground.</p>

<p>I am having quite a bit of trouble doing this. When I put my app in the background, the location services turn off. I have considered enabling the background location mode, but am aware that doing so may cause the user's battery to drain. I have also attempted to use <code>startMonitoringSignificantLocationChanges</code> but that doesn't seem to be accurate.</p>

<p>My view has a button that displays the user's coordinates when clicked. When the button is clicked while walking around, the coordinates are accurate. But if the user awakens the app and immediately clicks the button, the coordinates are way off. Can anyone help me with this? Is enabling the background location mode my only option? Can I disable the button until the location is accurate? any help would be greatly appreciated!</p>

<p>My view pulls the coordinates from a locationManager that is setup in my app delegate like below:</p>

<p><strong>Here is the view:</strong></p>

<pre><code>-(void&gt;buttonClick {

NSString *userLatitude =[(PDCAppDelegate *)[UIApplication sharedApplication].delegate 
getUserLatitude];

NSString *userLongitude =[(PDCAppDelegate *)[UIApplication sharedApplication].delegate 
getUserLongitude];
}
</code></pre>

<p><strong>Here is the app delegate:</strong></p>

<pre><code>- (NSString *)getUserLatitude {
    NSString *userLatitude = [NSString stringWithFormat:@""%f"", 
    locationManager.location.coordinate.latitude];
    return userLatitude;
}

- (NSString *)getUserLongitude {
    NSString *userLongitude = [NSString stringWithFormat:@""%f"", 
    locationManager.location.coordinate.longitude];
    return userLongitude;
}
</code></pre>",iphone|ios|objective-c|cllocationmanager,810984,Brandon,no
Android 5.0 - how to wake up device display? Scienctific app,"<p><strong>Question</strong></p>

<p>Since there is only one Wake-Lock left with 5.0, what is the way to force the device to go out of standby for 2-5 Seconds and then go back black. No interaction, no unlock of keys... just out of standby. All solutions I found work with deprecated Wake-Locks.</p>

<p>I know it´s a bad idea and Google want to forbid it to me... do this for normal apps makes sense, but I work on a scientific app where I need it and can risk the battery drain. </p>

<p>Can I force a deprecated wake lock to work under a newer OS?</p>

<p><strong>Why I need this?/What I do/2 Devices == Different behavoíour</strong></p>

<p>I have a step counter, write the values to a sqlite db - at a alarm i look to the db and ask for the steps. based on this I do some magic. </p>

<p><em>Sony:</em> With the Sony Xperia Z1 compact it works, because they don´t stop the sensors while Standby. So no batching.</p>

<p><em>Samsung:</em> Same app, also step counter as sensor. But here I always get 0 steps when I ask for them in my alarm. A workaround: When I start the device out of standby for a moment and go to black again. My alarm can get the right value. And this is what I need. So I want to activate the display before I ask for the steps. Then the batched sensor data must be in the db and I get the right steps. </p>

<p>So any solutions? Wake-Locks over the service runtime, where my step counter is inside, are not working.</p>

<p>Big thank you, and I am sure for this case there is no duplicate Question. Get points and make me happy. Big Thank you for your help!</p>",android|standby,3929224,Julian,yes
"Can I control what types of Geolocation service types (Wifi, GPS, Cell Triangulation) I use in PhoneGap with application logic?","<p>I am trying to determine if I can allow an application to intelligently decide when to use certain location services at the hardware level based on context. For example, if they have been inside (and out of GPS coverage for 5 minutes), it would be nice to poll wifi instead as GPS polling when out of coverage could cause a significant battery drain as I plan to be frequently checking for fine grain location. The application will need to use a PhoneGap API or a plain external JavaScript library if one has cross platform to native sensors. </p>

<hr>

<p>Here are other sources that I have looked at, including the documentation, but they don't seem to address my question. </p>

<p><a href=""https://stackoverflow.com/questions/19140722/phonegap-geolocator-using-wifi-instead-of-gps"">PhoneGap geolocator using WiFi instead of GPS</a></p>

<p>PhoneGap Location Documentation:   <a href=""http://docs.phonegap.com/en/edge/cordova_geolocation_geolocation.md.html"" rel=""nofollow noreferrer"">http://docs.phonegap.com/en/edge/cordova_geolocation_geolocation.md.html</a></p>

<p>W3C Geolocation API Spec:  <a href=""http://dev.w3.org/geo/api/spec-source.html#api_description"" rel=""nofollow noreferrer"">http://dev.w3.org/geo/api/spec-source.html#api_description</a></p>

<p>Many thanks in advance!</p>",cordova|gps|geolocation|phonegap-plugins,2831961,daniel.caspers,yes
"What is Chromium's ""Throttle Javascript timers in background"" feature and how to handle it?","<p>Since version 86 of Chromium, there is a new experimental feature called &quot;Throttle Javascript timers in background&quot; that is added to fix the high battery drain of Chromium browsers.</p>
<p>The description says:</p>
<blockquote>
<p>In a Window whose top Window has been hidden for 5 minutes, timers can
run:</p>
<ul>
<li>aligned on 1-minute intervals, or,</li>
<li>if the Window is same-origin with the top Window, &gt; 1 minute after the last timer has run in any Window in the tree that is same-origin
with the top Window.</li>
</ul>
<p>In a page that has been backgrounded for less than 5 minutes, keep the
existing policy of aligning wake ups from timers on 1-second
intervals.</p>
</blockquote>
<p>Are they referring to the DOM functions <code>setTimeout</code> and <code>setInterval</code>? How exactly are those handled on these circumstances?</p>
<p>I imagine to have a <code>setInterval</code> for every 5 seconds that will be modified to 60 seconds as soon as the tab is hidden for 5 minutes. Doing the same for <code>setTimeout</code> might cause many jobs to run at the same time when returning to a tab. Skipping those could break logic, so simple job queues could cause other issues in the website.</p>
<p>So, how is the feature working, exactly? And, how can a developer make sure their logic won't break while the throttling is active?</p>",javascript|chromium,1540350,Martin Braun,no
Android - Best pratice to repeat a task in the background even if the screen is locked,"<p>What is the best way to repeat a task on android with a short period (for example 2 seconds)? It must keep running even if the screen is locked. If I am not mistaken only the AlarmManager can be used for it because it wakes up the phone from sleep but it should not be used for such a short period (recommended minimum 1 minutes) because it drains your battery and uses too much resource. So what type of notification tool is used by chat programs like Facebook Messenger or Skype to keep the user notified in every second of a day?
Thank you in advance.</p>",android|notifications|task,2645964,user2645964,no
Deplorable GPU rendering profile only with just the cursor blinking,"<p>This is a problem that has me struck with confusion. I was profiling an app I am developing and noticed that whenever I stopped scrolling a RecyclerView the GPU profile started accusing horrible stats. I could not understand why this was happening, nothing on the screen appeared to be updating until I noticed something changing behind the GPU profile graph in sync with the graph update.</p>

<p>It was the cursor blinking in an EditText view.</p>

<p>I could not believe that I had develop an app that would behave so horribly only when the cursor was blinking, so I investigated other apps, google apps and found out that the issue is present everywhere and it is not restricted to my app.</p>

<p>The following is a screenshot taken of just the cursor blinking inside the searchbox of the Gmail official app.</p>

<p><a href=""https://i.stack.imgur.com/oq6Wi.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/oq6Wi.png"" alt=""enter image description here""></a></p>

<p>As you can see the GPU profile is unacceptable.</p>

<p>Is there anyway to fix this or avoid this issue? I recall testers complaining of battery drain when the app was open doing nothing, but I assumed at the time it was related to a bug that existed with a socket connection. Now when considering this problem and the testers often leave their phones on the same screen where a cursor is always blinking it's very likely the cause of the battery drain, so it would be important to reduce the impact that a simple blinking cursor has.</p>

<p>Do consider that I don't intend to rewrite the cursor nor change it's expected behavior, I'm simply trying to reduce the impact the blinking cursor has on the GPU.</p>",android|memory-leaks|gpu|android-cursor|battery,524695,Shadow,yes
ESP32 BLE and Android phone(s) - presence detection,"<p><strong>Is there a possibility how to &quot;overcome&quot; BLE MAC address randomization and detect presence of my own Android phone(s)?</strong></p>
<p>I'm looking for a solution how to detect presence of my phone in close-range to ESP32 without installing something like iBeacon app which would drain my battery.</p>
<ul>
<li>I've started with example for BLE sniffer which works nice but with MAC randomization on Android it is useless.</li>
<li>Then I moved to the solution using emulation of a HID keyboard. After pairing it, it is nicely reconnecting when the phone comes into the range. Once it is connected I can trigger needed action and then I can turn ESP32 Bluetooth off not to be connected whole time. When I need check the phone again I just can turn the server back on. It would be neat solution but... I need to check more (at least two) phones. I've tried to duplicate BLEServers to swith between or run two simoutinasly but without success - either it is not possible or it is exceeding my knowladge about this BLE advertising/pairing/connecting magic.</li>
<li>Third solution would be to have separate ESP for each phone - doable but only as a last resort</li>
</ul>
<p><strong>Has somebody solved such task somehow already?</strong></p>
<p>For the keyboard solution I'm using this code found online:</p>
<pre><code>#include &lt;Arduino.h&gt;
#include &lt;BLEDevice.h&gt;
#include &lt;BLEUtils.h&gt;
#include &lt;BLEServer.h&gt;
#include &quot;BLE2902.h&quot;
#include &quot;BLEHIDDevice.h&quot;
#include &quot;HIDTypes.h&quot;
#include &quot;HIDKeyboardTypes.h&quot;
#include &lt;driver/adc.h&gt;

BLEHIDDevice* hid;
BLECharacteristic* input;
BLECharacteristic* output;
BLEAdvertising *pAdvertising;
BLEServer *pServer;

bool connected = false;
bool restart = false;

class MyCallbacks : public BLEServerCallbacks {
  void onConnect(BLEServer* pServer){
    connected = true;
    Serial.println(&quot;Connected&quot;);
    BLE2902* desc = (BLE2902*)input-&gt;getDescriptorByUUID(BLEUUID((uint16_t)0x2902));
    desc-&gt;setNotifications(true);
    // NEEDED ACTIONS
  }

  void onDisconnect(BLEServer* pServer){
    connected = false;
    Serial.println(&quot;DisConnected&quot;);
    BLE2902* desc = (BLE2902*)input-&gt;getDescriptorByUUID(BLEUUID((uint16_t)0x2902));
    desc-&gt;setNotifications(false);
    restart = true;
  }
};

void setup() {
  Serial.begin(115200);
  Serial.println(&quot;Starting BLE work!&quot;);
  BLEDevice::init(&quot;Backpack-MeowMeow&quot;);
  pServer = BLEDevice::createServer();
  pServer-&gt;setCallbacks(new MyCallbacks());
  pServer-&gt;getPeerDevices(true);

  hid = new BLEHIDDevice(pServer);
  input = hid-&gt;inputReport(1); // &lt;-- input REPORTID from report map
  output = hid-&gt;outputReport(1); // &lt;-- output REPORTID from report map

  std::string name = &quot;ElectronicCats&quot;;
  hid-&gt;manufacturer()-&gt;setValue(name);

  hid-&gt;pnp(0x02, 0xe502, 0xa111, 0x0210);
  hid-&gt;hidInfo(0x00,0x02);

  BLESecurity *pSecurity = new BLESecurity();
  //  pSecurity-&gt;setKeySize();
    pSecurity-&gt;setAuthenticationMode(ESP_LE_AUTH_BOND);

    hid-&gt;startServices();

    pAdvertising = pServer-&gt;getAdvertising();
    pAdvertising-&gt;setAppearance(HID_BARCODE);
    pAdvertising-&gt;addServiceUUID(hid-&gt;hidService()-&gt;getUUID());
    pAdvertising-&gt;start();
    hid-&gt;setBatteryLevel(7);

    //ESP_LOGD(LOG_TAG, &quot;Advertising started!&quot;);
    //delay(portMAX_DELAY);
}

void loop() {
  
  if(connected){
    delay(10);
  }
  if (restart) {
    restart = false;
    pAdvertising-&gt;start();
  }
  delay(50);
}
</code></pre>",android|bluetooth-lowenergy|esp32|sniffer,16031759,Jan Novák,yes
Activity indicator with custom image,"<p>I am loading a <code>UIWebView</code> and in the meantime I wan't to show a blank page with this<img src=""https://i.stack.imgur.com/vtZsA.png"" alt=""spinner""> activity indicator spinning (siri activity indicator). From what I have understand you can not change the image, but can't I use that image and create an animation with it rotating 360° and looping? Or will that drain the battery? </p>

<p>something like this?:</p>

<pre><code>- (void)webViewDidStartLoad:(UIWebView *)webView {
    //set up animation        
    [self.view addSubview:self.loadingImage];
    //start animation
}

- (void)webViewDidFinishLoad:(UIWebView *)webView
{   
    //stop animation
    [self.loadingImage removeFromSuperview];
}
</code></pre>

<p>What should I do?</p>

<p>Thanks in advance!</p>",ios|objective-c|uiwebview|uiimageview|uiactivityindicatorview,3127637,Tibbe,no
iPhone screen sleep - built in proximity sensor,"<p>Bon jour</p>

<p>is it possible to implement the following:</p>

<p>a. user places the iphone screen side down.
b. the screen sleeps (black) 
c. the app reamins in foreground with full functionality</p>

<p>I believe other apps might achieve this with the proximity sensor?</p>

<p>Will this drain the battery significantly?</p>

<p>Cheers!</p>",iphone|ios|sleep|proximitysensor,1994480,TurtleKurtze,yes
Retrieve the battery drain level in Android,"<p>I have seen that some applications show the amount of mV/hour the battery is consuming. Is there a way of retrieving that info? Or those programs are periodically reading the ACTION_BATTERY_CHANGED intent,recording the voltage level and calculating the gradient?</p>",java|android|battery,838216,Caroline,no
Does apple permit background facial recognition in iOS app?,"<p>We are building an app for kids, where they can interact with animation character. We want to get camera feed while in interacting without show camera feed on UI for facial recognition. Continious accessing camera can drain battery and could have privacy issue. Does apple permit it?</p>

<p><a href=""https://developer.apple.com/app-store/review/guidelines/"" rel=""nofollow noreferrer"">Apple review guidelines</a> does not mention any related information. </p>",ios|swift|camera|appstore-approval|facial-identification,1372394,Shamim Hossain,no
Android. connect bluetooth devices,"<p>I'm attempting to write an app that involves connecting two android devices via bluetooth.</p>

<p>It is my understanding that one device acts as a server, listening for incoming connections while the other acts as the client, and initializes the connection using the server's MAC address.</p>

<p>Consider the following:</p>

<p>I have my android phone in my pocket, I start working on my android tablet. I want to connect the tablet to the phone (via bluetooth) without taking the phone out of my pocket (I do not want to pull out the phone and manually start listening for incoming connections).</p>

<p>What would be a good way to achieve this? It seems like I would have to make the phone the server, constantly listening for connections 24/7.  However, my gut says this will violently drain the battery.</p>

<p>Any suggestions? </p>",android|bluetooth,391979,jwheels,yes
Polling Battery Drain,"<p>I'd like to know how much polling will drain battery life. Is it dependent on the message size? Or is just the fact that I'm polling at all that makes it drain the batter?</p>

<p>I can provide more details:</p>

<p>Polling once every two seconds, and the message length is 60 bytes (on average)</p>",javascript|cordova|polling,973651,Mathew Berg,yes
"How to prevent ""App is draining battery"" notification","<p>We have a driving behavior monitoring app that requires gathering location and sensor data from phone in background when the user is driving a vehicle. We take the requisite permissions from user during onboarding to be able to access Location All the time. We also optimise the data collection to reduce battery consumption.</p>
<p>Still, some of our users get a sporadic message generated by Android that our App is draining the battery.</p>
<p>Is there any Android documentation that defines the criteria on when such a notification is shown. If the user ignores the notification, will it still keep coming. Is there anything a developer can do to prevent that notification from popping up.</p>
<p>Thanks</p>",android|android-location|android-background,19261229,Sigma Android,yes
Power off mode tasks handling with CMSIS RTOS,"<p>I am working on a battery operated device which has <a href=""https://www.keil.com/pack/doc/CMSIS/RTOS2/html/index.html"" rel=""nofollow noreferrer"">CMSIS RTOS v2</a> and STM32 F4 where device turns ON and OFF based on button interrupt. When a GPIO interrupt is received, the device turns ON and OFF on other interrupt.
Along with that I have 2 tasks running; capture sensor data and process it and other, send data over RF if available.</p>
<p>Things are working fine except I want to stop sensor &amp; RF operations since device shouldn't be operational and to conserve battery when the button is in OFF state.</p>
<p>I am able to detect device ON and OFF state and before going to OFF state, I disable sensor and RF operations. The issue is, the tasks are still running.</p>
<p>Below is pseudo implementation</p>
<pre class=""lang-c prettyprint-override""><code>void SensorTask(void *argument)
{
    while (1)
    {
        if (device_state == DEVICE_ON)
        {
            // perform expected task
        }
    }
}

void RFTask(void *argument)
{
    while (1)
    {
        status = osMessageQueueGet(rfTaskQueueId, rf_task_msg, 0, osWaitForever);
        if (status == osOK)
        {
        }
    }
}

void enter_sleep_mode(void)
{
    // disable peripherals
    // configure wakeup interrupt
}
</code></pre>
<p>With above implementation; sensor task keeps on checking device state since it is polling based code and rftask waits for osMessage.
I think this process itself may drain some amount of power and there can be better way to implement this.</p>
<p>Is <a href=""https://www.keil.com/pack/doc/CMSIS/RTOS2/html/group__CMSIS__RTOS__ThreadMgmt.html#gaa9de419d0152bf77e9bbcd1f369fb990"" rel=""nofollow noreferrer"">osThreadSuspend</a> a better choice here or there is some other way to implement this?</p>",c|embedded|rtos|cmsis,13346449,Android_dev,no
"How can we calculate/ to know, how much battery life my user defined application utilising?","<p>Here my question is, can we identify, how much battery life my android application is utilising. Because I developed an app based on GPS as well as network, service, broadcast receivers, so I have battery drain problem, so first of all i want to know that how much battery percentage is my application using. Any idea.
Thanks in advance.</p>",android|gps|location|battery|batterylevel,3285681,user3285681,no
iOS OpenGL ES - Only draw on request,"<p>I'm using OpenGL ES to write a custom UI framework on iOS. The use case is for an application, as in something that won't be updating on a per-frame basis (such as a game). From what I can see so far, it seems that the default behavior of the GLKViewController is to redraw the screen at a rate of about 30fps. It's typical for UI to only redraw itself when necessary to reduce resource usage, and I'd like to not drain extra battery power by utilizing the GPU while the user isn't doing anything.</p>

<p>I tried only clearing and drawing the screen once as a test, and got a warning from the profiler saying that an uninitialized color buffer was being displayed.</p>

<p>Looking into it, I found this documentation: <a href=""http://developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Reference/EAGLDrawable_Ref/EAGLDrawable/EAGLDrawable.html"" rel=""nofollow"">http://developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Reference/EAGLDrawable_Ref/EAGLDrawable/EAGLDrawable.html</a></p>

<p>The documentation states that there is a flag, kEAGLDrawablePropertyRetainedBacking, which when set to YES, will allow the backbuffer to retain things drawn to it in the previous frame. However, it also states that it isn't recommended and cause performance and memory issues, which is exactly what I'm trying to avoid in the first place. </p>

<p>I plan to try both ways, drawing every frame and not, but I'm curious if anyone has encountered this situation. What would you recommend? Is it not as big a deal as I assume it is to re-draw everything 30 times per frame?</p>",ios|performance|opengl-es|frame-rate|redraw,1380539,phosphoer,no
UWP : How to run a Service infinitly on a Windows Phone,"<p>I have gone through various articles on Background Tasks. But none could solve my use case: <strong>Running a service infinitely on Windows Phone</strong></p>

<p>1) Is it even possible to do that (consider that I have the OEM Account with Microsoft).</p>

<p>2) I know this is wrong as it would drain the battery, etc... but is it even possible.</p>

<p>3) Also the service should start when the phone starts up.</p>

<p>4) I have read about registering background tasks which run periodically, or on System triggers. But they don't seem to work for me.</p>

<p>5) The service should run even if the App is closed, suspended.</p>

<p>6) Windows Runtime Component(Tried using it) is fine but it's not what I want.</p>

<p>Any pointers ?</p>

<p><strong>UPDATE:</strong>  Consider that I open the weather App, it registers a background task which updates the weather periodically. But what I want is there is no actual App(Which registers my background task). I am an OEM(say ASUS) and I want to flash a Service which starts when the phone is started for the first time and sends me information and it runs even after restart and even after factory reset because it was on the image which I used to flash the device Now Is that possible?</p>

<p>The above example explains my use case more clearly (updated as suggested by Alexej).</p>

<p>Thanks!</p>",win-universal-app|background-task|background-service,4507873,Saurabh Rai,yes
Do not show location service icon in status bar but still use background updates,"<p>I'm looking for some solution to handle the problem: 
If I use <code>locationManager.requestAlwaysAuthorization()</code> there're appears an location icon in status bar and never disappears, so, it is the problem - user can think that my app drain battery, but it's not.</p>

<p>So, when I use <code>.requestWhenInUseAuthorization()</code> I can't call <code>didUpdateLocations</code> function to update location even I add fetch background update, the #selector does not allow to call that method. </p>

<p>I want my app get location updates in background without always showing the location icon in the status bar. How can I update location by fetch? </p>",ios|swift|xcode|ios8|cllocationmanager,6852753,Bogdan Novikov,no
Xamarin service - run according to a time schedule,"<p>I am developing an app built on this example: <a href=""https://github.com/xamarin/mobile-samples/tree/master/BackgroundLocationDemo"" rel=""nofollow noreferrer"">https://github.com/xamarin/mobile-samples/tree/master/BackgroundLocationDemo</a></p>

<p>The example works and the location updates are coming in as expected. However, Android keeps showing an notification that the service is running and draining battery. Now, all my users have a defined working schedule (list of Start to End DateTime per day e.g 8am-1pm, 4pm-8pm), and I want that the service is only running between those working times. This means that I need to start/stop the service whenever the schedule says the user is working or not.</p>

<p>I've asked this question before but wondering if anyone figured out an efficient and solid way to achieve this type of service that is operating from a time schedule?</p>",android|xamarin|schedule|background-service|foreground-service,12495749,ArturM,no
How do I create a chat server that is not driven by polling?,"<p>I have created a simple chat server that is driven by client polling. Clients send requests for data every few seconds, and get handed any new messages as well as information about whether their peer is still connected.</p>

<p>Since the client is running on a mobile platform (iPhone), I've been looking for ways of getting rid of the polling, which quickly drains the battery. I've read that it's possible to keep an http connection open indefinitely, but haven't understood how to utilize this technique in practice. I'm also wondering whether such connections are stable enough to use in a mobile setting.</p>

<p>The ideal scenario would be that the server only sends data to clients when an event that affects them has occurred (such as a peer posting a message or going off line).</p>

<p>Is it advisable to try to accomplish this over http, or would I have to write my own protocol over tcp? How hard would it be to customize xmpp to my need (my chat server has some specialized features that I would have to easily implement).</p>",http|networking|chat|xmpp|instant-messaging,96531,Felixyz,no
What is Firebase Event Listener's back-off policy?,"<p>I have a project where a user can have multiple logins across multiple devices. </p>

<p>Now the user can subscribe to a particular topic on any device and the need is that the rest of the device logins should also do the same. Similar case is when one device unsubscribes, the rest should also follow suite.</p>

<p>In order to do this, I have made a Node under each user where all the subscriptions are maintained in the firebase database. I have a START_STICKY service which attaches a Firebase listener to this location and subs/unsubs from the topics when the changes occur. The code for the service is attached under the description.</p>

<p>In regular usage from observation, the service that i have does re-spawn due to the start sticky in case the system kills it. It will also explicitly respawn in case the user tampers with it using the developer options. The only cases which will cause it to completely cease are :</p>

<ol>
<li>signout</li>
<li>data cleared</li>
<li>force stop</li>
</ol>

<p>My questions are</p>

<ol>
<li><p>how badly will keeping the listener attached affect the battery life. AFAIK Firebase has an exponential backoff when the web socket disconnects to prevent constant battery drain</p></li>
<li><p>Can the firebase listener just give up reconnecting if the connection is off for quite some time? If so, when is the backoff limit reached.</p></li>
<li><p>Is there a better way to ensure that a topic is subscribed and unsubscribed across multiple devices?</p></li>
<li><p>Is the service a good way to do this? can the following service be optimised? And yes it does need to run constantly.</p></li>
</ol>

<p>Code</p>

<pre><code>public class SubscriptionListenerService extends Service {

    DatabaseReference userNodeSubscriptionRef;

    ChildEventListener subscribedTopicsListener;

    SharedPreferences sessionPref,subscribedTopicsPreference;

    SharedPreferences.Editor subscribedtopicsprefeditor;

    String userid;

    boolean stoppedInternally = false;

    SharedPreferences.OnSharedPreferenceChangeListener sessionPrefChangeListener;

    @Nullable
    @Override
    public IBinder onBind(Intent intent) {
        //do not need a binder over here
        return null;
    }

    @Override
    public void onCreate(){
        super.onCreate();

        Log.d(""FragmentCreate"",""onCreate called inside service"");

        sessionPref = getSharedPreferences(""SessionPref"",0);

        subscribedTopicsPreference=getSharedPreferences(""subscribedTopicsPreference"",0);

        subscribedtopicsprefeditor=subscribedTopicsPreference.edit();

        userid = sessionPref.getString(""userid"",null);

        sessionPrefChangeListener = new SharedPreferences.OnSharedPreferenceChangeListener() {
            @Override
            public void onSharedPreferenceChanged(SharedPreferences sharedPreferences, String key) {
                Log.d(""FragmentCreate"",""The shared preference changed ""+key);
                stoppedInternally=true;
                sessionPref.unregisterOnSharedPreferenceChangeListener(this);
                if(userNodeSubscriptionRef!=null &amp;&amp; subscribedTopicsListener!=null){
                    userNodeSubscriptionRef.removeEventListener(subscribedTopicsListener);
                }
                stopSelf();
            }
        };

        sessionPref.registerOnSharedPreferenceChangeListener(sessionPrefChangeListener);

        subscribedTopicsListener = new ChildEventListener() {
            @Override
            public void onChildAdded(DataSnapshot dataSnapshot, String s) {
                if(!(dataSnapshot.getValue() instanceof Boolean)){
                    Log.d(""FragmentCreate"",""Please test subscriptions with a boolean value"");
                }else {
                    if ((Boolean) dataSnapshot.getValue()) {
                        //here we subscribe to the topic as the topic has a true value
                        Log.d(""FragmentCreate"", ""Subscribing to topic "" + dataSnapshot.getKey());
                        subscribedtopicsprefeditor.putBoolean(dataSnapshot.getKey(), true);
                        FirebaseMessaging.getInstance().subscribeToTopic(dataSnapshot.getKey());
                    } else {
                        //here we unsubscribed from the topic as the topic has a false value
                        Log.d(""FragmentCreate"", ""Unsubscribing from topic "" + dataSnapshot.getKey());
                        subscribedtopicsprefeditor.remove(dataSnapshot.getKey());
                        FirebaseMessaging.getInstance().unsubscribeFromTopic(dataSnapshot.getKey());
                    }

                    subscribedtopicsprefeditor.commit();
                }
            }

            @Override
            public void onChildChanged(DataSnapshot dataSnapshot, String s) {
                //either an unsubscription will trigger this, or a re-subscription after an unsubscription

                if(!(dataSnapshot.getValue() instanceof Boolean)){
                    Log.d(""FragmentCreate"",""Please test subscriptions with a boolean value"");
                }else{

                    if((Boolean)dataSnapshot.getValue()){
                        Log.d(""FragmentCreate"",""Subscribing to topic ""+dataSnapshot.getKey());
                        subscribedtopicsprefeditor.putBoolean(dataSnapshot.getKey(),true);
                        FirebaseMessaging.getInstance().subscribeToTopic(dataSnapshot.getKey());
                    }else{
                        Log.d(""FragmentCreate"",""Unsubscribing from topic ""+dataSnapshot.getKey());
                        subscribedtopicsprefeditor.remove(dataSnapshot.getKey());
                        FirebaseMessaging.getInstance().unsubscribeFromTopic(dataSnapshot.getKey());
                    }

                    subscribedtopicsprefeditor.commit();
                }

            }

            @Override
            public void onChildRemoved(DataSnapshot dataSnapshot) {
                //Log.d(""FragmentCreate"",""Unubscribing from topic ""+dataSnapshot.getKey());
                //FirebaseMessaging.getInstance().unsubscribeFromTopic(dataSnapshot.getKey());
            }

            @Override
            public void onChildMoved(DataSnapshot dataSnapshot, String s) {
                //do nothing, this won't happen --- rather this isnt important
            }

            @Override
            public void onCancelled(DatabaseError databaseError) {
                Log.d(""FragmentCreate"",""Failed to listen to subscriptions node"");
            }
        };

        if(userid!=null){

            Log.d(""FragmentCreate"",""Found user id in service ""+userid);

            userNodeSubscriptionRef = FirebaseDatabase.getInstance().getReference().child(""Users"").child(userid).child(""subscriptions"");

            userNodeSubscriptionRef.addChildEventListener(subscribedTopicsListener);

            userNodeSubscriptionRef.keepSynced(true);

        }else{
            Log.d(""FragmentCreate"",""Couldn't find user id"");
            stoppedInternally=true;
            stopSelf();
        }

    }

    @Override
    public int onStartCommand(Intent intent,int flags,int startId){
        //don't need anything done over here
        //The intent can have the following extras

        //If the intent was started by the alarm manager ..... it will contain android.intent.extra.ALARM_COUNT
        //If the intent was sent by the broadcast receiver listening for boot/update ... it will contain wakelockid
        //If it was started from within the app .... it will contain no extras in the intent

        //The following will not throw an exception if the intent does not have an wakelockid in extra
        //As per android doc... the following method releases the wakelock if any specified inside the extra and returns true
        //If no wakelockid is specified, it will return false;

        if(intent!=null){
            if(BootEventReceiver.completeWakefulIntent(intent)){
                Log.d(""FragmentCreate"",""Wakelock released"");
            }else{
                Log.d(""FragmentCreate"",""Wakelock not acquired in the first place"");
            }
        }else{
            Log.d(""FragmentCreate"",""Intent started by regular app usage"");
        }

        return START_STICKY;
    }

    @Override
    public void onDestroy(){

        if(userNodeSubscriptionRef!=null){
            userNodeSubscriptionRef.keepSynced(false);
        }

        userNodeSubscriptionRef = null;

        subscribedTopicsListener = null;

        sessionPref = null;
        subscribedTopicsPreference = null;

        subscribedtopicsprefeditor = null;

        userid = null;

        sessionPrefChangeListener = null;

        if(stoppedInternally){
            Log.d(""FragmentCreate"",""Service getting stopped due to no userid or due to logout or data clearance...do not restart auto.. it will launch when user logs in or signs up"");
        }else{

            Log.d(""FragmentCreate"",""Service getting killed by user explicitly from running services or by force stop ... attempt restart"");

            //well basically restart the service using an alarm manager ... restart after one minute

            AlarmManager alarmManager = (AlarmManager) this.getSystemService(ALARM_SERVICE);

            Intent restartServiceIntent = new Intent(this,SubscriptionListenerService.class);
            restartServiceIntent.setPackage(this.getPackageName());

            //context , uniqueid to identify the intent , actual intent , type of pending intent
            PendingIntent pendingIntentToBeFired = PendingIntent.getService(this,1,restartServiceIntent,PendingIntent.FLAG_ONE_SHOT);

            if(Build.VERSION.SDK_INT&gt;=23){
                alarmManager.setExactAndAllowWhileIdle(AlarmManager.ELAPSED_REALTIME_WAKEUP, SystemClock.elapsedRealtime()+600000,pendingIntentToBeFired);
            }else{
                alarmManager.setExact(AlarmManager.ELAPSED_REALTIME_WAKEUP, SystemClock.elapsedRealtime()+600000,pendingIntentToBeFired);
            }
        }

        super.onDestroy();

    }
}
</code></pre>",android|firebase|firebase-realtime-database,3582305,Kushan,yes
Acquiring location when app is close like WeBuyApp.com claim to do in iOS?,"<p>It's just brought to my attention today the guys at <code>www.webuyapp.com</code> which they claim to develop a patent-able algorithm to obtain location using push notification system even if the app is closed.</p>

<p>Personally I don't think it's possible as they claim:
<a href=""http://www.webuyapp.com/?page_id=29"" rel=""nofollow"">http://www.webuyapp.com/?page_id=29</a></p>

<blockquote>
  <p>How does it look on the customer side? All he has to do is download
  WeBuy’s app. Once he has the app installed, we know at all times where
  he is without draining his battery - via patentable algorithm we have
  created. We know at all times what discounts surround him. Via complex
  data mining, we know what our customer (personally) likes, and when we
  feel we have a value proposition for him, we reach out and update him
  via push notification. The push notification system itself has a
  complexed data mining system which learns the users’ behavior to the
  push and decides whether it’s a good idea to send a push or not.</p>
</blockquote>

<p>Is there any real patent for obtaining location in background when app is closed using apple push notification?</p>",ios|objective-c|apple-push-notifications,1673632,Idan Moshe,no
didUpdateLocations called only once and then stops firing,"<p>I want to make a simple IOS 6.0 application that shows the lat/lon on screen each time the location is changed. The ViewController files are pretty trivial.</p>

<p>I alloc a CCLocationManager objec, set its variables and start it.
didUpdateLocations is called once or twice and then it stops being fired, even if the iPhone is moved. If I press Home button and reopen the app, the data on screen is updated once or twice before it stops again.
At simulation it works fine but not on a real 3GS iPhone. </p>

<p>If I uncomment the start/stop inside didUpdateLocations and continuously stop and start the service, it works, but the battery gets drained in extreme rates.</p>

<p>Also, this is part of a much bigger project and didUpdateLocations <strong>must</strong> be called each time the location is changed.</p>

<p><strong>ViewController.h</strong>
<pre></p>

<pre><code>#import &lt;CoreLocation/CoreLocation.h&gt;
@interface ViewController : UIViewController
@property (nonatomic , strong) CLLocationManager *locationManager;
@property (weak, nonatomic) IBOutlet UILabel *lbl;
@end
</code></pre>

<p><strong>ViewConroller.m</strong></p>

<p>#import ""ViewController.h""
@interface ViewController ()</p>

<p>@end</p>

<code>@implementation ViewController

- (void)viewDidLoad {
[super viewDidLoad];
_locationManager = [[CLLocationManager alloc] init];
_locationManager.delegate = self;
_locationManager.distanceFilter = kCLHeadingFilterNone; // whenever we move
_locationManager.desiredAccuracy = kCLLocationAccuracyBest;
_locationManager.PausesLocationUpdatesAutomatically = NO;
[_locationManager startUpdatingLocation];
}

- (void)didReceiveMemoryWarning {
[super didReceiveMemoryWarning];
}

-(void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations
{
CLLocation *newLocation = [locations lastObject];
_lbl.text=[NSString stringWithFormat:@""%lf %lf"",newLocation.coordinate.latitude, newLocation.coordinate.longitude];
//[_locationManager stopUpdatingLocation];
//[_locationManager startUpdatingLocation];
}
@end
</code></pre>

<p></p>

<p>If there's any advice on what's wrong, I would welcome it, I have lost a week already without solving it.</p>

<p>BTW, I have tested various values for the _locationManager variables but without any chnage in the behaviour</p>

<p>Additional info:
application is authorized to use location services
application is in foreground</p>",ios|objective-c|iphone|core-location,2934017,user2934017,no
"Finding reason why my application is stopping, Android","<p>I have a small data collection app which has a single button to start and stop a service.</p>

<p>The service in turn starts a new thread. Which collects data about voltage changes whenever there is a broadcast about it.</p>

<p>Data is temporarily stored in a ArrayList, and every 10 seconds the all the data stored in arrayList is dumped into a database.</p>

<p>App is running fine for 10-20 min but after 20 min app automatically stops. Some times service is still running and some times service is also killed.</p>

<p>Can you guys tell me what could be the problem here.
Things I think might relate to this problem are:</p>

<p>1.> I am opening and closing database every 10 sec. Should I change the design to close database only when the whole app is finished.</p>

<p>2.> I also took a wakelock, but that didnt make any difference. Should I take wakelock for my service also ?</p>

<p>3.> And lastly how can I come to know about the error because of which my app stopped( I can not connect to USB to know that coz I want battery to be in draining mode)</p>

<p><strong>Update</strong>:</p>

<p>The logcat error is as follows:</p>

<pre><code>E/AndroidRuntime( 9770): FATAL EXCEPTION: Timer-0
E/AndroidRuntime( 9770): java.util.ConcurrentModificationException
E/AndroidRuntime( 9770):    at java.util.ArrayList$ArrayListIterator.next(ArrayList.java:569)
E/AndroidRuntime( 9770):    at com.amazon.hsyal.services.LoggerThread$2.run(LoggerThread.java:78)
E/AndroidRuntime( 9770):    at java.util.Timer$TimerImpl.run(Timer.java:284)
W/ActivityManager(  236):   Force finishing activity com.amazon.hsyal/.ui.VoltageSODLoggerActivity
I/ActivityManager(  236): No longer want com.amazon.dcp:OTAService (pid 12299): hidden #16
I/WindowManager(  236): WIN DEATH: Window{417dcd20 com.amazon.hsyal/com.amazon.hsyal.ui.VoltageSODLoggerActivity paused=true}
I/UsageStats(  236): No package stats for pkg:com.amazon.kindle.otter
I/ActivityManager(  236): Process com.amazon.hsyal (pid 9770) has died.
W/ActivityManager(  236): Scheduling restart of crashed service com.amazon.hsyal/.services.LoggerService in 5000ms
I/ActivityManager(  236): Start proc com.amazon.kindle for broadcast com.amazon.kindle/.PrimeAppReceiver: pid=13075 uid=32022 gids={3003, 1015}
W/ActivityManager(  236): Activity pause timeout for ActivityRecord{4173eb10 com.amazon.kindle.otter/.Launcher}
I/ActivityManager(  236): Start proc com.android.settings for broadcast com.android.settings/.TopWindowChangereceiver: pid=13111 uid=1000 gids={1015, 3002, 3001, 3003}
I/ActivityManager(  236): Start proc com.amazon.hsyal for service com.amazon.hsyal/.services.LoggerService: pid=13138 uid=10051 gids={}
W/ActivityManager(  236): Activity destroy timeout for ActivityRecord{41750838 com.amazon.hsyal/.ui.VoltageSODLoggerActivity}
</code></pre>

<p>and the corresponding Thread code is as follows:</p>

<pre><code>public void run() {
    // TODO Auto-generated method stub
    dbInstance = new DbClass(ctx);
    Log.d(""Debuglogger"",""Came inside thread"");
    ctx.registerReceiver(this.voltageReceiver, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));

    Timer timer = new Timer();
    timer.schedule(new TimerTask() {
        @Override
        public void run() {
            // TODO Auto-generated method stub
            if(threadStatus == false){
                return;
            }
            if(!DataClass.dataList.isEmpty()){
                dbInstance.open();
                Iterator&lt;DataClass&gt; itr = DataClass.dataList.iterator();
                DataClass a_temp;
                while(itr.hasNext()){
                    a_temp = itr.next();
                    dbInstance.createEntry(a_temp.getVoltage(), a_temp.getCurrent(), a_temp.getBattery_level(),
                            a_temp.getTime(), a_temp.getRtime());
                }
                dbInstance.close();
                DataClass.dataList.clear();
                Log.d(""db-error"", ""Data written to database and list cleared !"");
            }
        }}, 0, UPDATE_INTERVAL);
}
</code></pre>",android|android-service|android-wake-lock,1257288,Harshit Syal,yes
I'm trying to figure out how to run a thread or activity in the background but still allow user's to use other app's,"<p>I'm trying to make an app for work that acts as parental control's and control's the wifi state, gps state, mobile state, and 4G state. I need it to run in the background to check the state's every 60 sec and then change it if needed. Also it needs to start doing this as soon as the device turns on. My question is how do I run it in the background but still allow the user to use one other app? (yes i know this would most likly drain battery life.) </p>",android|android-activity,2439016,Dakota Miller,yes
Background Task Taking 100% CPU and draining battery,"<p>I am working on an enterprise application that has to report information consistently on a timed basis, especially when the app is in the background.</p>

<pre><code>- (void)applicationWillResignActive:(UIApplication *)application {
     //stuff
     UIApplication *app = [UIApplication sharedApplication];

     //create new uiBackgroundTask
     bgTask = [app beginBackgroundTaskWithExpirationHandler:^{
     [app endBackgroundTask:bgTask];
     bgTask = UIBackgroundTaskInvalid;
     }];
     //and create new timer with async call:
     dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
     //run function methodRunAfterBackground
     timerOne = [NSTimer scheduledTimerWithTimeInterval:100 target:self selector:@selector(refreshInactiveTimer) userInfo:nil repeats:YES];
     timerTwo = [NSTimer scheduledTimerWithTimeInterval:300 target:self selector:@selector(postActivity) userInfo:nil repeats:YES];
     [[NSRunLoop currentRunLoop] addTimer:timerOne forMode:NSDefaultRunLoopMode];
     [[NSRunLoop currentRunLoop] addTimer:timerTwo forMode:NSDefaultRunLoopMode];
     [[NSRunLoop currentRunLoop] run];
     });
}

- (void)applicationWillEnterForeground:(UIApplication *)applicationq {
    [[UIApplication sharedApplication] endBackgroundTask:bgTask];
    [timerOne invalidate];
    [timerTwo invalidate];
}

-(void)refreshInactiveTimer {  //this function plays a short inaudible sound which refreshes the background timer
    AVSpeechSynthesizer *synth = [[AVSpeechSynthesizer alloc] init];
    AVSpeechUtterance *utter = [[AVSpeechUtterance alloc] initWithString:@""up""];
    [utter setVolume:0.0];
    [synth speakUtterance:utter];
}

-(void)postActivity {
    //this function makes a NSURLRequest that posts small data back to server side
}
</code></pre>

<p>The code works as intended, but the problem is it is taking 100% CPU (according to the profiler). I do notice that the battery seems to drain quickly too when I test while unplugged, so the CPU is definitely chugging away. Perhaps I am missing something small here.</p>

<p>Note: yes I know this is bad practice, and Apple would reject an app using such methods. However as I mentioned this is an enterprise application that will never be on the App Store and never distributed to the general public.</p>",ios|objective-c|xcode|background,1295744,ascendancy05,yes
Core Bluetooth - startScanningForPeripherals not working in background after app terminated and started in background,"<p>I have a custom BLE peripheral that turns a LED green when a person enters a building and turns the LED off when they leave the building. The iOS App uses Geofence regions to send the notifications to the app when the person enters and leaves the building. The <code>locationManger didDetermineState</code> gets called on a region change and the BadgeHandler class gets called to update the badge. Everything works great in the foreground and background, until iOS terminates the app.</p>

<p>When the app is terminated by iOS in the background, and later a geofence region notification comes in, the startScanningForPeripherals doesn't work. </p>

<p>The badge (peripheral) runs off 2 watch batteries and to minimize battery drain, we connect to the peripheral (badge) only to update the LED and <strong>then disconnects from the peripheral</strong>.</p>

<p>This works just fine in the foreground and the background until iOS kills the app while in the background. When the app starts back up in the background on a geofence region change  <code>startScanningForPeripherals</code> doesn't result in any delegate notifications after it is called. </p>

<p>I do have a delegate method: <code>willRestoreState</code> 
This doesn't get call. The reason it doesn't get called is it wasn't scanning for the device or connected to the device when the app was terminated by iOS in the background. Below is the sequence of events and how I am calling these methods:</p>

<ol>
<li>App is running and placed in the background</li>
<li>App receives a geofence notifications and connects to the badge (peripheral) updates the LED and disconnects from the badge (peripheral). Works as required.</li>
<li>After some time goes by, iOS terminates the app</li>
<li>A Geofence region notification comes in</li>
<li>The application is automatically restarted, (note: the app is still in the background)
<code>didFinishLaunchingWithOptions</code> is called and I start the the centralManager:</li>
</ol>

<p><code>let cmQueue = DispatchQueue( label: ""com.serial-queue"")
    centralManager = CBCentralManager(delegate:self, queue: cmQueue, options: [CBCentralManagerOptionRestoreIdentifierKey:""com.TrueAccess.BLEConnect.CentralManager"",CBCentralManagerOptionShowPowerAlertKey:true,CBCentralManagerScanOptionAllowDuplicatesKey:true])</code></p>

<ol start=""7"">
<li>The delegate method: <code>centralManagerDidUpdateState</code> gets called:</li>
</ol>

<p><code>else if central.state == .poweredOn{ 
     startScanningForPeripherals(central)
 }</code></p>

<ol start=""8"">
<li>Start scanning is then called with the the serviceID that it is looking for so scanning can occur in the background.</li>
</ol>

<p><code>if central.state == .poweredOn  {
    let serviceUUID:[CBUUID] =  [CBUUID(string: ""ID Number here"")]
    central.scanForPeripherals(withServices: serviceUUID, options: [CBCentralManagerScanOptionAllowDuplicatesKey : true])</code></p>

<p><strong>No delegate methods are received after this, i.e.:</strong>
<code>
didDiscover
didConnect
didFailToConnect</code></p>

<p>Any help is greatly appreciated.</p>

<p><strong>UPDATE TO QUESTION.</strong> I filed my first Technical Solutions Question to Apple in 8 years of iOS programming. This is their response. I will keep this updated.</p>

<blockquote>
  <p>Although there are many ways that an app can go wrong and not be able
  to scan or connect in the background, it is important to check first,
  if the lights are on.</p>
  
  <p>That is, is the peripheral advertising properly at the time your app
  starts scanning in the background?</p>
  
  <p>Following the specifications for the advertising interval and the
  advertising data becomes crucial when an app is scanning in the
  background. What might work in the foreground, even if out of spec,
  would start having problems when the app is in the background, or in
  terminated state.</p>
  
  <p>The advertising interval of your peripheral affects the time to
  discovery and connect performance.  To have a high probability of
  being discovered by an Apple product you should first use the
  recommended advertising interval of 20 ms for at least 30 seconds.  If
  it is not discovered within the initial 30 seconds, you can switch to
  using one of the following longer intervals to increase chances of
  discovery:
  152.5 ms, 211.25 ms, 318.75 ms, 417.5 ms, 546.25 ms, 760 ms, 852.5 ms, 1022.5 ms, 1285 ms</p>
  
  <p>Also, it is important that the service UUID you are scanning for is
  contained in the first advertising packet (ADV_IND) to ensure
  successful discovery of the peripheral under all conditions.</p>
  
  <p>So, please check these advertising requirements, and if those are OK,
  then we can see if there is something wrong in the app.</p>
</blockquote>",ios|objective-c|iphone|swift|core-bluetooth,1499530,Gary Bennett,yes
Is it okey using WebSocket to get JSON on Android?,"<p>I am developing client application on Android, which uses REST API to get JSON.
App sends a lot of requests to different URLs. This way is somehow slow - takes 30~60 seconds. <a href=""https://www.pubnub.com/blog/2015-01-05-websockets-vs-rest-api-understanding-the-difference/"" rel=""nofollow"">This article</a> says that <code>WebSocket</code> works faster. Now I am wondering  whether I can use <code>WebSocket</code>s for this purpose. So I have several questions about this:</p>

<ol>
<li>Is it a good practice to use <code>WebSocket</code> to get JSON data from server?
If not, what can be better(faster/more secure) than regular HTTP?</li>
<li>Can I send request to regular HTTP REST API using <code>WebSocket</code>?(this question may seem strange, but I really do not know)? Or guys on
backend should change/modify something to make this enable?</li>
<li>What can be disadvantage(eg. battery drain) for using <code>WebSocket</code>?</li>
</ol>",android|json|rest|http|websocket,2752399,Joe Richard,no
User Activity Static/running/Walking/Driving based on CoreMotion data only,"<p>How can we detect user is driving/walking/running/static with CoreMotion data. 
We can get user activity in iPhone 5s using CMMotionActivityManager. But how to get in lower version devices.</p>

<p>With the help of CLLocationManager I can get the device speed and based on speed I can decide the user state, which drain battery life of device.</p>

<p>Is there any possibility to detect Device State based on Core motion only?</p>

<p>Some application like like <a href=""https://www.placemeapp.com/placeme/"" rel=""nofollow"">Place me</a> app does, It detect user activity based on Coremotion data.</p>",ios|iphone|machine-learning|accelerometer|core-motion,673063,Bhumeshwer katre,no
Doze mode suspends foreground service,"<p>I am writing a data logger app and I need to make an http request every 5 minutes exactly. The user is aware of the battery drain and that's ok for me. I am using a foreground service with the appropriate notification for that and I have a handler thread to witch I post runnable tasks every 5 minutes. It seems that when the phone enter DOZE MODE the thread is suspended and no runnables are executed. Is that normal behaviour or I am missing something?
Any help on how to do that will be appreciated.</p>

<p><strong>Service code that starts the thread:</strong></p>

<pre><code>private void startTheForegroundService() {   
      NotificationCompat.Builder builder = new NotificationCompat.Builder(MainService.this);
      builder.setPriority(Notification.PRIORITY_HIGH);
      startForeground(1000, builder.build());

      httpThread = new HttpThread(""Ping Thread"", Thread.NORM_PRIORITY);
      httpThread.start();
      httpThread.loop();
}
</code></pre>

<p><strong>Thread code:</strong></p>

<pre><code>public class HttpThread extends HandlerThread {
   public Handler mHandler;

   public HttpThread(String name, int priority) {
      super(name, priority);
   }

   public synchronized void waitUntilReady() {
      mHandler = new Handler(getLooper(), new Handler.Callback() {
         @Override
         public boolean handleMessage(Message msg) {
            return false;
         }
      });
   }

   public void loop() {
      waitUntilReady();
      mHandler.post(new Runnable(){
      @Override
      public void run() {
         //code for the http request.
       }
     });
   }
}
</code></pre>",android|android-service|foreground-service|android-doze-and-standby,1199408,georgeok,no
"Xcode chat app, creating dynamic views - a little lost","<p>Am just about to start doing an iphone application which is supposed to have a multi user private chat. Something like facebook style, where the user has a list of friends and he can chat with them independently. I just need a little direction here</p>

<ol>
<li><p>If i have a list of users, let's say i create individual views for the chat, how can I handle these views? If jim is chatting with dick and jane, there should be 2 views, each for one chat window right? Are there any references that i can use.</p></li>
<li><p>I am looking for references in socket programming where i can push messages to the user from the server. I have been looking but could not find anything helpful.</p></li>
<li><p>If i try to update the user's chat window using local notifications, lets say request data every couple of seconds, will that be battery draining?</p></li>
</ol>

<p>I would really like some direction here, i do not want to start something just realize its the wrong way.</p>

<p>Any help is highly appreciated</p>",ios|xcode|push-notification,164601,Veeru,no
FCM Maximum message rate to a single device,"<p>per <a href=""https://firebase.google.com/docs/cloud-messaging/concept-options#device_throttling"" rel=""nofollow noreferrer"">https://firebase.google.com/docs/cloud-messaging/concept-options#device_throttling</a>, it says...</p>
<blockquote>
<p>You can send up to 240 messages/minute and 5,000 messages/hour to a single device. This high threshold is meant to allow for short term bursts of traffic, such as when users are interacting rapidly over chat. This limit prevents errors in sending logic from inadvertently draining the battery on a device.</p>
</blockquote>
<p>does this mean a device can only receive 240 messages / minute?
or does it mean it can receive 240 messages sent by a particular device?</p>
<p>say, 4 other devices can send 240 messages to a device?</p>",firebase-cloud-messaging,13879523,fcm-fanatic,no
What is the iPhone process com.apple.dt.ins?,"<p>This process is constantly consuming 10% or more of my CPU time on my iPhone 6, however I can't find any mention of what this process is on the internet at all.</p>

<p>My battery is draining fast and appears to be related to this process running, but not knowing what it's responsible for I can't try and debug by disabling settings etc.</p>

<p>Does anyone have any insight onto what this process does on the iPhone?</p>

<p><img src=""https://i.stack.imgur.com/NQW3A.png"" alt=""http://i.imgur.com/4mF3iYq.png""></p>",ios|xcode,3703189,trendsi,yes
Execute alaramManager.setRepeating() on condition,"<p>I have implemented a simple app that shows notification at particular intervals using alaramManager just as shown <a href=""https://stackoverflow.com/a/23440985/2649104"">here</a> .</p>

<p>I have a static <code>bool shouldNotify</code> class level variable in main activity.
I need <code>setRepearing</code> to execute only if my <code>shouldNotify</code>  is true. 
How shall it be done? </p>

<p>EDIT:</p>

<p>One way is by notifying on condition(as specified in the first answer), but that will drain the battery as alaram will always be fired. Is there any better option?</p>

<p>Let me know if its too vague to be asked here. I am new to OOP.</p>",android|oop|alarmmanager,2649104,Srujan Barai,yes
How do I send live updates to my Android device?,"<p>I want to send live updates to a phone to my app, approximately 1KB/sec. It is acceptable, if for reasons of power management, the updates will come about once per minute in batches, since Google advises that what drains the battery is leaving the radio on, and that a radio drops power after 15sec. What is the appropriate tool to use?</p>

<ol>
<li>Websockets/stomp. That's what I am already using for the browser client. However my worry is that it will keep the radio on, and devastate the battery.</li>
<li>Google Cloud Messaging. Google promises that it's battery efficient, however how live is it? Who controls the frequency of pushes? Is it designed for a lot of data? Does it have to put notifications up for every push which would be highly undesirable to me since it's a push every second.</li>
<li>Amazon SNS. I already use Amazon AWS, so it may fit the profile well. How good is it with power management? </li>
<li>Something else that I don't know of</li>
</ol>",mobile|websocket|google-cloud-messaging|amazon-sns|stomp,356083,f.khantsis,yes
Will it drain the phone's battery if I use a Handler to request location every several seconds?,"<p>I'm making an app that silences the user's ringer based on their location.  I have a Service that runs in the background, and I need it to get the user's location every few seconds.  I'm using LocationListener, so I tried  putting onLocationChanged inside my service's onStart method, but I was not allowed.  So, I'm wondering if I used a Handler to request the user's location every 5 seconds, if it would drain their battery.  I'm doing this because I cannot test the app by moving around, so I'm not sure if onLocationChanged gets called.</p>

<pre><code>public class myService extends Service implements LocationListener {
Double lat;
Double lng;

@Override
public IBinder onBind(Intent arg0) {
    return null;
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    // Let it continue running until it is stopped.
    Toast.makeText(this, ""Service Started"", Toast.LENGTH_LONG).show();





    return START_STICKY;

}

@Override
public void onDestroy() {
    super.onDestroy();
    Toast.makeText(this, ""Service Destroyed"", Toast.LENGTH_LONG).show();

}



@Override
public void onLocationChanged(Location location) {

    if (MainActivity.location != null) {


       lat = MainActivity.location.getLatitude();

        lng = MainActivity.location.getLongitude();


        if (MainActivity.placeArrayList.size() != 0) {
            for (int i = 0; i &lt; MainActivity.placeArrayList.size(); i++) {


                Log.e(""hello"", String.valueOf(Float.parseFloat(MainActivity.latitudeArrayList.get(i))));

                MainActivity.destination.setLatitude(Double.parseDouble(MainActivity.latitudeArrayList.get(i)));
                MainActivity.destination.setLongitude(Double.parseDouble(MainActivity.longitudeArrayList.get(i)));
                Log.e(""distancemeters"", String.valueOf(MainActivity.location.distanceTo(MainActivity.destination)));

                if (MainActivity.location.distanceTo(MainActivity.destination)&lt;100) {




                    AudioManager audioManager = (AudioManager) getSystemService(Context.AUDIO_SERVICE);

                    audioManager.setStreamVolume(AudioManager.STREAM_RING, AudioManager.RINGER_MODE_SILENT, AudioManager.FLAG_SHOW_UI);


                } else {



                }

            }


        }
    }

}

@Override
public void onStatusChanged(String provider, int status, Bundle extras) {

}

@Override
public void onProviderEnabled(String provider) {

}

@Override
public void onProviderDisabled(String provider) {

}
}
</code></pre>",android|handler|locationlistener,4599324,felix,yes
Can os and Home screen update the android app widget at will?,"<p>I want to make and app with widget to present some data,and i want to be sure it will not become a battery drain source and add all the checks i have to,so there is no problem.</p>

<p>So android documentation actually says that ACTION_APPWIDGET_UPDATE may be sent in response to a new instance for this AppWidget provider having been instantiated, the requested update interval having lapsed, or the system booting.</p>

<p>But i came into this bizarre answer here </p>

<p><a href=""https://stackoverflow.com/questions/13363840/android-widget-update-called-twice-after-device-boot"">Android widget update called twice after device boot</a></p>

<p>that suggest that the home screen can actually update your widget n times at will.Seems bizarre,and i cant find something similar,do i really have no control over this?</p>",java|android|widget,8830927,Apollon Moropoulos,no
Implementing Classes Java,"<p>Question in book: 
Write a class Battery that models a rechargeable battery. A battery has a constructor public Battery(double capacity)
where capacity is a value measured in milliampere hours. A typical AA battery has a capacity of 2000 to 3000 mAh. The method
public void drain(double amount)
drains the capacity of the battery by the given amount. The method
public void charge()
charges the battery to its original capacity. The method
public double getRemainingCapacity()
gets the remaining capacity of the battery.</p>

<p>My Question: Are my instance variables right? How do you figure out what needs to be in the private instance variables? (If that makes sense)  Can this code be written in a better way?</p>

<p>My Code: </p>

<pre><code>public class Battery
{

      private double fullCharge;
      private double batteryCapacity;

public Battery(double capacity)
{

      batteryCapacity = capacity;
      fullCharge = capacity;

}
public void drain(double amount)
{
     batteryCapacity = batteryCapacity - amount;
}

public void charge()
{

     batteryCapacity = fullCharge;
}

public double getRemainingCapacity()
{
     return batteryCapacity;
}

}  
</code></pre>",java|instance-variables,2691237,Can't see me,no
"Android - Inflate view, runnable or animations drain battery?","<p>I am building a game where i do some things in simple steps...</p>

<ul>
<li>In Handler Object I set post delayed runnable(new instance of runnable)</li>
<li>In the runnable I call method where I inflate random layout from layout id list. My layout has ImageView.</li>
<li>I add inflated ImageView layout in the desiret view parrent.</li>
<li>I am creating fadein animation object to the ImageView layout I just added and start it.</li>
<li>After on fadein animation end I creae new animation object where i move the ImageView layout by changing it's margins. For this I use <code>applyTransformation</code></li>
<li>On end of moving animation I remove the view from the ViewGroup and start from the beginning.... This means I add new runnable object to the handler....</li>
</ul>

<p>This cost me too much battery drain.....</p>

<p>For the durations of the runnable and the animations I use random values in range I specify so in most efficient scenario i have not more than 20 views moving on screen.</p>

<p>Playing the game for 5 mins drain my battery 5% or more.</p>

<p>My main question is: <strong>Which of my actions drain my battery?</strong></p>

<p>I don't know if it's the inflating or the animations or the runnables...</p>

<p>My second question is: <strong>How to slove the problem?</strong></p>

<p>If it's the animations... is is better to have just one(of a kind.. i have 2 kinds of animations) animation object just reinitialize it or ?</p>

<p>I know it's better to use OpenGL but I think it will be hard for me to learn it just for this basic functions. I don't know but i think this basic functions are hard to do there. If they are not I will do it with OpenGL</p>

<p>If it's something else just please tell me where is the drain battery problem...</p>

<p><strong>I am sure that it's draining battery because it's on top of battery usage native Android app it's like 30%</strong></p>",java|android|multithreading|animation,1633609,Sir NIkolay Cesar The First,yes
Problem: LG Optimus One P500 powering off after 2.3 (gingerbread) update,"<p>I've updated my P500 to 2.3.3 (Gingerbread) using LGMobile Support Tool, as described at <a href=""http://www.lge.com/br/android/p500/atualizacao/index.jsp"" rel=""nofollow"">http://www.lge.com/br/android/p500/atualizacao/index.jsp</a> (pt_BR). Now, a couple of hours after running it gets powered off and won't turn on without taking the battery off and putting it back. Then, battery is about 60-80% charged (not drained). </p>

<p>I called LG support and they told me to hard reset the phone (home + vol. down + power) and reinstall. I did it, but the problem persists. Any suggestion to resolve this? If not, is it possible to downgrade to 2.2 (Froyo)?</p>",android|lg,215459,mcrisc,yes
Best way to get daily steps count of user to send to server in background,"<p>I want to send to my server every 24 hours how many steps I walked. I have an AlarmManager to go off <code>alarmManager.setRepeating(AlarmManager.RTC_WAKEUP,System.currentTimeMillis(),1000*60*60*24, pendingIntent1)</code> </p>

<p>Now this is where I am stuck... how should I measure the daily steps?(remember I need to send this in the background) I can use this a service that could override this function <code>public void onSensorChanged(SensorEvent event)</code> this doesn't seem so accurate since my Service could be destroyed(and battery will get drained very fast).</p>

<p>Or</p>

<p>I can try and use the Google Fitness but I need to request connection from user every time I try to get the data <code>mGoogleApiClient.connect()</code>(I need to get this data in the background)</p>

<p>Anyone have experience doing this?</p>",android|android-sensors|google-fit,1163234,user1163234,yes
How to make my iOS radio app more efficient,<p>I'm building an iOS radio app using AVPlayer that streams from a live url. How can I make it more energy efficient? I noticed that it is constantly making network calls and is at the top of my battery drain apps.</p>,ios|xcode|streaming|avplayer|http-live-streaming,12506105,atdonsm,no
Android Multiple IntentService draining battery,"<p>I have an application that launches two IntentService. 
I performed some current drain measurement and found out that if I launch one service that perform audio recording and audio analysis the current consumption is about 65mA. If I launch the other one that perform BLE scan the current drain is about 85mA. If the two IntentService are running simultaneously, I have a current drain of 200mA. 
I measured this on Samsung SIII with Android 4.3. 
Also in Nexus 5  Android 4.4.2 the battery is drained when the two services are running together. I am not using wakelock.
Is there an explanation for this? Is it possible to save battery life? The two IntentService are not using Network connection at all, they don't send data.</p>",android|multithreading|battery|battery-saver,3206345,Sfavilla,yes
Options for keeping device awake while a short-lived service runs,"<p>I'm developing an application that takes the user through an exercise plan. It's a running trainer that uses audio cues to let the user know when to walk, run, etc. at different points during their exercise.</p>

<p>It's very likely that the phone will be locked and in someone's pocket while the app is running, so I'm looking into the ways I can keep the audible cues coming. At the moment I'm just testing using a Handler in a local Service to schedule the next cue along. That's working better than I expected on some devices, but, on others, the Service seems to stop when the phone is locked.</p>

<p>I know there are a variety of options open to me -- keep a wake lock on the phone, schedule alarms, (perhaps? Not sure on this one) changing the priority of the Service, and maybe more.</p>

<p>So, what do people think would be the best approach? Bear in mind that this is not a ""normal"" Service -- it will be typically be running for at most half an hour, three times a week, and many of its users will be playing music while they run, so the phone is fairly unlikely to be asleep anyway. I'm thinking, therefore, that the usual caveats about battery-draining wake-locks may not apply so much in this case?</p>

<p>Currently I'm targeting API level 8 as my minimum.</p>",android|android-service|android-alarms|android-wake-lock,300836,Matt Gibson,yes
Nexus 7 NFC interfering with Wireless charging,"<p>From my initial research and experience with wireless chargers for my Nexus 7, it appears that there are issues with wireless chargers interfering and causing issues with NFC functionality. Note, I am not talking about doing both simultaneously. Rather, I am speaking of whether there are detrimental effects on the NFC antenna due to wireless charging over time. I gather that both inductive charging and NFC use the same coil on Nexus 7 (?)</p>

<p>I have personally seen wirelessly charged Nexus 7's NFC scans/tags not registered, but do not know for sure if these two are related for sure. My basic understanding is that the NFC antenna is right near the wireless charging area in the back of the device.</p>

<p>Moreover, wireless charging it's too slow; often times, it seems as though it's slowing down the battery drainage than actively charging it.</p>

<p>Questions to the community are</p>

<p><strong>1</strong>- what's the best wireless charger out there? Specifically, one that does not interfere with NFC functionality both at a hardware and software level?</p>

<p><strong>2</strong>- if the NFC functionality is hurt, what's the best way to troubleshoot it? I am experiencing inconsistent scans-- 1 out 5 scans are not registered and the device needs to be powe cycled.</p>",android|nfc|wireless|battery,3071689,eager_learner313,yes
When should I stop updating location manager?,"<p>I have an app that makes a call to get the user's location:</p>

<pre><code>-(void)getLocation{
    locationManager = [[CLLocationManager alloc] init];
    locationManager.delegate = self;
    locationManager.distanceFilter = kCLDistanceFilterNone;
    locationManager.desiredAccuracy = kCLLocationAccuracyBest;
    [locationManager startUpdatingLocation];

}
//SET USER LOCATION
-(void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations {
    self.userLocation = [locations lastObject];
    NSLog(@""location in IntroVC %f, %f"", self.userLocation.coordinate.latitude, self.userLocation.coordinate.longitude);
}
</code></pre>

<p>My question is, because that NSLog keeps spitting out a new location infinitely, when should I stop calling the location?  Well I guess its really up to my app's functionality, but doesnt this cause battery drain?  If so, I should really look into the best way of stopping the updates.</p>",ios|objective-c|mapkit|cllocationmanager,452889,marciokoko,yes
XMPP (Openfire) Push Notifications Android,"<p>I really tried to find a solution to this problem but didn't. There are some threads related to this concept, but I didn't find a comprehensive solution.</p>

<p>I have a server with Openfire which sends messages. When both users are online, there is no problem. However, when a user is offline I would like to send a push notification, as in Whatsapp. I heard that Whatsapp and other IM apps use a modified version of ejabber to send push notifications, but couldn't find out how.</p>

<p>One possibility is to use GCM, but I am not sure if this is the right way to go. Also I would like to avoid polling, for the sake of not draining battery life.</p>

<p>Does anyone know some solution to this or has an example?</p>",android|push-notification|xmpp|google-cloud-messaging,1279324,Max,no
Background location draining too much battery since iOS 9,"<p>I have an app that runs in background collecting GPS location and sending it to a server.
The app exists since iOS 7 or before.</p>

<p>When M7 came out, I managed to stop/start background location when the device is stopped or moving. This way, the app was consuming only 2-6% battery and the location monitoring was 100% effective. So I had a background GPS location monitoring app that was really battery friendly.</p>

<p>This was true until iOS 9. </p>

<p>The same app, which was consuming around 5%, is now consuming 30-60% in iOS 9/9.1.
I have tried so many things, but I don't see any reason for that battery usage difference.
I do realize that the battery percentage is a relative information, but I'm testing since iOS 9 came out and it is really draining more battery.</p>

<p>I run the app on iOS 8.2/8.4 and it consumes only 2-6%. The same version of app running on iOS 9/9.1 consumes around 40%!
M7 is working fine, GPS listener is stopped/started as intended. But the battery usage goes crazy on iOS 9.</p>

<p>If I don't enable GPS location at all, the app running in background consumes around 3% on iOS 9. But if I enable GPS location for a while and then stops it according to M7, the battery usage goes super high. So the problem is really GPS location.</p>

<p>It looks like that iOS is not turning off GPS hardware when I call [MyLocationManager stopUpdatingLocation].</p>

<p>This is how I initialize my location manager:</p>

<pre><code>locationManager = [[CLLocationManager alloc] init];  
locationManager.delegate = self;  
locationManager.desiredAccuracy = kCLLocationAccuracyNearestTenMeters;  
if ([locationManager respondsToSelector:@selector(allowsBackgroundLocationUpdates)]) {  
    [locationManager setAllowsBackgroundLocationUpdates:YES];  
}  
if ([locationManager respondsToSelector:@selector(pausesLocationUpdatesAutomatically)]) {  
    locationManager.pausesLocationUpdatesAutomatically = NO;  
    locationManager.activityType = CLActivityTypeOther;  
}  
</code></pre>

<p>When I want to start it, I call:</p>

<pre><code>[locationManager startUpdatingLocation];
</code></pre>

<p>And to stop it, I call:</p>

<pre><code>[locationManager stopUpdatingLocation];
</code></pre>

<p>I do repeat:</p>

<ol>
<li><p>My location manager is not running all the time! I start and stop it according to M7 reports!</p></li>
<li><p>The same version of the app consumes much less battery on earlier iOS versions.</p></li>
</ol>

<p>Anyone else noticed that?
Is there a bug or something with CLLocationManager since iOS 9?
Should I just accept that the same app consumes more battery now?
Is apple condemning apps that use background GPS location by showing more battery usage?</p>

<p>What can I do?</p>

<p>Any ideas/suggestions are welcome!</p>

<p>PS: I'm not questioning whether background location it is a nice thing to do. We have a legal usage.</p>",ios|objective-c|background|gps|ios9,2174489,Eduardo Herzer,no
How to force my application to sleep?,"<p>I'm developing an android application that uses the users Google Calendar to generate it's content dynamically. Randomly over the past month I've noticed that the app would have drained my battery in a couple of hours. This likely happens when the user's Google calendar has several hundred events (like mine does) and is a problem since I really don't need to be running in the background at all.</p>

<p>Obviously, I probably need to revise and rethink how I'm querying the for calendar events, but is there an easy way to force my app to stop once the user has navigated out of it?</p>

<p>Edit: my sourcecode is here: <a href=""https://code.google.com/p/togenda/source/browse/ToGenda/src/edu/jcu/cs470/togenda/AgendaFragment.java"" rel=""nofollow"">https://code.google.com/p/togenda/source/browse/ToGenda/src/edu/jcu/cs470/togenda/AgendaFragment.java</a></p>",android|android-activity,2765456,BooleanCheese,yes
How to implement push notifications in Intranet in ionic app,"<p>I am trying to implement push notifications in my ionic app. <br>
The challenge is that the network in which the device and the backend service resides is a closed network(no internet). <br>
Is it possible that I get notifications somehow on my app on certain triggers from the backend?<br>
Solutions, I've come across is, sending local notifications from my app while it continuously polls from the server.<br>
The potential problem with this is:</p>
<ol>
<li>If the app gets closed, the notifications wont show up</li>
<li>Mobile battery will be heavily drained</li>
</ol>
<p>Is there any other fix to this or any efficient solution?<br>
Any help is much appreciated</p>
<p>Thanks,</p>",ionic-framework|push-notification|notifications|push|mobile-application,5662197,Pranava Sureka,yes
Write code for battery benchmark on iPhone,"<p>How to create code in Xcode that drain the battery the most ?. Any code, but device is being in Airplane Mode (no wifi, no gps, no blutooth,...). (Ex: create loop code, run video, create multi thread,...)</p>",iphone|benchmarking|battery,1546192,Kent Phong,no
Can I kill JavaScript execution in J2V8?,"<p>I've embedded v8 in my Android project via <a href=""https://github.com/eclipsesource/J2V8"" rel=""nofollow"">J2V8</a>. This works great, but there are situations where the script hangs (probably due to some kind of endless loop I suppose). The code is way too complicated to debug it and there can always be a situation where a script is running mad.</p>

<p>To be sure not to have some zombie thread hanging around and draining battery, I'd like to define a timeout and kill v8 if the script has not yet returned. Of course I'm executing the script in <code>AsyncTask</code> or <code>IntentService</code> and never in the main thread. This way Android doesn't protect itself showing an ""Application Not Responding"" (ANR). The background thread runs and runs and runs...</p>

<p>How to kill v8 in a clean way?</p>",android|v8|embedded-v8|j2v8,2176962,hgoebl,no
Can anyone help me with fixing a VBS script on Windows 10 that displays a warning/MsgBox on low battery?,"<p>What I'm trying to do is write a script that creates a message box/popup when my computer's battery falls to 20%. I want the message box to appear only once—it shouldn't show up again after I click &quot;OK&quot; unless I charge my computer and let it drain to 20% again.</p>
<p>The problem is that the code I have causes message boxes to appear every few minutes while my battery is below 20%. My code is below:</p>
<pre><code>set oLocator = CreateObject(&quot;WbemScripting.SWbemLocator&quot;)
set oServices = oLocator.ConnectServer(&quot;.&quot;,&quot;root\wmi&quot;)
set oResults = oServices.ExecQuery(&quot;select * from batteryfullchargedcapacity&quot;)
 
for each oResult in oResults
    iFull = oResult.FullChargedCapacity
next

while (1) 
    set oResults = oServices.ExecQuery(&quot;select * from batterystatus&quot;)
    for each oResult in oResults
        iRemaining = oResult.RemainingCapacity
        bCharging = oResult.Charging
    next
    iPercent = Round((iRemaining / iFull) * 100)
    
    if iRemaining and not bCharging and (iPercent &lt; 21) and (iPercent &gt; 10) Then msgbox &quot;Your battery power is low (&quot; &amp; iPercent &amp; &quot;%). If you need to continue using your computer, either plug in your computer, or shut it down and then change the battery.&quot;,vbInformation, &quot;Your battery is running low.&quot;
    wscript.sleep 30000 ' 5 minutes
wend
</code></pre>
<p>I'm very new to VBScript (and programming in general), so I'm not really sure how to fix this.</p>",windows|vbscript,13314162,Zodiiak,yes
Foreground app being killed when screen is off,"<p>I have a problem on my android phone where the app that I'm running in the foreground is getting killed if the screen is off. Examples include: listning to a podcast with stitcher, using voice mavigation with google maps, having an ongoing call using a voip app, listning to an audio book with audible.</p>
<p>Apps get killed off at some random point when the screen is off. e.g. sometimes it'll happen after a minute, sometimes i'll be 30 mins in a drive and a podcast will just cut out. After this happens, if I unlock my phone, I'm back on my home screen.</p>
<p>Things I have tried:</p>
<ul>
<li>restarting my phone more regularly, no benefit</li>
<li>pin the foreground app before turning off the screen. no benefit.</li>
<li>Uninstalling apps / stopping background services to reduce RAM usage. I initially blamed RAM, but I've uninstalled a bunch of things and it's been no help.</li>
</ul>
<p>Other information about my phone:</p>
<ul>
<li>LG G7 (LM-G710EMW), Android version 9, kernel version 4.9.112</li>
<li>Developer options -&gt; running services: usually shows plenty of free RAM (e.g. right now, 1.2GB free). When stitcher appears on this list, it uses about 250mb.</li>
<li>Using nova launcher</li>
<li>Not using any third party battery saving / optimization apps. All apps mentioned have been selected in Settings -&gt; Battery -&gt; 'Power saving exclusions' for android's built in battery. Android's built in battery saver is turned off.</li>
<li>Not using any third party apps that kill other apps, claim to free up RAM, etc. The only thing I have that could be killing other apps is tasker.</li>
</ul>
<p>So this is super annoying because it basically prevents me from using the phone for anything useful unless I keep the screen on. I know I can darken the screen as much as possible, so keeping the screen on reduces battery drain, this is ok for navigation but not good enough for when you want to keep your phone in your pocket.</p>
<p>I was blaming RAM - i.e. somehow I'm running out of RAM and android is killing the app that's using the most. But it makes no sense to kill the foreground app.</p>
<p>Open to any and all suggestions, even if it's a long shot.</p>
<p>I'm not concerned about battery life at all. If there's any other battery saving / optimization features I can turn off, I'm all for it.</p>",android|ram|battery|foreground,14223862,Yaksha,yes
Android gps listener,<p>I have built an app where in you take pictures and GPS data of that picture is captured for GPS I implemented service and implemented location listener for it. Its working fine but it drains battery so I am planning to change a Lil bit I will start the GPS service when user decides to take pic in my app.. And remove the listener on picture taken. This works fine provided the button to capture is taken after the GPS search is finished else GPS data accuracy is not there. So I have thought to show a dialog fragment to user saying GPS is initializing and ask user to wait. And once GPS location is set the dialog fragment should disappear and user must be able to take picture by the button provided. My problem is how do I capture the event That GPS search is completed .. I am using built in GPS satellite.</p>,android|gps|notifications|location,3048027,user3048027,yes
UserIdleDetectionMode versus ApplicationIdleDetectionMode,"<p>How do you choose between <strong>UserIdleDetectionMode</strong> and <strong>ApplicationIdleDetectionMode</strong>?</p>
<p>MSDN: <a href=""http://msdn.microsoft.com/en-us/library/microsoft.phone.shell.phoneapplicationservice.useridledetectionmode%28v=VS.92%29.aspx"" rel=""nofollow noreferrer"">UserIdleDetectionMode</a></p>
<blockquote>
<p>When user idle detection is enabled, the operating system will go into a low power usage state when the user is idle. Disabling this property requests that the operating system not perform this service. Use this property to disable user idle detection if your application needs to continue running even when the user is not physically interacting with the screen or hardware buttons. Example scenarios include turn-by-turn navigation applications and games that use the accelerometer for input.</p>
<p>This feature should be used with caution. Applications that disable user idle detection will continue to run and consume battery power when the user is not using the phone. It is recommended that applications that disable user idle detection implement their own form of idle detection and enable UserIdleDetectionMode when appropriate. For example, an accelerometer-based game could enable user idle detection if the accelerometer shows no activity for a period of time.</p>
<p><strong>In the current release, the operating system considers the user to be idle when they have not touched the screen or the hardware buttons within the device lock timeout window, specified in the device’s Settings page.</strong> The conditions for detecting user idle status may change in future releases.</p>
</blockquote>
<p>MSDN: <a href=""http://msdn.microsoft.com/en-us/library/microsoft.phone.shell.phoneapplicationservice.applicationidledetectionmode%28v=VS.92%29.aspx"" rel=""nofollow noreferrer"">ApplicationIdleDetectionMode</a></p>
<blockquote>
<p>When application idle detection is enabled, the operating system will deactivate idle applications. Disabling application idle detection requests that the operating system not perform this service. This feature should be used with caution because applications that run while the phone is locked continue to drain the device’s battery. In this case, the user may not realize that the application is running because the screen is off and the phone looks idle.</p>
<p><strong>In the current release, an application is considered to be idle if the user has allowed the phone to lock.</strong> In future releases, the conditions that qualify an application as idle may change. Even if application idle detection is disabled, the operating system may deactivate an application for other reasons, such as a depleted battery.</p>
</blockquote>",windows-phone-7,265706,Jerry Nixon,no
How can I start iBeacon while my app is not running?,"<p>How can I start iBeacon while my app is not running. 
I mean there must me some broadcast receiver which can be placed in my app's Manifest.</p>

<p><strong>Edit:</strong></p>

<p>As this question is misleading, let me rephrase it again:</p>

<p>I've created a project which detects the iBeacon 
1. In activity running state.
2. In service.</p>

<p>If I want be get notified whenever an iBeacon gets detected, when application is not running I've got one option that is through Service. But that will drain the battery. So is there any broadcast receiver which an notify my app as soon as any iBeacon is detected. </p>

<p>The Demo code which I've written for this is:
<a href=""https://github.com/Vinayrraj/Android-iBeacon-Demo"" rel=""nofollow"">https://github.com/Vinayrraj/Android-iBeacon-Demo</a></p>",android|ibeacon|ibeacon-android,812131,Vinay,no
iPhone: Listening to GPS regularly and battery drain,"<p>I am new to iPhone development and I have an idea for an app that requires that I record the GPS position at least every 5 minute.</p>

<p>Is this possible without draining the battery completely?</p>

<p>TIA
Soeren</p>",ios|iphone|swift,3173943,sdalby,no
Face Detection Listener on Google Glass,"<p>I have been trying to launch face detection on Google Glass. It is supposed to run realtime as I want to trigger a custom method if there are faces on camera sight. Unfortunately it always detects zero faces.
I want to start the detection as soon as my application starts, therefore I start face recognition on surface creation:</p>

<pre><code>@Override
public void surfaceCreated(SurfaceHolder holder) {
    camera = Camera.open();
    this.setCameraParameters(camera);
    try {
        camera.setPreviewDisplay(this.getHolder());
    } catch (IOException e1) {
        Log.e(""surface created"", e1.getMessage());
    }
    camera.startPreview();
    try {
        camera.setPreviewDisplay(holder);
        CameraManager manager = new CameraManager(this, camera);
        manager.startFaceRecognition();
    } catch (Exception e) {
        this.releaseCamera();
    }
}
</code></pre>

<p>The implementation of manager.startFaceRecognition:</p>

<pre><code>public void startFaceRecognition() {
    ...
    camera.setFaceDetectionListener(new FaceDetectionTriggeringListener());
}
</code></pre>

<p>It is the same camera object as I pass it to constructor. The implementation of face detection listener:</p>

<pre><code>public class FaceDetectionTriggeringListener implements FaceDetectionListener {

    @Override
    public void onFaceDetection(Face[] faces, Camera camera) {
        if (faces.length &gt; 0) {
            Log.d(""onFaceDetection"", Integer.toString(faces.length));
        }
        for (Face face : faces) {
            Log.d(""onFaceDetection"", Integer.toString(face.score));
        }
    }
}
</code></pre>

<p>In the last code part <code>faces.length</code> is always zero and nothing is logged. I have tried logging <code>faces.length</code>, it really outputs zero. I have tried different faces including my project manager and pictures from google searches.
Please note that I want to do this in realtime and I do not need ultimate accuracy. I have tried methods that include picture transcoding, but they are too slow and uses too much CPU and, as a consequence, this gets Glass hot and drains battery heavily. The goal is to write something like this:</p>

<pre><code>if (faces.length &gt; 0){
    Foo.bar();
}
</code></pre>

<p>Is there any solution to this problem? Alternative solutions are accepted in case they can work in realtime.</p>",java|android|google-glass,2273107,Karolis Ryselis,yes
iPhone GPS - Battery Draining Extremely Fast,"<p>We are developing an app that has heavy GPS usage, and we are unable to optimize the battery life. </p>

<p>Even when the device is not moved, there is <strong>significant battery drainage</strong> that, according to the code, should not happen.</p>

<p><strong>Here is the code:</strong></p>

<pre><code>locationManager = [[CLLocationManager alloc] init];
locationManager.distanceFilter = 100;
locationManager.desiredAccuracy = kCLLocationAccuracyHundredMeters;
[locationManager startUpdatingLocation];
</code></pre>

<p><em>Ideally we want to trigger GPS every 20 minutes (if there is no location change then save battery) OR every 5 minutes if there is location change. According to my developer this cannot be done</em></p>

<p><strong>Previously</strong> we were using <code>kCLLocationAccuracyBest</code>, which was consuming battery very fast and now we are using <code>kCLLocationAccuracyHundredMeters</code>.</p>

<p><strong>startUpdatingLocation</strong> - is to get the GPS coordinates. There is another call startMonitoringSignificantLocationChanges which is to get AGPS coordinates which I believe returns the coordinates whenever cell tower will change, and hence consumes battery really fast.</p>

<p><strong>distanceFilter</strong> - The minimum distance (measured in meters) a device must move laterally before an update event is generated. On the basis of distance filter we get the GPS fix from the device and then we send the updated GPS coordinates to the server.</p>

<p><strong>Any help will be greatly appreciated</strong>
Thank you!</p>",iphone|ios5|gps|power-management,1124546,KB403,yes
"Android app high CPU usage, no services or wakelocks","<p>I've forked the system messaging app and it is consuming the majority of my CPU, and others have reported the same. I cannot for the life of me determine why.</p>

<p>I figured the drainage could be possibly two things (because of how much it is draining): a wakelock that has not been released, or a service doing continuous computation.</p>

<p>Here's what I have tried:</p>

<p><code>adb shell dumpsys power</code></p>

<p>This shows <code>Wake Locks: size=0</code> so I am assuming it is not a wakelock issue (the app uses wakelocks, of course, but I have not touched the code involving them). I have also used the app, WakeLock Detector, which also shows no wake locks for my application.</p>

<p>I have searched the logs tirelessly for something indicating a problem to no avail. I have also checked running services (via Settings > Apps > Running) and there are no services running for the app.</p>

<p>Does anyone know what may be causing this (enormous) battery drain?</p>

<p>EDIT: I downloaded an app called ""Disable Service"" that allows me to view all services an app has available. The main issue with my problem is it is impossible to replicate (that is, I don't know how to replicate it and it seems to happen randomly). I managed to encounter the battery drain today and tried disabling a service (TransactionService for those interested) and the problem stopped immediately. I don't think I can say for sure that this service is causing the problem but it is the first place to look. The code is available <a href=""https://bitbucket.org/cyanogenmod/android_packages_apps_mms/src/f7e8281a223af6228e6399055a6197a1edd9bc3a/src/com/android/mms/transaction/TransactionService.java"" rel=""nofollow"">here</a>.</p>",android|cpu|battery|wakelock,394416,mtbrock,yes
How to make the client disconnect immediately on network loss in socket.io?,"<p>I am developing a chat application using socket.io for iOS app and androdi app. And the issue am facing is when network connection is suddenly lost on client, it takes 25 secs(default heartbeat interval) for the disconnect event on the socket.io server to get called. I am removing the socket.id/username from my db when the disconnect event is called. But since during this 25 secs the socket.id/username still exists on my db, when some other user sends a message to this user who lost network connection, it will be shown as sent even though it was never delivered. The solution would probably be to reduce the Heartbeat interval to maybe 1 or 2 secs. I have tried that but strangely its not being set, it still takes 25 secs approx. Below is my code</p>

<pre><code>var app = require('express')()
 , server = require('http').createServer(app)
 , sio = require('socket.io')
 , redis = require('redis');

var client = redis.createClient();
var io = sio.listen(server, { origins: '*:*' });

io.set(""store"", new sio.RedisStore);

io.set(""heartbeat interval"", 2);    

var azure = require('azure');

server.listen(4002);
</code></pre>

<p>But even if i get the heartbeat interval set to 2secs, i think there might be a downside to it. If the mobile apps send acknowledgement to the server's heartbeat every 2secs then taht would probably drain the app's battery if the app is left idle for a long time. So I would appreciate any solutions at all that would work best in my case.</p>

<p>Thanks</p>",node.js|sockets|websocket|socket.io|chat,1697150,Bitsian,yes
lateinit property healthServicesManager has not been initialized,"<p>I'm trying to make an application for wearable in which I get various metrics from health services such as the heart rate for different sports. However I get the following error:: lateinit property healthServicesManager has not been initialized.
I have declared the lateinit as:</p>
<pre><code>@Inject
    lateinit var healthServicesManager: HealthServicesManagerTaekwondo
</code></pre>
<p>The complete code of the class:</p>
<pre><code>@AndroidEntryPoint
class ExerciseServiceTaekwondo : LifecycleService() {

    @Inject
    lateinit var healthServicesManager: HealthServicesManagerTaekwondo

    private val localBinder = LocalBinder()
    private var isBound = false
    private var isStarted = false
    private var isForeground = false

    private val _exerciseState = MutableStateFlow(ExerciseState.USER_ENDED)
    val exerciseState: StateFlow&lt;ExerciseState&gt; = _exerciseState

    private val _exerciseMetrics = MutableStateFlow(emptyMap&lt;DataType, List&lt;DataPoint&gt;&gt;())
    val exerciseMetrics: StateFlow&lt;Map&lt;DataType, List&lt;DataPoint&gt;&gt;&gt; = _exerciseMetrics

    private val _aggregateMetrics = MutableStateFlow(emptyMap&lt;DataType, AggregateDataPoint&gt;())
    val aggregateMetrics: StateFlow&lt;Map&lt;DataType, AggregateDataPoint&gt;&gt; = _aggregateMetrics

    private val _exerciseLaps = MutableStateFlow(0)
    val exerciseLaps: StateFlow&lt;Int&gt; = _exerciseLaps

    private val _exerciseDurationUpdate = MutableStateFlow(ActiveDurationUpdate())
    val exerciseDurationUpdate: StateFlow&lt;ActiveDurationUpdate&gt; = _exerciseDurationUpdate

    private val _locationAvailabilityState = MutableStateFlow(LocationAvailability.UNKNOWN)
    val locationAvailabilityState: StateFlow&lt;LocationAvailability&gt; = _locationAvailabilityState

    fun prepareExercise() {
        lifecycleScope.launch {
            healthServicesManager.prepareExercise()
        }
    }

    fun startExercise() {
        lifecycleScope.launch {
            healthServicesManager.startExercise()
        }
        postOngoingActivityNotification()
    }

    fun pauseExercise() {
        lifecycleScope.launch {
            healthServicesManager.pauseExercise()
        }
    }

    fun resumeExercise() {
        lifecycleScope.launch {
            healthServicesManager.resumeExercise()
        }
    }

    /**
     * End exercise in this service's coroutine context.
     */
    fun endExercise() {
        lifecycleScope.launch {
            healthServicesManager.endExercise()
        }
        removeOngoingActivityNotification()
    }

    override fun onStartCommand(intent: Intent?, flags: Int, startId: Int): Int {
        super.onStartCommand(intent, flags, startId)
        Log.d(TAG, &quot;onStartCommand&quot;)

        if (!isStarted) {
            isStarted = true

            if (!isBound) {
                // We may have been restarted by the system. Manage our lifetime accordingly.
                stopSelfIfNotRunning()
            }

            // Start collecting exercise information. We might stop shortly (see above), in which
            // case launchWhenStarted takes care of canceling this coroutine.
            lifecycleScope.launch {
                repeatOnLifecycle(Lifecycle.State.STARTED) {
                    launch {
                        healthServicesManager.exerciseUpdateFlow.collect {
                            when (it) {
                                is ExerciseMessage.ExerciseUpdateMessage -&gt;
                                    processExerciseUpdate(it.exerciseUpdate)
                                is ExerciseMessage.LapSummaryMessage -&gt;
                                    _exerciseLaps.value = it.lapSummary.lapCount
                                is ExerciseMessage.LocationAvailabilityMessage -&gt;
                                    _locationAvailabilityState.value = it.locationAvailability
                            }
                        }
                    }
                }
            }
        }

        // If our process is stopped, we might have an active exercise. We want the system to
        // recreate our service so that we can present the ongoing notification in that case.
        return Service.START_STICKY
    }

    private fun stopSelfIfNotRunning() {
        lifecycleScope.launch {
            // We may have been restarted by the system. Check for an ongoing exercise.
            if (!healthServicesManager.isExerciseInProgress()) {
                // Need to cancel [prepareExercise()] to prevent battery drain.
                if (_exerciseState.value == ExerciseState.PREPARING) {
                    lifecycleScope.launch {
                        healthServicesManager.endExercise()
                    }
                }

                // We have nothing to do, so we can stop.
                stopSelf()
            }
        }
    }

    private fun processExerciseUpdate(exerciseUpdate: ExerciseUpdate) {
        val oldState = _exerciseState.value
        if (!oldState.isEnded &amp;&amp; exerciseUpdate.state.isEnded) {
            // Our exercise ended. Gracefully handle this termination be doing the following:
            // TODO Save partial workout state, show workout summary, and let the user know why the exercise was ended.

            // Dismiss any ongoing activity notification.
            removeOngoingActivityNotification()

            // Custom flow for the possible states captured by the isEnded boolean
            when (exerciseUpdate.state) {
                ExerciseState.TERMINATED -&gt; {
                    // TODO Send the user a notification (another app ended their workout)
                    Log.i(
                        TAG,
                        &quot;Your exercise was terminated because another app started tracking an exercise&quot;
                    )
                }
                ExerciseState.AUTO_ENDED -&gt; {
                    // TODO Send the user a notification
                    Log.i(
                        TAG,
                        &quot;Your exercise was auto ended because there were no registered listeners&quot;
                    )
                }
                ExerciseState.AUTO_ENDED_PERMISSION_LOST -&gt; {
                    // TODO Send the user a notification
                    Log.w(
                        TAG,
                        &quot;Your exercise was auto ended because it lost the required permissions&quot;
                    )
                }
                else -&gt; {
                }
            }
        } else if (oldState.isEnded &amp;&amp; exerciseUpdate.state == ExerciseState.ACTIVE) {
            // Reset laps.
            _exerciseLaps.value = 0
        }

        _exerciseState.value = exerciseUpdate.state
        _exerciseMetrics.value = exerciseUpdate.latestMetrics
        _aggregateMetrics.value = exerciseUpdate.latestAggregateMetrics
        _exerciseDurationUpdate.value =
            ActiveDurationUpdate(exerciseUpdate.activeDuration, Instant.now())
    }

    override fun onBind(intent: Intent): IBinder {
        super.onBind(intent)
        handleBind()
        return localBinder
    }

    override fun onRebind(intent: Intent?) {
        super.onRebind(intent)
        handleBind()
    }

    private fun handleBind() {
        if (!isBound) {
            isBound = true
            // Start ourself. This will begin collecting exercise state if we aren't already.
            startService(Intent(this, this::class.java))
        }
    }

    override fun onUnbind(intent: Intent?): Boolean {
        isBound = false
        lifecycleScope.launch {
            // Client can unbind because it went through a configuration change, in which case it
            // will be recreated and bind again shortly. Wait a few seconds, and if still not bound,
            // manage our lifetime accordingly.
            delay(UNBIND_DELAY_MILLIS)
            if (!isBound) {
                stopSelfIfNotRunning()
            }
        }
        // Allow clients to re-bind. We will be informed of this in onRebind().
        return true
    }

    private fun removeOngoingActivityNotification() {
        if (isForeground) {
            Log.d(TAG, &quot;Removing ongoing activity notification&quot;)
            isForeground = false
            stopForeground(true)
        }
    }

    private fun postOngoingActivityNotification() {
        if (!isForeground) {
            isForeground = true
            Log.d(TAG, &quot;Posting ongoing activity notification&quot;)

            createNotificationChannel()
            startForeground(NOTIFICATION_ID, buildNotification())
        }
    }

    private fun createNotificationChannel() {
        val notificationChannel = NotificationChannel(
            NOTIFICATION_CHANNEL,
            NOTIFICATION_CHANNEL_DISPLAY,
            NotificationManager.IMPORTANCE_DEFAULT
        )
        val manager = getSystemService(NOTIFICATION_SERVICE) as NotificationManager
        manager.createNotificationChannel(notificationChannel)
    }

    private fun buildNotification(): Notification {
        // Make an intent that will take the user straight to the exercise UI.
        val pendingIntent = NavDeepLinkBuilder(this)
            .setGraph(R.navigation.nav_graph)
            .setDestination(R.id.exerciseFragment)
            .createPendingIntent()
        // Build the notification.
        val notificationBuilder = NotificationCompat.Builder(this, NOTIFICATION_CHANNEL)
            .setContentTitle(NOTIFICATION_TITLE)
            .setContentText(NOTIFICATION_TEXT)
            .setSmallIcon(R.drawable.ic_run)
            .setContentIntent(pendingIntent)
            .setOngoing(true)
            .setCategory(NotificationCompat.CATEGORY_WORKOUT)
            .setVisibility(NotificationCompat.VISIBILITY_PUBLIC)

        // Ongoing Activity allows an ongoing Notification to appear on additional surfaces in the
        // Wear OS user interface, so that users can stay more engaged with long running tasks.
        val lastUpdate = exerciseDurationUpdate.value
        val duration = lastUpdate.duration + Duration.between(lastUpdate.timestamp, Instant.now())
        val startMillis = SystemClock.elapsedRealtime() - duration.toMillis()
        val ongoingActivityStatus = Status.Builder()
            .addTemplate(ONGOING_STATUS_TEMPLATE)
            .addPart(&quot;duration&quot;, Status.StopwatchPart(startMillis))
            .build()
        val ongoingActivity =
            OngoingActivity.Builder(applicationContext, NOTIFICATION_ID, notificationBuilder)
                .setAnimatedIcon(R.drawable.ic_run)
                .setStaticIcon(R.drawable.ic_run)
                .setTouchIntent(pendingIntent)
                .setStatus(ongoingActivityStatus)
                .build()
        ongoingActivity.apply(applicationContext)

        return notificationBuilder.build()
    }

    /** Local clients will use this to access the service. */
    inner class LocalBinder : Binder() {
        fun getService() = this@ExerciseServiceTaekwondo
    }

    companion object {
        private const val NOTIFICATION_ID = 1
        private const val NOTIFICATION_CHANNEL = &quot;com.example.exercise.ONGOING_EXERCISE&quot;
        private const val NOTIFICATION_CHANNEL_DISPLAY = &quot;Ongoing Exercise&quot;
        private const val NOTIFICATION_TITLE = &quot;Exercise Sample&quot;
        private const val NOTIFICATION_TEXT = &quot;Ongoing Exercise&quot;
        private const val ONGOING_STATUS_TEMPLATE = &quot;Ongoing Exercise #duration#&quot;
        private const val UNBIND_DELAY_MILLIS = 3_000L

        fun bindService(context: Context, serviceConnection: ServiceConnection) {
            val serviceIntent = Intent(context, ExerciseServiceTaekwondo::class.java)
            context.bindService(serviceIntent, serviceConnection, Context.BIND_AUTO_CREATE)
        }

        fun unbindService(context: Context, serviceConnection: ServiceConnection) {
            context.unbindService(serviceConnection)
        }
    }
}
</code></pre>",android|kotlin|kotlin-lateinit|lateinit,9635131,Desirée Rodríguez,no
Constant running control service on Android,"<p>I need to create a service, in Android, that constantly listens to UDP messages (either broadcast or unicast). Service need to work all the time and never die.</p>

<p>Current solution that I stick with - service, that started by <strong>WakefulBroadcastReceiver</strong> with startWakefulService. Receiver is registered programatically in main activity of the application, that starts service.
Also, to prevent service from being killed or suspended I used <em>START_STICKY</em> and plenty of <strong>WakeLock</strong>s (to prevent CPU from falling asleep), <strong>WifiLock</strong>s(to prevent wifi module from falling asleep) and <strong>MulticastLock</strong>s(to prevent blocking UDP broadcasts while device screen is locked). Main problem with wakelocks that I have - I don't know from which thread I need to create it (currently service starts separate thread for UDP packets receiving, so for now I created them from every thread I have). I know about battery drain that wakelocks can create, but it doesn't matter as in the my case device will be almost constantly charged.</p>

<p>Main problem that I currently experiencing - phone still stops receiving broadcast (and I assume that unicasts also) after some time after the screen was locked (I tested my solution on <strong>Samsung Galaxy S7</strong> and <strong>S6</strong>). So, the question is - how do I keep CPU and network alive forever, by any means possible? </p>",java|android|multithreading|sockets|udp,5090940,John Stonebridge,no
Push Notifications in Android Platform,"<p>I am looking to write an app that receives pushed alerts from a server. I found a couple of methods to do this.  </p>

<ol>
<li>SMS - Intercept the incoming SMS and initiate a pull from the server</li>
<li>Poll the server periodically</li>
</ol>

<p>Each has its own limitations. SMS- no guarantee on arrival time. Poll may drain the battery.</p>

<p>Do you have a better suggestion please? Thanks very much.</p>",android|push|alerts,165473,Vinod,yes
Android - How to slow down battery Drain,"<p>I am developing a game for Android. It uses a surface view and uses Bitmaps to draw objects each frame, redrawing on the Bitmap objects only when required.
Using the app I noticed that the battery is draining.
I would like to know if there is a library to understand which part I am consuming a lot of battery in or a way to apply the battery safety function in my surface view.
Each bitmap in the game is recycled every time it is instantiated. So apart from this little trick I don't know how to optimize my code.
Can anyone suggest me what I can do?
Thanks in advance</p>",android|game-engine|battery,10191400,DoctorWho,yes
"Background task that gets the GPS locations, at regular intervals. AlarmManager Service Android","<p>I want to create applications that will get location in the background every five minutes.
I tried to do something, but I have trouble with AlarmManager because The first Toast appears, but the second one never and it doesn't get location.
Do you have any idea and show me what have I bad?</p>

<p><strong>AndroidManifest.xml</strong></p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;
</code></pre>

<p></p>

<pre><code>&lt;uses-permission android:name=""android.permission.INTERNET"" /&gt;
&lt;uses-permission android:name=""android.permission.ACCESS_FINE_LOCATION"" /&gt;
&lt;uses-permission android:name=""android.permission.ACCESS_COARSE_LOCATION"" /&gt;
&lt;uses-permission android:name=""android.permission.READ_PHONE_STATE"" /&gt;

&lt;application
    android:allowBackup=""true""
    android:icon=""@mipmap/ic_launcher""
    android:label=""@string/app_name""
    android:supportsRtl=""true""
    android:theme=""@style/AppTheme""&gt;
    &lt;meta-data
        android:name=""com.google.android.gms.version""
        android:value=""@integer/google_play_services_version"" /&gt;

    &lt;activity
        android:name="".MainActivity""
        android:label=""@string/app_name""
        android:theme=""@style/AppTheme.NoActionBar""&gt;
        &lt;intent-filter&gt;
            &lt;action android:name=""android.intent.action.MAIN"" /&gt;

            &lt;category android:name=""android.intent.category.LAUNCHER"" /&gt;
        &lt;/intent-filter&gt;
    &lt;/activity&gt;
    &lt;activity
        android:name="".AfterLoginActivity""
        android:label=""@string/title_activity_login""
        android:theme=""@style/AppTheme.NoActionBar"" /&gt;
    &lt;activity
        android:name="".RegisterActivity""
        android:label=""@string/title_activity_register""
        android:theme=""@style/AppTheme.NoActionBar"" /&gt;
    &lt;activity
        android:name="".ActualLocationActivity""
        android:label=""@string/title_activity_actual_location""
        android:theme=""@style/AppTheme.NoActionBar"" /&gt;
    &lt;activity
        android:name="".DetailsActivity""
        android:label=""@string/title_activity_details""
        android:theme=""@style/AppTheme.NoActionBar""&gt;&lt;/activity&gt;
    &lt;service android:enabled=""true"" android:name=""LocationUpdaterService""&gt;&lt;/service&gt;
    &lt;receiver android:name=""ConnectivityReceiver""&gt;&lt;/receiver&gt;
&lt;/application&gt;
</code></pre>

<p></p>

<p><strong>OnClickListerner in AfterLoginActivity</strong></p>

<pre><code>public void onClickServicesAction(View view) {
Toast.makeText(this, "" onclick"", Toast.LENGTH_SHORT).show();
Intent intent = new Intent(this, ConnectivityReceiver.class);
PendingIntent pintent = PendingIntent.getBroadcast(this, 0, intent, 0);
AlarmManager alarmManager = (AlarmManager)getSystemService(ALARM_SERVICE);
alarmManager.set(AlarmManager.ELAPSED_REALTIME_WAKEUP,
        SystemClock.elapsedRealtime()+ (10 * 1000), pintent);

}
</code></pre>

<p><strong>ConnectivityReceiver.java</strong></p>

<pre><code>public final class ConnectivityReceiver extends BroadcastReceiver {

@Override
public void onReceive(Context context, Intent intent) {

    Toast.makeText(context, "" onReceive"", Toast.LENGTH_SHORT).show();

    final AlarmManager alarmManager = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
    final PendingIntent wakeupIntent = PendingIntent.getService(context, 0,
            new Intent(context, LocationUpdaterService.class), PendingIntent.FLAG_UPDATE_CURRENT);

    final boolean hasNetwork = !intent.getBooleanExtra(ConnectivityManager.EXTRA_NO_CONNECTIVITY, false);
    if (hasNetwork) {
        // start service now for doing once
        context.startService(new Intent(context, LocationUpdaterService.class));

        // schedule service for every 10 seconds
        alarmManager.setInexactRepeating(AlarmManager.ELAPSED_REALTIME_WAKEUP,
                SystemClock.elapsedRealtime() + 10 * 1000,
                10 * 1000, wakeupIntent);
    } else {
        alarmManager.cancel(wakeupIntent);
    }
}
</code></pre>

<p>}</p>

<p><strong>LocationUpdaterService.java</strong> </p>

<pre><code>public  final class LocationUpdaterService extends Service implements LocationListener {

private String latitude = ""default"";
private String longitude = ""default"";

private enum State {
    IDLE, WORKING;
}

private static State state;

private LocationManager locationManager;
private PowerManager.WakeLock wakeLock;

static {
    state = State.IDLE;
}

@Override
public void onCreate() {
    super.onCreate();
    final PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
    this.wakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, ""LocationUpdaterService"");
}


@Override
public IBinder onBind(Intent arg0) {
    return null;
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    if (state == State.IDLE) {
        state = State.WORKING;
        this.wakeLock.acquire();
        // register location updates, not gonna code it you know

    }
    return START_STICKY;
}

@Override
public void onDestroy() {
    super.onDestroy();
    state = State.IDLE;
    if (this.wakeLock.isHeld()) {
        this.wakeLock.release();
    }
}

private void sendToServer(Location location) {
    Toast.makeText(getApplicationContext(), latitude +"" ""+ longitude, Toast.LENGTH_SHORT).show();
    // send to server in background thread. you might want to start AsyncTask here
}

private void onSendingFinished() {
    // call this after sending finished to stop the service
    this.stopSelf(); //stopSelf will call onDestroy and the WakeLock releases.
    //Be sure to call this after everything is done (handle exceptions and other stuff) so you release a wakeLock
    //or you will end up draining battery like hell
}

@Override
public void onLocationChanged(Location location) {
    if (ContextCompat.checkSelfPermission(this, android.Manifest.permission.ACCESS_FINE_LOCATION) == PackageManager.PERMISSION_GRANTED) {
        locationManager.removeUpdates(this); // you will want to listen for updates only once
        latitude = Double.toString(location.getLatitude());
        longitude = Double.toString(location.getLongitude());
    }
    sendToServer(location);
}

@Override
public void onProviderDisabled(String provider) {
}

@Override
public void onProviderEnabled(String provider) {
}

@Override
public void onStatusChanged(String provider, int status, Bundle extras) {
}
</code></pre>

<p>}</p>",android|service|background|alarmmanager,7264972,Gustawson,no
Better than FileObserver,"<p>I'm curious to know if there's a better way to monitor a directory for file changes/creations/deletions than <code>FileObserver</code>. FileObserver requires a constant reference to it, which requires a constantly running service, which is difficult and a bad practice, right?</p>

<p>I'd appreciate any insight as to how you monitor the filesystem without, say, draining battery or having to keep a service running. (In newer Android versions, the service is killed when you swipe the app off the recent apps stack.)</p>

<p>Thanks!</p>",android|fileobserver,1461223,Osmium USA,yes
Android location based Augmented Reality values for sensors,"<p>I have created an augmented reality app. Now, I want to know which values are the appropriate for sensors? First of all the time interval between updates for the <a href=""/questions/tagged/gps"" class=""post-tag"" title=""show questions tagged 'gps'"" rel=""tag"">gps</a> is 30 secs and 3 meters. For the <a href=""/questions/tagged/accelerometer"" class=""post-tag"" title=""show questions tagged 'accelerometer'"" rel=""tag"">accelerometer</a> and <a href=""/questions/tagged/magnometer"" class=""post-tag"" title=""show questions tagged 'magnometer'"" rel=""tag"">magnometer</a> the sensor delay in the beginning was normal -> UI and know it is game. which are the appropriate values for a good user experience. I tested recently the app and it wasn't too accurate. the icon was not exact in the building. Also I don't want to drain the user's battery. Most of all I don't know which sensor delay should I use.</p>",android|augmented-reality|android-sensors,2065529,user2065529,no
prevent iOS app from sleep but retain lock screen and screen dimming,"<p>My app communicates with an external accessory, however seems there is a bug that when the ios device comes back from sleep sometimes the EAAccessoryManager list is empty. The app is already in the field and I need a fix as currently the users have to turn the external accessory off and on for it to work again.</p>

<p>I am thinking of preventing the iOS device from going to sleep. However I do not want the LCD screen to be on always as that will drain the battery. I also want the lock screen to activate for security purposes. What are my options?</p>

<p>Btw the EAAccessoryManager list is usually empty after the device awakes and the user has to enter an unlock code. Seems if I use the fingerprint it is fine, so believe it is a bug in iOS 10.3.3? Any one else encounter this?</p>",ios|mfi,4139729,rukiman,yes
SourceKit Service nightmare,"<p>My SSK usually takes up 100% of a core and drains battery really quickly.</p>

<p>Each time it does this, I got to Activitiy Monitor, figure out which folder in the ModuleCache it's working on, delete it and then finally force quit SSK, and things return to normal for a little bit, and then the same exact problem returns.</p>

<p>Any advice on this issue?</p>",xcode,2255814,Latcie,yes
How to detect if phone is moving?,"<p>right now I'm working on an app that heavily relies on Geofencing API.
It works fine, however sometimes when I leave phone on my desk, I sometimes receive false-positive callbacks. Probably because I switch between 3G antennas or something. </p>

<p>My idea was to detect user movement. If user is not moving and I receive message that he left the area - I'll know its wrong. Unfortunately I can't rely on location services, because apparently LocationManager and Geofencing API are giving me weird data. 
Sometimes when I enter an area and trigger <code>getLastLocation()</code>, it's few kilometers away. Sometimes when I'm notified about leaving the area... Location Services are informing me that I'm still where I should. So yea - can't really rely on that. </p>

<p>Is there some kind of callback, notification or whole library for receiving notification of some sorts that phone is moving? From accelerometer or gyroscope?</p>

<p>Yes, I could micro manage that, because my app already has a service... but I'd like to avoid heavy battery drainage. </p>",android|accelerometer|gyroscope,1812056,a_dzik,no
Monitoring memory usage of other apps in iOS,"<p>I have serious doubts that it is even possible through apple approved apps, but I have seen a couple of apps in cydia that allow you to see how much memory individual apps are using and was wondering if that was possible without jail breaking the device.  </p>

<p>The reason I am asking is that I am helping to design a ""green"" charger and accompanying app and the client thinks it would be beneficial to show the user what apps are draining their batteries or using the most memory to try to increase battery life.</p>",iphone,406076,Ian Oswald,yes
How to run an async task for every x mins in android?,"<p>how to run the async task at specific time? (I want to run it every 2 mins)</p>

<p>I tried using  post delayed but it's not working?</p>

<pre><code>    tvData.postDelayed(new Runnable(){

    @Override
    public void run() {
        readWebpage();

    }}, 100);
</code></pre>

<p>In the above code readwebpage is function which calls the async task for me..</p>

<p>Right now below is the method which I am using</p>

<pre><code>   public void onCreate(Bundle savedInstanceState) {

         readwebapage();

   }

   public void readWebpage() {
    DownloadWebPageTask task = new DownloadWebPageTask();
    task.execute(""http://www.google.com"");

   }

   private class DownloadWebPageTask extends AsyncTask&lt;String, Void, String&gt; {
    @Override
    protected String doInBackground(String... urls) {
        String response1 = """";
        response1=read(); 
                   //read is my another function which does the real work    
        response1=read(); 
        super.onPostExecute(response1);
        return response1;
    }


      protected void onPostExecute(String result) {


         try {
                Thread.sleep(100);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            TextView tvData = (TextView) findViewById(R.id.TextView01);
            tvData.setText(result);

        DownloadWebPageTask task = new DownloadWebPageTask();
        task.execute(new String[] { ""http://www.google.com"" });

    }

    }
</code></pre>

<p>This is what I  my code is and it works perfectly fine but the big problem I drains my battery?</p>",android|android-asynctask,1395320,Shan,no
Android Wear 2.0 Architecture issues for realtime complications,"<p>I'm developing a set of complications that I would like have regardless of the other installed apps and watch faces. Yes, at some point I am reinventing the wheel, but at the same time I am using this as a learning project. This will also ensure that I always have all the complications I use, available and that they all have the same format and style, instead of relying on 3rd party apps to provide them separately.</p>

<p>The set will have complications for Heart rate, gps coordinates, hours, minutes, seconds, dd/MM date, dd/MM/yy date, battery, etc. </p>

<p>When I started programing all this I found several problematic pieces (most likely because this is the first time I develop complications, or an app for android wear for that matter) and hence this question. </p>

<p>Note that some of this behavior might be specific to the Huawei Watch 2 LTE.</p>

<p><strong>1) Upgrade interval push / pull.</strong></p>

<p>I understand complications as data providers, whose only responsibility is to provide the data to whatever watch face is calling them. This means that we are not certain (and we rely on the watch face developer) to know about the complication and request updates accordingly. This turns some complications completely useless if not updated in time (for example display the Seconds). Could also leave to complications displaying old data (for example old GPS coordinates, old heart rate bpm).
So ok, I decided to implement <code>ProviderUpdateRequester</code> with the <code>AlarmManager</code> to <em>push</em> data to the watch face. The problem again, is with complications that should happen faster, like seconds, as Android will block pending intents if they are schedule too often. So in order to get around that, I decided to use Android handlers within the same service instance, which turn out to be not a good idea because of the next topic.</p>

<p><strong>2) Complication lifecycle</strong></p>

<p>By debugging, I found out that the instance of the <code>ComplicationProviderService</code> object that is executing <code>onComplicationActivated</code>, <code>onComplicationUpdate</code>, <code>onComplicationDeactivated</code> can be different. This means that this is not a sticky service (single instance) that will be always running, but every update creates a new instance of the service. This is problematic because of heavy initialization complications: for example GPS, or Heart Rate monitor that need to listen for new values and it might take a while to retrieve the first value. And also, for those complications that can't rely on AlarmManager, and/or need to keep some sort of state between updates executions.</p>

<p><strong>3) Display aware service</strong></p>

<p>To get around the previous point , let's say you have static variables on your complication service , which are initialized <code>onComplicationActivated</code> and disabled at <code>onComplicationDeactivated</code>. For example, this could be getting a reference for the LocationProvider and starting listening for location updates. This will ensure that each invocation to <code>onComplicationUpdate</code> will not have to perform the heavy/cold initialization and will have access to the most up-to-date data. 
However, this also means that your logic will executed regardless if <code>onComplicationUpdate</code> is called or not. 
When in ambient mode (or screen off) the watch face can decide not to update the complication by not calling <code>onComplicationUpdate</code>, but it's not aware of our static logic, nor the <code>ComplicationProviderService</code> has a callback invocation for when the screen goes into ambient mode or turns on/off. This is a problem, because in our example, if the screen is off, we are still going to be listening for GPS coordinates, and most likely draining the battery.
Sure, we can deal with this by using a combination of BroadcastReceiver (Intent.ACTION_SCREEN_ON/OFF) and <code>DisplayManager.DisplayListener</code>, but then again, not sure if i'm taking the correct path here, because this will mean that we are now creating services that need to be statically aware of the state of the display.</p>

<p><strong>4) Detect screen on/off</strong></p>

<p>The <code>BroadcastReceiver</code> for <code>Intent.ACTION_SCREEN_ON/OFF</code> works as expected when ambient mode is disabled, but it doesn't it's enabled. When ambient mode is enabled, <code>Intent.ACTION_SCREEN_OFF</code> is dispatched when going into ambient mode, but <code>Intent.ACTION_SCREEN_ON</code> is not dispatched when coming out of ambient mode. While a bit more complex, this can be accomplished by using <code>DisplayManager.DisplayListener</code> to get updates on the <code>onDisplayChanged</code> callback.</p>

<p><strong>TL;RD</strong></p>

<p>1) How do you ensure watch faces display your complications in a timely manner to always have correct and most up-to-date information?</p>

<p>2) How do you deal heavy/cold initialization of a <code>ComplicationProviderService</code> if everytime <code>onComplicationUpdate</code> is called the service instance is different? </p>

<p>3) Is making a long running service display-aware something crazy to do?</p>

<p>4) Technically the screen is still on when in ambient mode, so why is <code>Intent.ACTION_SCREEN_OFF</code> being broadcasted? Why isn't <code>Intent.ACTION_SCREEN_ON/OFF</code> symetrical when ambient mode is enabled?</p>

<p>5) Maybe complications shouldn't be use for exposing realtime information?</p>

<p>Thanks a lot</p>",android|wear-os|android-wear-complication,961759,Robert Estivill,yes
Check location every 15min even if app in foreground or killed state,"<p>I have a requirement,  where my android app needs to check for location every 15 min and update it to SQLite DB. This process should happen even if app removed from background. I tried all the following ways, but none of them are working when app running for long time.</p>
<ol>
<li>Runnable function with a foreground service. Below is the example</li>
</ol>
<pre><code>mHandlerTask = new Runnable() {
            @Override
            public void run() {
                doCheckLocation();
                mHandler.postDelayed(mHandlerTask, 60000 * 15);
            }
        };
        mHandler.postDelayed(mHandlerTask, 60000 * 15);
</code></pre>
<p>This is working fine, but if screen turned off that runnable is not triggering. I think it's because of doze mode.</p>
<ol start=""2"">
<li><p>Work manager with Periodic Work Request: This is also not triggering when device goes to doze mode / screen turned off.</p>
</li>
<li><p>Alarm Manager: This has few functions <code>setExactAndAllowWhileIdle()</code>, <code>setAlarmClock()</code> for triggering at exact time. But the battery consumption is very high and phone gets heated up if I'm using <code>setAlarmClock()</code>.</p>
</li>
</ol>
<p>So I wanna try with a wake lock. When screen getting turned off I acquire it. I'll release it when screen is on. But wake lock is going to drain the battery, and most likely OS can kill my app.</p>
<p>Can anyone suggest a better way to solve this problem?</p>",android|alarmmanager|android-workmanager|background-service|foreground-service,11363529,Ravi Kiran,yes
How to display live location of user within a map in an android app?,"<p>I am working on an application module where the module interacts with user directly and tracks down the location of the user from the app and stores the same in the database as <code>Latitude</code> and <code>Longitude</code> field. I am using <code>MYSql databse</code>.</p>

<p>I have used a concept where I am making <strong>repeated <code>Web Service</code></strong> request to get the latest lat long from the database as well as pushing the same to the database to store the same using <strong>API</strong> endpoint. But the same is not efficient and drains battery a lot.</p>

<p>So I would like to know how to make a location aware app which displays live location of the user without calling the end point repeatedly.</p>

<p><strong>Indirectly I would like to know how an app like OLA or UBER displays cabs nearby also shows accurate location of the cab moving from one point to the another.</strong></p>

<p>TIA</p>

<p><a href=""https://i.stack.imgur.com/FWZ6G.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/FWZ6G.png"" alt=""enter image description here""></a></p>",java|android|mysql|dictionary|location,4578454,silverFoxA,no
How to reduce battery drain while using large number(50) of geofences,"<p>My requirement:</p>

<p>Area around the Path(Route) is having some important places(quantity is approx. 50). When user is moving on the path, and reach to the nearest place(e.g. A), I need to perform some task particular to that place(e.g. A).</p>

<p>Currently, I am creating geofences for all the required places at the same time but having doubt about the battery consumption.</p>

<p>Is there any way to minimize the battery consumption? If yes, then please help. Any help or guidance will be well appreciated.</p>

<p>Note: User can enter to the route from start/end/middle of the route.</p>",android|google-maps|geofencing|android-geofence,526443,abhishek kumar gupta,yes
NodeJS + SocketIO android battery issue,"<p>I am using node.js socket.io library for building a android chat application with socket connection.
but socket connection consume too much power that it drain battery by very high rate.</p>

<p>so 
is it possible to minimize power consumption by any mean of keeping socket idle or anything</p>

<p>below is my code where i have added in IOConnection.java class</p>

<pre><code>public void transportMessage(String text) {
    // my logic
}
</code></pre>",android|node.js|socket.io,1428013,Mufazzal,yes
Android WebView enters unrecoverable state if executed JavaScript enters infinite loop,"<p>The Android WebView widget appears to enter an unrecoverable state if executed JavaScript code is caught in an infinite loop.</p>

<p>For example, this webpage will cause the problem:</p>

<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;title&gt;FAIL&lt;/title&gt;
&lt;script type=""text/javascript""&gt;
    function test() {
        while (true);
    }
&lt;/script&gt;
&lt;/head&gt;
&lt;body onload=""test();""&gt;
Failure Test
&lt;/body&gt;
</code></pre>

<p></p>

<p>As will simply entering the following URL in any Android browser using WebView:</p>

<pre><code>javascript:while(true);
</code></pre>

<p>Once such an infinite loop is encountered, one CPU core will be run at its maximum.  The WebView appears to never shut down.  This will of course rapidly drain the battery and slow the device.  Only terminating the containing application appears to resolve this.</p>

<p>The following appear to be ineffective:</p>

<ul>
<li>Disabling JavaScript: webView.getSettings().setJavaScriptEnabled(false);</li>
<li>Stopping the page from loading: webView.stopLoading();</li>
<li>Pausing all JS Timers: webView.pauseTimers();</li>
<li>Loading an alternate URL: webView.loadUrl(""about:blank"");</li>
<li>Removing the WebView from the widget hierarchy: parent.removeView(browserView);</li>
<li>Invoking destroy on the WebView: webView.destroy();</li>
<li>Finishing the activity: activity.finish();</li>
<li>Returning false from WebChromeClient.onJsTimeout();  (This method was deprecated in API 17, and appears to never be invoked).</li>
</ul>

<p>The following is effective:</p>

<ul>
<li>Killing the VM: System.exit(0);  (This is a method that should never be called on Android.)</li>
</ul>

<p>It's worth noting that the stock Android browser (not Chrome) suffers this problem as well.  Though Chrome does not have the issue, it does still appear to occur when using the Chromium-based WebView shipped in Android 4.4.</p>

<p>Once one WebView enters this state, the application will be unable to load any URL into any other WebViews.</p>

<p>If anyone has any suggestions for terminating a WebView, it'd be greatly appreciated.  I can't control the content being loaded into the WebView, as it's being used for a general-purpose browser.  Otherwise my default solution will be to attempt to detect the scenario and warn the user if it is encountered, providing the option to forcibly terminate the application to prevent battery drain.  </p>

<p>Thank you for any ideas!</p>",javascript|android|webview|infinite-loop|terminate,321049,tliebeck,yes
"In Android 4.4+ versions, geofence not working over 3G/WiFi","<p>I am using the sample application(Creating and Monitoring Geofences) provided by Android.</p>

<p>On Android 4.4+ (KitKat )versions only, I am not able to add/delete Geofences over 3G or WiFi. Every time I am getting error code 1000("" Add Geofences: Failure, error code 1000""). </p>

<p>Just by enabling GPS(it doesn't matter whether GPS is fixed or not), everything works fine but accompanied with the problem of battery drain.</p>

<p>Is there any alternative solution? If yes, then please guide me.</p>

<p>Any help or guidance will be well appreciated.</p>

<p><strong>Note</strong>: I have tested on Nexus 5(4.4.4), Nexus 4(4.4) and Samsung Galaxy S4(4.4.2).
On Android 4.3 and below, everything works fine.</p>",android|google-maps-android-api-2|android-geofence,526443,abhishek kumar gupta,no
Is it possible to stop my app from showing battery draining notification?,"<p>My Android app is using Locationmanger service and when it is in background for a longtime, Android OS(7+ version) showing battery draining notification. I'm afraid will it provoke my customer to uninstall the application. So I just want to know is there anyway to prevent my app from showing this notification.</p>",android,6680744,Manu Ram V,no
smart phone bratinger app,"<p>I want to make an android application that when it reaches a predefined  GPS location , it will do an action(send message or play sound )</p>

<p>I can make a background service that will run in the background, but while surfing the internet I found this app <a href=""http://smartphone.bartinger.at/"" rel=""nofollow"">http://smartphone.bartinger.at/</a></p>

<p>where you can set conditions and adjust the settings when this condition is met. It said on the website that
""isn´t just a background service that constantly checks if the conditions apply. Nearly all conditions are handled by features of Android. Smart Phone is using these features, so they don’t need to run in the background and won’t drain your battery.""</p>

<p>So clearly my question is , ift's not background service so what is it ? What does it mean that I am programming the features ?</p>

<p>Thanks in advance</p>",android,1074872,Mariam,yes
Data from presure sensor to home widget,"<p>Im starting to develop my first home screen widget. I got activity where i can read and display data from presure sensore by:</p>

<pre><code>public class BaroWidgetActivity extends Activity implements SensorEventListener {
[...]
   public final void onSensorChanged(SensorEvent event) {
        float millibars_of_pressure = event.values[0];
      }
} 
</code></pre>

<p>I also have home widget with simple textview. And i want to display current preseure there every 30min. But i dont know how to do it, so some service will not constant work and not drain battery. I dont want to display all presure change but read current presure every 30 min. What is the best way to do this?</p>",android,464492,Rafał Kot,yes
Short interval alarms in Android,"<p>I know that we can't set repeating alarms of short intervals in Android because it drains battery and has other such effects. Well, technically you can, but android will automatically push it up to a minute citing ""suspiciously short duration"".</p>

<p>So how exactly does an app like WhatsApp or Facebook constantly update our messages or newsfeed? I thought they fire an Alarm each second, but clearly that is impossible because the OS will push it up to a minute anyway. Using Handlers/Threads is off the question anyway because they don't fire when the app is closed, but WhatsApp updates your messages even when the app is closed.</p>

<p>So what exactly do these apps use if not AlarmManager to do the aforementioned task, and if they use AlarmManager, how do they set the short duration?</p>",android,2672265,Anshu Dwibhashi,yes
How to analyze app battery performance,"<p>My app is draining the battery also when its not in foreground and i can't figure out why.</p>

<p>I have one background service for a chat room (using <a href=""http://framework.realtime.co/messaging/"" rel=""nofollow"">realtime</a>).</p>

<p>Is there any tool for analysing app battery performance?</p>

<p>Not an app like battery doctor.
I want to check exactly what Activity or Service is draining the battery. </p>

<p>Thanks</p>",android,1833272,ilan,yes
How to do Application wise bettery usage/drain in android,"<p>i got many stack overflow for the battery info mobile.but i can't get any info on stack overflow for the application wise get battery info.my mean to which application most use the power and voltage in android.please anybody can suggest me to how to do programming for battery usage.</p>

<p><img src=""https://i.stack.imgur.com/UVZBy.png"" alt=""enter image description here""></p>

<p>I want battery status output as above application wise battery drain/usage in android.</p>",android,3241582,Vasant,no
How can I programmatically detect which apps caused phone to wake up?,"<p>Looking for a way to collect a statistics on phone wake ups. And then uninstall that stupid app which does that every 10 minutes on my phone.</p>

<p><strong>Update</strong>: Tried battery apps, they are crap. They show that phone wakes up every 5-15 minutes, but tell me nothing why. They also show how much each app drained, but it always less than 5%.</p>

<p>So I looking for a way to collect this stats and do some analytics with that.</p>

<p><strong>Update II</strong>: Looks like there are battery managers that do the job (GSam Battery Monitor for example), and with a bit of reverse engineering I hope I'll find, how they collect statistics.</p>",android,484301,Maksym Davydov,yes
How to fetch application details which has just started in android,"<p>Hello I am trying to track a certain app after it has installed. I want to have a information of apps whenever they start. </p>

<p>It's just like <code>AppLock</code> app in which they know when I open an app on which I activated a lock then it show their <code>activity</code> to enter password.</p>

<p>To achieve this 
I've made a service and put a while loop infinite in a gap of 1 seconds to keep track of running application on top but it really drain my battery in a few hours. <code>AppLock</code> did this in a nice way that's why it doesn't drain battery fast.</p>

<p>I know that my current logic that is really bad: </p>

<pre><code>while(true) {
    final   ActivityManager activityManager = (ActivityManager) getSystemService(Context.ACTIVITY_SERVICE);
    final List&lt;RunningTaskInfo&gt; recentTasks = activityManager.getRunningTasks(Integer.MAX_VALUE);
    Log.d(""Executed app"", ""Application executed : "" +recentTasks.get(0).baseActivity.toShortString()+ ""\t\t ID: ""+recentTasks.get(0).id+"""");         
    Thread.sleep(1000);
}
</code></pre>

<h2>Question</h2>

<p>How this should be done in a efficient way as like <code>AppLock</code> app ?</p>",android,2455259,N Sharma,no
Services and battery consumption,"<p>I am working over a project that has many services that need to download and upload data from time to time. I was wondering, if we increase the number of services in an app, is this going to affect the battery consumption? Will it heavily drain or so?</p>",android,1747460,Payal,no
Android Track Users Location?,"<p>I'm playing around with a bit of a game as a way to learn Android and spend more time getting to know the town I just moved to. The premise behind the game is that you get points for visiting various places in the area around you. What I'd like to do is have the app periodically track your location so that when you launch the game again you can see the different places you've been and how many points you accrued for visiting the various places.</p>

<p>It seems like I could use this <a href=""https://github.com/yyl/Tracking-map-on-android"" rel=""nofollow"">github project</a> as a starting point, but it seems like that just has a long running task on it that seems like it would really drain your phones battery.</p>

<p>Is there a better way to handle this kind of thing? </p>",android,2650407,Tom Hammond,no
Closed android app still running in background,"<p>I am working on an Android app which requires a lot of resources, for this reason I decided to add an Exit button even though it is discouraged, the usual practice is to let the systems handle it via the Back Button.
The issue is that it doesn't work, at least on the emulator. The app closes the main View, goes in the background and keeps logging.
The first time I tried to exit by calling <strong>finish()</strong>, then I tried by calling <strong>super.onBackPressed()</strong>, then both of them, but the result is always the same. </p>

<pre><code>override fun onCreateOptionsMenu(item: MenuItem): Boolean {
    when (item.itemId) {
        R.id.exti_item -&gt; {
            finish()
            super.onBackPressed()
        }
    }
}
</code></pre>

<p>Is it possible to close and app? I could leave it to the OS, but apart from the memory usage I'm worried it could drain the battery.</p>",android,9770698,FluidCode,yes
How to permanently communicate with an app,"<p>Many apps (e.g. WhatsApp) receive messages on their servers and send them to their app.I want to do something similar, but how?</p>

<p>I thought about a constant socket connection, but this would drain the battery, wouldn't it?</p>

<p>Another idea was to run a scheduler in the app reauesting the sever every few seconds, but this would mean messages will not receive immediately like they do at other apps.</p>

<p>So what's the suggested way to do this without draining the phones battery?</p>",android,8850201,Florian,no
Estimating time until battery is depleted for Android phones programmatically,"<p>So there are ways to get the current battery levels via a listener. However, these give you the values of the phone's current battery state, but no indicator of how fast/slow is the rate at which the battery is draining.</p>

<p>What would be a way to estimate the time remaining until the battery is depleted? Can you do anything knowing what the voltage is? Or perhaps monitor the rate at which the battery drains over a period of time and then extrapolating it?</p>

<p>Many thanks.</p>",android,527329,mMx,yes
Partial wake lock power drain in Android phones,"<p>I am creating a remote service that keeps the PARTIAL_WAKE_LOCK in order to continually
do some background work. What range of power drain should I expect in the Android devices
from this? On my devices, it eats anything between 30 min and 2 hours of battery life as measured from full charge.</p>",android,922128,TudorT,no
Will my android service drain the entire battery?,"<p>I am from Argentina, sorry for my bad english...</p>

<p>I am doing an android app and i have one service.</p>

<p>This service send a notification to a external webservice every XX seconds (XX is a parameter set by the user)</p>

<p>So i have:</p>

<p>XX seconds = ReminderTime;</p>

<pre><code>for(;;){
    try {
    if(chkReminderNotif == true)
    {
        if(ReminderCount &gt;= ReminderTime) {
            ReminderCount = 0;
            SendDataService(""..........."");
        }
        else{
            ReminderCount = ReminderCount + 1;
        }
    }
    Thread.sleep(1000);
    } catch (InterruptedException e) {
        e.printStackTrace();
        Thread.currentThread().interrupt();
    }
}
</code></pre>

<p>There is best way to do this?</p>

<p>I will drain the battery with this code?</p>

<p>Without taking into account the consumption of part SendDataService(""..........."");""</p>

<p>Thanks and sorry for my bad english!</p>",android,7873959,thearing,no
How to put my phone in dim mode in Android?,<p>I want to put my phone in dim mode using my application. It seems phone's home screen will be in deem mode. If I going to use Power Manager class then it will drain battery. How can I do this then?  Can any one give some sample code? </p>,android,698070,Arindam Mukherjee,yes
Android with E-Ink display,"<p>I'm interested in using Android for a <a href=""http://www.eink.com/technology/howitworks.html"" rel=""noreferrer"">E-Ink</a>
 based platform. I know it has been <a href=""http://vimeo.com/3162590"" rel=""noreferrer"">demonstrated</a> once by MOTO, but I'm interested in using it for a commercial grade product and not 'just' a technology demo.  I have got a question on the ability to change the platform to cope with specific display effect caused by E-Ink. I'm asking this question from the role of system architect and have no prior experience with Android.</p>

<p>E-ink has several characteristics which are very different than the common LCD displays:</p>

<ul>
<li>time to update display (50-700ms)</li>
<li>it costs power to <em>change</em> the display (none to maintain)</li>
<li>display life time is determined by number of display updates!</li>
<li>tradeoffs can be made between quality, performance and display lifetime</li>
<li>grayscale versions available</li>
</ul>

<p>The great thing: it costs no power to retain display information and they can be read in bright sunlight with no backlight. Also the display can be literally as thin as paper...</p>

<p>This means that the platform software needs to have a degree of control over the number of display updates and the type of display updates to get the best performance. Otherwise, an application which is unaware of the display characteristics could quickly drain the battery, or worse, shorten display life time to months instead of years. Conceptually I'd be interested in replacing a display driver, but I'm not sure if this part is open. I know it is hard to get info on the Qualcomm chipsets.... </p>

<p>My question: can this be done? Can the Android platform be modified to support a drastically different display effect? Any pointers to an android roadmap?</p>

<p>The reason I find Android interesting for this application is because there is a significant overlap in functionality (from cell phone to browser).</p>

<p>Thanks!</p>",android,147820,Adriaan,yes
How to avoid the battery drain while implementing the GPS?,"<p>In my app I'm using a GPS listener. I need to turn off the GPS and activate it later. Currently I'm using</p>

<p><code>locationManager.removeUpdates(locationListener);</code></p>

<p>to turn off the gps. That will turn the GPS off. But later I'm not able to turn it on? Is there any other methods to turn off the gps?</p>

<p>For activating the GPS I'm using</p>

<pre><code>locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, updatesInterval, 0, locationListener);
</code></pre>",android,482625,includeMe,yes
Using LocationManager in an IntentService doesn't seem to work,"<p>I'm having an problem using LocationManager in my IntentService.  I'm developing an application to display a Map Image.  I want an IntentService to run the background to detect location changes.  When location updates are detected, the service will write the new location to the SQLite database.  The IntentService will send a Broadcast to the main Activity to let it know a new location has been stored.  The main app extracts the location for the database and moves the icon to the new location on the map.</p>

<p>Here is the code for the Service:</p>

<pre><code>import java.util.List;
import java.io.*;

import android.os.AsyncTask;
import android.os.Bundle;

import android.app.IntentService;
import android.content.Context;
import android.content.Intent;

import android.widget.Toast;

import android.location.GpsStatus;
import android.location.Location;
import android.location.LocationListener;
import android.location.GpsStatus.NmeaListener;

import android.location.LocationManager;

import android.database.*;

import android.util.Log;

// local imports
import com.saic.MCAppActivity;
import com.saic.db.*;

public class SaService extends IntentService {

    private static final String tag = ""SaService"";


    private Location loc = null;
    private Intent updateMapIntent = null;
    private LocationManager locMgr = null; 
    private boolean gps_provider = false;
    private boolean net_provider = false;

    public SaService ()
    {
       super( tag );
    }

    public SaService(String name)
    {
       super(name);
    }

    @Override
    protected void onHandleIntent(Intent intent)
    {
       updateMapIntent = new Intent();
       updateMapIntent.setAction( ""UPDATE_LOCATION"" );

       locMgr = MCAppActivity.getLocationManager();

       locMgr.requestLocationUpdates( LocationManager.GPS_PROVIDER, 60, 0,
                                      locationListener );
       locMgr.requestLocationUpdates( LocationManager.NETWORK_PROVIDER, 60, 0,
                                      locationListener );

       // loop until told to quit
       while ( !MCAppActivity.toQuit() )
       {
          try {
             Thread.sleep( 30000 );
          }
          catch ( InterruptedException e ) {}
          getBaseContext().sendBroadcast( updateMapIntent );
       }
       stopSelf();
    }


    LocationListener locationListener = new LocationListener() {
        public void onLocationChanged(Location location) {
            double lat = 0.0;
            double lon = 0.0;

            // Called when a new location is found by the network location provider.
            if ( location.getProvider().equals(LocationManager.GPS_PROVIDER) )
            {
               lat = location.getLatitude();
               lon = location.getLongitude();
               Log.i(tag, ""LocationListener(): gps_provider location update:\nlat: "" + lat +
                                               ""\nlon: "" + lon );
               writeLocationToDB( location );
            }
            else if ( location.getProvider().equals(LocationManager.NETWORK_PROVIDER) )
            {
               lat = location.getLatitude();
               lon = location.getLongitude();
               Log.i(tag, ""LocationListener(): net_provider location update:\nlat: "" + lat +
                       ""\nlon: "" + lon );
               writeLocationToDB( location );
            }
            else
            {
               Log.i(tag, ""LocationListener(): unknown provider found"" );
            }
        }

        // don't need them now. make them NO-OP
        public void onStatusChanged ( String provider, int status, Bundle extras ) {}
        public void onProviderEnabled ( String provider )
        {
           Log.i( tag, ""enable gps: ""+ provider );
        }
        public void onProviderDisabled ( String provider )
        {
           Log.w( tag, ""disable gps: ""+ provider );
        }

    };

}
</code></pre>

<p>The LocationManager is defined in my MCAppActivity and passed to the Service.  I get no errors when running the application on my phone.  However, the listener is never invoked. Is there a problem with invoking the LocationManager in a Service as opposed to an Activity? I do know I have to change the minTime to something larger to avoid battery drain. For now, I just want to see if I can get it to work.</p>

<p>Thanks in advance.</p>",android,884821,theodoros tafoni,no
What to listen for to detect do-not-disturb mode changes in Android?,"<p>I would like my application to show a notification when the phone has been set to do-not-disturb modes (alarms-only, priority-only or total-silence). This works pretty well by listening to <code>android.media.RINGER_MODE_CHANGED</code> when checking this mode in quick settings and choosing the mode in the already selected tab. But when selecting another tab it isn't fired again. So my application has the wrong mode information and displays a wrong notification.</p>

<p>I gave another try to <code>android.app.action.INTERRUPTION_FILTER_CHANGED</code> but it wasn't fired at all in the cases above.</p>

<p>As I want to be informed at once I don't want to use a polling observer. In my case I'd expect massive battery drain from that.</p>

<p>There's a similar question but no listener solution for it:</p>

<p><a href=""https://stackoverflow.com/questions/31387137/android-detect-do-not-disturb-status"">Android: Detect Do Not Disturb status?</a></p>

<p>In the hope there might be a solution in the meantime I wanted to ask this again: Has anybody a good idea or a hint what to listen for?</p>

<p>UPDATE:</p>

<p>This is the broadcast receiver definition in AndroidManifest.xml ... to be clear about this: the receiver is called on ring mode changes, flight mode and off hook are detected as well, but it is not called on all ring mode changes, especially switches between do-not-disturb mode changes by tabbing in quick settings or by volume keys:</p>

<pre><code>    &lt;receiver android:name=""UpdateStatusNotification"" android:process="":remote""&gt;
        &lt;intent-filter&gt;
            &lt;action android:name=""android.app.action.INTERRUPTION_FILTER_CHANGED""/&gt;
            &lt;action android:name=""android.intent.action.AIRPLANE_MODE""/&gt;
            &lt;action android:name=""android.intent.action.PHONE_STATE""/&gt;
            &lt;action android:name=""android.media.RINGER_MODE_CHANGED""/&gt;
        &lt;/intent-filter&gt;
    &lt;/receiver&gt;
</code></pre>

<p>UPDATE 2:</p>

<p>Please read my last comment to the accepted answer.</p>",android,2532583,yasd,no
"Is better battery life assured in new android versions with AOT, KSM","<p>We know google has replaced android dalvik virtual machine by android runtime 'ART'. It also introduced ahead of time compilation instaed of JIT for better user experience. This requires a better memory management. So, KSM (Kernel Samepage merging) comes in place. Now KSM gives a better memory management but it requires more cpu cycle. Which of course costs more battery life. Everybody says(google too I guess) new devices with these features are giving better performance with better battery life. </p>

<p>Now my confusion points are.</p>

<ol>
<li><p>From mobile device point of view AOT, KSM giving better performance that's ok but how its giving better battery life when KSM is causing more battery drain? </p></li>
<li><p>Is the optimization in battery coming because AOT draining less battery than JIT? I mean does AOT takes less battery? </p></li>
<li><p>If the optimization in battery life is coming from AOT is it assured always or sometime it is not assured.</p></li>
<li><p>How can we be sure that battery saving in AOT is more than battery drain in KSM. </p></li>
</ol>",android,3975838,Zahan Safallwa,no
App is draining battery by frequently refreshing in the background,"<p>I'm working on an app and after installing it on my phone and leaving it in the background for an hour or so, my phone showed me an alert with</p>

<pre><code> App is draining battery by frequently refreshing in the background
</code></pre>

<p>Does it mean that something causes one or more of the activities to constantly resume? How can I test it to track down the problem? Should I overwrite onActivityResume method in each activity and log something?
Could it be firebase listeners?</p>

<p>What could be an efficient strategy to deal with this problem?</p>",android,9856049,sir-haver,yes
Detect battery drain programmatically,"<p>I have some application where users usually spend quite long time every day and it does also some background work, notifications, alarms etc.
I want to be sure that it does not drain the battery too much after some new functionality added.</p>

<p>Is it possible to collect data of my app battery usage on users devices?</p>

<p>I know that some functionality was added since android 5.1 via ADB, but is it possible to do it programmatically?
Maybe some indirect way, like CPU time, active screen and wifi usage of my app?</p>",android,1159507,anber,no
Battery drain notification on although there is no battery drain on Huawei P10 Lite Android 8,"<p>A colleague of mine gets the notification that an app I helped develope drains her battery quickly when it's in the background. So far she is the first person I know of to get this notification with our app. </p>

<p>Let me describe what the app does/needs: When the user starts the app the device is localised once. After that the user has to push a button to update their position. Whenever the user switches to a specific activity the server is pinged to update the data in the app. There no other permissions than GPS required to use the app. The server is only pinged and the location is only updated when the app is used actively.</p>

<p>This is the code for the server communication.</p>

<pre><code>/**
 * Queries for Stores in the BoundingBox defined by the given GeoCoordinates.
 * After the Async- Query was successful the Stores which are in the Resultset but currently not
 * loaded are queryed for and added to the global Adapter and an
 * ID-Filter is put in place limiting the List to the retrieved ones.
 *
 * @param topLeft     TopLeft- Coordinates for the Query
 * @param bottomRight BottomRight- Coordinates for the Query
 */
private void queryForStoresInBoundingBox(lokalfuchs.de.lokalfuchs.api.model.Location topLeft, lokalfuchs.de.lokalfuchs.api.model.Location bottomRight) {

    //query elasticsearch for all stores in the given region
    StoreService.getInstance().queryForStoresInGeoPointBoundingBox(
            topLeft, bottomRight, new ElasticsearchQueryCallback() {
                @Override
                public void querySuccesful(final List&lt;Integer&gt; ids) {
                    //from the list of ids which lie in the currently visible region: determine which are not currently loaded
                    final List&lt;Integer&gt; missingStores = StoreService.getInstance().getStoreAdapter().findMissingItemIds(ids);
                    final List&lt;Integer&gt; missingOffers = OfferService.getInstance().findMissingStoreIds(ids);
                    if (!missingStores.isEmpty()) {
                        //request these missing items and add them in the adapter
                        StoreService.getInstance().requestStores(null, null, missingStores.toArray(new Integer[missingStores.size()]), new StoreRequestCallback() {
                            @Override
                            public void requestSuccesful(final List&lt;Store&gt; stores) {
                                // !! TODO dont ask for offers without out valid offer ids you will get from elastic search!
                                OfferService.getInstance().requestOffers(null, missingOffers.toArray(new Integer[missingOffers.size()]), null, null, new OfferRequestCallback() {
                                    @Override
                                    public void requestSuccesful(final List&lt;Offer&gt; offers) {

                                        // TODO replace quick fix, just fetching valid offers with elastic offerIds
                                        // only continue with valid offers
                                        final List&lt;Offer&gt; validOffers = new ArrayList&lt;&gt;();

                                        SimpleDateFormat parserEndDate = new SimpleDateFormat(getResources().getString(R.string.date_pattern));
                                        Date currentDate = new Date();
                                        for (Offer offer : offers) {
                                            try {
                                                Date endDate = parserEndDate.parse(offer.getEndDate());

                                                if (endDate != null &amp;&amp; currentDate.compareTo(endDate) &lt; 0) {
                                                    validOffers.add(offer);
                                                    continue;
                                                }
                                            } catch (ParseException e) {
                                                e.printStackTrace();
                                            }
                                        }

                                        //add to adapter on ui-thread
                                        MapActivity.this.runOnUiThread(new Runnable() {
                                            @Override
                                            public void run() {
                                                Map&lt;Integer, List&lt;Integer&gt;&gt; allStoreOffers = OfferService.getInstance().getOffers();
                                                ItemAdapter adapter = OfferService.getInstance().getOfferAdapter();

                                                final List&lt;Offer&gt; handledOffers = (LocationService.getInstance().getLastLocation() != null) ? OfferService.getInstance().calculateDistancesAndRemoveExpiredOffers(
                                                        validOffers, new com.google.maps.model.LatLng(LocationService.getInstance().getLastLocation().getLatitude(), LocationService.getInstance().getLastLocation().getLongitude())) : validOffers;

                                                for (Offer o : handledOffers) {
                                                    OfferService.getInstance().getOfferAdapter().getItems().put(o.getId(), o);
                                                    List&lt;Integer&gt; storeOffers = allStoreOffers.get(o.getStoreId());
                                                    if (storeOffers == null) {
                                                        storeOffers = new ArrayList&lt;&gt;();
                                                        allStoreOffers.put(o.getStoreId(), storeOffers);
                                                    }
                                                    if (!storeOffers.contains(o.getId())) {
                                                        storeOffers.add(o.getId());
                                                        adapter.getItems().put(o.getId(), o);
                                                    }
                                                }
                                                Map&lt;Integer, MappableItem&gt; list = StoreService.getInstance().getStoreAdapter().getItems();

                                                for (Store store : stores)
                                                    list.put(store.getId(), store);
                                                StoreService.getInstance().getStoreAdapter().setIdFilter(new ItemIdFilter(ids));
                                            }
                                        });
                                    }

                                    @Override
                                    public void requestFailed(int errorCode) {
                                    }
                                });
                            }

                            @Override
                            public void requestFailed(int errorCode) {

                            }
                        });
                    } else {
                        //there are no missing items - add the filter immediately instead of after the query
                        StoreService.getInstance().getStoreAdapter().setIdFilter(new ItemIdFilter(ids));
                    }

                }

                @Override
                public void queryFailed() {

                }
            });
}

public void queryForStoresInGeoPointBoundingBox(@NonNull Location top_left, @NonNull Location bottom_right, final @NonNull ElasticsearchQueryCallback callback) {

    //if the coordinates are not correctly ordered reoder them
    if (top_left.getLat() &lt; bottom_right.getLat()) {
        Double temp = top_left.getLat();
        top_left.setLat(bottom_right.getLat());
        bottom_right.setLat(temp);
    }
    if (top_left.getLon() &gt; bottom_right.getLon()) {
        Double temp = top_left.getLon();
        top_left.setLon(bottom_right.getLon());
        bottom_right.setLon(temp);
    }

    this.elasticSearchInterface.elasticSearchStoreIdsGeopointRequest(new ElasticSearchInterface.SearchQuery(top_left, bottom_right, false), LokalFuchs.DEFAULT_SIZE).enqueue(new Callback&lt;ElasticSearchInterface.SearchResult&gt;() {
        @Override
        public void onResponse(Call&lt;ElasticSearchInterface.SearchResult&gt; call, Response&lt;ElasticSearchInterface.SearchResult&gt; response) {
            //check for response-code 200
            if (response.code() == 200) {
                //prepare resultlist
                List&lt;Integer&gt; storeIds = new ArrayList&lt;&gt;();

                //and iterate over all hits extracting the ids
                for (ElasticSearchInterface.SearchResult.Hits hit : response.body().hits.hits) {
                    if (hit.fields.id.length &gt; 0)
                        storeIds.add(hit.fields.id[0]);
                }
                callback.querySuccesful(storeIds);
            } else {
                callback.queryFailed();
            }
        }

        @Override
        public void onFailure(Call&lt;ElasticSearchInterface.SearchResult&gt; call, Throwable t) {
            callback.queryFailed();
        }
    });

}
</code></pre>

<p>I forgot to mention that the data takes a long time to load, probably more than 4 seconds.</p>

<p>This is the code for the localisation.</p>

<pre><code>/**
 * asking for localisation permission
 * &lt;p&gt;
 * if ok:
 * start location updates 
 * if not set isRequesting to false
 *
 * @param activity Activity
 */
public boolean requestLocation(Activity activity) {

    if (AppService.getInstance().checkPermission(Manifest.permission.ACCESS_FINE_LOCATION, activity, R.string.missing_gps_permission, null)) {
        this.isRequesting = true;
             this.locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, this);
        return true;
    } else {
        return false;
    }
}

 /**
 * register Callback for change of position
 *
 * @param locationChangedCallback Callback für for position change
 */
public void registerCallback(LocationChangedCallback locationChangedCallback) {
    if (!this.locationChangedCallbacks.contains(locationChangedCallback)) {
        this.locationChangedCallbacks.add(locationChangedCallback);
    }
}

@Override
public void onMapReady(GoogleMap googleMap) {
[...]
    //register for location-changes and request the location once
    Location location = LocationService.getInstance().getLastLocation();

    //if we have a location use it
    if (location == null) {
        this.googleMap.moveCamera(CameraUpdateFactory.zoomTo(15));
        this.googleMap.moveCamera(CameraUpdateFactory.newLatLng(new LatLng(52.520008, 13.404954)));
        LocationService.getInstance().registerCallback(this);
        LocationService.getInstance().requestLocation(this);
    } else {
        LatLng position = new LatLng(location.getLatitude(), location.getLongitude());
        this.markMyPosition(position);
        this.googleMap.moveCamera(CameraUpdateFactory.zoomTo(15));
        this.googleMap.moveCamera(CameraUpdateFactory.newLatLng(position));
    }
[...]
}
</code></pre>

<p>I checked the battery drain details on her phone and the CPU doesn't have much to do even when the app is active and the GPS is only used for less then 10 seconds. The app has downloaded 20 mb during past 30 days. Still she gets the notification after like 15 minutes and she has to close it to get rid of the notification. She didn't have this problem with any other app so far nor did anyone else report this issue so far.</p>

<p>Does anyone have an idea what the problem could be or what I could do to find out what causes this problem?</p>",android,8818143,Anna,yes
Android prevent sleeping,"<p>Our company is developing an android application that uses network communication to send GPS signals from devices. The devices are the same and they are all work tools, so we do not have to worry about battery draining, or etc. Currently the activity has a thread, which communicates with the server. The problem is that when the device is locked and it goes to sleep, the network communication breaks.</p>

<p>I've tried to put a partial wake lock to the <code>onPause</code> method to keep the CPU on, and release the wakelock in the <code>onResume</code> method, but it seems not to work. Any idea how to prevent the sleep, or keep flowless communication between the client and the server?</p>",android,9396613,Bandi Tóth,yes
Android OsclNativeFile error: Seek lseek64 failed,"<p>I get the following error on my Android device:</p>

<blockquote>
  <p>E/OsclNativeFile( 1616): OsclNativeFile::Seek lseek64 failed</p>
</blockquote>

<p>I want to know what it means, because I wasn't making anything special just getting a battery drain and the logcat show me zillion lines like the above. Thanks.</p>",android,802241,Mox,no
Android O power state implicit broadcasts alternative,"<p>Since Android O imposes restrictions on implicit broadcasts, the following no longer works:</p>

<pre><code>&lt;receiver android:name="".model.PowerStateBroadcastReceiver"" &gt;
    &lt;intent-filter&gt;
        &lt;action android:name=""android.intent.action.ACTION_POWER_CONNECTED"" /&gt;
    &lt;/intent-filter&gt;
&lt;/receiver&gt;
</code></pre>

<p>I considered registering for the <code>ACTION_BOOT_COMPLETE</code> intent, launch a service and registering the listener for <code>ACTION_POWER_CONNECTED</code> in java from there, but the service would probably be killed.
I also considered using the <code>JobScheduler</code> with <code>setRequiresCharging(true)</code>, but according to the <a href=""https://developer.android.com/reference/android/app/job/JobInfo.Builder#setRequiresCharging(boolean)"" rel=""nofollow noreferrer"">docs</a>: </p>

<blockquote>
  <p>For purposes of running jobs, a battery-powered device ""charging"" is not quite the same as simply being connected to power. If the device is so busy that the battery is draining despite a power connection, jobs with this constraint will not run. This can happen during some common use cases such as video chat, particularly if the device is plugged in to USB rather than to wall power.</p>
</blockquote>

<p>For an app whose behavior depends on knowing when the charger gets connected (its a battery/charging app), what would be the best approach to do this behavior now?</p>",android,1054746,amfcosta,no
How to determine the time that the device was not being used for?,"<p>My application should detect whether the user was sleeping to start itself with a welcome message when the user wakes up and powers up his phone for the first time in the morning, afternoon, or whenever he wakes up, by pressing the power putton and entering the pattern on the homescreen or pin or whatever.</p>

<p>I want to do this by measuring the time the device was used the last time. I presume 8 hours of sleep, so if 8 hours passed since the last switching off, the next time the mobile phone is being switched on, the application starts(respectively a function inside).</p>

<p>The screen going on because of an alarm or anything but user interaction should not count.</p>

<p>I looked at logcat and it gave me the useful information <code>I/PowerManagerService: Going to sleep due to power button</code>. So a PowerManagerServiceListener could be a way. I found <a href=""https://developer.android.com/reference/android/os/PowerManager.html"" rel=""nofollow"">https://developer.android.com/reference/android/os/PowerManager.html</a> but it is for actively keeping the display on, not for passively reporting it.</p>

<p>Another candidate is <code>KeyguardViewMediator: onStartedGoingToSleep(2)</code> and <code>KeyguardServiceDelegate: onScreenTurnedOff()</code>.</p>

<p>Sure, I could create a polling application, that looks through logcat, but that sounds like a strongly battery draining approach.</p>

<p>Which performance friendly way is there to accomplish what I want?</p>",android,4688878,Vitalis Hommel,yes
How does NsdManager register/discover services impact battery life?,"<p><a href=""https://developer.android.com/reference/android/net/nsd/NsdManager"" rel=""nofollow noreferrer"">https://developer.android.com/reference/android/net/nsd/NsdManager</a></p>
<p>I have 2 applications</p>
<p>1st is kind of server, it's registering service on activity resume and unregistering on pause.</p>
<p>2nd of them is a client, it has to discover one specific service via NsdManager.
Currently I stop discovering right after first service is found. For client it's a bit more important not to drain battery a lot. I run this method every time I enter the screen, but it proves to have issues when discovery fails to happen sometimes, and user is not able to send data to discovered host.</p>
<p>How does registering/discovering impacts battery life.
would it be ok, to discover services onResume, and stop discovering onPause, considering that the screen of client app can be resumed for a really long period of time</p>",android,2179276,Андрій Пугач,no
Track per app usage on android on pre-Lollipop devices,"<p>I would like to build an app that can track how long a user spends on certain apps (mainly for proof of concept and to implement in other apps.) I know that Lollipop  implemented the API <a href=""https://developer.android.com/reference/android/app/usage/UsageStatsManager.html"">UsageStatsManager</a> that enables you to track the ""total length of time an app was in the foreground for a time interval (by day, week, month, or year).""</p>

<p>I have also read that one <a href=""https://stackoverflow.com/questions/9012361/how-to-track-app-usage-in-android-how-to-detect-when-an-activity-is-launched"">can poll the AcvtivtyManager continuously</a>, however that would waste battery life and take up CPU and RAM.</p>

<p>What I am wonder is, is there an efficient way to keep track of the amount of time an app is open on devices running an android version lower than Lollipop. Specifically how apps like <a href=""https://play.google.com/store/apps/details?id=com.binerx.aptrax&amp;hl=en"">Aptrax</a> and <a href=""https://play.google.com/store/apps/details?id=com.agrvaibhav.AppUsageTracking&amp;hl=en"">App Usage Tracker</a> as well as many others, do it with very little or ""No battery drain (even on high frequency tracking).""
Is there another method that these apps use, to get app usage data on pre-Lollipop devices, with little battery usage, or is polling the Activity manger not as resource heavy as they source I read lead me to believe.  </p>",android,2202646,Neil M.,yes
how to create a password protected android application,"<p>I want to create a password-protected android application. The password should be asked when the task is started or when it comes to foreground. </p>

<p>The complex part is that my app can invoke device inbuilt camera application to capture photo/video, so I cannot control that activity.</p>

<p>So the behavior should be that whenever user starts/returns to my app then password should be asked except for the scenario when he is returning from camera that I sent him to in the first place.</p>

<p>I have thought following ideas, but none of them solve my problem completely, the best one I could think of is</p>

<p>1) Set a flag(flagA) while sending the user to camera, then in a service keep checking that the foreground app is our app. When the foreground app is not our app then set another flag(flagB) to indicate that our app has gone to background. When the app in foreground is our app again, then check if flagA is false (we didnt send him to camera) and flagB is true (app is coming from background). Then show the password screen</p>

<p>Problems
1) The polling interval must be small like 3-4 seconds, so that foreground is detected quickly. This drains the battery.</p>

<p>Thanks</p>",android,726153,Animesh,yes
Accelerometer in background,"<p>I am in the process of developing an Android application with the intent of monitoring accelerometer data in the background. My own device is running Android 2.2. When the device is locked it no longer collects the accelerometer data. I am aware of the partial wake lock option, but due to the nature of my application it simply isn't ideal.</p>

<p>I have done quite a bit of intensive Googling on the matter. Some say this is a bug, that it is unintended. However, some say that it is intended. I've also read that this is fixed in 2.3.3 <a href=""https://stackoverflow.com/questions/5671106/accelerometer-onsensorchanged-not-called-when-screen-is-off"">here</a>. If that is the case, I will upgrade my own device. 
However, the comments on <a href=""http://code.google.com/p/android/issues/detail?id=3708"" rel=""nofollow noreferrer"">this</a> page seem to contradict that.</p>

<p>I am led to believe using the partial wake lock will drain a battery fast. Is there any other way I can achieve what I want to do, or does anyone have any information on some sort of fix for this problem?</p>",android,980782,Nicklas,no
Alarm manager not pushing data in server periodically for nougat,"<p>i am using AlarmManager to call the PendingIntent. which triggers the WakefulBroadcastReceiver to push the data in server periodically. but for nougat, its not pushing in the periodic time. and also draining battery too much.</p>

<pre><code>my code is here-&gt;

public static void startSyncAlarm(String enteredTime) {
    // Construct an intent that will execute the AlarmReceiver
    Intent intent = new Intent(context, SyncDbToServerAlarmReceiver.class);
    intent.putExtra(Constants.ENTERED_TIME, enteredTime);
    // Create a PendingIntent to be triggered when the alarm goes off
    final PendingIntent pIntent = PendingIntent.getBroadcast(context, SyncDbToServerAlarmReceiver.REQUEST_CODE,
            intent, PendingIntent.FLAG_UPDATE_CURRENT);

    // alarm needs to be set after 5 minutes of entered time
    // convert entered time to milliseconds
    // create Date object using string time format with using Simple date format
    SimpleDateFormat format = new SimpleDateFormat(""MM/dd/yyyy hh:mm:ss aa"");
    try {
        Date enteredDate = format.parse(enteredTime);
        long enteredTimeInMillis = enteredDate.getTime();
        long intervalMillis = 30 * 60 * 1000; // 30 minutes gap
        long triggerAtMillis = enteredTimeInMillis + intervalMillis;
        Log.d(TAG, ""start alarm, enteredTimeMillis = "" + enteredTimeInMillis + ""\ntriggerAtMillis = "" + triggerAtMillis);
    //long firstMillis = System.currentTimeMillis(); // alarm is set right away
        syncDbAlarmManager = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
        // Setup periodic alarm every 5 minutes
        syncDbAlarmManager.setRepeating(AlarmManager.RTC_WAKEUP, triggerAtMillis/*firstMillis*/,
                intervalMillis, pIntent);
    } catch (ParseException e) {
        e.printStackTrace();
    }
}
</code></pre>",android,6819563,Ashish Patel,yes
Best approach to send data from a server to an Android device,"<p>I am developing an Android app that needs to communicate bi-directionally with a server.  By that, I mean either the server or the device can send a message at any time, with an arbitrary amount of time in between messages.  Sending data from the device to the server is a common and I think well understood task, but I'm not as sure what the best approach is to go in the opposite direction from the server to the device.</p>

<p>I think having the device periodically poll the server may be a bad idea due to latency and the drain on the battery, but I'd be willing to consider this option.  My plan at the moment is to send text messages from the server via an email-to-SMS bridge, and to have my app run a service to receive and handle these messages.  </p>

<p>The question I have is if there are any best practices for this scenario, and if using text messages has some downsides that I have failed to consider.  For the sake of this question, I want to assume that users have an unlimited text data plan, so paying per text won't be an issue.</p>",android,3126,newdayrising,yes
Optimal usage of battery,<p>As a programmer what are the measures I can take to take care that my app does not hog a lot of resources and drain the battery ? </p>,android,669444,user669444,no
Exact repetitive method for AlarmManager,"<p>Beginning with API 19 (KITKAT) alarm delivery is inexact.
For my app this is very bad news.</p>

<p>There are new APIs to support applications which need strict delivery guarantees; see setWindow(int, long, long, PendingIntent) and setExact(int, long, PendingIntent). </p>

<p>But I do not see any 'setRepetitiveExact' method, what does this means ? they completely discourage this thing and they did not even made an API :S ?</p>

<p>I know it can drain battery but I still want to use it, I need to be exact!, I do not want this to happen eventually when the phone wakes up :S...</p>",android,3564382,user3564382,no
Android Service that can last as long as the phone operating with Event Listeners,"<p>I have a foreground service that has a thread. This thread implement some event listeners triggered from Internet and sensors.
The App should be always running as far as the phone is on.
What would be the best approach for building this App without draining the battery?
I am looking for best practices for a Service that running all the time listening to Events from Internet and Sensors not a task that should be be finished.</p>",android,3179443,aselims,no
Android's SensorManager fails to effectively unregister listeners,"<p>My app creates a <code>Service</code> that overrides onStartCommand to create a <code>SensorManager</code> and attach a <code>SensorEventListener</code> to one of the sensors:</p>

<pre><code>public class AccelerometerService extends Service {
    private SensorManager sensorManager;
    private Sensor sensor;
    private SensorEventListener activeListener; 
    // ...

    @Override
    public int onStartCommand(Intent intent, int flags, int startid) {
        // ...

        sensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
        sensor = sensorManager.getDefaultSensor(Sensor.TYPE_LINEAR_ACCELERATION);
        activeListener = new SensorEventListener() {
            @Override
            public void onAccuracyChanged(Sensor sensor, int accuracy) {

            }

            @Override
            public void onSensorChanged(SensorEvent event) {
                Log.i(""PluckLock"", """" + event.values[0]);
            }
        };

        sensorManager.registerListener(activeListener, sensor, SensorManager.SENSOR_DELAY_NORMAL);

        return START_STICKY;
    }

    // ...
}
</code></pre>

<p>The full code is available on <a href=""https://github.com/SyntaxBlitz/PluckLock/blob/master/src/net/syntaxblitz/plucklock/AccelerometerService.java"" rel=""nofollow noreferrer"">GitHub</a>.</p>

<p>I want to override <code>Service</code>'s <code>onDestroy()</code> method and, in it, kill the sensor:</p>

<pre><code>sensorManager.unregisterListener(activeListener);
</code></pre>

<p>But when I do this, nothing actually happens! My <code>onSensorChanged()</code> listener <strong>continues to receive correct values</strong> from the accelerometer (or software LINEAR_ACCELERATION sensor, in my case). The problem, of course, is quoted here in the <a href=""http://developer.android.com/reference/android/hardware/SensorManager.html"" rel=""nofollow noreferrer"">docs</a>:</p>

<blockquote>
  <p>Always make sure to disable sensors you don't need, especially when your activity is paused. Failing to do so can drain the battery in just a few hours. </p>
</blockquote>

<p>My app only needs to ping the accelerometer for as long as the screen is actually unlocked. I've implemented (and verified the correct function of) <code>BroadcastReceiver</code>s that destroy the <code>Service</code> when the phone is locked, successfully calling its <code>onDestroy()</code> method. But nothing actually happens once I try to unregister the listeners.</p>

<p>I've found a few others asking this question, with no resolution.</p>

<ul>
<li><a href=""https://stackoverflow.com/questions/11071035/unregistering-sensormanager-doesnt-work"">Unregistering SensorManager doesn&#39;t work</a></li>
<li><a href=""https://stackoverflow.com/questions/9750742/how-to-unregister-a-listener-from-a-sensor-after-stopping-the-service"">How to unregister a listener from a sensor after stopping the service?</a></li>
<li><a href=""https://stackoverflow.com/questions/15947910/sensoreventlistener-not-unregistering-itself"">SensorEventListener not unregistering itself</a></li>
<li><a href=""https://stackoverflow.com/questions/24239949/android-sensor-listener-does-not-get-unregistered-or-sensor-still-retrieves-valu"">Android sensor listener does not get unregistered or sensor still retrieves values</a></li>
<li><a href=""https://stackoverflow.com/questions/6919577/sensoreventlistener-doesnt-get-unregistered-with-unregisterlistener-method"">SensorEventListener doesn&#39;t get unregistered with unregisterListener() method</a></li>
</ul>

<p>I can only assume it is an API bug, and that there is really no good way to kill these sensors once I've started grabbing data from them. I have tried setting the <code>SensorManager</code>, <code>Sensor</code>, and <code>SensorEventListener</code> to null, as well as trying to register a null sensor listener with the manager. None of these have any effect on the polling.</p>

<p>My current ""workaround"" has almost no effect on battery life. I have a private boolean in my class's definition that I set to <code>true</code> or <code>false</code> depending on whether I want sensor values. In my <code>onSensorChanged()</code> method, I immediately <code>return</code> if the sensor listener is supposed to be inactive. But by then, it is too late: the brunt of the work being performed by the OS (getting sensor values) occurs before I can manage to leave the <code>onSensorChanged()</code> method, so battery life is still horrendous for as long as my service is running.</p>

<p>My real question here, barring some miracle <em>real</em> solution, is <strong>what can I do to stop getting sensor values?</strong> Obviously, unregistering the sensor listener does not work at this point; even setting everything to null and destroying the service has no effect. But there must be <em>some</em> way to indicate to the operating system that my app doesn't require use of the sensor values anymore. Is there some way to kill my entire app, only restarting it when the phone is unlocked? Maybe that would let the operating system know that my app's not in need of values anymore. Really, any solution that legitimately stops polling the sensor but gives me some way to restart it, even if the code is ugly, would make me happy.</p>

<p>The minimum API level for my project is 9.</p>",android,1826496,Timothy J. Aveni,no
Android doesn't kill bound service,"<p>I am creating bound service for socket connection.Which means it is creating a long polling connection and listens my server.If user closes the app in task manager my service is killing i have no problem with this.But when user presses the back button I am calling <code>activity.finish()</code> method for close app.But with this method my service doesn't kill,it is still connected to socket server.</p>

<p>Is this normal ? And Could be this drain the battery ? </p>

<p>My service:</p>

<pre><code>public class SocketService extends Service {
    //you need constants to tell servise and activity what you are sending a message for
    public static final int REGISTER_CHAT_ACTIVITY = 1;
    public static final int MESSAGE_RECEIVED = 2;

    final Messenger mMessenger = new Messenger(new IncomingHandler());
    Messenger chat;
    private Socket socket;

    @Override
    public void onCreate() {
        try {
            socket = IO.socket(""ip"");

            socket.on(Socket.EVENT_CONNECT, new Emitter.Listener() {
                @Override
                public void call(Object... args) {
                }
            }).on(""connected"", new Emitter.Listener() {
                @Override
                public void call(Object... args) {

                }
            }).on(""message"", new Emitter.Listener() {

            @Override
            public void call(Object... args) {
                try {
                    chat.send(android.os.Message.obtain(null, MESSAGE_RECEIVED, args[0]));
                } catch (RemoteException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } 
            }
        });
            //and add all the other on listeners here
            socket.connect();
        } catch (URISyntaxException e) {
            e.printStackTrace();
        }


    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        if (socket != null) {
            socket.disconnect();
            socket.connect();
        } else {
            try {
                socket = IO.socket(""ip"");
                socket.connect();
            } catch (URISyntaxException e) {
                e.printStackTrace();
            }
        }
        return START_STICKY;
    }

    @Override
    public IBinder onBind(Intent intent) {
        return mMessenger.getBinder();
    }
    class IncomingHandler extends Handler {
        @Override
        public void handleMessage(android.os.Message msg) {
            switch(msg.what){
                case REGISTER_CHAT_ACTIVITY:
                      chat = msg.replyTo;
                      break;
            }
        }
    }

    public class LocalBinder extends Binder {
        SocketService getService() {
            return SocketService.this;
        }
    }

}
</code></pre>",android,4266906,Okan,yes
Keeping a receiver alive after the service get killed,"<p>I'll start by telling the story first ..</p>

<p>I Have Service mService, Receiver mReceiver, PreferenceFragment with a switch .</p>

<p>Now, This switch will run the service, which will register a Screen.OFF receiver, When the screen get off, the receiver will be called, and it will check if the screen is locked, if yes it will output a log message . </p>

<p>So, Locking means killing the service, the receiver get only called twice and then go off, I've registered the receiver and unrigstered it in the onDestory in mService .</p>

<p>I've added a boolean, And thought about adding a ""if"" statement in onDestroy, if it's On and getting killed, then run the service when the device get unlocked .</p>

<p>Another thought, It's making the service alive ( which will drain the battery ) .</p>

<p>What i want, to keep listen to Screen.OFF, And i don't want to start use one of them without an advice about using, or maybe i understood it in wrong way ? .</p>

<p>Codes are the basic one, Register / unRegister / class extends Service. </p>",android,5646429,Jaeger,yes
How to pass data to another droid device when the other device isn't expecting it,"<p>I am working on an application and one feature that would make it really useful is the ability to share some information, but the other device may not be expecting the data to be sent.</p>

<p>For example, if I am reading a really good book, and I realize that a friend may like it, I could use an application to send the data to him, so he could order the book from Amazon.</p>

<p>But, since he isn't expecting the data, I would hate for the application to be polling a server every so often, as that will be needlessly draining the battery.</p>

<p>Ideally it would be great if there was a way to make a phone call to the target device, send a data packet and end the call.</p>

<p>If it could be done and prevent the phone from ringing, then it would be very useful to me.</p>

<p>I am curious if there is some way to send data between devices without polling.</p>",android,67566,James Black,yes
Repeating task in android will takes more battery power if we use alarm manager?,"<p>We are using following code for repeating task:</p>

<pre><code>Intent alarmIntent = new Intent(MainActivity.this, TestReceiver.class);
PendingIntent pendingIntent = PendingIntent.getBroadcast(MainActivity.this, 0, alarmIntent, 0);

AlarmManager manager = (AlarmManager)getSystemService(Context.ALARM_SERVICE);
int interval=15000;
manager.setRepeating(AlarmManager.RTC_WAKEUP, System.currentTimeMillis(), interval, pendingIntent);
</code></pre>

<p>Will this drains battery?</p>",android,3257304,Gowrishankar_Ind,yes
Nexus 5 kitkat; my app is reported as high battery use; shows GPS on for lengthy time even though not doing location polling,"<p>my app is not doing polling updates. It displays a simple map and just calls ""getMap().setMyLocationEnabled(true);""</p>

<p>on a Nexus 5 android 4.4.2 - it reports my app as using most of the current battery drain 70% my app - 80ish% total battery remaining; (and Google Play Services as minor 2% ?). and on further details it seems to indicate that GPS is on the whole time for my app.</p>

<p>I tried (although it didn't seem necessary) adding in onPause() and onStop() a call for getMap().setMyLocationEnabled(false); didn't change anything with the 'battery usage' reporting.</p>

<p>under 'Location' I found a spot to change 'mode' to 'Device only - GPS' and now it indicates my app (and Google Play Services) under this Location area as ""Low Battery use.""</p>

<p>how can i control it better?</p>",android,3411527,user3411527,yes
why android alarm receiver is not working,"<p>I downloaded the scheduler example from android developer site. I have two package one package have three classes 
 com.example.android.scheduler----sampleSchedulerService and SampleAlarmReceiver and SampleBootReceiver
and another package is com.example1, has MainActivity class.</p>

<p>SampleSchedulerrService.java code as follows</p>

<pre><code>package com.example.android.scheduler;

import android.app.IntentService;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.support.v4.app.NotificationCompat;
import android.util.Log;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;

/**
 * This {@code IntentService} does the app's actual work.
 * {@code SampleAlarmReceiver} (a {@code WakefulBroadcastReceiver}) holds a
 * partial wake lock for this service while the service does its work. When the
 * service is finished, it calls {@code completeWakefulIntent()} to release the
 * wake lock.
 */
public class SampleSchedulingService extends IntentService {
    public SampleSchedulingService() {
        super(""SchedulingService"");
    }

    public static final String TAG = ""Scheduling Demo"";
    // An ID used to post the notification.
    public static final int NOTIFICATION_ID = 1;
    // The string the app searches for in the Google home page content. If the app finds 
    // the string, it indicates the presence of a doodle.  
    public static final String SEARCH_STRING = ""doodle"";
    // The Google home page URL from which the app fetches content.
    // You can find a list of other Google domains with possible doodles here:
    // http://en.wikipedia.org/wiki/List_of_Google_domains
    public static final String URL = ""http://www.google.com"";
    private NotificationManager mNotificationManager;
    NotificationCompat.Builder builder;

    @Override
    protected void onHandleIntent(Intent intent) {
         Log.i(""EFAIR"",""in onhandleintent"");
        // sendNotification(getString(R.string.doodle_found));
         sendNotification(intent);
        /*// BEGIN_INCLUDE(service_onhandle)
        // The URL from which to fetch content.
        String urlString = URL;

        String result ="""";

        // Try to connect to the Google homepage and download content.
        try {
            result = loadFromNetwork(urlString);
        } catch (IOException e) {
            Log.i(TAG, getString(R.string.connection_error));
        }

        // If the app finds the string ""doodle"" in the Google home page content, it
        // indicates the presence of a doodle. Post a ""Doodle Alert"" notification.
        if (result.indexOf(SEARCH_STRING) != -1) {
            sendNotification(getString(R.string.doodle_found));
            Log.i(TAG, ""Found doodle!!"");
        } else {
            sendNotification(getString(R.string.no_doodle));
            Log.i(TAG, ""No doodle found. :-("");
        }*/
        // Release the wake lock provided by the BroadcastReceiver.
        SampleAlarmReceiver.completeWakefulIntent(intent);
        // END_INCLUDE(service_onhandle)
    }

    // Post a notification indicating whether a doodle was found.
    private void sendNotification(Intent intent) {
        String msg=intent.getStringExtra(""MSG"");
        mNotificationManager = (NotificationManager)
               this.getSystemService(Context.NOTIFICATION_SERVICE);

       /* PendingIntent contentIntent = PendingIntent.getActivity(this, 0,
            new Intent(this, MainActivity.class), 0);*/
        PendingIntent contentIntent = PendingIntent.getActivity(this,(int) Math.random(),
                intent.setClass(this,MainActivity.class),PendingIntent.FLAG_ONE_SHOT);

        NotificationCompat.Builder mBuilder =
                new NotificationCompat.Builder(this)
        .setSmallIcon(R.drawable.ic_launcher)
        .setContentTitle(getString(R.string.doodle_alert))
        .setStyle(new NotificationCompat.BigTextStyle()
        .bigText(msg))
        .setContentText(msg);

        mBuilder.setContentIntent(contentIntent);
        mNotificationManager.notify((int) Math.random(), mBuilder.build());
    }

//
// The methods below this line fetch content from the specified URL and return the
// content as a string.
//
    /** Given a URL string, initiate a fetch operation. */
    private String loadFromNetwork(String urlString) throws IOException {
        InputStream stream = null;
        String str ="""";

        try {
            stream = downloadUrl(urlString);
            str = readIt(stream);
        } finally {
            if (stream != null) {
                stream.close();
            }      
        }
        return str;
    }

    /**
     * Given a string representation of a URL, sets up a connection and gets
     * an input stream.
     * @param urlString A string representation of a URL.
     * @return An InputStream retrieved from a successful HttpURLConnection.
     * @throws IOException
     */
    private InputStream downloadUrl(String urlString) throws IOException {

        URL url = new URL(urlString);
        HttpURLConnection conn = (HttpURLConnection) url.openConnection();
        conn.setReadTimeout(10000 /* milliseconds */);
        conn.setConnectTimeout(15000 /* milliseconds */);
        conn.setRequestMethod(""GET"");
        conn.setDoInput(true);
        // Start the query
        conn.connect();
        InputStream stream = conn.getInputStream();
        return stream;
    }

    /** 
     * Reads an InputStream and converts it to a String.
     * @param stream InputStream containing HTML from www.google.com.
     * @return String version of InputStream.
     * @throws IOException
     */
    private String readIt(InputStream stream) throws IOException {

        StringBuilder builder = new StringBuilder();
        BufferedReader reader = new BufferedReader(new InputStreamReader(stream));
        for(String line = reader.readLine(); line != null; line = reader.readLine()) 
            builder.append(line);
        reader.close();
        return builder.toString();
    }
}
</code></pre>

<p>SampleAlarmReceiver.java as follows</p>

<pre><code>package com.example.android.scheduler;

import android.app.AlarmManager;
import android.app.PendingIntent;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.pm.PackageManager;
import android.support.v4.content.WakefulBroadcastReceiver;
import android.util.Log;

import java.util.Calendar;

/**
 * When the alarm fires, this WakefulBroadcastReceiver receives the broadcast Intent 
 * and then starts the IntentService {@code SampleSchedulingService} to do some work.
 */
public class SampleAlarmReceiver extends WakefulBroadcastReceiver {
    // The app's AlarmManager, which provides access to the system alarm services.
    private AlarmManager alarmMgr;
    // The pending intent that is triggered when the alarm fires.
    private PendingIntent alarmIntent;

    public void onReceive(Context context, Intent intent) {   
         Log.i(""EFAIR"",""in onReceive "");
        // BEGIN_INCLUDE(alarm_onreceive)
        /* 
         * If your receiver intent includes extras that need to be passed along to the
         * service, use setComponent() to indicate that the service should handle the
         * receiver's intent. For example:
         * 
         * ComponentName comp = new ComponentName(context.getPackageName(), 
         *      MyService.class.getName());
         *
         * // This intent passed in this call will include the wake lock extra as well as 
         * // the receiver intent contents.
         * startWakefulService(context, (intent.setComponent(comp)));
         * 
         * In this example, we simply create a new intent to deliver to the service.
         * This intent holds an extra identifying the wake lock.
         */

         ComponentName comp = new ComponentName(""com.example.android.scheduler"", 
                       SampleSchedulingService.class.getName());

                  // This intent passed in this call will include the wake lock extra as well as 
                  // the receiver intent contents.
                  startWakefulService(context, (intent.setComponent(comp)));
        /*Intent service = new Intent(context, SampleSchedulingService.class);

        // Start the service, keeping the device awake while it is launching.
        startWakefulService(context, service);*/
        // END_INCLUDE(alarm_onreceive)
    }

    // BEGIN_INCLUDE(set_alarm)
    /**
     * Sets a repeating alarm that runs once a day at approximately 8:30 a.m. When the
     * alarm fires, the app broadcasts an Intent to this WakefulBroadcastReceiver.
     * @param context
     */
    public void setAlarm(Context context,int day,int mongth,int year,int hour,int minute) {
        Log.i(""EFAIR"",""in set alarm""+minute);
        alarmMgr = (AlarmManager)context.getSystemService(Context.ALARM_SERVICE);
        Intent intent = new Intent(context, SampleAlarmReceiver.class);
        //put the massage 
        intent.putExtra(""MSG"",""your schedule is going on......"");
        alarmIntent = PendingIntent.getBroadcast(context,hour+minute+day, intent,0);

        Calendar calendar = Calendar.getInstance();
        calendar.setTimeInMillis(System.currentTimeMillis());
        // Set the alarm's trigger time to 8:30 a.m.
        calendar.set(Calendar.HOUR_OF_DAY, hour);
        calendar.set(Calendar.MINUTE, minute);
        //calendar.add

        /* 
         * If you don't have precise time requirements, use an inexact repeating alarm
         * the minimize the drain on the device battery.
         * 
         * The call below specifies the alarm type, the trigger time, the interval at
         * which the alarm is fired, and the alarm's associated PendingIntent.
         * It uses the alarm type RTC_WAKEUP (""Real Time Clock"" wake up), which wakes up 
         * the device and triggers the alarm according to the time of the device's clock. 
         * 
         * Alternatively, you can use the alarm type ELAPSED_REALTIME_WAKEUP to trigger 
         * an alarm based on how much time has elapsed since the device was booted. This 
         * is the preferred choice if your alarm is based on elapsed time--for example, if 
         * you simply want your alarm to fire every 60 minutes. You only need to use 
         * RTC_WAKEUP if you want your alarm to fire at a particular date/time. Remember 
         * that clock-based time may not translate well to other locales, and that your 
         * app's behavior could be affected by the user changing the device's time setting.
         * 
         * Here are some examples of ELAPSED_REALTIME_WAKEUP:
         * 
         * // Wake up the device to fire a one-time alarm in one minute.
         * alarmMgr.set(AlarmManager.ELAPSED_REALTIME_WAKEUP, 
         *         SystemClock.elapsedRealtime() +
         *         60*1000, alarmIntent);
         *        
         * // Wake up the device to fire the alarm in 30 minutes, and every 30 minutes
         * // after that.
         * alarmMgr.setInexactRepeating(AlarmManager.ELAPSED_REALTIME_WAKEUP, 
         *         AlarmManager.INTERVAL_HALF_HOUR, 
         *         AlarmManager.INTERVAL_HALF_HOUR, alarmIntent);
         */

        // Set the alarm to fire at approximately 8:30 a.m., according to the device's
        // clock, and to repeat once a day.
        alarmMgr.setRepeating(AlarmManager.RTC_WAKEUP,  
                calendar.getTimeInMillis(), AlarmManager.INTERVAL_DAY, alarmIntent);

        // Enable {@code SampleBootReceiver} to automatically restart the alarm when the
        // device is rebooted.
        ComponentName receiver = new ComponentName(context, SampleBootReceiver.class);
        PackageManager pm = context.getPackageManager();

        pm.setComponentEnabledSetting(receiver,
                PackageManager.COMPONENT_ENABLED_STATE_ENABLED,
                PackageManager.DONT_KILL_APP);           
    }
    // END_INCLUDE(set_alarm)

    /**
     * Cancels the alarm.
     * @param context
     */
    // BEGIN_INCLUDE(cancel_alarm)
    public void cancelAlarm(Context context) {
        // If the alarm has been set, cancel it.
        if (alarmMgr!= null) {
            alarmMgr.cancel(alarmIntent);
        }

        // Disable {@code SampleBootReceiver} so that it doesn't automatically restart the 
        // alarm when the device is rebooted.
        ComponentName receiver = new ComponentName(context, SampleBootReceiver.class);
        PackageManager pm = context.getPackageManager();

        pm.setComponentEnabledSetting(receiver,
                PackageManager.COMPONENT_ENABLED_STATE_DISABLED,
                PackageManager.DONT_KILL_APP);
    }
    // END_INCLUDE(cancel_alarm)
}
and SamplebootReceiver.java
package com.example.android.scheduler;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

/**
 * This BroadcastReceiver automatically (re)starts the alarm when the device is
 * rebooted. This receiver is set to be disabled (android:enabled=""false"") in the
 * application's manifest file. When the user sets the alarm, the receiver is enabled.
 * When the user cancels the alarm, the receiver is disabled, so that rebooting the
 * device will not trigger this receiver.
 */
// BEGIN_INCLUDE(autostart)
public class SampleBootReceiver extends BroadcastReceiver {
    SampleAlarmReceiver alarm = new SampleAlarmReceiver();
    @Override
    public void onReceive(Context context, Intent intent) {
        if (intent.getAction().equals(""android.intent.action.BOOT_COMPLETED""))
        {
            alarm.setAlarm(context,0,0,0,12,45);
        }
    }
}
//END_INCLUDE(autostart)
and MainActivity.java
/*
 * Copyright 2013 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the ""License"");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an ""AS IS"" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.example1;

import com.example.android.scheduler.R;
import com.example.android.scheduler.SampleAlarmReceiver;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuItem;
import android.widget.TextView;


/**
 * This sample demonstrates how to schedule an alarm that causes a service to
 * be started. This is useful when you want to schedule alarms that initiate
 * long-running operations, such as retrieving a daily forecast.
 * This particular sample retrieves content from the Google home page once a day and  
 * checks it for the search string ""doodle"". If it finds this string, that indicates 
 * that the page contains a custom doodle instead of the standard Google logo.
 */
public class MainActivity extends Activity {
    SampleAlarmReceiver alarm = new SampleAlarmReceiver();

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        TextView tv=(TextView) findViewById(R.id.sample_output);
        try{
            String msg=getIntent().getStringExtra(""MSG"");
            tv.setText(msg);
        }catch(Exception e){
            e.printStackTrace();
        }
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

    // Menu options to set and cancel the alarm.
    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
            // When the user clicks START ALARM, set the alarm.
            case R.id.start_action:
                alarm.setAlarm(getApplicationContext(),0,0,0,16,35);
                return true;
            case R.id.start_action1:
                alarm.setAlarm(getApplicationContext(),0,0,0,16,37);
                return true;
            case R.id.start_action2:
                alarm.setAlarm(getApplicationContext(),0,0,0,16,19);
                return true;
            case R.id.start_action3:
                alarm.setAlarm(getApplicationContext(),0,0,0,16,21);
                return true;
            case R.id.start_action4:
                alarm.setAlarm(getApplicationContext(),0,0,0,16,23);
                return true;
            case R.id.start_action5:
                alarm.setAlarm(getApplicationContext(),0,0,0,16,25);
                return true;    
            // When the user clicks CANCEL ALARM, cancel the alarm. 
            case R.id.cancel_action:
                alarm.cancelAlarm(this);
                return true;
        }
        return false;
    }
}
</code></pre>

<p>When I put the MainAcivity.java in same package as in SampleAlarmReceiver then it works fine.otherwise not. my problem is that when I put MainActivity.java in separate package then it not working.any body can help.</p>",android,3098087,USKMobility,no
"Battery drains even with app off screen, could it be Location Services doing it?","<p>I run my app, which uses GPS and Bluetooth, then hit the back button so it goes off screen. I verified via LogCat that the app's onDestroy was called. OnDestroy removes the location listeners and shuts down my app's Bluetooth service. I look at the phone 8 hours later and half the battery charge has been consumed, and my app was responsible according the phone's Battery Use screen. If I use the phone's Settings menu to Force Stop the app, this doesn't occur. So my question is: do I need to do something more than remove the listeners to stop Location Services from consuming power? That's the only thing I can think of that would be draining the battery to that degree when the app is supposedly dormant.</p>

<p>Here's my onStart() where I turn on the location-related stuff and Bluetooth:</p>

<pre><code>@Override
public void onStart() {
    super.onStart();

    if(D_GEN) Log.d(TAG, ""MainActivity onStart, adding location listeners"");

    // If BT is not on, request that it be enabled.
    // setupBluetooth() will then be called during onActivityResult
    if (!mBluetoothAdapter.isEnabled()) {
        Intent enableIntent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
        startActivityForResult(enableIntent, REQUEST_ENABLE_BT);
        // Otherwise, setup the Bluetooth session
    } else {
        if (mBluetoothService == null) 
            setupBluetooth();
    }
    // Define listeners that respond to location updates
    mLocationManager = (LocationManager) this.getSystemService(Context.LOCATION_SERVICE);
    mLocationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, GPS_UPDATE_INTERVAL, 0, this);    
    mLocationManager.addGpsStatusListener(this);
    mLocationManager.addNmeaListener(this);

}
</code></pre>

<p>And here's my onDestroy() where I remove them:</p>

<pre><code>public void onDestroy() {
    super.onDestroy();
    if(D_GEN) Log.d(TAG, ""MainActivity onDestroy, removing update listeners"");
    // Remove the location updates
    if(mLocationManager != null) {
        mLocationManager.removeUpdates(this); 
        mLocationManager.removeGpsStatusListener(this);
        mLocationManager.removeNmeaListener(this);
    }
    if(D_GEN) Log.d(TAG, ""MainActivity onDestroy, finished removing update listeners"");
    if(D_GEN) Log.d(TAG, ""MainActivity onDestroy, stopping Bluetooth"");
    stopBluetooth();
    if(D_GEN) Log.d(TAG, ""MainActivity onDestroy finished"");
}
</code></pre>",android,1427490,John Jorsett,yes
Android keep intentservice running and listen for broadcasts,"<p>Im trying to track how many times the ""SCREEN_ON"" is triggered without the user starting the app. The app itself shows a single activity with some charts and info nothing more. I created a small test but i think it's not the correct way because it's draining my battery.</p>

<p>I got a broadcast receiver ""BOOT_COMPLETED"" that starts a sticky IntentService that is registering the ""SCREEN_ON"" broadcast receiver with a never ending loop to catch to broadcast's (the battery drain problem).</p>

<p>Is it possible that i can listen on the ""SCREEN_ON"" broadcast without a Service?</p>

<p>Jur</p>

<p><strong>Manifest</strong></p>

<pre><code>&lt;manifest xmlns:android=""http://schemas.android.com/apk/res/android""&gt;
&lt;uses-permission android:name=""android.permission.RECEIVE_BOOT_COMPLETED"" /&gt;
&lt;application
    android:name="".Application""
    android:allowBackup=""true""
    android:icon=""@mipmap/ic_launcher""
    android:label=""@string/app_name""
    android:theme=""@style/AppTheme""
    android:hardwareAccelerated=""true""&gt;

    &lt;activity
        android:name="".activities.MainActivity""
        android:label=""@string/app_name"" &gt;
        &lt;intent-filter&gt;
            &lt;action android:name=""android.intent.action.MAIN"" /&gt;
            &lt;category android:name=""android.intent.category.LAUNCHER"" /&gt;
        &lt;/intent-filter&gt;
    &lt;/activity&gt;

    &lt;service android:enabled=""true"" android:name="".services.ScreenOnService"" /&gt;

    &lt;receiver android:name="".broadcast.receivers.AutoStartReceiver""&gt;
        &lt;intent-filter&gt;
            &lt;action android:name=""android.intent.action.BOOT_COMPLETED"" /&gt;
        &lt;/intent-filter&gt;
    &lt;/receiver&gt;
    &lt;receiver android:name="".broadcast.receivers.ScreenOnReceiver""&gt;
        &lt;intent-filter&gt;
            &lt;action android:name=""android.intent.action.SCREEN_ON"" /&gt;
        &lt;/intent-filter&gt;
    &lt;/receiver&gt;
&lt;/application&gt;
</code></pre>

<p></p>

<p><strong>AutoStartReceiver</strong> </p>

<pre><code>public class AutoStartReceiver extends BroadcastReceiver
{
    public void onReceive(Context aContext, Intent anIntent)
    {
        Log.i(""[AutoStartReceiver]"", ""onReceive"");
        aContext.startService(new Intent(aContext, ScreenOnService.class));
    }
}
</code></pre>

<p><strong>ScreenOnReceiver</strong> </p>

<pre><code>public class ScreenOnReceiver extends BroadcastReceiver
{
    @Override
    public void onReceive(Context context, Intent intent)
    {
        Log.i(""[ScreenOnReceiver]"", ""onReceive"");
    }
}
</code></pre>

<p><strong>ScreenOnService</strong></p>

<pre><code>public class ScreenOnService extends IntentService
{
    private ScreenOnReceiver theReceiver;

    public ScreenOnService()
    {
        super(ScreenOnService.class.getName());
        theReceiver = new ScreenOnReceiver();
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId)
    {
        Log.v(""[ScreenOnService]"", ""onStartCommand"");
        super.onStartCommand(intent, flags, startId);
        return START_STICKY;
    }

    @Override
    protected void onHandleIntent(Intent intent)
    {
        Log.i(""[ScreenOnService]"", ""onHandleIntent"");
        registerReceiver(theReceiver, new IntentFilter(Intent.ACTION_SCREEN_ON));
        while(true);
    }

    @Override
    public void onDestroy()
    {
        Log.i(""[ScreenOnService]"", ""onDestroy"");
        unregisterReceiver(theReceiver);
        super.onDestroy();
    }
}
</code></pre>",android,810085,Jurdefur,yes
Determining programatically whether satellite GPS functionality is needed,"<p>Is it possible to determine programatically whether any background applications/services are using the sattelite GPS functionality?
I realise from searching SO that it isn't possible to disable it in code, but that I have to use a button shortcut which does:</p>

<pre><code>Intent myIntent = new Intent(Settings.ACTION_SECURITY_SETTINGS);
startActivity(myIntent);
</code></pre>

<p>and click the relevant settings button.</p>

<p>I've written a maps application but have no access to a real phone at present and notice that the little satellite icon in the emulator's status bar doesn't reflect the state of the system setting. I'd like to try and conserve battery charge and am wondering whether the GPS stays on, draining the battery, if nothing requires its functionality.</p>

<p>I realise that disabling satellite GPS at system level may impact other apps, hence my question.</p>",android,440010,NickT,yes
requestLocationUpdates parameters having no effect on Gingerbread device,"<p>I had previously coded an app with a location listener without access to a real device. Now that I have a Gingerbread phone (2.3.3), as expected my app is a battery killer.</p>

<p>I started examining the effect of the update time and minimum distance arguments to requestLocationUpdates as the documentation says that these will affect battery drain.</p>

<p>I had wondered how just adjusting these parameters could affect the battery drain, as far as I could see the GPS would have to remain on, in order to know what distance the device had moved and only the actual process of notifying the app would change whilst the chip continued using power.</p>

<p>This article <a href=""http://blog.doityourselfandroid.com/2010/12/25/understanding-locationlistener-android/"" rel=""nofollow"">Understanding the LocationListener in Android</a> put forward a credible explanation, indicating that the status would change to 'temporarily unavailable' and the GPS icon would disappear from the screen for a while, until such time as it was necessary to turn back on again according to the update period specified.</p>

<p><strong>This doesn't happen on my phone - the GPS icon stays on even with an update period of 90 seconds and I get no status changes</strong> and according to some of the posts at the end of the article, others find the same.</p>

<ul>
<li><p>Do any users on SO experience the same thing with 2.3.3?</p></li>
<li><p>Or have Android given up on managing the GPS chip and expect users to write their own battery management regime for the GPS?</p></li>
</ul>

<p>For info my minimum code to demonstrate this behaviour is shown below:</p>

<pre><code>public class GpsTimeOutTestActivity extends Activity implements
        LocationListener {

    private LocationManager mLocMgr;
    private long mUpdatePeriod = 90000; // 90 seconds
    private float mMinDistance = 10.0f;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }

    @Override
    protected void onResume() {
        super.onResume();
        getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
        mLocMgr = (LocationManager) getSystemService(LOCATION_SERVICE);
        mLocMgr.requestLocationUpdates(LocationManager.GPS_PROVIDER,
                mUpdatePeriod, mMinDistance, (LocationListener) this);
    }

    @Override
    protected void onPause() {
        mLocMgr.removeUpdates((LocationListener) this);
        super.onPause();
    }

    @Override
    public void onLocationChanged(Location loc) {
        String str = null;
        NumberFormat formatter = new DecimalFormat(""##0.000"");
        String fLat = formatter.format(loc.getLatitude());
        String fLon = formatter.format(loc.getLongitude());
        String provider = loc.getProvider();
        provider = (provider == null) ? ""No provider"" : provider;
        str = ""Locn chg "" + provider + "" Lat/Lon "" + fLat + ""/"" + fLon;
        if (loc.hasAccuracy())
            str+= "" accy "" + loc.getAccuracy();

        showSomeOutput(str);
    }

    @Override
    public void onProviderDisabled(String provider) {
        String str = ""Prov disabled "" + provider;
        showSomeOutput(str);
    }

    @Override
    public void onProviderEnabled(String provider) {
        String str = ""Prov enabled "" + provider;
        showSomeOutput(str);
    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
        String str = ""Status chg "" + provider;
        switch (status) {
        case android.location.LocationProvider.OUT_OF_SERVICE:
            str+= "" OUT OF SERVICE"";
            break;
        case android.location.LocationProvider.AVAILABLE:
            str+= "" AVAILABLE"";
            break;
        case android.location.LocationProvider.TEMPORARILY_UNAVAILABLE:
            str+= "" TEMPORARILY UNAVAILABLE"";
            break;
        default:
            str+= "" UNKNOWN STATUS"";
        }
        showSomeOutput(str);
    }

    private void showSomeOutput(String str) {
        Log.d(""GPSTEST"", str);
        EditText et = (EditText) findViewById(R.id.editText1);
        Editable existingText = et.getText();
        existingText.append(""\n"" + str);
    }
}
</code></pre>

<p>All comments will be gratefully received.</p>",android,440010,NickT,yes
Google Services draining battery of Nexus 6,"<p>This happened three times in the last month:</p>

<p>My Nexus 6 battery drained in several hours. When I reboot and go to battery usage, I always found Google Services uses up to 90% of the battery. However there is no application on my Nexus 6 called ""Google Services"". What does it mean?</p>",android,2561007,darklord,yes
Why does Android app rolls back to a previous version after device shutdown?,"<p>Observed this very strange behavior with Android application. Approximate scenario:</p>

<ol>
<li>Version A installed on the device</li>
<li>Application works alright</li>
<li>Version B installed on the device (B > A)</li>
<li>Application works alright</li>
<li>Device shuts down due to battery drain</li>
<li>Device turned on</li>
<li>Version A of the application runs on the device again</li>
</ol>

<p>Additional info: </p>

<ul>
<li>The application isn't distributed through Google Play, but installed on-premise via USB connection (NOTE: the application runs in production; it's not installed through AndroidStudio).</li>
<li>Kiosk</li>
<li>Android 5.1 (API 22)</li>
</ul>

<p>I guess I've got two questions:</p>

<ul>
<li>Why the device cached the older version of the APK (and where did it cache it)?</li>
<li>Under which circumstances can applications roll back to previous versions like that?</li>
</ul>

<p><strong>Edit (more information):</strong></p>

<ul>
<li>It looks like after the APK is rolled back, the application loses some permissions (maybe even all). Functionality that worked before the roll-back stops working due to SecurityException being thrown from Android's APIs. This happens even though this version of Android doesn't have runtime permissions yet!</li>
<li>After browsing tablet's filesystem, I indeed see several app's APKs residing under similar paths: <code>/data/app/com.myapp-2/base.apk</code>, <code>/data/app/com.myapp-3/base.apk</code>, etc.</li>
</ul>

<p>My current hypothesis is that battery drain causes the tablet to ""reset"" its state (for example, the clock is also reset), and when it's powered again it confuses between app's APKs and loads the wrong one. </p>

<p>However, I have no clue why would it do that, or how to prevent this behavior.</p>",android,2463035,Vasiliy,yes
Android turn off GPS,"<p>Can I turn ON/OFF GPS in an application? As it drains so much of battery, can I turn it OFF for some time? OR there is better solution for this .....                                </p>",android,533844,user533844,yes
My Android App Uses CPU even after closed,"<p>My Application drains the battery.I have used services where a request is sent to url.The service is called from my class which extends Application.Below is my code.</p>

<pre><code>public class GApplication extends Application {
private static final String TAG =""GApplication"";
private HttpClient httpClient;
private DatabaseHelper databaseHelper;

@Override
public void onCreate(){
    super.onCreate();   
    startService(new Intent(this, GService.class));
    httpClient = createHttpClient();
    databaseHelper = new DatabaseHelper(this);
}

@Override
public void onLowMemory(){
    super.onLowMemory();
    shutdownHttpClient();
}

@Override
public void onTerminate(){
    super.onTerminate();
    stopService(new Intent(this, GService.class));
    shutdownHttpClient();
    databaseHelper.close();
}

private void shutdownHttpClient(){
    if(httpClient != null &amp;&amp; httpClient.getConnectionManager() != null){
        httpClient.getConnectionManager().shutdown();
    }
}

public DatabaseHelper getDatabaseHelper(){
    if(databaseHelper == null){
        databaseHelper = new DatabaseHelper(this);
    }
    return databaseHelper;
}

public HttpClient getHttpClient(){
    return httpClient;
}

public HttpClient createHttpClient(){
    HttpParams params = new BasicHttpParams();
    HttpProtocolParams.setVersion(params, HttpVersion.HTTP_1_1);
    HttpProtocolParams.setContentCharset(params, HTTP.DEFAULT_CONTENT_CHARSET);
    HttpProtocolParams.setUseExpectContinue(params, true);

    SchemeRegistry registry = new SchemeRegistry();
    registry.register(new Scheme(""http"", PlainSocketFactory.getSocketFactory(), 80));
    registry.register(new Scheme(""https"", PlainSocketFactory.getSocketFactory(), 443));
    return new DefaultHttpClient(new ThreadSafeClientConnManager(params, registry), params);
}

public boolean isOnline(){
    boolean isConnected = false;
    try{
        ConnectivityManager manager = (ConnectivityManager)getSystemService(Context.CONNECTIVITY_SERVICE);
        NetworkInfo info = manager.getActiveNetworkInfo();
        isConnected = (info != null &amp;&amp; info.isAvailable() &amp;&amp; info.isConnected());
    }
    catch(Exception e){
        isConnected = false;
        if(e.getMessage() != null) Log.e(TAG, e.getMessage());
    }
    return isConnected;
}
</code></pre>

<p>}</p>

<p>My Gservice Class </p>

<pre><code>public class GService extends Service {
private static final String TAG = ""Gservice"";



public IBinder onBind(Intent intent) {
    return null;
}   


public void onCreate(){
    super.onCreate();
    Log.i(TAG, ""starting GService"");

    if(isOnline()){
        URI uri = URI.create(""http://myserver/Android/UploadImage/newAlert.php"");
        new UpdateCheckAsyncTask(getHttpClient()).execute(uri); 
    }

}



boolean isOnline(){
    return ((GApplication)getApplication()).isOnline();
}

HttpClient getHttpClient(){
    return  ((GApplication)getApplication()).getHttpClient();
}

DatabaseHelper getDatabaseHelper(){
    return  ((GApplication)getApplication()).getDatabaseHelper();
}



class UpdateCheckAsyncTask extends WebAsyncTaskBase{
    public UpdateCheckAsyncTask(HttpClient httpClient) {
        super(httpClient);
    }


    protected String doInBackground(URI... params) {
        return getHttpContent(params[0]);
    }


    protected void onProgressUpdate(Integer... progress){

    }


    protected void onPostExecute(String result){
        if(result == null){
            Log.i(TAG, ""Call returned null"");
            return;
        }
        try {
            Log.i(TAG, ""Processsing request"");
            JSONObject json = new JSONObject(result);
            new BlogDbAsyncTask(getDatabaseHelper()).execute(json);
        } catch (JSONException e) {
            if(e.getMessage() != null) Log.e(TAG, e.getMessage());
        }
    }

    class BlogDbAsyncTask extends DbAsyncTaskBase&lt;JSONObject, Boolean, BlogInfo&gt;{

        public BlogDbAsyncTask(DatabaseHelper database) {
            super(database);
        }

        @Override
        protected BlogInfo doInBackground(JSONObject... json) {
            BlogInfo blogInfo = new BlogInfo();
            BlogDAO dao = new BlogDAO(GService.this, getDatabaseHelper());
            try {
                Log.i(TAG, ""Adding new blog entry"");
                Blog blog = dao.Select(json[0].getInt(""FeedId""));
                if(blog.UID == null){
                    blog.UID = json[0].getInt(""FeedId"");
                    blog.Text = json[0].getString(""Text"");
                    blog.Title = json[0].getString(""Header"");
                    blog.PostedOn = json[0].getString(""DisplayDate"");
                    blog.PostedBy = ""Gservice"";
                    dao.Insert(blog);

                    blogInfo.Blog = blog;
                    blogInfo.IsNew = true;
                }
            } catch (JSONException e) {
                if(e.getMessage() != null) Log.e(TAG, e.getMessage());
            }
            return blogInfo;
        }


        protected void onPostExecute(BlogInfo result){


        }

    }

    class BlogInfo{
        public Blog Blog;
        public boolean IsNew;
    }
}
</code></pre>

<p>Probably the Onterminate method is never called in GApplication class which makes the service run continuously.Please Suggest if any issues can be found with this code.Also Suggest how to stop service if onterminate is never called in device..Thanks in advance.</p>",android,808177,hemanth kumar,yes
How to detect backlight is on?,"<p>My application requires resource and drains a battery when it is working. So, I want to know the way that user is not available on the phone.</p>

<p>Is there a way to use the built in power save mode on the blackberry to where if the screen dims to suspend the application works active and when the user wakes the device back up with a keypress or trackball movement to resume the application works active?  </p>

<p>Thanks in advance.</p>",android,164589,Ferdinand,no
Cheap way to measure battery drain in Android,"<p>I need to calculate programmitically the battery drain per hour. E.g. 2% per hour average battery drain.</p>

<p>I would ideally need to calculate this value on each screen On, or just before shutdown/reboot on Froyo onwards.</p>

<p>What can be a cheap/battery efficient way to calculate this value?</p>",android,341791,Saurabh Kumar,yes
Ideal Polling Mechanism/Interval for Android client/server application,"<p>I am planning to implement a chat application in Android, and need to make a few design decisions related to polling the server for updates:</p>

<ol>
<li><p>How often should I poll for new messages? Will polling every minute be a good choice?</p></li>
<li><p>How can real time chat be supported? Should the polling be done every 5 seconds in case the user sends message and then return to long polling interval in case no new message is received? </p></li>
</ol>

<p>I also need to make sure the application does not drain the battery quickly. I need to design the application on similar lines as WhatsApp. I am not sure how does it manage polling, but I know its not a battery killer.</p>",android,913369,Manish,no
How to detect if FLAG_KEEP_SCREEN_ON has been set inside an Activity only?,"<p>My question is with reference to the following link:
<a href=""https://developer.android.com/training/scheduling/wakelock.html"" rel=""nofollow"">https://developer.android.com/training/scheduling/wakelock.html</a></p>

<p>I am using APKs and thus ASM to read through the classes.
I have also gone through ASM Guide by Eric Bruneton.</p>

<p>TraceClassVisitor is the closest I found something close enough to accomplish what I am trying to do.
But it is not good enough.</p>

<p>I have chosen few Android apps from Google PlayStore and am trying to find out if they cause more battery drain than they actually should.........</p>

<p>Using ASM, how do I find out if <code>FLAG_KEEP_SCREEN_ON</code> has been called from inside an Activity only?
If it were a method, I could have just checked if the owner of the method was a class which extends Activity. But the problem here is that <code>FLAG_KEEP_SCREEN_ON</code> will be passed as a parameter by using </p>

<pre><code>getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
</code></pre>

<p>So how do I detect that FLAG_KEEP_SCREEN_ON is set inside an Activity?
If not I will need to log it.</p>",android,3575020,user3575020,no
Monitor every battery state change even with screen off,"<p>I want my app to monitor every percent change and be able to execute some code when it changes even when the screen is off.</p>

<p>Yes, I know this is a bad idea and will drain battery unnecessarily. I am giving the user the option to turn this off. Also, this is more of an experiment at this point than a user-friendly feature. So please do not answer that I should not monitor every change.</p>

<p>I also know this is possible because Tasker implements this quite well. You can set a profile to do something on ""Battery Changed"" and it works when the screen is off. How is Tasker doing this?</p>

<p>From my research I have found that I will probably need to use AlarmManager and a partial wake lock from the PowerManager class. However I don't know how to best use these classes. Should I set an alarm manager to check every minute for a change? Tasker seems to not eat up too much battery when doing this so I would like to keep that in mind. </p>

<p>I have this working when the screen is on just fine. I have a service that registers an ACTION_BATTERY_CHANGED intent filter and a receiver to implement my code that I want to run. However when the screen is off, the code does not run until I ""wake"" the device by turning on the screen.</p>",android,844827,Drew S,yes
sim card with disabled TS11 (Tele Service: Telephony) drains battery,"<p>I have a sim card with disabled TS11 (Tele Service: Telephony), im using this card only for data connection. My question is: it is possible to disalble TS11 service on android? Because when this sim card is in use, my phone thinks that there is no service and trying to find network wchich causes battery drain. Is there any solution for this problem?</p>",android,130024,astropanic,yes
Is any possibility to switch ON the GPS provider in android programmatically?,"<p>Due to the battery drainage, i want to switch ON/OFF the providers programmatically that is background mode. Previously i did with settings activity of providers. But i feel it is not user friendly.</p>

<p>Please help me?</p>",android,1670564,user1670564,no
"Will a short time period for SyncAdapter's periodic sync, necessarily drain the battery?","<p>In this case, ""short time period"" can be 30 seconds up 5 minutes.
My <code>onPerformSync</code> method does almost nothing most of the times, but I'm concerned that the short sync period might prevent the phone from sleeping, and have a drastic effect on battery life.</p>

<pre><code>public void onPerformSync(Account account, Bundle extras, String authority, ContentProviderClient provider, SyncResult syncResult) {

    if (!InternetConnectionDetector.isConnectedToInternet())
        return;

    if (/*We have received a push from server indicating update is available*/)
        syncWithServer();
    else
        return;

}
</code></pre>",android,4723383,Xlv,yes
Android Network Optimization,"<p>I was reading the Android developer docs for network optimization as one of them states the following:</p>
<p><strong>Check for connectivity before making requests</strong></p>
<blockquote>
<p>Searching for a cell signal is one of the most power-draining
operations on a mobile device.
A best practice for user-initiated requests is to first check for a connection using ConnectivityManager,
as shown in Monitor connectivity status and connection metering.
If there’s no network, the app can save battery by not forcing the mobile radio to search.
The request can then be scheduled and performed in a batch with other requests when a connection is made.</p>
</blockquote>
<p>So, does this mean we need to check the network before making every n/w request?</p>
<p>If so then I've been doing it wrong for years now. What are your thoughts on this?</p>
<p>Here's the link to the doc - <a href=""https://developer.android.com/training/connectivity/network-access-optimization#check-connectivity-status"" rel=""nofollow noreferrer"">https://developer.android.com/training/connectivity/network-access-optimization#check-connectivity-status</a></p>",android,4644853,Veeresh Charantimath,yes
How to detect which thing is causing battery drain in my android app?,"<p>Recently I have developed an android app . The app is ok . But the user is complaining that app causing battery drain . Even some battery optimizer app (Like Battery Doctor)  suggesting my app to force stop as it is causing battery draining too fast . There are a lot of service (like sync service , socket service) and broadcast receiver is used in this app and alarm manager is used in the app. How can I detect actually which is responsible for battery draining ?</p>",android|battery,5337440,aroSuv,yes
Measuring and Exporting System Performance on Android Phones in Battery Drainage Experiment,"<p>I am working on an experiment that requires measuring battery drainage and system performance impact for an android app. The app has multiple features that can be turned on and off individually, hence allowing me to measure the impact of each component independently. </p>

<p>The app is a connectivity monitoring tool that gathers information about signal strength, performs QoS tests for both mobile and wi-fi connections, logs information about call duration and GPS info, etc.</p>

<p>To measure the power consumption (hence battery drainage), I will be running the phone using the <a href=""http://www.msoon.com/LabEquipment/PowerMonitor/"" rel=""nofollow"">Monsoon Power Monitor</a> which will be connected to a PC to collect the required data. I will be establishing a baseline first for each Android phone that I will use for the experiment and then perform the app component measurements.</p>

<p>However, I still haven't figured out the best way to measure the system performance metrics (Memory Usage, CPU Load, etc...) in a way that can help me fulfill the following requirements:</p>

<ul>
<li>External Measurement: the measurement needs to be independent of my app. That is, I don't want to add code to log system performance information from within my app. </li>
<li>Exportable: the measurements need to be associated with time and can also be exported for analysis alongside the measurements from the Monsoon Power Monitor. </li>
<li>Rooting the Phone: the method of measuring phone's system performance metrics CANNOT be one that requires rooting of the phone. The environment that is simulated is a typical end user, who usually wouldn't root their phone.</li>
</ul>

<p>From my understanding, there is no way to do an external (totally hardware external) method to gather the performance information. Hence, the next best method is to use another app and establish a base line for that app. However, considering the aforementioned requirements, what application (or potentially a different method) would help me achieve the described objective?</p>

<p>Thanks!</p>",android|battery,1024995,halab,yes
Battery draining issue in my android application,"<p>We've a application which is using location manager and gcm push notification. Rest of components are like UI etc. 
Issue is that my application is using normal battery drain as expected when both push notification and location service is enabled. 
But now days with some devices, customers are reporting that my device is using unexpected battery draining and some time application's battery manager showing warning even. </p>

<p>As concern to Location, I'm using location manager with time and distance component under a android service. 
Gcm push implemention is simple as all other applications, like registering push and once push generated, getting push notification.
So, I'm seeing only unusual thing in my app is that background service with location manager registered for significant location change (on behalf of time and distance).
But when my application is not using location service, then also some time reported for battery drain.
So, I wanted to know about the any tools that what is causing of battery drain in my app, is there any tools available? How can we identify that which part of application is cause of battery drain?</p>

<p>****Edit - I come to know by tester that it's happening on a specific device, which recently launched i.e Samsung S7 Edge device. Is someone have any idea for similar issue reported?</p>",android|battery,579936,Pankaj,no
Android: Determine where app is draining battery?,"<p>My app is draining a lot of the battery, but I don't know what in my app could be causing this. What is a good way for me to determine what part of my app is causing such a huge drain on the battery?</p>

<p><b>EDIT :</b><br>
So I found out my Location Listener was not being unregistered, and I fixed that.</p>",android|battery,548852,Hank,yes
Steps to investigate battery drain issue on Android,"<p>I am working on an Android app now and now it is in beta release. However, a number of my beta users are claiming that they are experiencing battery drain, compared to before installing the app.</p>

<p>It looks like it is only impacting some users, but I am unable to pinpoint why yet.</p>

<p>I am using GPS and GCM in this application. I have followed the guidelines in Android Developers' documentation (removing the location client when onStop() is called). The app will not attempt to refresh data from the server if there is no network connection. However, I have some users saying that the app is in background all the time but the app drained more than 10% of the battery. (!!)</p>

<p>1) Should I remove the WAKE_LOCK permission associated with GCM?</p>

<p>2) What else can I do about the get Location? I am only calling getLocation in a few activities when they start. There is no interval update.</p>

<p>3) Any other potential battery drain culprits that I may missed out?</p>",android|battery,1755709,Lorteld,yes
How can I find out how much battery my Android app consumes on user's devices?,"<p>I am writing an app to evaluate the feasibility of a Bluetooth P2P network on Android.</p>

<p>I noticed that on a Galaxy Nexus, it uses very little battery, while on a Nexus S, it drains the battery very quickly. This is directly caused by high CPU load due to Bluetooth.</p>

<p>Now, I would like to collect information about how much battery drain my app causes on the devices it is installed upon. Simply logging time vs. battery level is useless since I don't know when the device is in use, and even if I logged that, I would not know if the user is playing 3D games while Torrenting over WiFi or reading an eBook on a dimmed screen.</p>

<p>To make the problem worse, not all battery usage caused by my app is attributed to it in the battery screen - some is listed as ""Bluetooth"", for example (again, device-dependent).</p>

<p><strong>Is there any easy, privacy-preserving way to get useful information on non-rooted devices?</strong> The devices are not under my control. I cannot simply go look in the menu, I cannot use ADB.</p>",android|battery,1939031,Jan Schejbal,yes
App draining battery,"<p>I've an app that has been out in production for a year and is working ok with regard to battery life. The latest version of the app now stores some data(2k a few times per day) in the sqlite DB. It also redraws a progressbar when the signal strength changes.</p>

<p>One customer is saying that 20 of their staff who have the latest version, cannot make the phone battery last more than 5 hrs. It used to last 10 or 12 hrs. The above changes are the only ones i have made in the latest version.</p>

<p>can redrawing the view on every signal change half the battery's life over a day?</p>

<p>thanks Matt.</p>",android|battery,532462,turtleboy,no
"I'm getting reports that my app is draining the battery, but only on HTC Incredible","<p>Has anyone else noticed behavior specific to the HTC Incredible that might result in an app keeping the device awake and busy? I've received reports that my app is responsible for keeping the device awake and draining the battery, but only from HTC Incredible users. </p>

<p>My app responds to a number of Intents that might be related. It has a service that starts on boot, and it also responds to changes in network connectivity. I do use a WakeLock, but I'm careful to release it when I'm done processing, and the WakeLock times out after a couple minutes whether I'm done or not.</p>

<p>I've heard that the Incredible may have some connectivity problems, or that some of them do. Could it be that the network is going up and down frequently, triggering my app?</p>

<p>Any other ideas? I've asked a user to send me their logs with aLogCat. If they're willing, that may help narrow down the cause.</p>",android|battery,301145,BenTobin,yes
Android - Drain battery quickly on purpose,"<p>I am nearly finished with my app and last functionality to be made is to call specific action when battery level reaches below specific level.</p>

<p>So for test purposes I am wondering - how can I drain battery?</p>

<p>P.S - Using AVD wont work since my app is using Google Play services so I am testing app on my phone. </p>",android|battery,3794065,arleitiss,no
Android-Need to find GPS signal strength without turning on GPS,"<p>My app should find the current location using <code>GPS</code>,<code>Cellular network</code> or<code>WiFi</code>.I can easily find out the current location by <code>GPS</code></p>

<pre><code>LocationManager locationmanager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
LocationListener locationlistener = new mylocationlistener();
locationmanager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, locationlistener);
</code></pre>

<p>where <code>mylocationlistener()</code>function is like below</p>

<pre><code>private class mylocationlistener implements LocationListener {
  @Override
  public void onLocationChanged(Location location) {
      if (location != null) {
      Toast.makeText(LocationActivity.this,""latitude: ""+
          location.getLatitude() + ""longitude: "" + location.getLongitude(),
          Toast.LENGTH_LONG).show();
      }
  }
</code></pre>

<p>It is working properly.I can use celluler network to find out the current location by the above code where i need to change <code>locationmanager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, locationlistener);</code></p>

<p>it is  okey but my challenge is</p>

<ol>
<li>I need to find the GPS signal strength in order to activate GPS.If GPS signal strength is poor then i can't activate GPS because it will drain battery.</li>
<li>If GPS signal is poor i have to find out the current location by cellular network or WiFi.</li>
</ol>

<p>So,my question is that if there any way to determine the GPS signal strength without turning on <code>GPS</code>?
Thank you advance for any kind of help.</p>",android|gps,1432009,Humayun Kabir,no
Android Latitude and Longitude with out GPS or city name,<p>How can I get my location in latitude and longitude from android code. I dont want to use GPS as it drains battery and dont wana give my city or country name. Can you please share the code sample to get my current location.</p>,android|gps,989001,Jewel,no
Does the Android GPS drain battery when trying to get first fix?,"<p>I noticed something odd on my HTC Desire S Android phone: If the GPS cannot get a fix the GPS icon in the notification bar stays blinking the whole day. Even if I force stop all applications using the GPS the icon keeps on blinking.</p>

<p>Blinking means that it hasn't gotten a fix. It seems like the GPS is continuously trying to get that first fix. If I cannot shut off the GPS during initial fix, does it still drain the battery as if it had a fix?</p>",android|gps,807802,MarcFasel,yes
Best way to collect GPS points periodically in android without draining battery?,"<p>Could someone help me with a sample program on this?
How to get a location with an interval of 15 min?</p>

<pre><code>locationManager = (LocationManager) getSystemService(LOCATION_SERVICE);
Criteria criteria = new Criteria();
criteria.setAccuracy(Criteria.ACCURACY_FINE);
criteria.setPowerRequirement(Criteria.POWER_LOW);
final String bestProvider1 = locationManager.getBestProvider(criteria, true);
locationManager.requestLocationUpdates(
            bestProvider1,
            75000,
            1, GPSLocationService.this);
Location location = locationManager.getLastKnownLocation(bestProvider1);'
</code></pre>",android|gps,3836168,user3836168,yes
How to determine if user is in motion,"<p>I have an application that is a service and what I want to do is have the service kick on when the user is in motion, going faster then 10 mph (or whatever value I want).</p>

<p>What I don't want to do is keep polling the GPS because if I do that, the battery will drain fast.</p>

<p>What are some options that I can use to do this? Realistic options that will not drain the battery would be great! Thank for the help.</p>",android|gps,98094,Icemanind,yes
how to use background gps properly in android,"<p>I am writing a service that records your gps location every 30 mins. what should I write to turn on a location listener, wait x mins until my location.accuracy is less than 25 meters, then turn off the location listener.</p>

<p>Right now my method is draining too much battery and its not acceptable.</p>

<p>Thank you</p>",android|gps,875584,Sean,yes
Android requestLocationUpdates with a 15 minute interval is causing gps indicator to fire constantly,"<p>this is the requestLocationUpdates call I am using, 900000 (15 minutes) and 500 meters shouldn't be causing the gps to fire constantly, its really draining battery...</p>

<p>I know this code isn't helpful.. But does anyone know why this might be happening?</p>

<p>in my onStartCommand</p>

<pre><code>mlocManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 900000, 500, locationListener);
mLocation = mlocManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);
</code></pre>

<p>and then</p>

<pre><code>private final LocationListener locationListener = new LocationListener() {
    public void onLocationChanged(Location location) {
        mLocation = location;
    }

    @Override
    public void onProviderDisabled(String arg0) {}
    @Override
    public void onProviderEnabled(String arg0) {}
    @Override
    public void onStatusChanged(String arg0, int arg1, Bundle arg2) {}
};
</code></pre>",android|gps,726398,David,yes
GPS icon still shows in Android after removeProximityAlert,"<p>Why does the GPS icon still show  up in notification bar when I already remove Proximity Alert</p>

<blockquote>
  <p>removeProximityAlert</p>
</blockquote>

<p>I gave the same PendingIntent that I gave to AddProximityAlert and Proximity Alert is no longer working but GPS icon isn't gone.</p>

<p>Does that mean device still tries to get my position and drain battery? </p>",android|gps,1158939,Intathep,no
What should be the idle time of detection interval while requesting activity updates?,"<p>I am currently using the ActivityRecognitionClient API to get activity updates regularly. Now the detection interval I used to run it for only 3 seconds. I am getting the result, but along with that battery is draining faster also.</p>
<p>When I was going through android developer site for this, it says less detection interval will drain battery faster, but larger values will result in fewer activity detections while improving battery life. In that case if I put 30 sec or 20 sec time, then there are very few detection.</p>
<p>Website - <a href=""https://developers.google.com/android/reference/com/google/android/gms/location/ActivityRecognitionClient"" rel=""nofollow noreferrer"">ActivityRecognitionClient API Details</a></p>
<blockquote>
<p>My question is here what should be the idle detection time interval we
put so that we can get activity detection as well as our battery life
also should not affect much.</p>
</blockquote>",android|location,5363055,Sudhansu,yes
Android: How to periodically check current location without draining the battery,"<p>I have a background service which works periodically by <code>timer.scheduleAtFixedRate</code>.
It wakes up every amount of time (let's say 60 seconds for example) and checks for the location.</p>

<p>The location is checked by <code>locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 60000, 5, listener);</code> and the actual location is collected from the listener's <code>onLocationChanged</code>.</p>

<p>Now, when the phone is outside and GPS reception is good, this works fine.
But, if the phone is inside, the GPS is almost always active - looking for a signal, and the battery is drained rapidly.</p>

<p>I created another thread using a Handler and a Runnable in order to conrol the GPS active time accurately:
I used <code>locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, listener);</code> and <code>locManager.removeUpdates(listener);</code> so I can open and close the GPS as I want.
In this case, I can open the GPS for the exact amount of time, but found out that it doesn't lock in an area with good reception even after 10 seconds. So here I'm draining the battery again...</p>

<p>I'm using API level 7, hence I cannot use <code>locationManager.requestSingleUpdate</code>.
I have two questions:</p>

<ol>
<li>Is there any way to optimize this process?</li>
<li>Will upgrading to API level 9 (and use <code>locationManager.requestSingleUpdate</code>) improve the process significantly? I mean, does it worth upgrading?</li>
</ol>",android|location,1398764,uyahalom,no
Fused Location Provider should invoke onLocationChanged() only when user's location changes,"<p>My app requires user's location only when user location changes. I can very easily know the user location when wifi/gps are turned on and when I code this:</p>

<pre><code>mLocationRequest.setInterval(LocationUtils.UPDATE_INTERVAL_IN_MILLISECONDS);    //10 seconds                    
mLocationRequest.setFastestInterval(LocationUtils.FAST_INTERVAL_CEILING_IN_MILLISECONDS);  
</code></pre>

<p>By coding this, the onLocationChanged() is called after every 10 seconds even if user's location is not changed. Why?
This is unneccessarily draining the battery. I want that when user moves then only my app should have the updated location.
In Google I/O 2013, it is said that through sensors (Fused Location Provider) user's location need not be traced if he is sitting at one place.
I commented the above lines and coded:</p>

<pre><code>    mLocationRequest.setPriority(LocationRequest.PRIORITY_BALANCED_POWER_ACCURACY);
    mLocationRequest.setSmallestDisplacement(50.0f);    //50 meters
</code></pre>

<p>I can see only once that I walked 50 meters and the onLocationChanged() is called. I have never seen onLocationChanged() invoked at other times.</p>

<pre><code>protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // Get handles to the UI view objects

    // Create a new global location parameters object
    mLocationRequest = LocationRequest.create();

    /**
     * If below two lines are commented the location change method is not called.
     */
   // mLocationRequest.setInterval(LocationUtils.UPDATE_INTERVAL_IN_MILLISECONDS);                      //Set the update interval
    //mLocationRequest.setFastestInterval(LocationUtils.FAST_INTERVAL_CEILING_IN_MILLISECONDS);         // Set the interval ceiling to one minute

    // Use high accuracy
    mLocationRequest.setPriority(LocationRequest.PRIORITY_BALANCED_POWER_ACCURACY);
    mLocationRequest.setSmallestDisplacement(50.0f);


    /*
     * Create a new location client, using the enclosing class to
     * handle callbacks.
     */
    mLocationClient = new LocationClient(this, this, this);

}

@Override
public void onStart() {

    super.onStart();
    mLocationClient.connect();

}
}

  public void getLocation(View v) {

    // If Google Play Services is available
    if (servicesConnected()) {

        // Get the current location
        Location currentLocation = mLocationClient.getLastLocation();

        // Display the current location in the UI
        mLatLng.append(""\nLast Location: ""+LocationUtils.getLatLng(this, currentLocation));
    }
}

public void startUpdates(View v) {
    mUpdatesRequested = true;

    if (servicesConnected()) {
        startPeriodicUpdates();
    }
}

@Override
public void onConnected(Bundle bundle) {
    mConnectionStatus.setText(R.string.connected);

    if (mUpdatesRequested) {
        startPeriodicUpdates();
    }
}
</code></pre>

<p>@Override
    public void onConnected(Bundle bundle) {
        mConnectionStatus.setText(R.string.connected);</p>

<pre><code>    if (mUpdatesRequested) {
        startPeriodicUpdates();
    }
}
</code></pre>

<p>public void onLocationChanged(Location location) {</p>

<pre><code>    // Report to the UI that the location was updated
    mConnectionStatus.setText(R.string.location_updated);

    // In the UI, set the latitude and longitude to the value received
    mLatLng.append(""\nLoc Changed:""+LocationUtils.getLatLng(this, location));
}

/**
 * In response to a request to start updates, send a request
 * to Location Services
 */
private void startPeriodicUpdates() {

    mLocationClient.requestLocationUpdates(mLocationRequest, this);
    mConnectionState.setText(R.string.location_requested);
}
</code></pre>

<p>How can I have the onLocationChanged() invoke only when the user's location change. If the user is sitting at one place, this method should not be invoked.       </p>",android|location,578098,Khushboo,no
Android GeoFencing Dwell,"<p>I want to detect when a user is visiting a place for more then about 10 minutes.
The user has to give a location in advance that he/she wants to track visits to.</p>

<p>I'm wondering about the best way to implement this.
In Android geofencing I am aware of the ""dwell"" type, but I'm wondering if this causes a battery drain.</p>

<p>Talking to some people, I hear iOS has something called ""visits"". Is there an Android counterpart?</p>

<p>I am aware that my question is broad, but I just need to be pointed in the right direction.</p>

<p><strong>Summary</strong>
Best way to detect when a user ""visits"" a place which is not too aggressive on the battery.</p>",android|location,3220953,TomCB,yes
How frequently does the Android OS itself (not apps) poll for Location?,"<p>I'm looking at writing a location-aware application for Android.  My application would periodically make calls to a central server, passing in the current user's location.  I don't want to drain the battery, so I've been considering using the <code>Passive</code> Location Provider.</p>

<p>According to the provider description no active polling is performed (hence being labelled ""Passive"").  Instead, it relies on other applications requesting active polls.</p>

<p>My question is:  If no other applications poll for Location, does it mean the <code>Passive</code> provider never provides any data?  Or, does the Android OS itself periodically poll for Location.  If so, what is the polling frequency?</p>

<p>Thanks</p>",android|location,569777,MetaFight,yes
Which applications are using location service?,"<p>I found that location service drain my battery. But I think it is not because location service  is ON, it is because some application use that service a lot. Is there any way to find, which application set location service wrong (with high load)? Can I get list of application using location service right now?
Thank you in advance for any help.</p>",android|location,2463173,Michal,yes
service that will run and stop automatically in background,"<p>need a service that will run in background and it will awake after 30-120 seconds and find the location where the device is,then send the location to the data center and go to sleep.Again 30-120 seconds later service awake and determine location and go to sleep. I can start and stop the service manually.But i need to start(between 30 to 120 sec) and stop the service automatically.I can not remain the service live cause it will drain the battery.</p>

<pre><code>So,My question is how can i start and stop the service automatically?
</code></pre>

<p>Thanks advance for any suggestion.</p>

<p>My code is</p>

<pre><code>public class Service extends Activity {
   @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Button start = (Button)findViewById(R.id.startButton);
        Button stop = (Button)findViewById(R.id.stopButton);

        start.setOnClickListener(startListener);
        stop.setOnClickListener(stopListener);

   }

private OnClickListener startListener = new OnClickListener() {
public void onClick(View v){
    startService(new Intent(Service.this,SimpleService.class));
}               
</code></pre>

<p>};</p>

<pre><code>private OnClickListener stopListener = new OnClickListener() {
    public void onClick(View v){
        stopService(new Intent(Service.this,SimpleService.class));
    }               
};
}
</code></pre>",android|service,1432009,Humayun Kabir,yes
Stop Android Service after some time?,"<p>I have a  background service in my app which is started by Widget. When User Starts service it's going to run until user stop it. And that can drain battery a lot if user forgets to stop it.
I want to add some safety to switch. To stop service after some time like 5 or 10 minutes. What is the best way to do this? </p>",android|service,3013161,Slim C.,yes
"startService restart my service if currently running, the Android docs say the opposite","<p>in my service, I download a lot of stuff from the internet and would like to do this every x hours (choice in Preferences)</p>

<p>The current implementation I have written in this code in the main Activity:</p>

<pre><code>    Intent svc = new Intent(this, AlarmService.class);

    if (startService(svc)!=null) {
        Log.i(this.getClass().toString(), ""Service already running"");
    } else {
        Log.i(this.getClass().toString(), ""Service Started"");
    }
</code></pre>

<p>Because, according to <a href=""http://developer.android.com/reference/android/content/Context.html#startService%28android.content.Intent%29"" rel=""nofollow"">the docs</a></p>

<blockquote>
  <p>Request that a given application service be started. The Intent can
  either contain the complete class name of a specific service
  implementation to start, or an abstract definition through the action
  and other fields of the kind of service to start. If this service is
  not already running, it will be instantiated and started (creating a
  process for it if needed); <strong>if it is running then it remains running</strong>.</p>
</blockquote>

<p>That last sentence that I highlited let me hope that I could write all my heavy code in the onCreate of the service and it will be untouched, but unfortunately, everytime the user starts the app, the service starts again and make a huge download, draining the battery.</p>

<p>The indication if the service is running or not is correct:</p>

<blockquote>
  <p>Returns If the service is being started or is already running, the
  ComponentName of the actual service that was started is returned; else
  if the service does not exist null is returned.</p>
</blockquote>

<p>So, my question, How can I let the service untouched if already started, and start it if not yet started?</p>

<p>Thanks</p>

<p>EDIT:</p>

<p>The service in never stopped:</p>

<pre><code>public class AlarmService extends Service {

    Alarm alarm = new Alarm();

    public void onCreate() {
        super.onCreate();
        Log.i(""**"", ""onCreate"");
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        Log.i(""LocalService"", ""Received start id "" + startId + "": "" + intent);
        // DO NOTHING FOR TESTING alarm.SetAlarm(this);
        return START_STICKY;
    }

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }
}
</code></pre>",android|service,327402,Waza_Be,yes
Android service - keep checking the current time if it match a saved time,"<p>My Android service has to keep checking if the current time is matching a saved time. I used a service which has a timer that every minute checks if the current time is matching the saved time. If Android goes to sleep mode, he stops checking. I tried WakeLocker for this problem. It works, but it drains my battery.</p>

<p>The code I'm currently using is as follow.</p>

<pre><code>    public class AlarmService extends Service {

    private static Timer timer = new Timer(); 
    private Context ctx;
    private WakeLock wakeLock;

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
      return Service.START_STICKY;
    }

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public void onCreate() {
        Toast.makeText(this, ""The new Service was Created"", Toast.LENGTH_LONG).show();
        super.onCreate();
        ctx = this; 
        startService();

        /* Wake locker
        PowerManager mgr = (PowerManager)this.getSystemService(Context.POWER_SERVICE);
        wakeLock = mgr.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, ""Wake locker"");
        wakeLock.acquire();
        */

    }

    private void startService()
    {           
        timer.scheduleAtFixedRate(new mainTask(), 0, 60000);
    }

    @Override
    public void onStart(Intent intent, int startId) {
        Toast.makeText(this, "" Service Started"", Toast.LENGTH_LONG).show();
        startService();
    }

    @Override
    public void onDestroy() {
        Toast.makeText(this, ""Service Destroyed"", Toast.LENGTH_LONG).show();
    }

    private class mainTask extends TimerTask
    { 
        public void run() 
        {
            toastHandler.sendEmptyMessage(0);
        }
    }  

    private final Handler toastHandler = new Handler()
    {
        @Override
        public void handleMessage(Message msg)
        {
            Calendar cal = Calendar.getInstance(TimeZone.getTimeZone(""Europe/Amsterdam""));
            Date currentLocalTime = cal.getTime();
            DateFormat date = new SimpleDateFormat(""HH:mm"", new Locale(""nl"", ""nl""));
            date.setTimeZone(TimeZone.getTimeZone(""Europe/Amsterdam"")); 
                String currenttime = date.format(currentLocalTime); 

                DateFormat date2 = new SimpleDateFormat(""EEEE"", new Locale(""nl"", ""nl""));
                date2.setTimeZone(TimeZone.getTimeZone(""Europe/Amsterdam"")); 
                    String currentday = date2.format(currentLocalTime); 

            if(currentday.equals(""maandag"")) { // ""maandag"" is dutch for Monday
                String tijd1 = ""16:00"";

                if(currenttime.equals(tijd1)) {
                    NotificationCompat.Builder mBuilder = 
                            new NotificationCompat.Builder(AlarmService.this)
                            .setSmallIcon(R.drawable.ic_launcher)
                            .setContentTitle(""Test message"") .setAutoCancel(true)
                            .setAutoCancel(true)
                            .setContentText(""This is a test message"");
                    Intent resultIntent = new Intent(AlarmService.this, MainActivity.class);
                    TaskStackBuilder stackBuilder = TaskStackBuilder.create(AlarmService.this);
                    stackBuilder.addParentStack(MainActivity.class);
                    stackBuilder.addNextIntent(resultIntent);
                    PendingIntent resultPendingIntent = stackBuilder.getPendingIntent(0, PendingIntent.FLAG_UPDATE_CURRENT);
                    mBuilder.setContentIntent(resultPendingIntent);
                    NotificationManager mNotificationManager = (NotificationManager) AlarmService.this.getSystemService(Context.NOTIFICATION_SERVICE);
                    mNotificationManager.notify(1, mBuilder.build());

                }                
            }
        }
    }; 
}
</code></pre>

<p>Does somebody have a solution for this problem, which doesn't drain my battery? So it has to check if the current time is matching the saved time, even when Android is sleeping.</p>

<p>Thanks!</p>",android|service,1462219,Jacob,no
PhoneStateListener onSignalStrengthsChanged stops being called in Service,"<p>I'm writing simple application containing two elements - Service and Activity. Activity is used only for starting and stopping the service. Service uses <code>PhoneStateListener</code> to get information about current CellID, LAC and RSSI (signal strength) and log them into file.</p>

<p>Everything works fine while phone is not sleeping. I've noticed that after switching off the screen and few minutes of inactivity my <code>PhoneStateListener</code> is not invoked anymore. I tried adding PARTIAL_WAKE_LOCK (and other types of locks too) into my service, but I guess it causes severe battery drain and shouldn't be used that way. On the other hand it didn't really help me though. My another try was to use Timer and unregister/register my <code>PhoneStateListener</code> in specified intervals. Unexpectedly, it looks that this way helped with refreshing CellId and LAC (so I guess that <code>onCellLocationChanged()</code> from my listener was called), but the signal strength still wasn't updated.</p>

<p>I didn't try using <code>BroadcastReciever</code>, but after some digging into topic and reading threads on SO I don't think it would work for me.</p>

<p>To sum up, my question: Why are <code>PhoneStateListener</code> methods not called when phone is in sleep? Is there any way (like force phone to wake up or to use different mechanism) to overcome this behavior efficiently?</p>",android|service,465685,mih,no
How to make android service run every day once,"<p>I have a service that runs well but when phone goes to deep sleep , the service stop working .</p>

<p>I want to make use of some android class that makes the service to run everyday 
at specific time ,??</p>

<p>i have tried wakelock but it drains the battery very fast for 24/24 cpu on </p>

<p>Any HELP ??</p>",android|service,7927096,Ahmad Basic,yes
